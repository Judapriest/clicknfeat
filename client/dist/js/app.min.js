"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(b){if(b._babelPolyfill)throw new Error("only one instance of babel/polyfill is allowed");b._babelPolyfill=!0,a("core-js/shim"),a("regenerator/runtime")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"core-js/shim":72,"regenerator/runtime":73}],2:[function(a,b,c){var d=a("./$");b.exports=function(a){return function(b){var c,e=d.toObject(this),f=d.toLength(e.length),g=d.toIndex(arguments[1],f);if(a&&b!=b){for(;f>g;)if(c=e[g++],c!=c)return!0}else for(;f>g;g++)if((a||g in e)&&e[g]===b)return a||g;return!a&&-1}}},{"./$":16}],3:[function(a,b,c){var d=a("./$"),e=a("./$.ctx");b.exports=function(a){var b=1==a,c=2==a,f=3==a,g=4==a,h=6==a,i=5==a||h;return function(j){for(var k,l,m=Object(d.assertDefined(this)),n=d.ES5Object(m),o=e(j,arguments[1],3),p=d.toLength(n.length),q=0,r=b?Array(p):c?[]:void 0;p>q;q++)if((i||q in n)&&(k=n[q],l=o(k,q,m),a))if(b)r[q]=l;else if(l)switch(a){case 3:return!0;case 5:return k;case 6:return q;case 2:r.push(k)}else if(g)return!1;return h?-1:f||g?g:r}}},{"./$":16,"./$.ctx":10}],4:[function(a,b,c){function d(a,b,c){if(!a)throw TypeError(c?b+c:b)}var e=a("./$");d.def=e.assertDefined,d.fn=function(a){if(!e.isFunction(a))throw TypeError(a+" is not a function!");return a},d.obj=function(a){if(!e.isObject(a))throw TypeError(a+" is not an object!");return a},d.inst=function(a,b,c){if(!(a instanceof b))throw TypeError(c+": use the 'new' operator!");return a},b.exports=d},{"./$":16}],5:[function(a,b,c){var d=a("./$");b.exports=Object.assign||function(a,b){for(var c=Object(d.assertDefined(a)),e=arguments.length,f=1;e>f;)for(var g,h=d.ES5Object(arguments[f++]),i=d.getKeys(h),j=i.length,k=0;j>k;)c[g=i[k++]]=h[g];return c}},{"./$":16}],6:[function(a,b,c){function d(a){return g.call(a).slice(8,-1)}var e=a("./$"),f=a("./$.wks")("toStringTag"),g={}.toString;d.classof=function(a){var b,c;return void 0==a?void 0===a?"Undefined":"Null":"string"==typeof(c=(b=Object(a))[f])?c:d(b)},d.set=function(a,b,c){a&&!e.has(a=c?a:a.prototype,f)&&e.hide(a,f,b)},b.exports=d},{"./$":16,"./$.wks":27}],7:[function(a,b,c){function d(a,b){if(!m(a))return("string"==typeof a?"S":"P")+a;if(p(a))return"F";if(!k(a,q)){if(!b)return"E";n(a,q,++w)}return"O"+a[q]}function e(a,b){var c,e=d(b);if("F"!=e)return a[r][e];for(c=a[t];c;c=c.n)if(c.k==b)return c}var f=a("./$"),g=a("./$.ctx"),h=a("./$.uid").safe,i=a("./$.assert"),j=a("./$.iter"),k=f.has,l=f.set,m=f.isObject,n=f.hide,o=j.step,p=Object.isFrozen||f.core.Object.isFrozen,q=h("id"),r=h("O1"),s=h("last"),t=h("first"),u=h("iter"),v=f.DESC?h("size"):"size",w=0;b.exports={getConstructor:function(a,b,c){function d(e){var g=i.inst(this,d,a);l(g,r,f.create(null)),l(g,v,0),l(g,s,void 0),l(g,t,void 0),void 0!=e&&j.forOf(e,b,g[c],g)}return f.mix(d.prototype,{clear:function(){for(var a=this,b=a[r],c=a[t];c;c=c.n)c.r=!0,c.p&&(c.p=c.p.n=void 0),delete b[c.i];a[t]=a[s]=void 0,a[v]=0},"delete":function(a){var b=this,c=e(b,a);if(c){var d=c.n,f=c.p;delete b[r][c.i],c.r=!0,f&&(f.n=d),d&&(d.p=f),b[t]==c&&(b[t]=d),b[s]==c&&(b[s]=f),b[v]--}return!!c},forEach:function(a){for(var b,c=g(a,arguments[1],3);b=b?b.n:this[t];)for(c(b.v,b.k,this);b&&b.r;)b=b.p},has:function(a){return!!e(this,a)}}),f.DESC&&f.setDesc(d.prototype,"size",{get:function(){return i.def(this[v])}}),d},def:function(a,b,c){var f,g,h=e(a,b);return h?h.v=c:(a[s]=h={i:g=d(b,!0),k:b,v:c,p:f=a[s],n:void 0,r:!1},a[t]||(a[t]=h),f&&(f.n=h),a[v]++,"F"!=g&&(a[r][g]=h)),a},getEntry:e,getIterConstructor:function(){return function(a,b){l(this,u,{o:a,k:b})}},next:function(){for(var a=this[u],b=a.k,c=a.l;c&&c.r;)c=c.p;return a.o&&(a.l=c=c?c.n:a.o[t])?"key"==b?o(0,c.k):"value"==b?o(0,c.v):o(0,[c.k,c.v]):(a.o=void 0,o(1))}}},{"./$":16,"./$.assert":4,"./$.ctx":10,"./$.iter":15,"./$.uid":25}],8:[function(a,b,c){function d(a,b){return s.call(a.array,function(a){return a[0]===b})}function e(a){return a[q]||l(a,q,{array:[],get:function(a){var b=d(this,a);return b?b[1]:void 0},has:function(a){return!!d(this,a)},set:function(a,b){var c=d(this,a);c?c[1]=b:this.array.push([a,b])},"delete":function(a){var b=t.call(this.array,function(b){return b[0]===a});return~b&&this.array.splice(b,1),!!~b}})[q]}var f=a("./$"),g=a("./$.uid").safe,h=a("./$.assert"),i=a("./$.iter").forOf,j=f.has,k=f.isObject,l=f.hide,m=Object.isFrozen||f.core.Object.isFrozen,n=0,o=g("id"),p=g("weak"),q=g("leak"),r=a("./$.array-methods"),s=r(5),t=r(6);b.exports={getConstructor:function(a,b,c){function d(e){f.set(h.inst(this,d,a),o,n++),void 0!=e&&i(e,b,this[c],this)}return f.mix(d.prototype,{"delete":function(a){return k(a)?m(a)?e(this)["delete"](a):j(a,p)&&j(a[p],this[o])&&delete a[p][this[o]]:!1},has:function(a){return k(a)?m(a)?e(this).has(a):j(a,p)&&j(a[p],this[o]):!1}}),d},def:function(a,b,c){return m(h.obj(b))?e(a).set(b,c):(j(b,p)||l(b,p,{}),b[p][a[o]]=c),a},leakStore:e,WEAK:p,ID:o}},{"./$":16,"./$.array-methods":3,"./$.assert":4,"./$.iter":15,"./$.uid":25}],9:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.iter"),g=a("./$.assert").inst;b.exports=function(b,c,h,i,j){function k(a,b){var c=o[a];d.FW&&(o[a]=function(a,d){var e=c.call(this,0===a?0:a,d);return b?this:e})}var l=d.g[b],m=l,n=i?"set":"add",o=m&&m.prototype,p={};if(d.isFunction(m)&&(j||!f.BUGGY&&o.forEach&&o.entries)){var q,r=new m,s=r[n](j?{}:-0,1);a("./$.iter-detect")(function(a){new m(a)})||(m=function(a){g(this,m,b);var c=new l;return void 0!=a&&f.forOf(a,i,c[n],c),c},m.prototype=o,d.FW&&(o.constructor=m)),j||r.forEach(function(a,b){q=1/b===-(1/0)}),q&&(k("delete"),k("has"),i&&k("get")),(q||s!==r)&&k(n,!0)}else m=h.getConstructor(b,i,n),d.mix(m.prototype,c);return a("./$.cof").set(m,b),a("./$.species")(m),p[b]=m,e(e.G+e.W+e.F*(m!=l),p),j||f.std(m,b,h.getIterConstructor(),h.next,i?"key+value":"value",!i,!0),m}},{"./$":16,"./$.assert":4,"./$.cof":6,"./$.def":11,"./$.iter":15,"./$.iter-detect":14,"./$.species":22}],10:[function(a,b,c){var d=a("./$.assert").fn;b.exports=function(a,b,c){if(d(a),~c&&void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./$.assert":4}],11:[function(a,b,c){function d(a,b){return function(){return a.apply(b,arguments)}}function e(a,b,c){var j,k,l,m,n=a&e.G,o=n?g:a&e.S?g[b]:(g[b]||{}).prototype,p=n?h:h[b]||(h[b]={});n&&(c=b);for(j in c)k=!(a&e.F)&&o&&j in o,l=(k?o:c)[j],m=a&e.B&&k?d(l,g):a&e.P&&i(l)?d(Function.call,l):l,o&&!k&&(n?o[j]=l:delete o[j]&&f.hide(o,j,l)),p[j]!=l&&f.hide(p,j,m)}var f=a("./$"),g=f.g,h=f.core,i=f.isFunction;g.core=h,e.F=1,e.G=2,e.S=4,e.P=8,e.B=16,e.W=32,b.exports=e},{"./$":16}],12:[function(a,b,c){b.exports=function(a){return a.FW=!0,a.path=a.g,a}},{}],13:[function(a,b,c){b.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3]);case 5:return d?a(b[0],b[1],b[2],b[3],b[4]):a.call(c,b[0],b[1],b[2],b[3],b[4])}return a.apply(c,b)}},{}],14:[function(a,b,c){var d=a("./$.wks")("iterator"),e=!1;try{var f=[7][d]();f["return"]=function(){e=!0},Array.from(f,function(){throw 2})}catch(g){}b.exports=function(a){if(!e)return!1;var b=!1;try{var c=[7],f=c[d]();f.next=function(){b=!0},c[d]=function(){return f},a(c)}catch(g){}return b}},{"./$.wks":27}],15:[function(a,b,c){function d(a,b){i.hide(a,n,b),o in[]&&i.hide(a,o,b)}function e(a,b,c,e){var f=a.prototype,g=f[n]||f[o]||e&&f[e]||c;if(i.FW&&d(f,g),g!==c){var h=i.getProto(g.call(new a));k.set(h,b+" Iterator",!0),i.FW&&i.has(f,o)&&d(h,i.that)}return p[b]=g,p[b+" Iterator"]=i.that,g}function f(a){var b=i.g.Symbol,c=a[b&&b.iterator||o],d=c||a[n]||p[k.classof(a)];return m(d.call(a))}function g(a){var b=a["return"];void 0!==b&&m(b.call(a))}function h(a,b,c,d){try{return d?b(m(c)[0],c[1]):b(c)}catch(e){throw g(a),e}}var i=a("./$"),j=a("./$.ctx"),k=a("./$.cof"),l=a("./$.def"),m=a("./$.assert").obj,n=a("./$.wks")("iterator"),o="@@iterator",p={},q={},r="keys"in[]&&!("next"in[].keys());d(q,i.that);var s=b.exports={BUGGY:r,Iterators:p,prototype:q,step:function(a,b){return{value:b,done:!!a}},stepCall:h,close:g,is:function(a){var b=Object(a),c=i.g.Symbol,d=c&&c.iterator||o;return d in b||n in b||i.has(p,k.classof(b))},get:f,set:d,create:function(a,b,c,d){a.prototype=i.create(d||s.prototype,{next:i.desc(1,c)}),k.set(a,b+" Iterator")},define:e,std:function(a,b,c,d,f,g,h){function j(a){return function(){return new c(this,a)}}s.create(c,b,d);var k,m,n=j("key+value"),o=j("value"),p=a.prototype;if("value"==f?o=e(a,b,o,"values"):n=e(a,b,n,"entries"),f&&(k={entries:n,keys:g?o:j("key"),values:o},l(l.P+l.F*r,b,k),h))for(m in k)m in p||i.hide(p,m,k[m])},forOf:function(a,b,c,d){for(var e,i=f(a),k=j(c,d,b?2:1);!(e=i.next()).done;)if(h(i,k,e.value,b)===!1)return g(i)}}},{"./$":16,"./$.assert":4,"./$.cof":6,"./$.ctx":10,"./$.def":11,"./$.wks":27}],16:[function(a,b,c){function d(a){return isNaN(a=+a)?0:(a>0?p:o)(a)}function e(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}function f(a,b,c){return a[b]=c,a}function g(a){return s?function(b,c,d){return u.setDesc(b,c,e(a,d))}:f}function h(a){return null!==a&&("object"==typeof a||"function"==typeof a)}function i(a){return"function"==typeof a}function j(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}var k="undefined"!=typeof self?self:Function("return this")(),l={},m=Object.defineProperty,n={}.hasOwnProperty,o=Math.ceil,p=Math.floor,q=Math.max,r=Math.min,s=!!function(){try{return 2==m({},"a",{get:function(){return 2}}).a}catch(a){}}(),t=g(1),u=b.exports=a("./$.fw")({g:k,core:l,html:k.document&&document.documentElement,isObject:h,isFunction:i,it:function(a){return a},that:function(){return this},toInteger:d,toLength:function(a){return a>0?r(d(a),9007199254740991):0},toIndex:function(a,b){return a=d(a),0>a?q(a+b,0):r(a,b)},has:function(a,b){return n.call(a,b)},create:Object.create,getProto:Object.getPrototypeOf,DESC:s,desc:e,getDesc:Object.getOwnPropertyDescriptor,setDesc:m,getKeys:Object.keys,getNames:Object.getOwnPropertyNames,getSymbols:Object.getOwnPropertySymbols,assertDefined:j,ES5Object:Object,toObject:function(a){return u.ES5Object(j(a))},hide:t,def:g(0),set:k.Symbol?f:t,mix:function(a,b){for(var c in b)t(a,c,b[c]);return a},each:[].forEach});"undefined"!=typeof __e&&(__e=l),"undefined"!=typeof __g&&(__g=k)},{"./$.fw":12}],17:[function(a,b,c){var d=a("./$");b.exports=function(a,b){for(var c,e=d.toObject(a),f=d.getKeys(e),g=f.length,h=0;g>h;)if(e[c=f[h++]]===b)return c}},{"./$":16}],18:[function(a,b,c){var d=a("./$"),e=a("./$.assert").obj;b.exports=function(a){return e(a),d.getSymbols?d.getNames(a).concat(d.getSymbols(a)):d.getNames(a)}},{"./$":16,"./$.assert":4}],19:[function(a,b,c){var d=a("./$"),e=a("./$.invoke"),f=a("./$.assert").fn;b.exports=function(){for(var a=f(this),b=arguments.length,c=Array(b),g=0,h=d.path._,i=!1;b>g;)(c[g]=arguments[g++])===h&&(i=!0);return function(){var d,f=this,g=arguments.length,j=0,k=0;if(!i&&!g)return e(a,c,f);if(d=c.slice(),i)for(;b>j;j++)d[j]===h&&(d[j]=arguments[k++]);for(;g>k;)d.push(arguments[k++]);return e(a,d,f)}}},{"./$":16,"./$.assert":4,"./$.invoke":13}],20:[function(a,b,c){b.exports=function(a,b,c){var d=b===Object(b)?function(a){return b[a]}:b;return function(b){return String(c?b:this).replace(a,d)}}},{}],21:[function(a,b,c){function d(a,b){f.obj(a),f(null===b||e.isObject(b),b,": can't set as prototype!")}var e=a("./$"),f=a("./$.assert");b.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(b,c){try{c=a("./$.ctx")(Function.call,e.getDesc(Object.prototype,"__proto__").set,2),c({},[])}catch(f){b=!0}return function(a,e){return d(a,e),b?a.__proto__=e:c(a,e),a}}():void 0),check:d}},{"./$":16,"./$.assert":4,"./$.ctx":10}],22:[function(a,b,c){var d=a("./$");b.exports=function(b){d.DESC&&d.FW&&d.setDesc(b,a("./$.wks")("species"),{configurable:!0,get:d.that})}},{"./$":16,"./$.wks":27}],23:[function(a,b,c){var d=a("./$");b.exports=function(a){return function(b){var c,e,f=String(d.assertDefined(this)),g=d.toInteger(b),h=f.length;return 0>g||g>=h?a?"":void 0:(c=f.charCodeAt(g),55296>c||c>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):c:a?f.slice(g,g+2):(c-55296<<10)+(e-56320)+65536)}}},{"./$":16}],24:[function(a,b,c){function d(){var a=+this;if(i.has(x,a)){var b=x[a];delete x[a],b()}}function e(a){d.call(a.data)}var f,g,h,i=a("./$"),j=a("./$.ctx"),k=a("./$.cof"),l=a("./$.invoke"),m=i.g,n=i.isFunction,o=i.html,p=m.document,q=m.process,r=m.setImmediate,s=m.clearImmediate,t=m.postMessage,u=m.addEventListener,v=m.MessageChannel,w=0,x={},y="onreadystatechange";n(r)&&n(s)||(r=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return x[++w]=function(){l(n(a)?a:Function(a),b)},f(w),w},s=function(a){delete x[a]},"process"==k(q)?f=function(a){q.nextTick(j(d,a,1))}:u&&n(t)&&!m.importScripts?(f=function(a){t(a,"*")},u("message",e,!1)):n(v)?(g=new v,h=g.port2,g.port1.onmessage=e,f=j(h.postMessage,h,1)):f=p&&y in p.createElement("script")?function(a){o.appendChild(p.createElement("script"))[y]=function(){o.removeChild(this),d.call(a)}}:function(a){setTimeout(j(d,a,1),0)}),b.exports={set:r,clear:s}},{"./$":16,"./$.cof":6,"./$.ctx":10,"./$.invoke":13}],25:[function(a,b,c){function d(a){return"Symbol("+a+")_"+(++e+Math.random()).toString(36)}var e=0;d.safe=a("./$").g.Symbol||d,b.exports=d},{"./$":16}],26:[function(a,b,c){var d=a("./$"),e=a("./$.wks")("unscopables");!d.FW||e in[]||d.hide(Array.prototype,e,{}),b.exports=function(a){d.FW&&([][e][a]=!0)}},{"./$":16,"./$.wks":27}],27:[function(a,b,c){var d=a("./$").g,e={};b.exports=function(b){return e[b]||(e[b]=d.Symbol&&d.Symbol[b]||a("./$.uid").safe("Symbol."+b))}},{"./$":16,"./$.uid":25}],28:[function(a,b,c){function d(a,b){return function(c){var d,e=B(c),f=0,g=[];for(d in e)d!=o&&x(e,d)&&g.push(d);for(;b>f;)x(e,d=a[f++])&&(~u.call(g,d)||g.push(d));return g}}function e(a){return!j.isObject(a)}function f(){}function g(a){return function(){return a.apply(j.ES5Object(this),arguments)}}function h(a){return function(b,c){p.fn(b);var d=B(this),e=C(d.length),f=a?e-1:0,g=a?-1:1;if(arguments.length<2)for(;;){if(f in d){c=d[f],f+=g;break}f+=g,p(a?f>=0:e>f,"Reduce of empty array with no initial value")}for(;a?f>=0:e>f;f+=g)f in d&&(c=b(c,d[f],f,this));return c}}function i(a){return a>9?a:"0"+a}var j=a("./$"),k=a("./$.cof"),l=a("./$.def"),m=a("./$.invoke"),n=a("./$.array-methods"),o=a("./$.uid").safe("__proto__"),p=a("./$.assert"),q=p.obj,r=Object.prototype,s=[],t=s.slice,u=s.indexOf,v=k.classof,w=Object.defineProperties,x=j.has,y=j.setDesc,z=j.getDesc,A=j.isFunction,B=j.toObject,C=j.toLength,D=!1;if(!j.DESC){try{D=8==y(document.createElement("div"),"x",{get:function(){return 8}}).x}catch(E){}j.setDesc=function(a,b,c){if(D)try{return y(a,b,c)}catch(d){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(q(a)[b]=c.value),a},j.getDesc=function(a,b){if(D)try{return z(a,b)}catch(c){}return x(a,b)?j.desc(!r.propertyIsEnumerable.call(a,b),a[b]):void 0},w=function(a,b){q(a);for(var c,d=j.getKeys(b),e=d.length,f=0;e>f;)j.setDesc(a,c=d[f++],b[c]);return a}}l(l.S+l.F*!j.DESC,"Object",{getOwnPropertyDescriptor:j.getDesc,defineProperty:j.setDesc,defineProperties:w});var F="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),G=F.concat("length","prototype"),H=F.length,I=function(){var a,b=document.createElement("iframe"),c=H,d=">";for(b.style.display="none",j.html.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object</script"+d),a.close(),I=a.F;c--;)delete I.prototype[F[c]];return I()};l(l.S,"Object",{getPrototypeOf:j.getProto=j.getProto||function(a){return a=Object(p.def(a)),x(a,o)?a[o]:A(a.constructor)&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?r:null},getOwnPropertyNames:j.getNames=j.getNames||d(G,G.length,!0),create:j.create=j.create||function(a,b){var c;return null!==a?(f.prototype=q(a),c=new f,f.prototype=null,c[o]=a):c=I(),void 0===b?c:w(c,b)},keys:j.getKeys=j.getKeys||d(F,H,!1),seal:j.it,freeze:j.it,preventExtensions:j.it,isSealed:e,isFrozen:e,isExtensible:j.isObject}),l(l.P,"Function",{bind:function(a){function b(){var e=d.concat(t.call(arguments));return m(c,e,this instanceof b?j.create(c.prototype):a)}var c=p.fn(this),d=t.call(arguments,1);return c.prototype&&(b.prototype=c.prototype),b}}),0 in Object("z")&&"z"=="z"[0]||(j.ES5Object=function(a){return"String"==k(a)?a.split(""):Object(a)}),l(l.P+l.F*(j.ES5Object!=Object),"Array",{slice:g(t),join:g(s.join)}),l(l.S,"Array",{isArray:function(a){return"Array"==k(a)}}),l(l.P,"Array",{forEach:j.each=j.each||n(0),map:n(1),filter:n(2),some:n(3),every:n(4),reduce:h(!1),reduceRight:h(!0),indexOf:u=u||a("./$.array-includes")(!1),lastIndexOf:function(a,b){var c=B(this),d=C(c.length),e=d-1;for(arguments.length>1&&(e=Math.min(e,j.toInteger(b))),0>e&&(e=C(d+e));e>=0;e--)if(e in c&&c[e]===a)return e;return-1}}),l(l.P,"String",{trim:a("./$.replacer")(/^\s*([\s\S]*\S)?\s*$/,"$1")}),l(l.S,"Date",{now:function(){return+new Date}}),l(l.P,"Date",{toISOString:function(){if(!isFinite(this))throw RangeError("Invalid time value");var a=this,b=a.getUTCFullYear(),c=a.getUTCMilliseconds(),d=0>b?"-":b>9999?"+":"";return d+("00000"+Math.abs(b)).slice(d?-6:-4)+"-"+i(a.getUTCMonth()+1)+"-"+i(a.getUTCDate())+"T"+i(a.getUTCHours())+":"+i(a.getUTCMinutes())+":"+i(a.getUTCSeconds())+"."+(c>99?c:"0"+i(c))+"Z"}}),"Object"==v(function(){return arguments}())&&(k.classof=function(a){var b=v(a);return"Object"==b&&A(a.callee)?"Arguments":b})},{"./$":16,"./$.array-includes":2,"./$.array-methods":3,"./$.assert":4,"./$.cof":6,"./$.def":11,"./$.invoke":13,"./$.replacer":20,"./$.uid":25}],29:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=d.toIndex;e(e.P,"Array",{copyWithin:function(a,b){var c=Object(d.assertDefined(this)),e=d.toLength(c.length),g=f(a,e),h=f(b,e),i=arguments[2],j=void 0===i?e:f(i,e),k=Math.min(j-h,e-g),l=1;for(g>h&&h+k>g&&(l=-1,h=h+k-1,g=g+k-1);k-- >0;)h in c?c[g]=c[h]:delete c[g],g+=l,h+=l;return c}}),a("./$.unscope")("copyWithin")},{"./$":16,"./$.def":11,"./$.unscope":26}],30:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=d.toIndex;e(e.P,"Array",{fill:function(a){for(var b=Object(d.assertDefined(this)),c=d.toLength(b.length),e=f(arguments[1],c),g=arguments[2],h=void 0===g?c:f(g,c);h>e;)b[e++]=a;return b}}),a("./$.unscope")("fill")},{"./$":16,"./$.def":11,"./$.unscope":26}],31:[function(a,b,c){var d=a("./$.def");d(d.P,"Array",{findIndex:a("./$.array-methods")(6)}),a("./$.unscope")("findIndex")},{"./$.array-methods":3,"./$.def":11,"./$.unscope":26}],32:[function(a,b,c){var d=a("./$.def");d(d.P,"Array",{find:a("./$.array-methods")(5)}),a("./$.unscope")("find")},{"./$.array-methods":3,"./$.def":11,"./$.unscope":26}],33:[function(a,b,c){var d=a("./$"),e=a("./$.ctx"),f=a("./$.def"),g=a("./$.iter"),h=g.stepCall;f(f.S+f.F*!a("./$.iter-detect")(function(a){Array.from(a)}),"Array",{from:function(a){var b,c,f,i,j=Object(d.assertDefined(a)),k=arguments[1],l=void 0!==k,m=l?e(k,arguments[2],2):void 0,n=0;if(g.is(j))for(i=g.get(j),c=new("function"==typeof this?this:Array);!(f=i.next()).done;n++)c[n]=l?h(i,m,[f.value,n],!0):f.value;else for(c=new("function"==typeof this?this:Array)(b=d.toLength(j.length));b>n;n++)c[n]=l?m(j[n],n):j[n];return c.length=n,c}})},{"./$":16,"./$.ctx":10,"./$.def":11,"./$.iter":15,"./$.iter-detect":14}],34:[function(a,b,c){var d=a("./$"),e=a("./$.unscope"),f=a("./$.uid").safe("iter"),g=a("./$.iter"),h=g.step,i=g.Iterators;g.std(Array,"Array",function(a,b){d.set(this,f,{o:d.toObject(a),i:0,k:b})},function(){var a=this[f],b=a.o,c=a.k,d=a.i++;return!b||d>=b.length?(a.o=void 0,h(1)):"key"==c?h(0,d):"value"==c?h(0,b[d]):h(0,[d,b[d]])},"value"),i.Arguments=i.Array,e("keys"),e("values"),e("entries")},{"./$":16,"./$.iter":15,"./$.uid":25,"./$.unscope":26}],35:[function(a,b,c){var d=a("./$.def");d(d.S,"Array",{of:function(){for(var a=0,b=arguments.length,c=new("function"==typeof this?this:Array)(b);b>a;)c[a]=arguments[a++];return c.length=b,c}})},{"./$.def":11}],36:[function(a,b,c){a("./$.species")(Array)},{"./$.species":22}],37:[function(a,b,c){var d=a("./$"),e="name",f=d.setDesc,g=Function.prototype;e in g||d.FW&&d.DESC&&f(g,e,{configurable:!0,get:function(){var a=String(this).match(/^\s*function ([^ (]*)/),b=a?a[1]:"";return d.has(this,e)||f(this,e,d.desc(5,b)),b},set:function(a){d.has(this,e)||f(this,e,d.desc(0,a))}})},{"./$":16}],38:[function(a,b,c){var d=a("./$.collection-strong");a("./$.collection")("Map",{get:function(a){var b=d.getEntry(this,a);return b&&b.v},set:function(a,b){return d.def(this,0===a?0:a,b)}},d,!0)},{"./$.collection":9,"./$.collection-strong":7}],39:[function(a,b,c){function d(a){return a+1/r-1/r}function e(a){return 0==(a=+a)||a!=a?a:0>a?-1:1}function f(a){return isFinite(a=+a)&&0!=a?0>a?-f(-a):n(a+o(a*a+1)):a}function g(a){return 0==(a=+a)?a:a>-1e-6&&1e-6>a?a+a*a/2:m(a)-1}var h=1/0,i=a("./$.def"),j=Math.E,k=Math.pow,l=Math.abs,m=Math.exp,n=Math.log,o=Math.sqrt,p=Math.ceil,q=Math.floor,r=k(2,-52),s=k(2,-23),t=k(2,127)*(2-s),u=k(2,-126);i(i.S,"Math",{acosh:function(a){return(a=+a)<1?NaN:isFinite(a)?n(a/j+o(a+1)*o(a-1)/j)+1:a},asinh:f,atanh:function(a){return 0==(a=+a)?a:n((1+a)/(1-a))/2},cbrt:function(a){return e(a=+a)*k(l(a),1/3)},clz32:function(a){return(a>>>=0)?31-q(n(a+.5)*Math.LOG2E):32},cosh:function(a){return(m(a=+a)+m(-a))/2},expm1:g,fround:function(a){var b,c,f=l(a),g=e(a);return u>f?g*d(f/u/s)*u*s:(b=(1+s/r)*f,c=b-(b-f),c>t||c!=c?g*h:g*c)},hypot:function(a,b){for(var c,d=0,e=arguments.length,f=e,g=Array(e),i=-h;e--;){if(c=g[e]=+arguments[e],c==h||c==-h)return h;c>i&&(i=c)}for(i=c||1;f--;)d+=k(g[f]/i,2);return i*o(d)},imul:function(a,b){var c=65535,d=+a,e=+b,f=c&d,g=c&e;return 0|f*g+((c&d>>>16)*g+f*(c&e>>>16)<<16>>>0)},log1p:function(a){return(a=+a)>-1e-8&&1e-8>a?a-a*a/2:n(1+a)},log10:function(a){return n(a)/Math.LN10},log2:function(a){return n(a)/Math.LN2},sign:e,sinh:function(a){return l(a=+a)<1?(g(a)-g(-a))/2:(m(a-1)-m(-a-1))*(j/2)},tanh:function(a){var b=g(a=+a),c=g(-a);return b==h?1:c==h?-1:(b-c)/(m(a)+m(-a))},trunc:function(a){return(a>0?q:p)(a)}})},{"./$.def":11}],40:[function(a,b,c){function d(a){var b,c;if(h(b=a.valueOf)&&!g(c=b.call(a)))return c;if(h(b=a.toString)&&!g(c=b.call(a)))return c;throw TypeError("Can't convert object to number")}function e(a){if(g(a)&&(a=d(a)),"string"==typeof a&&a.length>2&&48==a.charCodeAt(0)){var b=!1;switch(a.charCodeAt(1)){case 66:case 98:b=!0;case 79:case 111:return parseInt(a.slice(2),b?2:8)}}return+a}var f=a("./$"),g=f.isObject,h=f.isFunction,i="Number",j=f.g[i],k=j,l=j.prototype;!f.FW||j("0o1")&&j("0b1")||(j=function m(a){return this instanceof m?new k(e(a)):e(a)},f.each.call(f.DESC?f.getNames(k):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),function(a){f.has(k,a)&&!f.has(j,a)&&f.setDesc(j,a,f.getDesc(k,a))}),j.prototype=l,l.constructor=j,f.hide(f.g,i,j))},{"./$":16}],41:[function(a,b,c){function d(a){return!e.isObject(a)&&i(a)&&h(a)===a}var e=a("./$"),f=a("./$.def"),g=Math.abs,h=Math.floor,i=e.g.isFinite,j=9007199254740991;f(f.S,"Number",{EPSILON:Math.pow(2,-52),isFinite:function(a){return"number"==typeof a&&i(a)},isInteger:d,isNaN:function(a){return a!=a},isSafeInteger:function(a){return d(a)&&g(a)<=j},MAX_SAFE_INTEGER:j,MIN_SAFE_INTEGER:-j,parseFloat:parseFloat,parseInt:parseInt})},{"./$":16,"./$.def":11}],42:[function(a,b,c){var d=a("./$.def");d(d.S,"Object",{assign:a("./$.assign")})},{"./$.assign":5,"./$.def":11}],43:[function(a,b,c){var d=a("./$.def");d(d.S,"Object",{is:function(a,b){return a===b?0!==a||1/a===1/b:a!=a&&b!=b}})},{"./$.def":11}],44:[function(a,b,c){var d=a("./$.def");d(d.S,"Object",{setPrototypeOf:a("./$.set-proto").set})},{"./$.def":11,"./$.set-proto":21}],45:[function(a,b,c){function d(a,b){var c=(e.core.Object||{})[a]||Object[a],d=0,i={};i[a]=1==b?function(a){return g(a)?c(a):a}:2==b?function(a){return g(a)?c(a):!0}:3==b?function(a){return g(a)?c(a):!1}:4==b?function(a,b){return c(h(a),b)}:5==b?function(a){return c(Object(e.assertDefined(a)))}:function(a){return c(h(a))};try{c("z")}catch(j){d=1}f(f.S+f.F*d,"Object",i)}var e=a("./$"),f=a("./$.def"),g=e.isObject,h=e.toObject;d("freeze",1),d("seal",1),d("preventExtensions",1),d("isFrozen",2),d("isSealed",2),d("isExtensible",3),d("getOwnPropertyDescriptor",4),d("getPrototypeOf",5),d("keys"),d("getOwnPropertyNames")},{"./$":16,"./$.def":11}],46:[function(a,b,c){var d=a("./$"),e=a("./$.cof"),f={};f[a("./$.wks")("toStringTag")]="z",d.FW&&"z"!=e(f)&&d.hide(Object.prototype,"toString",function(){return"[object "+e.classof(this)+"]"})},{"./$":16,"./$.cof":6,"./$.wks":27}],47:[function(a,b,c){function d(a){var b=C(a)[q];return void 0!=b?b:a}function e(a){var b;return A(a)&&(b=a.then),z(b)?b:!1}function f(a){var b,c=a[r],d=c.c,e=0;if(c.h)return!1;for(;d.length>e;)if(b=d[e++],b.fail||!f(b.P))return!1;return!0}function g(a,b){var c=a.c;(b||c.length)&&w(function(){var d=a.p,g=a.v,h=1==a.s,i=0;if(b&&f(d))setTimeout(function(){f(d)&&("process"==m(v)?v.emit("unhandledRejection",g,d):u.console&&z(console.error))},1e3);else for(;c.length>i;)!function(b){var c,d,f=h?b.ok:b.fail;try{f?(h||(a.h=!0),c=f===!0?g:f(g),c===b.P?b.rej(TypeError(t+"-chain cycle")):(d=e(c))?d.call(c,b.res,b.rej):b.res(c)):b.rej(g)}catch(i){b.rej(i)}}(c[i++]);c.length=0})}function h(a){var b=this;b.d||(b.d=!0,b=b.r||b,b.v=a,b.s=2,g(b,!0))}function i(a){var b,c,d=this;if(!d.d){d.d=!0,d=d.r||d;try{(b=e(a))?(c={r:d,d:!1},b.call(a,l(i,c,1),l(h,c,1))):(d.v=a,d.s=1,g(d))}catch(f){h.call(c||{r:d,d:!1},f)}}}var j,k=a("./$"),l=a("./$.ctx"),m=a("./$.cof"),n=a("./$.def"),o=a("./$.assert"),p=a("./$.iter"),q=a("./$.wks")("species"),r=a("./$.uid").safe("record"),s=p.forOf,t="Promise",u=k.g,v=u.process,w=v&&v.nextTick||a("./$.task").set,x=u[t],y=x,z=k.isFunction,A=k.isObject,B=o.fn,C=o.obj;z(x)&&z(x.resolve)&&x.resolve(j=new x(function(){}))==j||(x=function(a){B(a);var b={p:o.inst(this,x,t),c:[],s:0,d:!1,v:void 0,h:!1};k.hide(this,r,b);try{a(l(i,b,1),l(h,b,1))}catch(c){h.call(b,c)}},k.mix(x.prototype,{then:function(a,b){var c=C(C(this).constructor)[q],d={ok:z(a)?a:!0,fail:z(b)?b:!1},e=d.P=new(void 0!=c?c:x)(function(a,b){d.res=B(a),d.rej=B(b)}),f=this[r];return f.c.push(d),f.s&&g(f),e},"catch":function(a){return this.then(void 0,a)}})),n(n.G+n.W+n.F*(x!=y),{Promise:x}),m.set(x,t),a("./$.species")(x),n(n.S,t,{reject:function(a){return new(d(this))(function(b,c){c(a)})},resolve:function(a){return A(a)&&r in a&&k.getProto(a)===this.prototype?a:new(d(this))(function(b){b(a)})}}),n(n.S+n.F*!a("./$.iter-detect")(function(a){x.all(a)["catch"](function(){})}),t,{all:function(a){var b=d(this),c=[];return new b(function(d,e){s(a,!1,c.push,c);var f=c.length,g=Array(f);f?k.each.call(c,function(a,c){b.resolve(a).then(function(a){g[c]=a,--f||d(g)},e)}):d(g)})},race:function(a){var b=d(this);return new b(function(c,d){s(a,!1,function(a){b.resolve(a).then(c,d)})})}})},{"./$":16,"./$.assert":4,"./$.cof":6,"./$.ctx":10,"./$.def":11,"./$.iter":15,"./$.iter-detect":14,"./$.species":22,"./$.task":24,"./$.uid":25,"./$.wks":27}],48:[function(a,b,c){function d(a){var b,c=[];for(b in a)c.push(b);h.set(this,l,{o:a,a:c,i:0})}function e(a){return function(b){t(b);try{return a.apply(void 0,arguments),!0}catch(c){return!1}}}function f(a,b){var c,d=arguments.length<3?a:arguments[2],e=p(t(a),b);return e?h.has(e,"value")?e.value:void 0===e.get?void 0:e.get.call(d):o(c=r(a))?f(c,b,d):void 0}function g(a,b,c){var d,e,f=arguments.length<4?a:arguments[3],i=p(t(a),b);if(!i){if(o(e=r(a)))return g(e,b,c,f);i=h.desc(0)}return h.has(i,"value")?i.writable!==!1&&o(f)?(d=p(f,b)||h.desc(0),d.value=c,q(f,b,d),!0):!1:void 0===i.set?!1:(i.set.call(f,c),!0)}var h=a("./$"),i=a("./$.def"),j=a("./$.set-proto"),k=a("./$.iter"),l=a("./$.uid").safe("iter"),m=k.step,n=a("./$.assert"),o=h.isObject,p=h.getDesc,q=h.setDesc,r=h.getProto,s=Function.apply,t=n.obj,u=Object.isExtensible||h.it;k.create(d,"Object",function(){var a,b=this[l],c=b.a;do if(b.i>=c.length)return m(1);while(!((a=c[b.i++])in b.o));return m(0,a)});var v={apply:a("./$.ctx")(Function.call,s,3),construct:function(a,b){var c=n.fn(arguments.length<3?a:arguments[2]).prototype,d=h.create(o(c)?c:Object.prototype),e=s.call(a,d,b);return o(e)?e:d},defineProperty:e(q),deleteProperty:function(a,b){var c=p(t(a),b);return c&&!c.configurable?!1:delete a[b]},enumerate:function(a){return new d(t(a))},get:f,getOwnPropertyDescriptor:function(a,b){return p(t(a),b)},getPrototypeOf:function(a){return r(t(a))},has:function(a,b){return b in a},isExtensible:function(a){return!!u(t(a))},ownKeys:a("./$.own-keys"),preventExtensions:e(Object.preventExtensions||h.it),set:g};j&&(v.setPrototypeOf=function(a,b){j.check(a,b);try{return j.set(a,b),!0}catch(c){return!1}}),i(i.G,{Reflect:{}}),i(i.S,"Reflect",v)},{"./$":16,"./$.assert":4,"./$.ctx":10,"./$.def":11,"./$.iter":15,"./$.own-keys":18,"./$.set-proto":21,"./$.uid":25}],49:[function(a,b,c){var d=a("./$"),e=a("./$.cof"),f=d.g.RegExp,g=f,h=f.prototype;d.FW&&d.DESC&&(function(){try{return"/a/i"==f(/a/g,"i")}catch(a){}}()||(f=function(a,b){return new g("RegExp"==e(a)&&void 0!==b?a.source:a,b)},d.each.call(d.getNames(g),function(a){a in f||d.setDesc(f,a,{configurable:!0,get:function(){return g[a]},set:function(b){g[a]=b}})}),h.constructor=f,f.prototype=h,d.hide(d.g,"RegExp",f)),"g"!=/./g.flags&&d.setDesc(h,"flags",{configurable:!0,get:a("./$.replacer")(/^.*\/(\w*)$/,"$1")})),a("./$.species")(f)},{"./$":16,"./$.cof":6,"./$.replacer":20,"./$.species":22}],50:[function(a,b,c){var d=a("./$.collection-strong");a("./$.collection")("Set",{add:function(a){return d.def(this,a=0===a?0:a,a)}},d)},{"./$.collection":9,"./$.collection-strong":7}],51:[function(a,b,c){var d=a("./$.def");
d(d.P,"String",{codePointAt:a("./$.string-at")(!1)})},{"./$.def":11,"./$.string-at":23}],52:[function(a,b,c){var d=a("./$"),e=a("./$.cof"),f=a("./$.def"),g=d.toLength;f(f.P,"String",{endsWith:function(a){if("RegExp"==e(a))throw TypeError();var b=String(d.assertDefined(this)),c=arguments[1],f=g(b.length),h=void 0===c?f:Math.min(g(c),f);return a+="",b.slice(h-a.length,h)===a}})},{"./$":16,"./$.cof":6,"./$.def":11}],53:[function(a,b,c){var d=a("./$.def"),e=a("./$").toIndex,f=String.fromCharCode;d(d.S,"String",{fromCodePoint:function(a){for(var b,c=[],d=arguments.length,g=0;d>g;){if(b=+arguments[g++],e(b,1114111)!==b)throw RangeError(b+" is not a valid code point");c.push(65536>b?f(b):f(((b-=65536)>>10)+55296,b%1024+56320))}return c.join("")}})},{"./$":16,"./$.def":11}],54:[function(a,b,c){var d=a("./$"),e=a("./$.cof"),f=a("./$.def");f(f.P,"String",{includes:function(a){if("RegExp"==e(a))throw TypeError();return!!~String(d.assertDefined(this)).indexOf(a,arguments[1])}})},{"./$":16,"./$.cof":6,"./$.def":11}],55:[function(a,b,c){var d=a("./$").set,e=a("./$.string-at")(!0),f=a("./$.uid").safe("iter"),g=a("./$.iter"),h=g.step;g.std(String,"String",function(a){d(this,f,{o:String(a),i:0})},function(){var a,b=this[f],c=b.o,d=b.i;return d>=c.length?h(1):(a=e.call(c,d),b.i+=a.length,h(0,a))})},{"./$":16,"./$.iter":15,"./$.string-at":23,"./$.uid":25}],56:[function(a,b,c){var d=a("./$"),e=a("./$.def");e(e.S,"String",{raw:function(a){for(var b=d.toObject(a.raw),c=d.toLength(b.length),e=arguments.length,f=[],g=0;c>g;)f.push(String(b[g++])),e>g&&f.push(String(arguments[g]));return f.join("")}})},{"./$":16,"./$.def":11}],57:[function(a,b,c){var d=a("./$"),e=a("./$.def");e(e.P,"String",{repeat:function(a){var b=String(d.assertDefined(this)),c="",e=d.toInteger(a);if(0>e||e==1/0)throw RangeError("Count can't be negative");for(;e>0;(e>>>=1)&&(b+=b))1&e&&(c+=b);return c}})},{"./$":16,"./$.def":11}],58:[function(a,b,c){var d=a("./$"),e=a("./$.cof"),f=a("./$.def");f(f.P,"String",{startsWith:function(a){if("RegExp"==e(a))throw TypeError();var b=String(d.assertDefined(this)),c=d.toLength(Math.min(arguments[1],b.length));return a+="",b.slice(c,c+a.length)===a}})},{"./$":16,"./$.cof":6,"./$.def":11}],59:[function(a,b,c){function d(a){var b=s[a]=e.set(e.create(n.prototype),q,a);return e.DESC&&p&&e.setDesc(Object.prototype,a,{configurable:!0,set:function(b){k(this,a,b)}}),b}var e=a("./$"),f=a("./$.cof").set,g=a("./$.uid"),h=a("./$.def"),i=a("./$.keyof"),j=e.has,k=e.hide,l=e.getNames,m=e.toObject,n=e.g.Symbol,o=n,p=!1,q=g.safe("tag"),r={},s={};e.isFunction(n)||(n=function u(a){if(this instanceof u)throw TypeError("Symbol is not a constructor");return d(g(a))},k(n.prototype,"toString",function(){return this[q]})),h(h.G+h.W,{Symbol:n});var t={"for":function(a){return j(r,a+="")?r[a]:r[a]=n(a)},keyFor:function(a){return i(r,a)},pure:g.safe,set:e.set,useSetter:function(){p=!0},useSimple:function(){p=!1}};e.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(b){var c=a("./$.wks")(b);t[b]=n===o?c:d(c)}),p=!0,h(h.S,"Symbol",t),h(h.S+h.F*(n!=o),"Object",{getOwnPropertyNames:function(a){for(var b,c=l(m(a)),d=[],e=0;c.length>e;)j(s,b=c[e++])||d.push(b);return d},getOwnPropertySymbols:function(a){for(var b,c=l(m(a)),d=[],e=0;c.length>e;)j(s,b=c[e++])&&d.push(s[b]);return d}}),f(n,"Symbol"),f(Math,"Math",!0),f(e.g.JSON,"JSON",!0)},{"./$":16,"./$.cof":6,"./$.def":11,"./$.keyof":17,"./$.uid":25,"./$.wks":27}],60:[function(a,b,c){var d=a("./$"),e=a("./$.collection-weak"),f=e.leakStore,g=e.ID,h=e.WEAK,i=d.has,j=d.isObject,k=Object.isFrozen||d.core.Object.isFrozen,l={},m=a("./$.collection")("WeakMap",{get:function(a){if(j(a)){if(k(a))return f(this).get(a);if(i(a,h))return a[h][this[g]]}},set:function(a,b){return e.def(this,a,b)}},e,!0,!0);d.FW&&7!=(new m).set((Object.freeze||Object)(l),7).get(l)&&d.each.call(["delete","has","get","set"],function(a){var b=m.prototype[a];m.prototype[a]=function(c,d){if(j(c)&&k(c)){var e=f(this)[a](c,d);return"set"==a?this:e}return b.call(this,c,d)}})},{"./$":16,"./$.collection":9,"./$.collection-weak":8}],61:[function(a,b,c){var d=a("./$.collection-weak");a("./$.collection")("WeakSet",{add:function(a){return d.def(this,a,!0)}},d,!1,!0)},{"./$.collection":9,"./$.collection-weak":8}],62:[function(a,b,c){var d=a("./$.def");d(d.P,"Array",{includes:a("./$.array-includes")(!0)}),a("./$.unscope")("includes")},{"./$.array-includes":2,"./$.def":11,"./$.unscope":26}],63:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.own-keys");e(e.S,"Object",{getOwnPropertyDescriptors:function(a){var b=d.toObject(a),c={};return d.each.call(f(b),function(a){d.setDesc(c,a,d.desc(0,d.getDesc(b,a)))}),c}})},{"./$":16,"./$.def":11,"./$.own-keys":18}],64:[function(a,b,c){function d(a){return function(b){var c,d=e.toObject(b),f=e.getKeys(b),g=f.length,h=0,i=Array(g);if(a)for(;g>h;)i[h]=[c=f[h++],d[c]];else for(;g>h;)i[h]=d[f[h++]];return i}}var e=a("./$"),f=a("./$.def");f(f.S,"Object",{values:d(!1),entries:d(!0)})},{"./$":16,"./$.def":11}],65:[function(a,b,c){var d=a("./$.def");d(d.S,"RegExp",{escape:a("./$.replacer")(/([\\\-[\]{}()*+?.,^$|])/g,"\\$1",!0)})},{"./$.def":11,"./$.replacer":20}],66:[function(a,b,c){var d=a("./$.def"),e=a("./$.iter").forOf;d(d.P,"Set",{toJSON:function(){var a=[];return e(this,!1,a.push,a),a}})},{"./$.def":11,"./$.iter":15}],67:[function(a,b,c){var d=a("./$.def");d(d.P,"String",{at:a("./$.string-at")(!0)})},{"./$.def":11,"./$.string-at":23}],68:[function(a,b,c){function d(b,c){e.each.call(b.split(","),function(b){void 0==c&&b in g?h[b]=g[b]:b in[]&&(h[b]=a("./$.ctx")(Function.call,[][b],c))})}var e=a("./$"),f=a("./$.def"),g=e.core.Array||Array,h={};d("pop,reverse,shift,keys,values,entries",1),d("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3),d("join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill,turn"),f(f.S,"Array",h)},{"./$":16,"./$.ctx":10,"./$.def":11}],69:[function(a,b,c){a("./es6.array.iterator");var d=a("./$"),e=a("./$.iter").Iterators,f=a("./$.wks")("iterator"),g=d.g.NodeList;!d.FW||!g||f in g.prototype||d.hide(g.prototype,f,e.Array),e.NodeList=e.Array},{"./$":16,"./$.iter":15,"./$.wks":27,"./es6.array.iterator":34}],70:[function(a,b,c){var d=a("./$.def"),e=a("./$.task");d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},{"./$.def":11,"./$.task":24}],71:[function(a,b,c){function d(a){return i?function(b,c){return a(g(h,[].slice.call(arguments,2),e.isFunction(b)?b:Function(b)),c)}:a}var e=a("./$"),f=a("./$.def"),g=a("./$.invoke"),h=a("./$.partial"),i=!!e.g.navigator&&/MSIE .\./.test(navigator.userAgent);f(f.G+f.B+f.F*i,{setTimeout:d(e.g.setTimeout),setInterval:d(e.g.setInterval)})},{"./$":16,"./$.def":11,"./$.invoke":13,"./$.partial":19}],72:[function(a,b,c){a("./modules/es5"),a("./modules/es6.symbol"),a("./modules/es6.object.assign"),a("./modules/es6.object.is"),a("./modules/es6.object.set-prototype-of"),a("./modules/es6.object.to-string"),a("./modules/es6.object.statics-accept-primitives"),a("./modules/es6.function.name"),a("./modules/es6.number.constructor"),a("./modules/es6.number.statics"),a("./modules/es6.math"),a("./modules/es6.string.from-code-point"),a("./modules/es6.string.raw"),a("./modules/es6.string.iterator"),a("./modules/es6.string.code-point-at"),a("./modules/es6.string.ends-with"),a("./modules/es6.string.includes"),a("./modules/es6.string.repeat"),a("./modules/es6.string.starts-with"),a("./modules/es6.array.from"),a("./modules/es6.array.of"),a("./modules/es6.array.iterator"),a("./modules/es6.array.species"),a("./modules/es6.array.copy-within"),a("./modules/es6.array.fill"),a("./modules/es6.array.find"),a("./modules/es6.array.find-index"),a("./modules/es6.regexp"),a("./modules/es6.promise"),a("./modules/es6.map"),a("./modules/es6.set"),a("./modules/es6.weak-map"),a("./modules/es6.weak-set"),a("./modules/es6.reflect"),a("./modules/es7.array.includes"),a("./modules/es7.string.at"),a("./modules/es7.regexp.escape"),a("./modules/es7.object.get-own-property-descriptors"),a("./modules/es7.object.to-array"),a("./modules/es7.set.to-json"),a("./modules/js.array.statics"),a("./modules/web.timers"),a("./modules/web.immediate"),a("./modules/web.dom.iterable"),b.exports=a("./modules/$").core},{"./modules/$":16,"./modules/es5":28,"./modules/es6.array.copy-within":29,"./modules/es6.array.fill":30,"./modules/es6.array.find":32,"./modules/es6.array.find-index":31,"./modules/es6.array.from":33,"./modules/es6.array.iterator":34,"./modules/es6.array.of":35,"./modules/es6.array.species":36,"./modules/es6.function.name":37,"./modules/es6.map":38,"./modules/es6.math":39,"./modules/es6.number.constructor":40,"./modules/es6.number.statics":41,"./modules/es6.object.assign":42,"./modules/es6.object.is":43,"./modules/es6.object.set-prototype-of":44,"./modules/es6.object.statics-accept-primitives":45,"./modules/es6.object.to-string":46,"./modules/es6.promise":47,"./modules/es6.reflect":48,"./modules/es6.regexp":49,"./modules/es6.set":50,"./modules/es6.string.code-point-at":51,"./modules/es6.string.ends-with":52,"./modules/es6.string.from-code-point":53,"./modules/es6.string.includes":54,"./modules/es6.string.iterator":55,"./modules/es6.string.raw":56,"./modules/es6.string.repeat":57,"./modules/es6.string.starts-with":58,"./modules/es6.symbol":59,"./modules/es6.weak-map":60,"./modules/es6.weak-set":61,"./modules/es7.array.includes":62,"./modules/es7.object.get-own-property-descriptors":63,"./modules/es7.object.to-array":64,"./modules/es7.regexp.escape":65,"./modules/es7.set.to-json":66,"./modules/es7.string.at":67,"./modules/js.array.statics":68,"./modules/web.dom.iterable":69,"./modules/web.immediate":70,"./modules/web.timers":71}],73:[function(a,b,c){(function(a){!function(a){function c(a,b,c,d){var f=Object.create((b||e).prototype);return f._invoke=h(a,c||null,new l(d||[])),f}function d(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(d){return{type:"throw",arg:d}}}function e(){}function f(){}function g(){}function h(a,b,c){var e=t;return function(f,g){if(e===v)throw new Error("Generator is already running");if(e===w)return n();for(;;){var h=c.delegate;if(h){if("return"===f||"throw"===f&&h.iterator["throw"]===o){c.delegate=null;var i=h.iterator["return"];if(i){var j=d(i,h.iterator,g);if("throw"===j.type){f="throw",g=j.arg;continue}}if("return"===f)continue}var j=d(h.iterator[f],h.iterator,g);if("throw"===j.type){c.delegate=null,f="throw",g=j.arg;continue}f="next",g=o;var k=j.arg;if(!k.done)return e=u,k;c[h.resultName]=k.value,c.next=h.nextLoc,c.delegate=null}if("next"===f)e===u?c.sent=g:delete c.sent;else if("throw"===f){if(e===t)throw e=w,g;c.dispatchException(g)&&(f="next",g=o)}else"return"===f&&c.abrupt("return",g);e=v;var j=d(a,b,c);if("normal"===j.type){e=c.done?w:u;var k={value:j.arg,done:c.done};if(j.arg!==x)return k;c.delegate&&"next"===f&&(g=o)}else"throw"===j.type&&(e=w,f="throw",g=j.arg)}}}function i(a){y[a]=function(b){return this._invoke(a,b)}}function j(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function k(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function l(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(j,this),this.reset()}function m(a){if(a){var b=a[q];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function e(){for(;++c<a.length;)if(p.call(a,c))return e.value=a[c],e.done=!1,e;return e.value=o,e.done=!0,e};return d.next=d}}return{next:n}}function n(){return{value:o,done:!0}}var o,p=Object.prototype.hasOwnProperty,q="function"==typeof Symbol&&Symbol.iterator||"@@iterator",r="object"==typeof b,s=a.regeneratorRuntime;if(s)return void(r&&(b.exports=s));s=a.regeneratorRuntime=r?b.exports:{},s.wrap=c;var t="suspendedStart",u="suspendedYield",v="executing",w="completed",x={},y=g.prototype=e.prototype;f.prototype=y.constructor=g,g.constructor=f,f.displayName="GeneratorFunction",s.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return b?b===f||"GeneratorFunction"===(b.displayName||b.name):!1},s.mark=function(a){return a.__proto__=g,a.prototype=Object.create(y),a},s.async=function(a,b,e,f){return new Promise(function(g,h){function i(a,b){var c=d(j[a],j,b);if("throw"===c.type)return void h(c.arg);var e=c.arg;e.done?g(e.value):Promise.resolve(e.value).then(k,l)}var j=c(a,b,e,f),k=i.bind(j,"next"),l=i.bind(j,"throw");k()})},i("next"),i("throw"),i("return"),y[q]=function(){return this},y.toString=function(){return"[object Generator]"},s.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function d(){for(;b.length;){var c=b.pop();if(c in a)return d.value=c,d.done=!1,d}return d.done=!0,d}},s.values=m,l.prototype={constructor:l,reset:function(){this.prev=0,this.next=0,this.sent=o,this.done=!1,this.delegate=null,this.tryEntries.forEach(k);for(var a,b=0;p.call(this,a="t"+b)||20>b;++b)this[a]=null},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=p.call(e,"catchLoc"),h=p.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&p.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?this.next=e.finallyLoc:this.complete(f),x},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=a.arg,this.next="end"):"normal"===a.type&&b&&(this.next=b),x},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc)}},"catch":function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;k(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:m(a),resultName:b,nextLoc:c},x}}}("object"==typeof a?a:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.s=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./trim"),e=a("./decapitalize");b.exports=function(a,b){return a=d(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""}),b===!0?e(a):a}},{"./decapitalize":10,"./trim":62}],2:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){a=d(a);var c=b?a.slice(1).toLowerCase():a.slice(1);return a.charAt(0).toUpperCase()+c}},{"./helper/makeString":21}],3:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return d(a).split("")}},{"./helper/makeString":21}],4:[function(a,b,c){b.exports=function(a,b){return null==a?[]:(a=String(a),b=~~b,b>0?a.match(new RegExp(".{1,"+b+"}","g")):[a])}},{}],5:[function(a,b,c){var d=a("./capitalize"),e=a("./camelize"),f=a("./helper/makeString");b.exports=function(a){return a=f(a),d(e(a.replace(/[\W_]/g," ")).replace(/\s/g,""))}},{"./camelize":1,"./capitalize":2,"./helper/makeString":21}],6:[function(a,b,c){var d=a("./trim");b.exports=function(a){return d(a).replace(/\s\s+/g," ")}},{"./trim":62}],7:[function(a,b,c){var d=a("./helper/makeString"),e="ąàáäâãåæăćčĉęèéëêĝĥìíïîĵłľńňòóöőôõðøśșšŝťțŭùúüűûñÿýçżźž",f="aaaaaaaaaccceeeeeghiiiijllnnoooooooossssttuuuuuunyyczzz";e+=e.toUpperCase(),f+=f.toUpperCase(),b.exports=function(a){return d(a).replace(/.{1}/g,function(a){var b=e.indexOf(a);return-1===b?a:f.charAt(b)})}},{"./helper/makeString":21}],8:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){return a=d(a),b=d(b),0===a.length||0===b.length?0:a.split(b).length-1}},{"./helper/makeString":21}],9:[function(a,b,c){var d=a("./trim");b.exports=function(a){return d(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()}},{"./trim":62}],10:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return a=d(a),a.charAt(0).toLowerCase()+a.slice(1)}},{"./helper/makeString":21}],11:[function(a,b,c){function d(a){for(var b=a.match(/^[\s\\t]*/gm),c=b[0].length,d=1;d<b.length;d++)c=Math.min(b[d].length,c);return c}var e=a("./helper/makeString");b.exports=function(a,b){a=e(a);var c,f=d(a);return 0===f?a:(c="string"==typeof b?new RegExp("^"+b,"gm"):new RegExp("^[ \\t]{"+f+"}","gm"),a.replace(c,""))}},{"./helper/makeString":21}],12:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/toPositive");b.exports=function(a,b,c){return a=d(a),b=""+b,c="undefined"==typeof c?a.length-b.length:Math.min(e(c),a.length)-b.length,c>=0&&a.indexOf(b,c)===c}},{"./helper/makeString":21,"./helper/toPositive":23}],13:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/escapeChars"),f="[";for(var g in e)f+=g;f+="]";var h=new RegExp(f,"g");b.exports=function(a){return d(a).replace(h,function(a){return"&"+e[a]+";"})}},{"./helper/escapeChars":18,"./helper/makeString":21}],14:[function(a,b,c){b.exports=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse|join)$/)&&(a[b]=this[b]);return a}},{}],15:[function(a,b,c){function d(a){return this instanceof d?void(this._wrapped=a):new d(a)}function e(a,b){"function"==typeof b&&(d.prototype[a]=function(){var a=[this._wrapped].concat(Array.prototype.slice.call(arguments)),c=b.apply(null,a);return"string"==typeof c?new d(c):c})}function f(a){e(a,function(b){var c=Array.prototype.slice.call(arguments,1);return String.prototype[a].apply(b,c)})}d.VERSION="3.2.1",d.isBlank=a("./isBlank"),d.stripTags=a("./stripTags"),d.capitalize=a("./capitalize"),d.decapitalize=a("./decapitalize"),d.chop=a("./chop"),d.trim=a("./trim"),d.clean=a("./clean"),d.cleanDiacritics=a("./cleanDiacritics"),d.count=a("./count"),d.chars=a("./chars"),d.swapCase=a("./swapCase"),d.escapeHTML=a("./escapeHTML"),d.unescapeHTML=a("./unescapeHTML"),d.splice=a("./splice"),d.insert=a("./insert"),d.replaceAll=a("./replaceAll"),d.include=a("./include"),d.join=a("./join"),d.lines=a("./lines"),d.dedent=a("./dedent"),d.reverse=a("./reverse"),d.startsWith=a("./startsWith"),d.endsWith=a("./endsWith"),d.pred=a("./pred"),d.succ=a("./succ"),d.titleize=a("./titleize"),d.camelize=a("./camelize"),d.underscored=a("./underscored"),d.dasherize=a("./dasherize"),d.classify=a("./classify"),d.humanize=a("./humanize"),d.ltrim=a("./ltrim"),d.rtrim=a("./rtrim"),d.truncate=a("./truncate"),d.prune=a("./prune"),d.words=a("./words"),d.pad=a("./pad"),d.lpad=a("./lpad"),d.rpad=a("./rpad"),d.lrpad=a("./lrpad"),d.sprintf=a("./sprintf"),d.vsprintf=a("./vsprintf"),d.toNumber=a("./toNumber"),d.numberFormat=a("./numberFormat"),d.strRight=a("./strRight"),d.strRightBack=a("./strRightBack"),d.strLeft=a("./strLeft"),d.strLeftBack=a("./strLeftBack"),d.toSentence=a("./toSentence"),d.toSentenceSerial=a("./toSentenceSerial"),d.slugify=a("./slugify"),d.surround=a("./surround"),d.quote=a("./quote"),d.unquote=a("./unquote"),d.repeat=a("./repeat"),d.naturalCmp=a("./naturalCmp"),d.levenshtein=a("./levenshtein"),d.toBoolean=a("./toBoolean"),d.exports=a("./exports"),d.escapeRegExp=a("./helper/escapeRegExp"),d.wrap=a("./wrap"),d.strip=d.trim,d.lstrip=d.ltrim,d.rstrip=d.rtrim,d.center=d.lrpad,d.rjust=d.lpad,d.ljust=d.rpad,d.contains=d.include,d.q=d.quote,d.toBool=d.toBoolean,d.camelcase=d.camelize,d.prototype={value:function(){return this._wrapped}};for(var g in d)e(g,d[g]);e("tap",function(a,b){return b(a)});var h=["toUpperCase","toLowerCase","split","replace","slice","substring","substr","concat"];for(var g in h)f(h[g]);b.exports=d},{"./camelize":1,"./capitalize":2,"./chars":3,"./chop":4,"./classify":5,"./clean":6,"./cleanDiacritics":7,"./count":8,"./dasherize":9,"./decapitalize":10,"./dedent":11,"./endsWith":12,"./escapeHTML":13,"./exports":14,"./helper/escapeRegExp":19,"./humanize":24,"./include":25,"./insert":26,"./isBlank":27,"./join":28,"./levenshtein":29,"./lines":30,"./lpad":31,"./lrpad":32,"./ltrim":33,"./naturalCmp":34,"./numberFormat":35,"./pad":36,"./pred":37,"./prune":38,"./quote":39,"./repeat":40,"./replaceAll":41,"./reverse":42,"./rpad":43,"./rtrim":44,"./slugify":45,"./splice":46,"./sprintf":47,"./startsWith":48,"./strLeft":49,"./strLeftBack":50,"./strRight":51,"./strRightBack":52,"./stripTags":53,"./succ":54,"./surround":55,"./swapCase":56,"./titleize":57,"./toBoolean":58,"./toNumber":59,"./toSentence":60,"./toSentenceSerial":61,"./trim":62,"./truncate":63,"./underscored":64,"./unescapeHTML":65,"./unquote":66,"./vsprintf":67,"./words":68,"./wrap":69}],16:[function(a,b,c){var d=a("./makeString");b.exports=function(a,b){return a=d(a),0===a.length?"":a.slice(0,-1)+String.fromCharCode(a.charCodeAt(a.length-1)+b)}},{"./makeString":21}],17:[function(a,b,c){var d=a("./escapeRegExp");b.exports=function(a){return null==a?"\\s":a.source?a.source:"["+d(a)+"]"}},{"./escapeRegExp":19}],18:[function(a,b,c){var d={"¢":"cent","£":"pound","¥":"yen","€":"euro","©":"copy","®":"reg","<":"lt",">":"gt",'"':"quot","&":"amp","'":"#39"};b.exports=d},{}],19:[function(a,b,c){var d=a("./makeString");b.exports=function(a){return d(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},{"./makeString":21}],20:[function(a,b,c){var d={nbsp:" ",cent:"¢",pound:"£",yen:"¥",euro:"€",copy:"©",reg:"®",lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};b.exports=d},{}],21:[function(a,b,c){b.exports=function(a){return null==a?"":""+a}},{}],22:[function(a,b,c){b.exports=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c}},{}],23:[function(a,b,c){b.exports=function(a){return 0>a?0:+a||0}},{}],24:[function(a,b,c){var d=a("./capitalize"),e=a("./underscored"),f=a("./trim");b.exports=function(a){return d(f(e(a).replace(/_id$/,"").replace(/_/g," ")))}},{"./capitalize":2,"./trim":62,"./underscored":64}],25:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){return""===b?!0:-1!==d(a).indexOf(b)}},{"./helper/makeString":21}],26:[function(a,b,c){var d=a("./splice");b.exports=function(a,b,c){return d(a,b,0,c)}},{"./splice":46}],27:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return/^\s*$/.test(d(a))}},{"./helper/makeString":21}],28:[function(a,b,c){var d=a("./helper/makeString"),e=[].slice;b.exports=function(){var a=e.call(arguments),b=a.shift();return a.join(d(b))}},{"./helper/makeString":21}],29:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){if(a=d(a),b=d(b),a===b)return 0;if(!a||!b)return Math.max(a.length,b.length);for(var c=new Array(b.length+1),e=0;e<c.length;++e)c[e]=e;for(e=0;e<a.length;++e){for(var f=e+1,g=0;g<b.length;++g){var h=f;f=c[g]+(a.charAt(e)===b.charAt(g)?0:1);var i=h+1;f>i&&(f=i),i=c[g+1]+1,f>i&&(f=i),c[g]=h}c[g]=f}return f}},{"./helper/makeString":21}],30:[function(a,b,c){b.exports=function(a){return null==a?[]:String(a).split(/\r\n?|\n/)}},{}],31:[function(a,b,c){var d=a("./pad");b.exports=function(a,b,c){return d(a,b,c)}},{"./pad":36}],32:[function(a,b,c){var d=a("./pad");b.exports=function(a,b,c){return d(a,b,c,"both")}},{"./pad":36}],33:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/defaultToWhiteSpace"),f=String.prototype.trimLeft;b.exports=function(a,b){return a=d(a),!b&&f?f.call(a):(b=e(b),a.replace(new RegExp("^"+b+"+"),""))}},{"./helper/defaultToWhiteSpace":17,"./helper/makeString":21}],34:[function(a,b,c){b.exports=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=/(\.\d+|\d+|\D+)/g,d=String(a).match(c),e=String(b).match(c),f=Math.min(d.length,e.length),g=0;f>g;g++){var h=d[g],i=e[g];if(h!==i){var j=+h,k=+i;return j===j&&k===k?j>k?1:-1:i>h?-1:1}}return d.length!=e.length?d.length-e.length:b>a?-1:1}},{}],35:[function(a,b,c){b.exports=function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g}},{}],36:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/strRepeat");b.exports=function(a,b,c,f){a=d(a),b=~~b;var g=0;switch(c?c.length>1&&(c=c.charAt(0)):c=" ",f){case"right":return g=b-a.length,a+e(c,g);case"both":return g=b-a.length,e(c,Math.ceil(g/2))+a+e(c,Math.floor(g/2));default:return g=b-a.length,e(c,g)+a}}},{"./helper/makeString":21,"./helper/strRepeat":22}],37:[function(a,b,c){var d=a("./helper/adjacent");b.exports=function(a){return d(a,-1)}},{"./helper/adjacent":16}],38:[function(a,b,c){var d=a("./helper/makeString"),e=a("./rtrim");b.exports=function(a,b,c){if(a=d(a),b=~~b,c=null!=c?String(c):"...",a.length<=b)return a;var f=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},g=a.slice(0,b+1).replace(/.(?=\W*\w*$)/g,f);return g=g.slice(g.length-2).match(/\w\w/)?g.replace(/\s*\S+$/,""):e(g.slice(0,g.length-1)),(g+c).length>a.length?a:a.slice(0,g.length)+c}},{"./helper/makeString":21,"./rtrim":44}],39:[function(a,b,c){var d=a("./surround");b.exports=function(a,b){return d(a,b||'"')}},{"./surround":55}],40:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/strRepeat");b.exports=function f(a,b,c){if(a=d(a),b=~~b,null==c)return e(a,b);for(var f=[];b>0;f[--b]=a);return f.join(c)}},{"./helper/makeString":21,"./helper/strRepeat":22}],41:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b,c,e){var f=e===!0?"gi":"g",g=new RegExp(b,f);return d(a).replace(g,c)}},{"./helper/makeString":21}],42:[function(a,b,c){var d=a("./chars");b.exports=function(a){return d(a).reverse().join("")}},{"./chars":3}],43:[function(a,b,c){var d=a("./pad");b.exports=function(a,b,c){return d(a,b,c,"right")}},{"./pad":36}],44:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/defaultToWhiteSpace"),f=String.prototype.trimRight;b.exports=function(a,b){return a=d(a),!b&&f?f.call(a):(b=e(b),a.replace(new RegExp(b+"+$"),""))}},{"./helper/defaultToWhiteSpace":17,"./helper/makeString":21}],45:[function(a,b,c){var d=(a("./helper/makeString"),a("./helper/defaultToWhiteSpace"),a("./trim")),e=a("./dasherize"),f=a("./cleanDiacritics");b.exports=function(a){return d(e(f(a).replace(/[^\w\s-]/g,"-")),"-")}},{"./cleanDiacritics":7,"./dasherize":9,"./helper/defaultToWhiteSpace":17,"./helper/makeString":21,"./trim":62}],46:[function(a,b,c){var d=a("./chars");b.exports=function(a,b,c,e){var f=d(a);return f.splice(~~b,~~c,e),f.join("")}},{"./chars":3}],47:[function(a,b,c){var d=a("./helper/strRepeat"),e=Object.prototype.toString,f=function(){function a(a){return e.call(a).slice(8,-1).toLowerCase()}var b=d,c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e,g,h,i,j,k,l,m=1,n=c.length,o="",p=[];for(g=0;n>g;g++)if(o=a(c[g]),"string"===o)p.push(c[g]);else if("array"===o){if(i=c[g],i[2])for(e=d[m],h=0;h<i[2].length;h++){if(!e.hasOwnProperty(i[2][h]))throw new Error(f('[_.sprintf] property "%s" does not exist',i[2][h]));e=e[i[2][h]]}else e=i[1]?d[i[1]]:d[m++];if(/[^s]/.test(i[8])&&"number"!=a(e))throw new Error(f("[_.sprintf] expecting number but found %s",a(e)));switch(i[8]){case"b":e=e.toString(2);break;case"c":e=String.fromCharCode(e);break;case"d":e=parseInt(e,10);break;case"e":e=i[7]?e.toExponential(i[7]):e.toExponential();break;case"f":e=i[7]?parseFloat(e).toFixed(i[7]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=String(e))&&i[7]?e.substring(0,i[7]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}e=/[def]/.test(i[8])&&i[3]&&e>=0?"+"+e:e,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-String(e).length,j=i[6]?b(k,l):"",p.push(i[5]?e+j:j+e)}return p.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},c}();b.exports=f},{"./helper/strRepeat":22}],48:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/toPositive");b.exports=function(a,b,c){return a=d(a),b=""+b,c=null==c?0:Math.min(e(c),a.length),a.lastIndexOf(b,c)===c}},{"./helper/makeString":21,"./helper/toPositive":23}],49:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){a=d(a),b=d(b);var c=b?a.indexOf(b):-1;return~c?a.slice(0,c):a}},{"./helper/makeString":21}],50:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){a=d(a),b=d(b);var c=a.lastIndexOf(b);return~c?a.slice(0,c):a}},{"./helper/makeString":21}],51:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){a=d(a),b=d(b);var c=b?a.indexOf(b):-1;return~c?a.slice(c+b.length,a.length):a}},{"./helper/makeString":21}],52:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){a=d(a),b=d(b);var c=b?a.lastIndexOf(b):-1;return~c?a.slice(c+b.length,a.length):a}},{"./helper/makeString":21}],53:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return d(a).replace(/<\/?[^>]+>/g,"")}},{"./helper/makeString":21}],54:[function(a,b,c){var d=a("./helper/adjacent");b.exports=function(a){return d(a,1)}},{"./helper/adjacent":16}],55:[function(a,b,c){b.exports=function(a,b){return[b,a,b].join("")}},{}],56:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return d(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})}},{"./helper/makeString":21}],57:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a){return d(a).toLowerCase().replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()})}},{"./helper/makeString":21}],58:[function(a,b,c){function d(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;c<b.length;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var e=a("./trim");b.exports=function(a,b,c){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=e(a),d(a,b||["true","1"])?!0:d(a,c||["false","0"])?!1:void 0)}},{"./trim":62}],59:[function(a,b,c){a("./trim");b.exports=function(a,b){if(null==a)return 0;var c=Math.pow(10,isFinite(b)?b:0);return Math.round(a*c)/c}},{"./trim":62}],60:[function(a,b,c){var d=a("./rtrim");
b.exports=function(a,b,c,e){b=b||", ",c=c||" and ";var f=a.slice(),g=f.pop();return a.length>2&&e&&(c=d(b)+c),f.length?f.join(b)+c+g:g}},{"./rtrim":44}],61:[function(a,b,c){var d=a("./toSentence");b.exports=function(a,b,c){return d(a,b,c,!0)}},{"./toSentence":60}],62:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/defaultToWhiteSpace"),f=String.prototype.trim;b.exports=function(a,b){return a=d(a),!b&&f?f.call(a):(b=e(b),a.replace(new RegExp("^"+b+"+|"+b+"+$","g"),""))}},{"./helper/defaultToWhiteSpace":17,"./helper/makeString":21}],63:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b,c){return a=d(a),c=c||"...",b=~~b,a.length>b?a.slice(0,b)+c:a}},{"./helper/makeString":21}],64:[function(a,b,c){var d=a("./trim");b.exports=function(a){return d(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}},{"./trim":62}],65:[function(a,b,c){var d=a("./helper/makeString"),e=a("./helper/htmlEntities");b.exports=function(a){return d(a).replace(/\&([^;]+);/g,function(a,b){var c;return b in e?e[b]:(c=b.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(c[1],16)):(c=b.match(/^#(\d+)$/))?String.fromCharCode(~~c[1]):a})}},{"./helper/htmlEntities":20,"./helper/makeString":21}],66:[function(a,b,c){b.exports=function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a}},{}],67:[function(a,b,c){var d=a("./sprintf");b.exports=function(a,b){return b.unshift(a),d.apply(null,b)}},{"./sprintf":47}],68:[function(a,b,c){var d=a("./isBlank"),e=a("./trim");b.exports=function(a,b){return d(a)?[]:e(a,b).split(b||/\s+/)}},{"./isBlank":27,"./trim":62}],69:[function(a,b,c){var d=a("./helper/makeString");b.exports=function(a,b){if(a=d(a),b=b||{},width=b.width||75,seperator=b.seperator||"\n",cut=b.cut||!1,preserveSpaces=b.preserveSpaces||!1,trailingSpaces=b.trailingSpaces||!1,width<=0)return a;if(cut){for(index=0,result="";index<a.length;)index%width==0&&index>0&&(result+=seperator),result+=a.charAt(index),index++;if(trailingSpaces)for(;index%width>0;)result+=" ",index++;return result}for(words=a.split(" "),result="",current_column=0;words.length>0;){if(1+words[0].length+current_column>width&&current_column>0){if(preserveSpaces)result+=" ",current_column++;else if(trailingSpaces)for(;current_column<width;)result+=" ",current_column++;result+=seperator,current_column=0}current_column>0&&(result+=" ",current_column++),result+=words[0],current_column+=words[0].length,words.shift()}if(trailingSpaces)for(;current_column<width;)result+=" ",current_column++;return result}},{"./helper/makeString":21}]},{},[15])(15)});var XRegExp=function(a){function b(a,b,c,d,e){var f;if(a[v]={captureNames:b},e)return a;if(a.__proto__)a.__proto__=t.prototype;else for(f in t.prototype)a[f]=t.prototype[f];return a[v].source=c,a[v].flags=d?d.split("").sort().join(""):d,a}function c(a){return x.replace.call(a,/([\s\S])(?=[\s\S]*\1)/g,"")}function d(d,e){if(!t.isRegExp(d))throw new TypeError("Type RegExp expected");var h=d[v]||{},i=f(d),j="",k="",l=null,m=null;return e=e||{},e.removeG&&(k+="g"),e.removeY&&(k+="y"),k&&(i=x.replace.call(i,new RegExp("["+k+"]+","g"),"")),e.addG&&(j+="g"),e.addY&&(j+="y"),j&&(i=c(i+j)),e.isInternalOnly||(h.source!==a&&(l=h.source),null!=h.flags&&(m=j?c(h.flags+j):h.flags)),d=b(new RegExp(d.source,i),g(d)?h.captureNames.slice(0):null,l,m,e.isInternalOnly)}function e(a){return parseInt(a,16)}function f(a){return J?a.flags:x.exec.call(/\/([a-z]*)$/i,RegExp.prototype.toString.call(a))[1]}function g(a){return!(!a[v]||!a[v].captureNames)}function h(a){return parseInt(a,10).toString(16)}function i(a,b){var c,d=a.length;for(c=0;d>c;++c)if(a[c]===b)return c;return-1}function j(a,b){return L.call(a)==="[object "+b+"]"}function k(a,b,c){return x.test.call(c.indexOf("x")>-1?/^(?:\s+|#.*|\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/:/^(?:\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/,a.slice(b))}function l(a){for(;a.length<4;)a="0"+a;return a}function m(a,b){var d;if(c(b)!==b)throw new SyntaxError("Invalid duplicate regex flag "+b);for(a=x.replace.call(a,/^\(\?([\w$]+)\)/,function(a,d){if(x.test.call(/[gy]/,d))throw new SyntaxError("Cannot use flag g or y in mode modifier "+a);return b=c(b+d),""}),d=0;d<b.length;++d)if(!K[b.charAt(d)])throw new SyntaxError("Unknown regex flag "+b.charAt(d));return{pattern:a,flags:b}}function n(a){var b={};return j(a,"String")?(t.forEach(a,/[^\s,]+/,function(a){b[a]=!0}),b):a}function o(a){if(!/^[\w$]$/.test(a))throw new Error("Flag must be a single character A-Za-z0-9_$");K[a]=!0}function p(a,b,c,d,e){for(var f,g,h=B.length,i=a.charAt(c),j=null;h--;)if(g=B[h],!(g.leadChar&&g.leadChar!==i||g.scope!==d&&"all"!==g.scope||g.flag&&-1===b.indexOf(g.flag))&&(f=t.exec(a,g.regex,c,"sticky"))){j={matchLength:f[0].length,output:g.handler.call(e,f,d,b),reparse:g.reparse};break}return j}function q(a){w.astral=a}function r(a){RegExp.prototype.exec=(a?y:x).exec,RegExp.prototype.test=(a?y:x).test,String.prototype.match=(a?y:x).match,String.prototype.replace=(a?y:x).replace,String.prototype.split=(a?y:x).split,w.natives=a}function s(a){if(null==a)throw new TypeError("Cannot convert null or undefined to object");return a}var t,u,v="xregexp",w={astral:!1,natives:!1},x={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},y={},z={},A={},B=[],C="default",D="class",E={"default":/\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??|[\s\S]/,"class":/\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|[\s\S]/},F=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,G=x.exec.call(/()??/,"")[1]===a,H=function(){var a=!0;try{new RegExp("","u")}catch(b){a=!1}return a}(),I=function(){var a=!0;try{new RegExp("","y")}catch(b){a=!1}return a}(),J=/a/.flags!==a,K={g:!0,i:!0,m:!0,u:H,y:I},L={}.toString;return t=function(c,e){var f,g,h,i,j,k={hasNamedCapture:!1,captureNames:[]},l=C,n="",o=0;if(t.isRegExp(c)){if(e!==a)throw new TypeError("Cannot supply flags when copying a RegExp");return d(c)}if(c=c===a?"":String(c),e=e===a?"":String(e),t.isInstalled("astral")&&-1===e.indexOf("A")&&(e+="A"),A[c]||(A[c]={}),!A[c][e]){for(f=m(c,e),i=f.pattern,j=f.flags;o<i.length;){do f=p(i,j,o,l,k),f&&f.reparse&&(i=i.slice(0,o)+f.output+i.slice(o+f.matchLength));while(f&&f.reparse);f?(n+=f.output,o+=f.matchLength||1):(g=t.exec(i,E[l],o,"sticky")[0],n+=g,o+=g.length,"["===g&&l===C?l=D:"]"===g&&l===D&&(l=C))}A[c][e]={pattern:x.replace.call(n,/\(\?:\)(?=\(\?:\))|^\(\?:\)|\(\?:\)$/g,""),flags:x.replace.call(j,/[^gimuy]+/g,""),captures:k.hasNamedCapture?k.captureNames:null}}return h=A[c][e],b(new RegExp(h.pattern,h.flags),h.captures,c,e)},t.prototype=new RegExp,t.version="3.0.0",t.addToken=function(a,b,c){c=c||{};var e,f=c.optionalFlags;if(c.flag&&o(c.flag),f)for(f=x.split.call(f,""),e=0;e<f.length;++e)o(f[e]);B.push({regex:d(a,{addG:!0,addY:I,isInternalOnly:!0}),handler:b,scope:c.scope||C,flag:c.flag,reparse:c.reparse,leadChar:c.leadChar}),t.cache.flush("patterns")},t.cache=function(a,b){return z[a]||(z[a]={}),z[a][b]||(z[a][b]=t(a,b))},t.cache.flush=function(a){"patterns"===a?A={}:z={}},t.escape=function(a){return x.replace.call(s(a),/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},t.exec=function(a,b,c,e){var f,g,h="g",i=!1;return i=I&&!!(e||b.sticky&&e!==!1),i&&(h+="y"),b[v]=b[v]||{},g=b[v][h]||(b[v][h]=d(b,{addG:!0,addY:i,removeY:e===!1,isInternalOnly:!0})),g.lastIndex=c=c||0,f=y.exec.call(g,a),e&&f&&f.index!==c&&(f=null),b.global&&(b.lastIndex=f?g.lastIndex:0),f},t.forEach=function(a,b,c){for(var d,e=0,f=-1;d=t.exec(a,b,e);)c(d,++f,a,b),e=d.index+(d[0].length||1)},t.globalize=function(a){return d(a,{addG:!0})},t.install=function(a){a=n(a),!w.astral&&a.astral&&q(!0),!w.natives&&a.natives&&r(!0)},t.isInstalled=function(a){return!!w[a]},t.isRegExp=function(a){return"[object RegExp]"===L.call(a)},t.match=function(a,b,c){var e,f,g=b.global&&"one"!==c||"all"===c,h=(g?"g":"")+(b.sticky?"y":"")||"noGY";return b[v]=b[v]||{},f=b[v][h]||(b[v][h]=d(b,{addG:!!g,addY:!!b.sticky,removeG:"one"===c,isInternalOnly:!0})),e=x.match.call(s(a),f),b.global&&(b.lastIndex="one"===c&&e?e.index+e[0].length:0),g?e||[]:e&&e[0]},t.matchChain=function(a,b){return function c(a,d){var e,f=b[d].regex?b[d]:{regex:b[d]},g=[],h=function(a){if(f.backref){if(!(a.hasOwnProperty(f.backref)||+f.backref<a.length))throw new ReferenceError("Backreference to undefined group: "+f.backref);g.push(a[f.backref]||"")}else g.push(a[0])};for(e=0;e<a.length;++e)t.forEach(a[e],f.regex,h);return d!==b.length-1&&g.length?c(g,d+1):g}([a],0)},t.replace=function(a,b,c,e){var f,g=t.isRegExp(b),h=b.global&&"one"!==e||"all"===e,i=(h?"g":"")+(b.sticky?"y":"")||"noGY",j=b;return g?(b[v]=b[v]||{},j=b[v][i]||(b[v][i]=d(b,{addG:!!h,addY:!!b.sticky,removeG:"one"===e,isInternalOnly:!0}))):h&&(j=new RegExp(t.escape(String(b)),"g")),f=y.replace.call(s(a),j,c),g&&b.global&&(b.lastIndex=0),f},t.replaceEach=function(a,b){var c,d;for(c=0;c<b.length;++c)d=b[c],a=t.replace(a,d[0],d[1],d[2]);return a},t.split=function(a,b,c){return y.split.call(s(a),b,c)},t.test=function(a,b,c,d){return!!t.exec(a,b,c,d)},t.uninstall=function(a){a=n(a),w.astral&&a.astral&&q(!1),w.natives&&a.natives&&r(!1)},t.union=function(a,b){var c,d,e,f,g=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,h=[],i=0,k=function(a,b,e){var f=d[i-c];if(b){if(++i,f)return"(?<"+f+">"}else if(e)return"\\"+(+e+c);return a};if(!j(a,"Array")||!a.length)throw new TypeError("Must provide a nonempty array of patterns to merge");for(f=0;f<a.length;++f)e=a[f],t.isRegExp(e)?(c=i,d=e[v]&&e[v].captureNames||[],h.push(x.replace.call(t(e.source).source,g,k))):h.push(t.escape(e));return t(h.join("|"),b)},y.exec=function(b){var c,e,f,g=this.lastIndex,h=x.exec.apply(this,arguments);if(h){if(!G&&h.length>1&&i(h,"")>-1&&(e=d(this,{removeG:!0,isInternalOnly:!0}),x.replace.call(String(b).slice(h.index),e,function(){var b,c=arguments.length;for(b=1;c-2>b;++b)arguments[b]===a&&(h[b]=a)})),this[v]&&this[v].captureNames)for(f=1;f<h.length;++f)c=this[v].captureNames[f-1],c&&(h[c]=h[f]);this.global&&!h[0].length&&this.lastIndex>h.index&&(this.lastIndex=h.index)}return this.global||(this.lastIndex=g),h},y.test=function(a){return!!y.exec.call(this,a)},y.match=function(a){var b;if(t.isRegExp(a)){if(a.global)return b=x.match.apply(this,arguments),a.lastIndex=0,b}else a=new RegExp(a);return y.exec.call(a,s(this))},y.replace=function(b,c){var d,e,f,g=t.isRegExp(b);return g?(b[v]&&(e=b[v].captureNames),d=b.lastIndex):b+="",f=j(c,"Function")?x.replace.call(String(this),b,function(){var d,f=arguments;if(e)for(f[0]=new String(f[0]),d=0;d<e.length;++d)e[d]&&(f[0][e[d]]=f[d+1]);return g&&b.global&&(b.lastIndex=f[f.length-2]+f[0].length),c.apply(a,f)}):x.replace.call(null==this?this:String(this),b,function(){var a=arguments;return x.replace.call(String(c),F,function(b,c,d){var f;if(c){if(f=+c,f<=a.length-3)return a[f]||"";if(f=e?i(e,c):-1,0>f)throw new SyntaxError("Backreference to undefined group "+b);return a[f+1]||""}if("$"===d)return"$";if("&"===d||0===+d)return a[0];if("`"===d)return a[a.length-1].slice(0,a[a.length-2]);if("'"===d)return a[a.length-1].slice(a[a.length-2]+a[0].length);if(d=+d,!isNaN(d)){if(d>a.length-3)throw new SyntaxError("Backreference to undefined group "+b);return a[d]||""}throw new SyntaxError("Invalid token "+b)})}),g&&(b.global?b.lastIndex=0:b.lastIndex=d),f},y.split=function(b,c){if(!t.isRegExp(b))return x.split.apply(this,arguments);var d,e=String(this),f=[],g=b.lastIndex,h=0;return c=(c===a?-1:c)>>>0,t.forEach(e,b,function(a){a.index+a[0].length>h&&(f.push(e.slice(h,a.index)),a.length>1&&a.index<e.length&&Array.prototype.push.apply(f,a.slice(1)),d=a[0].length,h=a.index+d)}),h===e.length?(!x.test.call(b,"")||d)&&f.push(""):f.push(e.slice(h)),b.lastIndex=g,f.length>c?f.slice(0,c):f},u=t.addToken,u(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4}|{[\dA-Fa-f]+})|x(?![\dA-Fa-f]{2}))/,function(a,b){if("B"===a[1]&&b===C)return a[0];throw new SyntaxError("Invalid escape "+a[0])},{scope:"all",leadChar:"\\"}),u(/\\u{([\dA-Fa-f]+)}/,function(a,b,c){var d=e(a[1]);if(d>1114111)throw new SyntaxError("Invalid Unicode code point "+a[0]);if(65535>=d)return"\\u"+l(h(d));if(H&&c.indexOf("u")>-1)return a[0];throw new SyntaxError("Cannot use Unicode code point above \\u{FFFF} without flag u")},{scope:"all",leadChar:"\\"}),u(/\[(\^?)]/,function(a){return a[1]?"[\\s\\S]":"\\b\\B"},{leadChar:"["}),u(/\(\?#[^)]*\)/,function(a,b,c){return k(a.input,a.index+a[0].length,c)?"":"(?:)"},{leadChar:"("}),u(/\s+|#.*/,function(a,b,c){return k(a.input,a.index+a[0].length,c)?"":"(?:)"},{flag:"x"}),u(/\./,function(){return"[\\s\\S]"},{flag:"s",leadChar:"."}),u(/\\k<([\w$]+)>/,function(a){var b=isNaN(a[1])?i(this.captureNames,a[1])+1:+a[1],c=a.index+a[0].length;if(!b||b>this.captureNames.length)throw new SyntaxError("Backreference to undefined group "+a[0]);return"\\"+b+(c===a.input.length||isNaN(a.input.charAt(c))?"":"(?:)")},{leadChar:"\\"}),u(/\\(\d+)/,function(a,b){if(!(b===C&&/^[1-9]/.test(a[1])&&+a[1]<=this.captureNames.length)&&"0"!==a[1])throw new SyntaxError("Cannot use octal escape or backreference to undefined group "+a[0]);return a[0]},{scope:"all",leadChar:"\\"}),u(/\(\?P?<([\w$]+)>/,function(a){if(!isNaN(a[1]))throw new SyntaxError("Cannot use integer as capture name "+a[0]);if("length"===a[1]||"__proto__"===a[1])throw new SyntaxError("Cannot use reserved word as capture name "+a[0]);if(i(this.captureNames,a[1])>-1)throw new SyntaxError("Cannot use same name for multiple groups "+a[0]);return this.captureNames.push(a[1]),this.hasNamedCapture=!0,"("},{leadChar:"("}),u(/\((?!\?)/,function(a,b,c){return c.indexOf("n")>-1?"(?:":(this.captureNames.push(null),"(")},{optionalFlags:"n",leadChar:"("}),t}();(function(){var a={"@@functional/placeholder":!0},b=function(a,b){switch(a){case 0:return function(){return b.apply(this,arguments)};case 1:return function(a){return b.apply(this,arguments)};case 2:return function(a,c){return b.apply(this,arguments)};case 3:return function(a,c,d){return b.apply(this,arguments)};case 4:return function(a,c,d,e){return b.apply(this,arguments)};case 5:return function(a,c,d,e,f){return b.apply(this,arguments)};case 6:return function(a,c,d,e,f,g){return b.apply(this,arguments)};case 7:return function(a,c,d,e,f,g,h){return b.apply(this,arguments)};case 8:return function(a,c,d,e,f,g,h,i){return b.apply(this,arguments)};case 9:return function(a,c,d,e,f,g,h,i,j){return b.apply(this,arguments)};case 10:return function(a,c,d,e,f,g,h,i,j,k){return b.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},c=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c},d=function(a){return new RegExp(a.source,(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.sticky?"y":"")+(a.unicode?"u":""))},e=function(a){return function(){return!a.apply(this,arguments)}},f=function(a,b){a=a||[],b=b||[];var c,d=a.length,e=b.length,f=[];for(c=0;d>c;)f[f.length]=a[c],c+=1;for(c=0;e>c;)f[f.length]=b[c],c+=1;return f},g=function(a,b,c){for(var d=0,e=c.length;e>d;){if(a(b,c[d]))return!0;d+=1}return!1},h=function(a,b){for(var c=0,d=b.length,e=[];d>c;)a(b[c])&&(e[e.length]=b[c]),c+=1;return e},i=function(a){return{"@@transducer/value":a,"@@transducer/reduced":!0}},j=function(a,b){return Object.prototype.hasOwnProperty.call(b,a)},k=function(a){return a},l=function(){var a=Object.prototype.toString;return"[object Arguments]"===a.call(arguments)?function(b){return"[object Arguments]"===a.call(b)}:function(a){return j("callee",a)}}(),m=Array.isArray||function(a){return null!=a&&a.length>=0&&"[object Array]"===Object.prototype.toString.call(a)},n=Number.isInteger||function(a){return a<<0===a},o=function(a){return"[object Number]"===Object.prototype.toString.call(a)},p=function(a){return"[object Object]"===Object.prototype.toString.call(a)},q=function(a){return null!=a&&"object"==typeof a&&a["@@functional/placeholder"]===!0},r=function(a){return"[object RegExp]"===Object.prototype.toString.call(a)},s=function(a){return"[object String]"===Object.prototype.toString.call(a)},t=function(a){return"function"==typeof a["@@transducer/step"]},u=function(a,b){for(var c=0,d=b.length,e=Array(d);d>c;)e[c]=a(b[c]),c+=1;return e},v=function(a){return[a]},w=function(a,b){return function(){return b.call(this,a.apply(this,arguments))}},x=function(a,b){return function(){var c=this;return a.apply(c,arguments).then(function(a){return b.call(c,a)})}},y=function(a){var b=a.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+b.replace(/"/g,'\\"')+'"'},z=function(a){return a&&a["@@transducer/reduced"]?a:{"@@transducer/value":a,"@@transducer/reduced":!0}},A=function Ce(a,b,c){switch(arguments.length){case 1:return Ce(a,0,a.length);case 2:return Ce(a,b,a.length);default:for(var d=[],e=0,f=Math.max(0,Math.min(a.length,c)-b);f>e;)d[e]=a[b+e],e+=1;return d}},B=function(){var a=function(a){return(10>a?"0":"")+a};return"function"==typeof Date.prototype.toISOString?function(a){return a.toISOString()}:function(b){return b.getUTCFullYear()+"-"+a(b.getUTCMonth()+1)+"-"+a(b.getUTCDate())+"T"+a(b.getUTCHours())+":"+a(b.getUTCMinutes())+":"+a(b.getUTCSeconds())+"."+(b.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),C={init:function(){return this.xf["@@transducer/init"]()},result:function(a){return this.xf["@@transducer/result"](a)}},D=function(){function a(a){this.f=a}return a.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},a.prototype["@@transducer/result"]=function(a){return a},a.prototype["@@transducer/step"]=function(a,b){return this.f(a,b)},function(b){return new a(b)}}(),E=function(a,b){for(var c=0,d=b.length-(a-1),e=new Array(d>=0?d:0);d>c;)e[c]=A(b,c,c+a),c+=1;return e},F=function(a,b){return function(){var c=arguments.length;if(0===c)return b();var d=arguments[c-1];return m(d)||"function"!=typeof d[a]?b.apply(this,arguments):d[a].apply(d,A(arguments,0,c-1))}},G=function(a){return function b(c){return 0===arguments.length||q(c)?b:a.apply(this,arguments)}},H=function(a){return function b(c,d){switch(arguments.length){case 0:return b;case 1:return q(c)?b:G(function(b){return a(c,b)});default:return q(c)&&q(d)?b:q(c)?G(function(b){return a(b,d)}):q(d)?G(function(b){return a(c,b)}):a(c,d)}}},I=function(a){return function b(c,d,e){switch(arguments.length){case 0:return b;case 1:return q(c)?b:H(function(b,d){return a(c,b,d)});case 2:return q(c)&&q(d)?b:q(c)?H(function(b,c){return a(b,d,c)}):q(d)?H(function(b,d){return a(c,b,d)}):G(function(b){return a(c,d,b)});default:return q(c)&&q(d)&&q(e)?b:q(c)&&q(d)?H(function(b,c){return a(b,c,e)}):q(c)&&q(e)?H(function(b,c){return a(b,d,c)}):q(d)&&q(e)?H(function(b,d){return a(c,b,d)}):q(c)?G(function(b){return a(b,d,e)}):q(d)?G(function(b){return a(c,b,e)}):q(e)?G(function(b){return a(c,d,b)}):a(c,d,e)}}},J=function De(a,c,d){return function(){for(var e=[],f=0,g=a,h=0;h<c.length||f<arguments.length;){var i;h<c.length&&(!q(c[h])||f>=arguments.length)?i=c[h]:(i=arguments[f],f+=1),e[h]=i,q(i)||(g-=1),h+=1}return 0>=g?d.apply(this,e):b(g,De(a,e,d))}},K=function(a,b,c){return function(){var d=arguments.length;if(0===d)return c();var e=arguments[d-1];if(!m(e)){var f=A(arguments,0,d-1);if("function"==typeof e[a])return e[a].apply(e,f);if(t(e)){var g=b.apply(null,f);return g(e)}}return c.apply(this,arguments)}},L=function(a,b){for(var c=b.length-1;c>=0&&a(b[c]);)c-=1;return A(b,0,c+1)},M=function(){function a(a,b){this.xf=b,this.f=a,this.all=!0}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.all&&(a=this.xf["@@transducer/step"](a,!0)),this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.f(b)||(this.all=!1,a=z(this.xf["@@transducer/step"](a,!1))),a},H(function(b,c){return new a(b,c)})}(),N=function(){function a(a,b){this.xf=b,this.f=a,this.any=!1}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.any||(a=this.xf["@@transducer/step"](a,!1)),this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.f(b)&&(this.any=!0,a=z(this.xf["@@transducer/step"](a,!0))),a},H(function(b,c){return new a(b,c)})}(),O=function(){function a(a,b){this.xf=b,this.pos=0,this.full=!1,this.acc=new Array(a)}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.acc=null,this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.store(b),this.full?this.xf["@@transducer/step"](a,this.getCopy()):a},a.prototype.store=function(a){this.acc[this.pos]=a,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},a.prototype.getCopy=function(){return f(A(this.acc,this.pos),A(this.acc,0,this.pos))},H(function(b,c){return new a(b,c)})}(),P=function(){function a(a,b){this.xf=b,this.n=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){return this.n>0?(this.n-=1,a):this.xf["@@transducer/step"](a,b)},H(function(b,c){return new a(b,c)})}(),Q=function(){function a(a,b){this.xf=b,this.pos=0,this.full=!1,this.acc=new Array(a)}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.acc=null,this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.full&&(a=this.xf["@@transducer/step"](a,this.acc[this.pos])),this.store(b),a},a.prototype.store=function(a){this.acc[this.pos]=a,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},H(function(b,c){return new a(b,c)})}(),R=function(){function a(a,b){this.xf=b,this.pred=a,this.lastValue=void 0,this.seenFirstValue=!1}return a.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},a.prototype["@@transducer/result"]=function(a){return this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){var c=!1;return this.seenFirstValue?this.pred(this.lastValue,b)&&(c=!0):this.seenFirstValue=!0,this.lastValue=b,c?a:this.xf["@@transducer/step"](a,b)},H(function(b,c){return new a(b,c)})}(),S=function(){function a(a,b){this.xf=b,this.f=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){if(this.f){if(this.f(b))return a;this.f=null}return this.xf["@@transducer/step"](a,b)},H(function(b,c){return new a(b,c)})}(),T=function(){function a(a,b){this.xf=b,this.f=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){return this.f(b)?this.xf["@@transducer/step"](a,b):a},H(function(b,c){return new a(b,c)})}(),U=function(){function a(a,b){this.xf=b,this.f=a,this.found=!1}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.found||(a=this.xf["@@transducer/step"](a,void 0)),this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.f(b)&&(this.found=!0,a=z(this.xf["@@transducer/step"](a,b))),a},H(function(b,c){return new a(b,c)})}(),V=function(){function a(a,b){this.xf=b,this.f=a,this.idx=-1,this.found=!1}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.found||(a=this.xf["@@transducer/step"](a,-1)),this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.idx+=1,this.f(b)&&(this.found=!0,a=z(this.xf["@@transducer/step"](a,this.idx))),a},H(function(b,c){return new a(b,c)})}(),W=function(){function a(a,b){this.xf=b,this.f=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](a,this.last))},a.prototype["@@transducer/step"]=function(a,b){return this.f(b)&&(this.last=b),a},H(function(b,c){return new a(b,c)})}(),X=function(){function a(a,b){this.xf=b,this.f=a,this.idx=-1,this.lastIdx=-1}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](a,this.lastIdx))},a.prototype["@@transducer/step"]=function(a,b){return this.idx+=1,this.f(b)&&(this.lastIdx=this.idx),a},H(function(b,c){return new a(b,c)})}(),Y=function(){function a(a,b){this.xf=b,this.f=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){return this.xf["@@transducer/step"](a,this.f(b))},H(function(b,c){return new a(b,c)})}(),Z=function(){function a(a,b){this.xf=b,this.n=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){return 0===this.n?z(a):(this.n-=1,this.xf["@@transducer/step"](a,b))},H(function(b,c){return new a(b,c)})}(),$=function(){function a(a,b){this.xf=b,this.f=a}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=C.result,a.prototype["@@transducer/step"]=function(a,b){return this.f(b)?this.xf["@@transducer/step"](a,b):z(a)},H(function(b,c){return new a(b,c)})}(),_=H(function(a,b){return a+b}),aa=I(function(a,b,c){if(b>=c.length||b<-c.length)return c;var d=0>b?c.length:0,e=d+b,g=f(c);return g[e]=a(c[e]),g}),ba=H(K("all",M,function(a,b){for(var c=0;c<b.length;){if(!a(b[c]))return!1;c+=1}return!0})),ca=G(function(a){return function(){return a}}),da=H(function(a,b){return a&&b}),ea=H(K("any",N,function(a,b){for(var c=0;c<b.length;){if(a(b[c]))return!0;c+=1}return!1})),fa=H(K("aperture",O,E)),ga=H(function(a,b){return f(b,[a])}),ha=H(function(a,b){return a.apply(this,b)}),ia=I(function(a,b,c){var d={};for(var e in c)d[e]=c[e];return d[a]=b,d}),ja=I(function Ee(a,b,c){switch(a.length){case 0:return b;case 1:return ia(a[0],b,c);default:return ia(a[0],Ee(A(a,1),b,Object(c[a[0]])),c)}}),ka=H(function(a,c){return b(a.length,function(){return a.apply(c,arguments)})}),la=H(function(a,b){return function(){return a.apply(this,arguments)&&b.apply(this,arguments)}}),ma=G(function(a){return function(b,c){return a(b,c)?-1:a(c,b)?1:0}}),na=G(function(a){return function(){for(var b=0;b<a.length;){if(a[b][0].apply(this,arguments))return a[b][1].apply(this,arguments);b+=1}}}),oa=H(function(a,b){for(var c={},d=b.length,e=0;d>e;){var f=a(b[e]);c[f]=(j(f,c)?c[f]:0)+1,e+=1}return c}),pa=H(function(a,c){return 1===a?G(c):b(a,J(a,[],c))}),qa=_(-1),ra=H(function(a,b){return null==b||b!==b?a:b}),sa=I(function(a,b,c){for(var d=[],e=0,f=b.length;f>e;)g(a,b[e],c)||g(a,b[e],d)||d.push(b[e]),e+=1;return d}),ta=H(function(a,b){var c={};for(var d in b)d!==a&&(c[d]=b[d]);return c}),ua=H(function Fe(a,b){switch(a.length){case 0:return b;case 1:return ta(a[0],b);default:var c=a[0],d=A(a,1);return null==b[c]?b:ia(c,Fe(d,b[c]),b)}}),va=H(function(a,b){return a/b}),wa=H(K("dropWhile",S,function(a,b){for(var c=0,d=b.length;d>c&&a(b[c]);)c+=1;return A(b,c)})),xa=H(function(a,b){return function(){return a.apply(this,arguments)||b.apply(this,arguments)}}),ya=G(function(a){return null!=a&&"function"==typeof a.empty?a.empty():null!=a&&null!=a.constructor&&"function"==typeof a.constructor.empty?a.constructor.empty():m(a)?[]:s(a)?"":p(a)?{}:l(a)?function(){return arguments}():void 0}),za=H(function Ge(a,b){var c,d,e,f={};for(d in b)c=a[d],e=typeof c,f[d]="function"===e?c(b[d]):"object"===e?Ge(a[d],b[d]):b[d];return f}),Aa=H(K("find",U,function(a,b){for(var c=0,d=b.length;d>c;){if(a(b[c]))return b[c];c+=1}})),Ba=H(K("findIndex",V,function(a,b){for(var c=0,d=b.length;d>c;){if(a(b[c]))return c;c+=1}return-1})),Ca=H(K("findLast",W,function(a,b){for(var c=b.length-1;c>=0;){if(a(b[c]))return b[c];c-=1}})),Da=H(K("findLastIndex",X,function(a,b){for(var c=b.length-1;c>=0;){if(a(b[c]))return c;c-=1}return-1})),Ea=H(F("forEach",function(a,b){for(var c=b.length,d=0;c>d;)a(b[d]),d+=1;return b})),Fa=G(function(a){for(var b=0,c=a.length,d={};c>b;)m(a[b])&&a[b].length&&(d[a[b][0]]=a[b][1]),b+=1;return d}),Ga=H(function(a,b){return a>b}),Ha=H(function(a,b){return a>=b}),Ia=H(j),Ja=H(function(a,b){return a in b}),Ka=H(function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}),La=G(k),Ma=I(function(a,b,c){return pa(Math.max(a.length,b.length,c.length),function(){return a.apply(this,arguments)?b.apply(this,arguments):c.apply(this,arguments)})}),Na=_(1),Oa=I(function(a,b,c){a=a<c.length&&a>=0?a:c.length;var d=A(c);return d.splice(a,0,b),d}),Pa=I(function(a,b,c){return a=a<c.length&&a>=0?a:c.length,f(f(A(c,0,a),b),A(c,a))}),Qa=H(F("intersperse",function(a,b){for(var c=[],d=0,e=b.length;e>d;)d===e-1?c.push(b[d]):c.push(b[d],a),d+=1;return c})),Ra=H(function(a,b){return null!=b&&b.constructor===a||b instanceof a}),Sa=G(function(a){return m(a)?!0:a?"object"!=typeof a?!1:a instanceof String?!1:1===a.nodeType?!!a.length:0===a.length?!0:a.length>0?a.hasOwnProperty(0)&&a.hasOwnProperty(a.length-1):!1:!1}),Ta=G(function(a){return null==a}),Ua=function(){var a=!{toString:null}.propertyIsEnumerable("toString"),b=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],c=function(a,b){for(var c=0;c<a.length;){if(a[c]===b)return!0;c+=1}return!1};return G("function"==typeof Object.keys?function(a){return Object(a)!==a?[]:Object.keys(a)}:function(d){if(Object(d)!==d)return[];var e,f,g=[];for(e in d)j(e,d)&&(g[g.length]=e);if(a)for(f=b.length-1;f>=0;)e=b[f],j(e,d)&&!c(g,e)&&(g[g.length]=e),f-=1;return g})}(),Va=G(function(a){var b,c=[];for(b in a)c[c.length]=b;return c}),Wa=G(function(a){return null!=a&&Ra(Number,a.length)?a.length:NaN}),Xa=H(function(a,b){return b>a}),Ya=H(function(a,b){return b>=a}),Za=I(function(a,b,c){for(var d=0,e=c.length,f=[],g=[b];e>d;)g=a(g[0],c[d]),f[d]=g[1],d+=1;return[g[0],f]}),$a=I(function(a,b,c){for(var d=c.length-1,e=[],f=[b];d>=0;)f=a(f[0],c[d]),e[d]=f[1],d-=1;return[f[0],e]}),_a=H(function(a,b){return b.match(a)||[]}),ab=H(function(a,b){return n(a)?!n(b)||1>b?NaN:(a%b+b)%b:NaN}),bb=H(function(a,b){return b>a?b:a}),cb=I(function(a,b,c){return a(c)>a(b)?c:b}),db=I(function(a,b,c){var d,e={};for(d in b)j(d,b)&&(e[d]=j(d,c)?a(d,b[d],c[d]):b[d]);for(d in c)j(d,c)&&!j(d,e)&&(e[d]=c[d]);return e}),eb=H(function(a,b){return a>b?b:a}),fb=I(function(a,b,c){return a(c)<a(b)?c:b}),gb=H(function(a,b){return a%b}),hb=H(function(a,b){return a*b}),ib=H(function(a,b){switch(a){case 0:return function(){return b.call(this)};case 1:return function(a){return b.call(this,a)};case 2:return function(a,c){return b.call(this,a,c)};case 3:return function(a,c,d){return b.call(this,a,c,d)};case 4:return function(a,c,d,e){return b.call(this,a,c,d,e)};case 5:return function(a,c,d,e,f){return b.call(this,a,c,d,e,f)};case 6:return function(a,c,d,e,f,g){return b.call(this,a,c,d,e,f,g)};case 7:return function(a,c,d,e,f,g,h){return b.call(this,a,c,d,e,f,g,h)};case 8:return function(a,c,d,e,f,g,h,i){return b.call(this,a,c,d,e,f,g,h,i)};case 9:return function(a,c,d,e,f,g,h,i,j){return b.call(this,a,c,d,e,f,g,h,i,j)};case 10:return function(a,c,d,e,f,g,h,i,j,k){return b.call(this,a,c,d,e,f,g,h,i,j,k)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),jb=G(function(a){return-a}),kb=H(e(K("any",N,ea))),lb=G(function(a){return!a}),mb=H(function(a,b){var c=0>a?b.length+a:a;return s(b)?b.charAt(c):b[c]}),nb=G(function(a){return function(){return mb(a,arguments)}}),ob=H(function(a,b){var c={};return c[a]=b,c}),pb=G(v),qb=G(function(a){var c,d=!1;return b(a.length,function(){return d?c:(d=!0,c=a.apply(this,arguments))})}),rb=H(function(a,b){return a||b}),sb=function(){var a=function(b){return{value:b,map:function(c){return a(c(b))}}};return I(function(b,c,d){
return b(function(b){return a(c(b))})(d).value})}(),tb=H(function(a,b){return[a,b]}),ub=H(function(a,b){for(var c=b,d=0;d<a.length;){if(null==c)return;c=c[a[d]],d+=1}return c}),vb=I(function(a,b,c){return ra(a,ub(b,c))}),wb=I(function(a,b,c){return b.length>0&&a(ub(b,c))}),xb=H(function(a,b){for(var c={},d=0;d<a.length;)a[d]in b&&(c[a[d]]=b[a[d]]),d+=1;return c}),yb=H(function(a,b){for(var c={},d=0,e=a.length;e>d;){var f=a[d];c[f]=b[f],d+=1}return c}),zb=H(function(a,b){var c={};for(var d in b)a(b[d],d,b)&&(c[d]=b[d]);return c}),Ab=H(function(a,b){return f([a],b)}),Bb=H(function(a,b){return b[a]}),Cb=I(function(a,b,c){return null!=c&&j(b,c)?c[b]:a}),Db=I(function(a,b,c){return a(c[b])}),Eb=H(function(a,b){for(var c=a.length,d=[],e=0;c>e;)d[e]=b[a[e]],e+=1;return d}),Fb=H(function(a,b){if(!o(a)||!o(b))throw new TypeError("Both arguments to range must be numbers");for(var c=[],d=a;b>d;)c.push(d),d+=1;return c}),Gb=I(function(a,b,c){for(var d=c.length-1;d>=0;)b=a(b,c[d]),d-=1;return b}),Hb=G(z),Ib=I(function(a,b,c){return f(A(c,0,Math.min(a,c.length)),A(c,Math.min(c.length,a+b)))}),Jb=I(function(a,b,c){return c.replace(a,b)}),Kb=G(function(a){return s(a)?a.split("").reverse().join(""):A(a).reverse()}),Lb=I(function(a,b,c){for(var d=0,e=c.length,f=[b];e>d;)b=a(b,c[d]),f[d+1]=b,d+=1;return f}),Mb=I(function(a,b,c){return sb(a,ca(b),c)}),Nb=I(F("slice",function(a,b,c){return Array.prototype.slice.call(c,a,b)})),Ob=H(function(a,b){return A(b).sort(a)}),Pb=H(function(a,b){return A(b).sort(function(b,c){var d=a(b),e=a(c);return e>d?-1:d>e?1:0})}),Qb=H(function(a,b){return[Nb(0,a,b),Nb(a,Wa(b),b)]}),Rb=H(function(a,b){if(0>=a)throw new Error("First argument to splitEvery must be a positive integer");for(var c=[],d=0;d<b.length;)c.push(Nb(d,d+=a,b));return c}),Sb=H(function(a,b){for(var c=0,d=b.length,e=[];d>c&&!a(b[c]);)e.push(b[c]),c+=1;return[e,A(b,c)]}),Tb=H(function(a,b){return a-b}),Ub=F("tail",Nb(1,1/0)),Vb=H(K("take",Z,function(a,b){return Nb(0,0>a?1/0:a,b)})),Wb=H(function(a,b){for(var c=b.length-1;c>=0&&a(b[c]);)c-=1;return A(b,c+1,1/0)}),Xb=H(K("takeWhile",$,function(a,b){for(var c=0,d=b.length;d>c&&a(b[c]);)c+=1;return A(b,0,c)})),Yb=H(function(a,b){return a(b),b}),Zb=H(function(a,b){for(var c=Number(b),d=new Array(c),e=0;c>e;)d[e]=a(e),e+=1;return d}),$b=G(function(a){var b=[];for(var c in a)j(c,a)&&(b[b.length]=[c,a[c]]);return b}),_b=G(function(a){var b=[];for(var c in a)b[b.length]=[c,a[c]];return b}),ac=G(function(a){for(var b=0,c=[];b<a.length;){for(var d=a[b],e=0;e<d.length;)"undefined"==typeof c[e]&&(c[e]=[]),c[e].push(d[e]),e+=1;b+=1}return c}),bc=function(){var a="	\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff",b="​",c="function"==typeof String.prototype.trim;return G(c&&!a.trim()&&b.trim()?function(a){return a.trim()}:function(b){var c=new RegExp("^["+a+"]["+a+"]*"),d=new RegExp("["+a+"]["+a+"]*$");return b.replace(c,"").replace(d,"")})}(),cc=G(function(a){return null===a?"Null":void 0===a?"Undefined":Object.prototype.toString.call(a).slice(8,-1)}),dc=G(function(a){return function(){return a(A(arguments))}}),ec=G(function(a){return ib(1,a)}),fc=H(function(a,b){return pa(a,function(){for(var c,d=1,e=b,f=0;a>=d&&"function"==typeof e;)c=d===a?arguments.length:f+e.length,e=e.apply(this,A(arguments,f,c)),d+=1,f=c;return e})}),gc=H(function(a,b){for(var c=a(b),d=[];c&&c.length;)d[d.length]=c[0],c=a(c[1]);return d}),hc=H(function(a,b){for(var c,d=0,e=b.length,f=[];e>d;)c=b[d],g(a,c,f)||(f[f.length]=c),d+=1;return f}),ic=I(function(a,b,c){return a(c)?c:b(c)}),jc=I(function(a,b,c){return aa(ca(b),a,c)}),kc=H(function(a,b){return pa(b.length,function(){for(var c=[],d=0;d<b.length;)c.push(b[d].call(this,arguments[d])),d+=1;return a.apply(this,c.concat(A(arguments,b.length)))})}),lc=G(function(a){for(var b=Ua(a),c=b.length,d=[],e=0;c>e;)d[e]=a[b[e]],e+=1;return d}),mc=G(function(a){var b,c=[];for(b in a)c[c.length]=a[b];return c}),nc=function(){var a=function(a){return{value:a,map:function(){return this}}};return H(function(b,c){return b(a)(c).value})}(),oc=I(function(a,b,c){return a(c)?b(c):c}),pc=H(function(a,b){for(var c in a)if(j(c,a)&&!a[c](b[c]))return!1;return!0}),qc=H(function(a,b){return pa(a.length,function(){return b.apply(this,f([a],arguments))})}),rc=H(function(a,b){for(var c,d=0,e=a.length,f=b.length,g=[];e>d;){for(c=0;f>c;)g[g.length]=[a[d],b[c]],c+=1;d+=1}return g}),sc=H(function(a,b){for(var c=[],d=0,e=Math.min(a.length,b.length);e>d;)c[d]=[a[d],b[d]],d+=1;return c}),tc=H(function(a,b){for(var c=0,d=a.length,e={};d>c;)e[a[c]]=b[c],c+=1;return e}),uc=I(function(a,b,c){for(var d=[],e=0,f=Math.min(b.length,c.length);f>e;)d[e]=a(b[e],c[e]),e+=1;return d}),vc=ca(!1),wc=ca(!0),xc=function He(a,b,c){var e=function(d){for(var e=b.length,f=0;e>f;){if(a===b[f])return c[f];f+=1}b[f+1]=a,c[f+1]=d;for(var g in a)d[g]=He(a[g],b,c);return d};switch(cc(a)){case"Object":return e({});case"Array":return e([]);case"Date":return new Date(a);case"RegExp":return d(a);default:return a}},yc=function(a){return H(function(c,d){return b(Math.max(0,c.length-d.length),function(){return c.apply(this,a(d,arguments))})})},zc=function(a,b){return Vb(a<b.length?b.length-a:0,b)},Ac=function Ie(a,b,d,e){if(Ka(a,b))return!0;if(cc(a)!==cc(b))return!1;if(null==a||null==b)return!1;if("function"==typeof a.equals||"function"==typeof b.equals)return"function"==typeof a.equals&&a.equals(b)&&"function"==typeof b.equals&&b.equals(a);switch(cc(a)){case"Arguments":case"Array":case"Object":break;case"Boolean":case"Number":case"String":if(typeof a!=typeof b||!Ka(a.valueOf(),b.valueOf()))return!1;break;case"Date":if(!Ka(a.valueOf(),b.valueOf()))return!1;break;case"Error":if(a.name!==b.name||a.message!==b.message)return!1;break;case"RegExp":if(a.source!==b.source||a.global!==b.global||a.ignoreCase!==b.ignoreCase||a.multiline!==b.multiline||a.sticky!==b.sticky||a.unicode!==b.unicode)return!1;break;case"Map":case"Set":if(!Ie(c(a.entries()),c(b.entries()),d,e))return!1;break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":break;case"ArrayBuffer":break;default:return!1}var f=Ua(a);if(f.length!==Ua(b).length)return!1;for(var g=d.length-1;g>=0;){if(d[g]===a)return e[g]===b;g-=1}for(d.push(a),e.push(b),g=f.length-1;g>=0;){var h=f[g];if(!j(h,b)||!Ie(b[h],a[h],d,e))return!1;g-=1}return d.pop(),e.pop(),!0},Bc=function(a){return function b(c){for(var d,e,f,g=[],h=0,i=c.length;i>h;){if(Sa(c[h]))for(d=a?b(c[h]):c[h],f=0,e=d.length;e>f;)g[g.length]=d[f],f+=1;else g[g.length]=c[h];h+=1}return g}},Cc=function(){function a(a,b,c){for(var d=0,e=c.length;e>d;){if(b=a["@@transducer/step"](b,c[d]),b&&b["@@transducer/reduced"]){b=b["@@transducer/value"];break}d+=1}return a["@@transducer/result"](b)}function b(a,b,c){for(var d=c.next();!d.done;){if(b=a["@@transducer/step"](b,d.value),b&&b["@@transducer/reduced"]){b=b["@@transducer/value"];break}d=c.next()}return a["@@transducer/result"](b)}function c(a,b,c){return a["@@transducer/result"](c.reduce(ka(a["@@transducer/step"],a),b))}var d="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(e,f,g){if("function"==typeof e&&(e=D(e)),Sa(g))return a(e,f,g);if("function"==typeof g.reduce)return c(e,f,g);if(null!=g[d])return b(e,f,g[d]());if("function"==typeof g.next)return b(e,f,g);throw new TypeError("reduce: list must be array or iterable")}}(),Dc=function(){function a(a,b){this.f=a,this.retained=[],this.xf=b}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){return this.retained=null,this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){return this.f(b)?this.retain(a,b):this.flush(a,b)},a.prototype.flush=function(a,b){return a=Cc(this.xf["@@transducer/step"],a,this.retained),this.retained=[],this.xf["@@transducer/step"](a,b)},a.prototype.retain=function(a,b){return this.retained.push(b),a},H(function(b,c){return new a(b,c)})}(),Ec=function(){function a(a,b){this.xf=b,this.f=a,this.inputs={}}return a.prototype["@@transducer/init"]=C.init,a.prototype["@@transducer/result"]=function(a){var b;for(b in this.inputs)if(j(b,this.inputs)&&(a=this.xf["@@transducer/step"](a,this.inputs[b]),a["@@transducer/reduced"])){a=a["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](a)},a.prototype["@@transducer/step"]=function(a,b){var c=this.f(b);return this.inputs[c]=this.inputs[c]||[c,[]],this.inputs[c][1]=ga(b,this.inputs[c][1]),a},H(function(b,c){return new a(b,c)})}(),Fc=G(function(a){return pa(a.length,function(){var b=0,c=arguments[0],d=arguments[arguments.length-1],e=A(arguments);return e[0]=function(){var a=c.apply(this,f(arguments,[b,d]));return b+=1,a},a.apply(this,e)})}),Gc=G(function(a){return ib(2,a)}),Hc=G(function(a){return null!=a&&"function"==typeof a.clone?a.clone():xc(a,[],[])}),Ic=G(function(a){return pa(a.length,a)}),Jc=H(K("drop",P,function(a,b){return Nb(Math.max(0,a),1/0,b)})),Kc=H(K("dropLast",Q,zc)),Lc=H(K("dropLastWhile",Dc,L)),Mc=H(function(a,b){return Ac(a,b,[],[])}),Nc=H(K("filter",T,function(a,b){return p(b)?Cc(function(c,d){return a(b[d])&&(c[d]=b[d]),c},{},Ua(b)):h(a,b)})),Oc=G(Bc(!0)),Pc=G(function(a){return Ic(function(b,c){var d=A(arguments);return d[0]=c,d[1]=b,a.apply(this,d)})}),Qc=H(K("groupBy",Ec,function(a,b){return Cc(function(b,c){var d=a(c);return b[d]=ga(c,b[d]||(b[d]=[])),b},{},b)})),Rc=mb(0),Sc=H(function(a,b){return Cc(function(b,c){var d=a(c);return b[d]=c,b},{},b)}),Tc=Nb(0,-1),Uc=I(function(a,b,c){for(var d=[],e=0;e<b.length;)g(a,b[e],c)&&(d[d.length]=b[e]),e+=1;return hc(a,d)}),Vc=G(function(a){for(var b=Ua(a),c=b.length,d=0,e={};c>d;){var f=b[d],g=a[f],h=j(g,e)?e[g]:e[g]=[];h[h.length]=f,d+=1}return e}),Wc=G(function(a){for(var b=Ua(a),c=b.length,d=0,e={};c>d;){var f=b[d];e[a[f]]=f,d+=1}return e}),Xc=G(function(a){return null!=a&&Mc(a,ya(a))}),Yc=mb(-1),Zc=H(function(a,b){if("function"!=typeof b.lastIndexOf||m(b)){for(var c=b.length-1;c>=0;){if(Mc(b[c],a))return c;c-=1}return-1}return b.lastIndexOf(a)}),$c=H(K("map",Y,function(a,b){switch(Object.prototype.toString.call(b)){case"[object Function]":return pa(b.length,function(){return a.call(this,b.apply(this,arguments))});case"[object Object]":return Cc(function(c,d){return c[d]=a(b[d]),c},{},Ua(b));default:return u(a,b)}})),_c=H(function(a,b){return Cc(function(c,d){return c[d]=a(b[d],d,b),c},{},Ua(b))}),ad=I(function(a,b,c){return db(function(b,c,d){return a(c,d)},b,c)}),bd=yc(f),cd=yc(Pc(f)),dd=H(function(a,b){return Cc(function(b,c){var d=b[a(c)?0:1];return d[d.length]=c,b},[[],[]],b)}),ed=I(function(a,b,c){return Mc(ub(a,c),b)}),fd=H(function(a,b){return $c(Bb(a),b)}),gd=kc(u,[yb,La]),hd=I(function(a,b,c){return Db(Mc(b),a,c)}),id=I(function(a,b,c){return Db(Ra(a),b,c)}),jd=I(Cc),kd=H(function(a,b){return Nc(e(a),b)}),ld=H(function(a,b){return Zb(ca(a),b)}),md=jd(_,0),nd=H(function(a,b){return Jc(a>=0?b.length-a:0,b)}),od=pa(4,function(a,b,c,d){return Cc(a("function"==typeof b?D(b):b),c,d)}),pd=I(function(a,b,c){return hc(a,f(b,c))}),qd=H(function(a,b){return pc($c(Mc,a),b)}),rd=function(){var a=function(a){return{"@@transducer/init":C.init,"@@transducer/result":function(b){return a["@@transducer/result"](b)},"@@transducer/step":function(b,c){var d=a["@@transducer/step"](b,c);return d["@@transducer/reduced"]?i(d):d}}};return function(b){var c=a(b);return{"@@transducer/init":C.init,"@@transducer/result":function(a){return c["@@transducer/result"](a)},"@@transducer/step":function(a,b){return Sa(b)?Cc(c,a,b):Cc(c,a,[b])}}}}(),sd=function(a,b,c){var d,e;if("function"==typeof a.indexOf)switch(typeof b){case"number":if(0===b){for(d=1/b;c<a.length;){if(e=a[c],0===e&&1/e===d)return c;c+=1}return-1}if(b!==b){for(;c<a.length;){if(e=a[c],"number"==typeof e&&e!==e)return c;c+=1}return-1}return a.indexOf(b,c);case"string":case"boolean":case"function":case"undefined":return a.indexOf(b,c);case"object":if(null===b)return a.indexOf(b,c)}for(;c<a.length;){if(Mc(a[c],b))return c;c+=1}return-1},td=H(function(a,b){return $c(a,rd(b))}),ud=G(function(a){return pa(jd(bb,0,fd("length",a)),function(){for(var b=0,c=a.length;c>b;){if(!a[b].apply(this,arguments))return!1;b+=1}return!0})}),vd=G(function(a){for(var b=a.length,c=0;b>c;){if(sd(a,a[c],c+1)>=0)return!1;c+=1}return!0}),wd=G(function(a){return pa(jd(bb,0,fd("length",a)),function(){for(var b=0,c=a.length;c>b;){if(a[b].apply(this,arguments))return!0;b+=1}return!1})}),xd=H(function(a,b){return"function"==typeof a.ap?a.ap(b):"function"==typeof a?pa(Math.max(a.length,b.length),function(){return a.apply(this,arguments)(b.apply(this,arguments))}):Cc(function(a,c){return f(a,$c(c,b))},[],a)}),yd=Ic(function(a){return a.apply(this,A(arguments,1))}),zd=H(K("chain",td,function(a,b){return"function"==typeof b?function(){return b.call(this,a.apply(this,arguments)).apply(this,arguments)}:Bc(!1)($c(a,b))})),Ad=I(function(a,b,c){function d(b,c){return xd($c(Ab,a(c)),b)}return Gb(d,b([]),c)}),Bd=H(function(a,b){if(a>10)throw new Error("Constructor with greater than ten arguments");return 0===a?function(){return new b}:Ic(ib(a,function(a,c,d,e,f,g,h,i,j,k){switch(arguments.length){case 1:return new b(a);case 2:return new b(a,c);case 3:return new b(a,c,d);case 4:return new b(a,c,d,e);case 5:return new b(a,c,d,e,f);case 6:return new b(a,c,d,e,f,g);case 7:return new b(a,c,d,e,f,g,h);case 8:return new b(a,c,d,e,f,g,h,i);case 9:return new b(a,c,d,e,f,g,h,i,j);case 10:return new b(a,c,d,e,f,g,h,i,j,k)}}))}),Cd=H(function(a,b){return pa(Math.max.apply(Math,fd("length",b)),function(){var c=arguments,d=this;return a.apply(d,u(function(a){return a.apply(d,c)},b))})}),Dd=H(K("dropRepeatsWith",R,function(a,b){var c=[],d=1,e=b.length;if(0!==e)for(c[0]=b[0];e>d;)a(Yc(c),b[d])||(c[c.length]=b[d]),d+=1;return c})),Ed=I(function(a,b,c){return Mc(a(b),a(c))}),Fd=I(function(a,b,c){return Mc(b[a],c[a])}),Gd=H(function(a,b){return"function"!=typeof b.indexOf||m(b)?sd(b,a,0):b.indexOf(a)}),Hd=G(function(b){return function(){return $c(ha(a,arguments),b)}}),Id=H(function(a,b){return function(c){return function(d){return $c(function(a){return b(a,d)},c(a(d)))}}}),Jd=G(function(a){return Id(mb(a),jc(a))}),Kd=G(function(a){return Id(ub(a),ja(a))}),Ld=G(function(a){return Id(Bb(a),ia(a))}),Md=H(function(a,b){var c=pa(a,b);return pa(a,function(){return Cc(xd,$c(c,arguments[0]),A(arguments,1))})}),Nd=G(function(a){return md(a)/a.length}),Od=G(function(a){var b=a.length;if(0===b)return NaN;var c=2-b%2,d=(b-c)/2;return Nd(A(a).sort(function(a,b){return b>a?-1:a>b?1:0}).slice(d,d+c))}),Pd=ad(function(a,b){return b}),Qd=G(function(a){return jd(Pd,{},a)}),Rd=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return b(arguments[0].length,jd(w,arguments[0],Ub(arguments)))},Sd=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return b(arguments[0].length,jd(x,arguments[0],Ub(arguments)))},Td=jd(hb,1),Ud=H(function(a,b){return"function"==typeof b.sequence?b.sequence(a):Gb(function(a,b){return xd($c(Ab,b),a)},a([]),b)}),Vd=I(function(a,b,c){return Ud(a,$c(b,c))}),Wd=zd(k),Xd=function(a,b){return sd(b,a,0)>=0},Yd=function(){var a={"@@transducer/init":Array,"@@transducer/step":function(a,b){return f(a,[b])},"@@transducer/result":k},b={"@@transducer/init":String,"@@transducer/step":function(a,b){return a+b},"@@transducer/result":k},c={"@@transducer/init":Object,"@@transducer/step":function(a,b){return Pd(a,Sa(b)?ob(b[0],b[1]):b)},"@@transducer/result":k};return function(d){if(t(d))return d;if(Sa(d))return a;if("string"==typeof d)return b;if("object"==typeof d)return c;throw new Error("Cannot create transformer for "+d)}}(),Zd=function Je(a,b){var c=function(c){var d=b.concat([a]);return Xd(c,d)?"<Circular>":Je(c,d)},d=function(a,b){return u(function(b){return y(b)+": "+c(a[b])},b.slice().sort())};switch(Object.prototype.toString.call(a)){case"[object Arguments]":return"(function() { return arguments; }("+u(c,a).join(", ")+"))";case"[object Array]":return"["+u(c,a).concat(d(a,kd(function(a){return/^\d+$/.test(a)},Ua(a)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof a?"new Boolean("+c(a.valueOf())+")":a.toString();case"[object Date]":return"new Date("+y(B(a))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof a?"new Number("+c(a.valueOf())+")":1/a===-(1/0)?"-0":a.toString(10);case"[object String]":return"object"==typeof a?"new String("+c(a.valueOf())+")":y(a);case"[object Undefined]":return"undefined";default:if("function"==typeof a.toString){var e=a.toString();if("[object Object]"!==e)return e}return"{"+d(a,Ua(a)).join(", ")+"}"}},$d=Ad(La),_d=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Rd.apply(this,Kb(arguments))},ae=function(){return _d.apply(this,Ab(La,$c(zd,arguments)))},be=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Sd.apply(this,Kb(arguments))},ce=G(function(a){return Bd(a.length,a)}),de=H(Xd),ee=H(function(a,b){for(var c=[],d=0,e=a.length;e>d;)Xd(a[d],b)||Xd(a[d],c)||(c[c.length]=a[d]),d+=1;return c}),fe=G(K("dropRepeats",R(Mc),Dd(Mc))),ge=I(function(a,b,c){return t(a)?Cc(b(a),a["@@transducer/init"](),c):Cc(b(Yd(a)),a,c)}),he=G(function(a){return Md(a.length,a)}),ie=H(function(a,b){var c={};for(var d in b)Xd(d,a)||(c[d]=b[d]);return c}),je=function(){return ae.apply(this,Kb(arguments))},ke=G(function(a){return Zd(a,[])}),le=H("undefined"==typeof Set?function(a,b){for(var c,d,e=0,f=[],g=[];e<b.length;)d=b[e],c=a(d),Xd(c,f)||(g.push(d),f.push(c)),e+=1;return g}:function(a,b){for(var c,d,e,f=new Set,g=[],h=0,i=[],j=!1,k=!1,l=0;l<b.length;){switch(d=b[l],c=a(d),typeof c){case"number":if(0===c&&!k&&1/c===-(1/0)){k=!0,i.push(d);break}case"string":case"boolean":case"function":case"undefined":f.add(c),e=f.size,e>h&&(i.push(d),h=e);break;case"object":if(null===c){j||(j=!0,i.push(null));break}default:Xd(c,g)||(g.push(c),i.push(d))}l+=1}return i}),me=H(function(a,b){return kd(Pc(Xd)(a),b)}),ne=he(lb),oe=H(function(a,b){return pa(a+1,function(){var c=arguments[a];if(null!=c&&Ra(Function,c[b]))return c[b].apply(c,A(arguments,0,a));throw new TypeError(ke(c)+' does not have a method named "'+b+'"')})}),pe=oe(1,"join"),qe=G(function(a){var c={};return b(a.length,function(){var b=ke(arguments);return j(b,c)||(c[b]=a.apply(this,arguments)),c[b]})}),re=oe(1,"split"),se=H(function(a,b){if(!r(a))throw new TypeError("‘test’ requires a value of type RegExp as its first argument; received "+ke(a));return d(a).test(b)}),te=oe(0,"toLowerCase"),ue=oe(0,"toUpperCase"),ve=le(La),we=Pc(oe(1,"concat")),xe=H(function(a,b){return ve(h(Pc(Xd)(a),b))}),ye=H(function(a,b){return we(ee(a,b),ee(b,a))}),ze=I(function(a,b,c){return we(sa(a,b,c),sa(a,c,b))}),Ae=H(_d(ve,f)),Be={F:vc,T:wc,__:a,add:_,addIndex:Fc,adjust:aa,all:ba,allPass:ud,allUniq:vd,always:ca,and:da,any:ea,anyPass:wd,ap:xd,aperture:fa,append:ga,apply:ha,assoc:ia,assocPath:ja,binary:Gc,bind:ka,both:la,call:yd,chain:zd,clone:Hc,commute:$d,commuteMap:Ad,comparator:ma,complement:ne,compose:_d,composeK:ae,composeP:be,concat:we,cond:na,construct:ce,constructN:Bd,contains:de,converge:Cd,countBy:oa,curry:Ic,curryN:pa,dec:qa,defaultTo:ra,difference:ee,differenceWith:sa,dissoc:ta,dissocPath:ua,divide:va,drop:Jc,dropLast:Kc,dropLastWhile:Lc,dropRepeats:fe,dropRepeatsWith:Dd,dropWhile:wa,either:xa,empty:ya,eqBy:Ed,eqProps:Fd,equals:Mc,evolve:za,filter:Nc,find:Aa,findIndex:Ba,findLast:Ca,findLastIndex:Da,flatten:Oc,flip:Pc,forEach:Ea,fromPairs:Fa,groupBy:Qc,gt:Ga,gte:Ha,has:Ia,hasIn:Ja,head:Rc,identical:Ka,identity:La,ifElse:Ma,inc:Na,indexBy:Sc,indexOf:Gd,init:Tc,insert:Oa,insertAll:Pa,intersection:xe,intersectionWith:Uc,intersperse:Qa,into:ge,invert:Vc,invertObj:Wc,invoker:oe,is:Ra,isArrayLike:Sa,isEmpty:Xc,isNil:Ta,join:pe,juxt:Hd,keys:Ua,keysIn:Va,last:Yc,lastIndexOf:Zc,length:Wa,lens:Id,lensIndex:Jd,lensPath:Kd,lensProp:Ld,lift:he,liftN:Md,lt:Xa,lte:Ya,map:$c,mapAccum:Za,mapAccumRight:$a,mapObjIndexed:_c,match:_a,mathMod:ab,max:bb,maxBy:cb,mean:Nd,median:Od,memoize:qe,merge:Pd,mergeAll:Qd,mergeWith:ad,mergeWithKey:db,min:eb,minBy:fb,modulo:gb,multiply:hb,nAry:ib,negate:jb,none:kb,not:lb,nth:mb,nthArg:nb,objOf:ob,of:pb,omit:ie,once:qb,or:rb,over:sb,pair:tb,partial:bd,partialRight:cd,partition:dd,path:ub,pathEq:ed,pathOr:vb,pathSatisfies:wb,pick:xb,pickAll:yb,pickBy:zb,pipe:Rd,pipeK:je,pipeP:Sd,pluck:fd,prepend:Ab,product:Td,project:gd,prop:Bb,propEq:hd,propIs:id,propOr:Cb,propSatisfies:Db,props:Eb,range:Fb,reduce:jd,reduceRight:Gb,reduced:Hb,reject:kd,remove:Ib,repeat:ld,replace:Jb,reverse:Kb,scan:Lb,sequence:Ud,set:Mb,slice:Nb,sort:Ob,sortBy:Pb,split:re,splitAt:Qb,splitEvery:Rb,splitWhen:Sb,subtract:Tb,sum:md,symmetricDifference:ye,symmetricDifferenceWith:ze,tail:Ub,take:Vb,takeLast:nd,takeLastWhile:Wb,takeWhile:Xb,tap:Yb,test:se,times:Zb,toLower:te,toPairs:$b,toPairsIn:_b,toString:ke,toUpper:ue,transduce:od,transpose:ac,traverse:Vd,trim:bc,type:cc,unapply:dc,unary:ec,uncurryN:fc,unfold:gc,union:Ae,unionWith:pd,uniq:ve,uniqBy:le,uniqWith:hc,unless:ic,unnest:Wd,update:jc,useWith:kc,values:lc,valuesIn:mc,view:nc,when:oc,where:pc,whereEq:qd,without:me,wrap:qc,xprod:rc,zip:sc,zipObj:tc,zipWith:uc};"object"==typeof exports?module.exports=Be:"function"==typeof define&&define.amd?define(function(){return Be}):this.R=Be}).call(this),function(a,b,c){function d(a,b){return b=b||Error,function(){var c,d,e=2,f=arguments,g=f[0],h="["+(a?a+":":"")+g+"] ",i=f[1];for(h+=i.replace(/\{\d+\}/g,function(a){var b=+a.slice(1,-1),c=b+e;return c<f.length?ta(f[c]):a}),h+="\nhttp://errors.angularjs.org/1.4.8/"+(a?a+"/":"")+g,d=e,c="?";d<f.length;d++,c="&")h+=c+"p"+(d-e)+"="+encodeURIComponent(ta(f[d]));return new b(h)}}function e(a){if(null==a||C(a))return!1;if(Od(a)||x(a)||Cd&&a instanceof Cd)return!0;var b="length"in Object(a)&&a.length;return y(b)&&(b>=0&&b-1 in a||"function"==typeof a.item)}function f(a,b,c){var d,g;if(a)if(A(a))for(d in a)"prototype"==d||"length"==d||"name"==d||a.hasOwnProperty&&!a.hasOwnProperty(d)||b.call(c,a[d],d,a);else if(Od(a)||e(a)){var h="object"!=typeof a;for(d=0,g=a.length;g>d;d++)(h||d in a)&&b.call(c,a[d],d,a)}else if(a.forEach&&a.forEach!==f)a.forEach(b,c,a);else if(w(a))for(d in a)b.call(c,a[d],d,a);else if("function"==typeof a.hasOwnProperty)for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a);else for(d in a)xd.call(a,d)&&b.call(c,a[d],d,a);return a}function g(a,b,c){for(var d=Object.keys(a).sort(),e=0;e<d.length;e++)b.call(c,a[d[e]],d[e]);return d}function h(a){return function(b,c){a(c,b)}}function i(){return++Md}function j(a,b){b?a.$$hashKey=b:delete a.$$hashKey}function k(a,b,c){for(var d=a.$$hashKey,e=0,f=b.length;f>e;++e){var g=b[e];if(v(g)||A(g))for(var h=Object.keys(g),i=0,l=h.length;l>i;i++){var m=h[i],n=g[m];c&&v(n)?z(n)?a[m]=new Date(n.valueOf()):B(n)?a[m]=new RegExp(n):n.nodeName?a[m]=n.cloneNode(!0):K(n)?a[m]=n.clone():(v(a[m])||(a[m]=Od(n)?[]:{}),k(a[m],[n],!0)):a[m]=n}}return j(a,d),a}function l(a){return k(a,Fd.call(arguments,1),!1)}function m(a){return k(a,Fd.call(arguments,1),!0)}function n(a){return parseInt(a,10)}function o(a,b){return l(Object.create(a),b)}function p(){}function q(a){return a}function r(a){return function(){return a}}function s(a){return A(a.toString)&&a.toString!==Id}function t(a){return"undefined"==typeof a}function u(a){return"undefined"!=typeof a}function v(a){return null!==a&&"object"==typeof a}function w(a){return null!==a&&"object"==typeof a&&!Jd(a)}function x(a){return"string"==typeof a}function y(a){return"number"==typeof a}function z(a){return"[object Date]"===Id.call(a)}function A(a){return"function"==typeof a}function B(a){return"[object RegExp]"===Id.call(a)}function C(a){return a&&a.window===a}function D(a){return a&&a.$evalAsync&&a.$watch}function E(a){return"[object File]"===Id.call(a)}function F(a){return"[object FormData]"===Id.call(a)}function G(a){return"[object Blob]"===Id.call(a)}function H(a){return"boolean"==typeof a}function I(a){return a&&A(a.then)}function J(a){return a&&y(a.length)&&Pd.test(Id.call(a))}function K(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function L(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function M(a){return wd(a.nodeName||a[0]&&a[0].nodeName)}function N(a,b){var c=a.indexOf(b);return c>=0&&a.splice(c,1),c}function O(a,b){function c(a,b){var c,e=b.$$hashKey;if(Od(a))for(var f=0,g=a.length;g>f;f++)b.push(d(a[f]));else if(w(a))for(c in a)b[c]=d(a[c]);else if(a&&"function"==typeof a.hasOwnProperty)for(c in a)a.hasOwnProperty(c)&&(b[c]=d(a[c]));else for(c in a)xd.call(a,c)&&(b[c]=d(a[c]));return j(b,e),b}function d(a){if(!v(a))return a;var b=e.indexOf(a);if(-1!==b)return g[b];if(C(a)||D(a))throw Kd("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var d,f=!1;return Od(a)?(d=[],f=!0):J(a)?d=new a.constructor(a):z(a)?d=new Date(a.getTime()):B(a)?(d=new RegExp(a.source,a.toString().match(/[^\/]*$/)[0]),d.lastIndex=a.lastIndex):A(a.cloneNode)?d=a.cloneNode(!0):(d=Object.create(Jd(a)),f=!0),e.push(a),g.push(d),f?c(a,d):d}var e=[],g=[];if(b){if(J(b))throw Kd("cpta","Can't copy! TypedArray destination cannot be mutated.");if(a===b)throw Kd("cpi","Can't copy! Source and destination are identical.");return Od(b)?b.length=0:f(b,function(a,c){"$$hashKey"!==c&&delete b[c]}),e.push(a),g.push(b),c(a,b)}return d(a)}function P(a,b){if(Od(a)){b=b||[];for(var c=0,d=a.length;d>c;c++)b[c]=a[c]}else if(v(a)){b=b||{};for(var e in a)("$"!==e.charAt(0)||"$"!==e.charAt(1))&&(b[e]=a[e])}return b||a}function Q(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var c,d,e,f=typeof a,g=typeof b;if(f==g&&"object"==f){if(!Od(a)){if(z(a))return z(b)?Q(a.getTime(),b.getTime()):!1;if(B(a))return B(b)?a.toString()==b.toString():!1;if(D(a)||D(b)||C(a)||C(b)||Od(b)||z(b)||B(b))return!1;e=qa();for(d in a)if("$"!==d.charAt(0)&&!A(a[d])){if(!Q(a[d],b[d]))return!1;e[d]=!0}for(d in b)if(!(d in e)&&"$"!==d.charAt(0)&&u(b[d])&&!A(b[d]))return!1;return!0}if(!Od(b))return!1;if((c=a.length)==b.length){for(d=0;c>d;d++)if(!Q(a[d],b[d]))return!1;return!0}}return!1}function R(a,b,c){return a.concat(Fd.call(b,c))}function S(a,b){return Fd.call(a,b||0)}function T(a,b){var c=arguments.length>2?S(arguments,2):[];return!A(b)||b instanceof RegExp?b:c.length?function(){return arguments.length?b.apply(a,R(c,arguments,0)):b.apply(a,c)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function U(a,d){var e=d;return"string"==typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?e=c:C(d)?e="$WINDOW":d&&b===d?e="$DOCUMENT":D(d)&&(e="$SCOPE"),e}function V(a,b){return"undefined"==typeof a?c:(y(b)||(b=b?2:null),JSON.stringify(a,U,b))}function W(a){return x(a)?JSON.parse(a):a}function X(a,b){var c=Date.parse("Jan 01, 1970 00:00:00 "+a)/6e4;return isNaN(c)?b:c}function Y(a,b){return a=new Date(a.getTime()),a.setMinutes(a.getMinutes()+b),a}function Z(a,b,c){c=c?-1:1;var d=X(b,a.getTimezoneOffset());return Y(a,c*(d-a.getTimezoneOffset()))}function $(a){a=Cd(a).clone();try{a.empty()}catch(b){}var c=Cd("<div>").append(a).html();try{return a[0].nodeType===Zd?wd(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+wd(b)})}catch(b){return wd(c)}}function _(a){try{return decodeURIComponent(a)}catch(b){}}function aa(a){var b={};return f((a||"").split("&"),function(a){var c,d,e;a&&(d=a=a.replace(/\+/g,"%20"),c=a.indexOf("="),-1!==c&&(d=a.substring(0,c),e=a.substring(c+1)),d=_(d),u(d)&&(e=u(e)?_(e):!0,xd.call(b,d)?Od(b[d])?b[d].push(e):b[d]=[b[d],e]:b[d]=e))}),b}function ba(a){var b=[];return f(a,function(a,c){Od(a)?f(a,function(a){b.push(da(c,!0)+(a===!0?"":"="+da(a,!0)))}):b.push(da(c,!0)+(a===!0?"":"="+da(a,!0)))}),b.length?b.join("&"):""}function ca(a){return da(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function da(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function ea(a,b){var c,d,e=Ud.length;for(d=0;e>d;++d)if(c=Ud[d]+b,x(c=a.getAttribute(c)))return c;return null}function fa(a,b){var c,d,e={};f(Ud,function(b){var e=b+"app";!c&&a.hasAttribute&&a.hasAttribute(e)&&(c=a,d=a.getAttribute(e))}),f(Ud,function(b){var e,f=b+"app";!c&&(e=a.querySelector("["+f.replace(":","\\:")+"]"))&&(c=e,d=e.getAttribute(f))}),c&&(e.strictDi=null!==ea(c,"strict-di"),b(c,d?[d]:[],e))}function ga(c,d,e){v(e)||(e={});var g={strictDi:!1};e=l(g,e);var h=function(){if(c=Cd(c),c.injector()){var a=c[0]===b?"document":$(c);throw Kd("btstrpd","App Already Bootstrapped with this Element '{0}'",a.replace(/</,"&lt;").replace(/>/,"&gt;"))}d=d||[],d.unshift(["$provide",function(a){a.value("$rootElement",c)}]),e.debugInfoEnabled&&d.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]),d.unshift("ng");var f=ab(d,e.strictDi);return f.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d),c(b)(a)})}]),f},i=/^NG_ENABLE_DEBUG_INFO!/,j=/^NG_DEFER_BOOTSTRAP!/;return a&&i.test(a.name)&&(e.debugInfoEnabled=!0,a.name=a.name.replace(i,"")),a&&!j.test(a.name)?h():(a.name=a.name.replace(j,""),Ld.resumeBootstrap=function(a){return f(a,function(a){d.push(a)}),h()},void(A(Ld.resumeDeferredBootstrap)&&Ld.resumeDeferredBootstrap()))}function ha(){a.name="NG_ENABLE_DEBUG_INFO!"+a.name,a.location.reload()}function ia(a){var b=Ld.element(a).injector();if(!b)throw Kd("test","no injector found for element argument to getTestability");return b.get("$$testability")}function ja(a,b){return b=b||"_",a.replace(Vd,function(a,c){return(c?b:"")+a.toLowerCase()})}function ka(){var b;if(!Wd){var d=Td();Dd=t(d)?a.jQuery:d?a[d]:c,Dd&&Dd.fn.on?(Cd=Dd,l(Dd.fn,{scope:qe.scope,isolateScope:qe.isolateScope,controller:qe.controller,injector:qe.injector,inheritedData:qe.inheritedData}),b=Dd.cleanData,Dd.cleanData=function(a){var c;if(Nd)Nd=!1;else for(var d,e=0;null!=(d=a[e]);e++)c=Dd._data(d,"events"),c&&c.$destroy&&Dd(d).triggerHandler("$destroy");b(a)}):Cd=Ca,Ld.element=Cd,Wd=!0}}function la(a,b,c){if(!a)throw Kd("areq","Argument '{0}' is {1}",b||"?",c||"required");return a}function ma(a,b,c){return c&&Od(a)&&(a=a[a.length-1]),la(A(a),b,"not a function, got "+(a&&"object"==typeof a?a.constructor.name||"Object":typeof a)),a}function na(a,b){if("hasOwnProperty"===a)throw Kd("badname","hasOwnProperty is not a valid {0} name",b)}function oa(a,b,c){if(!b)return a;for(var d,e=b.split("."),f=a,g=e.length,h=0;g>h;h++)d=e[h],a&&(a=(f=a)[d]);return!c&&A(a)?T(f,a):a}function pa(a){for(var b,c=a[0],d=a[a.length-1],e=1;c!==d&&(c=c.nextSibling);e++)(b||a[e]!==c)&&(b||(b=Cd(Fd.call(a,0,e))),b.push(c));return b||a}function qa(){return Object.create(null)}function ra(a){function b(a,b,c){return a[b]||(a[b]=c())}var c=d("$injector"),e=d("ng"),f=b(a,"angular",Object);return f.$$minErr=f.$$minErr||d,b(f,"module",function(){var a={};return function(d,f,g){var h=function(a,b){if("hasOwnProperty"===a)throw e("badname","hasOwnProperty is not a valid {0} name",b)};return h(d,"module"),f&&a.hasOwnProperty(d)&&(a[d]=null),b(a,d,function(){function a(a,b,c,d){return d||(d=e),function(){return d[c||"push"]([a,b,arguments]),k}}function b(a,b){return function(c,f){return f&&A(f)&&(f.$$moduleName=d),e.push([a,b,arguments]),k}}if(!f)throw c("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",d);var e=[],h=[],i=[],j=a("$injector","invoke","push",h),k={_invokeQueue:e,_configBlocks:h,_runBlocks:i,requires:f,name:d,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),decorator:b("$provide","decorator"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),
config:j,run:function(a){return i.push(a),this}};return g&&j(g),k})}})}function sa(a){var b=[];return JSON.stringify(a,function(a,c){if(c=U(a,c),v(c)){if(b.indexOf(c)>=0)return"...";b.push(c)}return c})}function ta(a){return"function"==typeof a?a.toString().replace(/ \{[\s\S]*$/,""):t(a)?"undefined":"string"!=typeof a?sa(a):a}function ua(b){l(b,{bootstrap:ga,copy:O,extend:l,merge:m,equals:Q,element:Cd,forEach:f,injector:ab,noop:p,bind:T,toJson:V,fromJson:W,identity:q,isUndefined:t,isDefined:u,isString:x,isFunction:A,isObject:v,isNumber:y,isElement:K,isArray:Od,version:be,isDate:z,lowercase:wd,uppercase:yd,callbacks:{counter:0},getTestability:ia,$$minErr:d,$$csp:Sd,reloadWithDebugInfo:ha}),(Ed=ra(a))("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:sc}),a.provider("$compile",kb).directive({a:rf,input:If,textarea:If,form:wf,script:Ag,select:Dg,style:Fg,option:Eg,ngBind:Lf,ngBindHtml:Nf,ngBindTemplate:Mf,ngClass:Pf,ngClassEven:Rf,ngClassOdd:Qf,ngCloak:Sf,ngController:Tf,ngForm:xf,ngHide:ug,ngIf:Wf,ngInclude:Xf,ngInit:Zf,ngNonBindable:lg,ngPluralize:pg,ngRepeat:qg,ngShow:tg,ngStyle:vg,ngSwitch:wg,ngSwitchWhen:xg,ngSwitchDefault:yg,ngOptions:og,ngTransclude:zg,ngModel:ig,ngList:$f,ngChange:Of,pattern:Hg,ngPattern:Hg,required:Gg,ngRequired:Gg,minlength:Jg,ngMinlength:Jg,maxlength:Ig,ngMaxlength:Ig,ngValue:Kf,ngModelOptions:kg}).directive({ngInclude:Yf}).directive(sf).directive(Uf),a.provider({$anchorScroll:bb,$animate:Fe,$animateCss:Ge,$$animateQueue:Ee,$$AnimateRunner:De,$browser:hb,$cacheFactory:ib,$controller:pb,$document:qb,$exceptionHandler:rb,$filter:Gc,$$forceReflow:Le,$interpolate:Fb,$interval:Gb,$http:Bb,$httpParamSerializer:tb,$httpParamSerializerJQLike:ub,$httpBackend:Db,$xhrFactory:Cb,$location:Ub,$log:Vb,$parse:mc,$rootScope:rc,$q:nc,$$q:oc,$sce:wc,$sceDelegate:vc,$sniffer:xc,$templateCache:jb,$templateRequest:yc,$$testability:zc,$timeout:Ac,$window:Dc,$$rAF:qc,$$jqLite:Xa,$$HashMap:ue,$$cookieReader:Fc})}])}function va(){return++de}function wa(a){return a.replace(ge,function(a,b,c,d){return d?c.toUpperCase():c}).replace(he,"Moz$1")}function xa(a){return!le.test(a)}function ya(a){var b=a.nodeType;return b===Xd||!b||b===_d}function za(a){for(var b in ce[a.ng339])return!0;return!1}function Aa(a,b){var c,d,e,g,h=b.createDocumentFragment(),i=[];if(xa(a))i.push(b.createTextNode(a));else{for(c=c||h.appendChild(b.createElement("div")),d=(me.exec(a)||["",""])[1].toLowerCase(),e=oe[d]||oe._default,c.innerHTML=e[1]+a.replace(ne,"<$1></$2>")+e[2],g=e[0];g--;)c=c.lastChild;i=R(i,c.childNodes),c=h.firstChild,c.textContent=""}return h.textContent="",h.innerHTML="",f(i,function(a){h.appendChild(a)}),h}function Ba(a,c){c=c||b;var d;return(d=ke.exec(a))?[c.createElement(d[1])]:(d=Aa(a,c))?d.childNodes:[]}function Ca(a){if(a instanceof Ca)return a;var b;if(x(a)&&(a=Qd(a),b=!0),!(this instanceof Ca)){if(b&&"<"!=a.charAt(0))throw je("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new Ca(a)}b?Ma(this,Ba(a)):Ma(this,a)}function Da(a){return a.cloneNode(!0)}function Ea(a,b){if(b||Ga(a),a.querySelectorAll)for(var c=a.querySelectorAll("*"),d=0,e=c.length;e>d;d++)Ga(c[d])}function Fa(a,b,c,d){if(u(d))throw je("offargs","jqLite#off() does not support the `selector` argument");var e=Ha(a),g=e&&e.events,h=e&&e.handle;if(h)if(b){var i=function(b){var d=g[b];u(c)&&N(d||[],c),u(c)&&d&&d.length>0||(fe(a,b,h),delete g[b])};f(b.split(" "),function(a){i(a),ie[a]&&i(ie[a])})}else for(b in g)"$destroy"!==b&&fe(a,b,h),delete g[b]}function Ga(a,b){var d=a.ng339,e=d&&ce[d];if(e){if(b)return void delete e.data[b];e.handle&&(e.events.$destroy&&e.handle({},"$destroy"),Fa(a)),delete ce[d],a.ng339=c}}function Ha(a,b){var d=a.ng339,e=d&&ce[d];return b&&!e&&(a.ng339=d=va(),e=ce[d]={events:{},data:{},handle:c}),e}function Ia(a,b,c){if(ya(a)){var d=u(c),e=!d&&b&&!v(b),f=!b,g=Ha(a,!e),h=g&&g.data;if(d)h[b]=c;else{if(f)return h;if(e)return h&&h[b];l(h,b)}}}function Ja(a,b){return a.getAttribute?(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")>-1:!1}function Ka(a,b){b&&a.setAttribute&&f(b.split(" "),function(b){a.setAttribute("class",Qd((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Qd(b)+" "," ")))})}function La(a,b){if(b&&a.setAttribute){var c=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");f(b.split(" "),function(a){a=Qd(a),-1===c.indexOf(" "+a+" ")&&(c+=a+" ")}),a.setAttribute("class",Qd(c))}}function Ma(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var c=b.length;if("number"==typeof c&&b.window!==b){if(c)for(var d=0;c>d;d++)a[a.length++]=b[d]}else a[a.length++]=b}}function Na(a,b){return Oa(a,"$"+(b||"ngController")+"Controller")}function Oa(a,b,c){a.nodeType==_d&&(a=a.documentElement);for(var d=Od(b)?b:[b];a;){for(var e=0,f=d.length;f>e;e++)if(u(c=Cd.data(a,d[e])))return c;a=a.parentNode||a.nodeType===ae&&a.host}}function Pa(a){for(Ea(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function Qa(a,b){b||Ea(a);var c=a.parentNode;c&&c.removeChild(a)}function Ra(b,c){c=c||a,"complete"===c.document.readyState?c.setTimeout(b):Cd(c).on("load",b)}function Sa(a,b){var c=re[b.toLowerCase()];return c&&se[M(a)]&&c}function Ta(a){return te[a]}function Ua(a,b){var c=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var e=b[d||c.type],f=e?e.length:0;if(f){if(t(c.immediatePropagationStopped)){var g=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0,c.stopPropagation&&c.stopPropagation(),g&&g.call(c)}}c.isImmediatePropagationStopped=function(){return c.immediatePropagationStopped===!0};var h=e.specialHandlerWrapper||Va;f>1&&(e=P(e));for(var i=0;f>i;i++)c.isImmediatePropagationStopped()||h(a,c,e[i])}};return c.elem=a,c}function Va(a,b,c){c.call(a,b)}function Wa(a,b,c){var d=b.relatedTarget;(!d||d!==a&&!pe.call(a,d))&&c.call(a,b)}function Xa(){this.$get=function(){return l(Ca,{hasClass:function(a,b){return a.attr&&(a=a[0]),Ja(a,b)},addClass:function(a,b){return a.attr&&(a=a[0]),La(a,b)},removeClass:function(a,b){return a.attr&&(a=a[0]),Ka(a,b)}})}}function Ya(a,b){var c=a&&a.$$hashKey;if(c)return"function"==typeof c&&(c=a.$$hashKey()),c;var d=typeof a;return c="function"==d||"object"==d&&null!==a?a.$$hashKey=d+":"+(b||i)():d+":"+a}function Za(a,b){if(b){var c=0;this.nextUid=function(){return++c}}f(a,this.put,this)}function $a(a){var b=a.toString().replace(ye,""),c=b.match(ve);return c?"function("+(c[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function _a(a,b,c){var d,e,g,h;if("function"==typeof a){if(!(d=a.$inject)){if(d=[],a.length){if(b)throw x(c)&&c||(c=a.name||$a(a)),ze("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",c);e=a.toString().replace(ye,""),g=e.match(ve),f(g[1].split(we),function(a){a.replace(xe,function(a,b,c){d.push(c)})})}a.$inject=d}}else Od(a)?(h=a.length-1,ma(a[h],"fn"),d=a.slice(0,h)):ma(a,"fn",!0);return d}function ab(a,b){function d(a){return function(b,c){return v(b)?void f(b,h(a)):a(b,c)}}function e(a,b){if(na(a,"service"),(A(b)||Od(b))&&(b=y.instantiate(b)),!b.$get)throw ze("pget","Provider '{0}' must define $get factory method.",a);return w[a+q]=b}function g(a,b){return function(){var c=B.invoke(b,this);if(t(c))throw ze("undef","Provider '{0}' must return a value from $get factory method.",a);return c}}function i(a,b,c){return e(a,{$get:c!==!1?g(a,b):b})}function j(a,b){return i(a,["$injector",function(a){return a.instantiate(b)}])}function k(a,b){return i(a,r(b),!1)}function l(a,b){na(a,"constant"),w[a]=b,z[a]=b}function m(a,b){var c=y.get(a+q),d=c.$get;c.$get=function(){var a=B.invoke(d,c);return B.invoke(b,null,{$delegate:a})}}function n(a){la(t(a)||Od(a),"modulesToLoad","not an array");var b,c=[];return f(a,function(a){function d(a){var b,c;for(b=0,c=a.length;c>b;b++){var d=a[b],e=y.get(d[0]);e[d[1]].apply(e,d[2])}}if(!u.get(a)){u.put(a,!0);try{x(a)?(b=Ed(a),c=c.concat(n(b.requires)).concat(b._runBlocks),d(b._invokeQueue),d(b._configBlocks)):A(a)?c.push(y.invoke(a)):Od(a)?c.push(y.invoke(a)):ma(a,"module")}catch(e){throw Od(a)&&(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),ze("modulerr","Failed to instantiate module {0} due to:\n{1}",a,e.stack||e.message||e)}}}),c}function o(a,c){function d(b,d){if(a.hasOwnProperty(b)){if(a[b]===p)throw ze("cdep","Circular dependency found: {0}",b+" <- "+s.join(" <- "));return a[b]}try{return s.unshift(b),a[b]=p,a[b]=c(b,d)}catch(e){throw a[b]===p&&delete a[b],e}finally{s.shift()}}function e(a,c,e,f){"string"==typeof e&&(f=e,e=null);var g,h,i,j=[],k=ab.$$annotate(a,b,f);for(h=0,g=k.length;g>h;h++){if(i=k[h],"string"!=typeof i)throw ze("itkn","Incorrect injection token! Expected service name as string, got {0}",i);j.push(e&&e.hasOwnProperty(i)?e[i]:d(i,f))}return Od(a)&&(a=a[g]),a.apply(c,j)}function f(a,b,c){var d=Object.create((Od(a)?a[a.length-1]:a).prototype||null),f=e(a,d,b,c);return v(f)||A(f)?f:d}return{invoke:e,instantiate:f,get:d,annotate:ab.$$annotate,has:function(b){return w.hasOwnProperty(b+q)||a.hasOwnProperty(b)}}}b=b===!0;var p={},q="Provider",s=[],u=new Za([],!0),w={$provide:{provider:d(e),factory:d(i),service:d(j),value:d(k),constant:d(l),decorator:m}},y=w.$injector=o(w,function(a,b){throw Ld.isString(b)&&s.push(b),ze("unpr","Unknown provider: {0}",s.join(" <- "))}),z={},B=z.$injector=o(z,function(a,b){var d=y.get(a+q,b);return B.invoke(d.$get,d,c,a)});return f(n(a),function(a){a&&B.invoke(a)}),B}function bb(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,c,d){function e(a){var b=null;return Array.prototype.some.call(a,function(a){return"a"===M(a)?(b=a,!0):void 0}),b}function f(){var a=h.yOffset;if(A(a))a=a();else if(K(a)){var c=a[0],d=b.getComputedStyle(c);a="fixed"!==d.position?0:c.getBoundingClientRect().bottom}else y(a)||(a=0);return a}function g(a){if(a){a.scrollIntoView();var c=f();if(c){var d=a.getBoundingClientRect().top;b.scrollBy(0,d-c)}}else b.scrollTo(0,0)}function h(a){a=x(a)?a:c.hash();var b;a?(b=i.getElementById(a))?g(b):(b=e(i.getElementsByName(a)))?g(b):"top"===a&&g(null):g(null)}var i=b.document;return a&&d.$watch(function(){return c.hash()},function(a,b){(a!==b||""!==a)&&Ra(function(){d.$evalAsync(h)})}),h}]}function cb(a,b){return a||b?a?b?(Od(a)&&(a=a.join(" ")),Od(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function db(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.nodeType===Be)return c}}function eb(a){x(a)&&(a=a.split(" "));var b=qa();return f(a,function(a){a.length&&(b[a]=!0)}),b}function fb(a){return v(a)?a:{}}function gb(a,b,c,d){function e(a){try{a.apply(null,S(arguments,1))}finally{if(s--,0===s)for(;u.length;)try{u.pop()()}catch(b){c.error(b)}}}function g(a){var b=a.indexOf("#");return-1===b?"":a.substr(b)}function h(){z=null,j(),k()}function i(){try{return n.state}catch(a){}}function j(){v=i(),v=t(v)?null:v,Q(v,C)&&(v=C),C=v}function k(){(x!==l.url()||w!==v)&&(x=l.url(),w=v,f(A,function(a){a(l.url(),v)}))}var l=this,m=(b[0],a.location),n=a.history,o=a.setTimeout,q=a.clearTimeout,r={};l.isMock=!1;var s=0,u=[];l.$$completeOutstandingRequest=e,l.$$incOutstandingRequestCount=function(){s++},l.notifyWhenNoOutstandingRequests=function(a){0===s?a():u.push(a)};var v,w,x=m.href,y=b.find("base"),z=null;j(),w=v,l.url=function(b,c,e){if(t(e)&&(e=null),m!==a.location&&(m=a.location),n!==a.history&&(n=a.history),b){var f=w===e;if(x===b&&(!d.history||f))return l;var h=x&&Lb(x)===Lb(b);return x=b,w=e,!d.history||h&&f?((!h||z)&&(z=b),c?m.replace(b):h?m.hash=g(b):m.href=b,m.href!==b&&(z=b)):(n[c?"replaceState":"pushState"](e,"",b),j(),w=v),l}return z||m.href.replace(/%27/g,"'")},l.state=function(){return v};var A=[],B=!1,C=null;l.onUrlChange=function(b){return B||(d.history&&Cd(a).on("popstate",h),Cd(a).on("hashchange",h),B=!0),A.push(b),b},l.$$applicationDestroyed=function(){Cd(a).off("hashchange popstate",h)},l.$$checkUrlChange=k,l.baseHref=function(){var a=y.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""},l.defer=function(a,b){var c;return s++,c=o(function(){delete r[c],e(a)},b||0),r[c]=!0,c},l.defer.cancel=function(a){return r[a]?(delete r[a],q(a),e(p),!0):!1}}function hb(){this.$get=["$window","$log","$sniffer","$document",function(a,b,c,d){return new gb(a,d,b,c)}]}function ib(){this.$get=function(){function a(a,c){function e(a){a!=m&&(n?n==a&&(n=a.n):n=a,f(a.n,a.p),f(a,m),m=a,m.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw d("$cacheFactory")("iid","CacheId '{0}' is already taken!",a);var g=0,h=l({},c,{id:a}),i=qa(),j=c&&c.capacity||Number.MAX_VALUE,k=qa(),m=null,n=null;return b[a]={put:function(a,b){if(!t(b)){if(j<Number.MAX_VALUE){var c=k[a]||(k[a]={key:a});e(c)}return a in i||g++,i[a]=b,g>j&&this.remove(n.key),b}},get:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;e(b)}return i[a]},remove:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;b==m&&(m=b.p),b==n&&(n=b.n),f(b.n,b.p),delete k[a]}a in i&&(delete i[a],g--)},removeAll:function(){i=qa(),g=0,k=qa(),m=n=null},destroy:function(){i=null,h=null,k=null,delete b[a]},info:function(){return l({},h,{size:g})}}}var b={};return a.info=function(){var a={};return f(b,function(b,c){a[c]=b.info()}),a},a.get=function(a){return b[a]},a}}function jb(){this.$get=["$cacheFactory",function(a){return a("templates")}]}function kb(a,d){function e(a,b,c){var d=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,e={};return f(a,function(a,f){var g=a.match(d);if(!g)throw He("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",b,f,a,c?"controller bindings definition":"isolate scope definition");e[f]={mode:g[1][0],collection:"*"===g[2],optional:"?"===g[3],attrName:g[4]||f}}),e}function g(a,b){var c={isolateScope:null,bindToController:null};if(v(a.scope)&&(a.bindToController===!0?(c.bindToController=e(a.scope,b,!0),c.isolateScope={}):c.isolateScope=e(a.scope,b,!1)),v(a.bindToController)&&(c.bindToController=e(a.bindToController,b,!0)),v(c.bindToController)){var d=a.controller,f=a.controllerAs;if(!d)throw He("noctrl","Cannot bind to controller without directive '{0}'s controller.",b);if(!ob(d,f))throw He("noident","Cannot bind to controller without identifier for directive '{0}'.",b)}return c}function i(a){var b=a.charAt(0);if(!b||b!==wd(b))throw He("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",a);if(a!==a.trim())throw He("baddir","Directive name '{0}' is invalid. The name should not contain leading or trailing whitespaces",a)}var j={},k="Directive",m=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,n=/(([\w\-]+)(?:\:([^;]+))?;?)/,s=L("ngSrc,ngSrcset,src,srcset"),w=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,y=/^(on[a-z]+|formaction)$/;this.directive=function B(b,c){return na(b,"directive"),x(b)?(i(b),la(c,"directiveFactory"),j.hasOwnProperty(b)||(j[b]=[],a.factory(b+k,["$injector","$exceptionHandler",function(a,c){var d=[];return f(j[b],function(e,f){try{var h=a.invoke(e);A(h)?h={compile:r(h)}:!h.compile&&h.link&&(h.compile=r(h.link)),h.priority=h.priority||0,h.index=f,h.name=h.name||b,h.require=h.require||h.controller&&h.name,h.restrict=h.restrict||"EA";var i=h.$$bindings=g(h,h.name);v(i.isolateScope)&&(h.$$isolateBindings=i.isolateScope),h.$$moduleName=e.$$moduleName,d.push(h)}catch(j){c(j)}}),d}])),j[b].push(c)):f(b,h(B)),this},this.aHrefSanitizationWhitelist=function(a){return u(a)?(d.aHrefSanitizationWhitelist(a),this):d.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(a){return u(a)?(d.imgSrcSanitizationWhitelist(a),this):d.imgSrcSanitizationWhitelist()};var z=!0;this.debugInfoEnabled=function(a){return u(a)?(z=a,this):z},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,d,e,g,h,i,r,u,B,C,E){function F(a,b){try{a.addClass(b)}catch(c){}}function G(a,b,c,d,e){a instanceof Cd||(a=Cd(a)),f(a,function(b,c){b.nodeType==Zd&&b.nodeValue.match(/\S+/)&&(a[c]=Cd(b).wrap("<span></span>").parent()[0])});var g=I(a,b,a,c,d,e);G.$$addScopeClass(a);var h=null;return function(b,c,d){la(b,"scope"),e&&e.needsNewScope&&(b=b.$parent.$new()),d=d||{};var f=d.parentBoundTranscludeFn,i=d.transcludeControllers,j=d.futureParentElement;f&&f.$$boundTransclude&&(f=f.$$boundTransclude),h||(h=H(j));var k;if(k="html"!==h?Cd(_(h,Cd("<div>").append(a).html())):c?qe.clone.call(a):a,i)for(var l in i)k.data("$"+l+"Controller",i[l].instance);return G.$$addScopeInfo(k,b),c&&c(k,b),g&&g(b,k,k,f),k}}function H(a){var b=a&&a[0];return b&&"foreignobject"!==M(b)&&b.toString().match(/SVG/)?"svg":"html"}function I(a,b,d,e,f,g){function h(a,d,e,f){var g,h,i,j,k,l,m,n,q;if(o){var r=d.length;for(q=new Array(r),k=0;k<p.length;k+=3)m=p[k],q[m]=d[m]}else q=d;for(k=0,l=p.length;l>k;)i=q[p[k++]],g=p[k++],h=p[k++],g?(g.scope?(j=a.$new(),G.$$addScopeInfo(Cd(i),j)):j=a,n=g.transcludeOnThisElement?J(a,g.transclude,f):!g.templateOnThisElement&&f?f:!f&&b?J(a,b):null,g(h,j,i,e,n)):h&&h(a,i.childNodes,c,f)}for(var i,j,k,l,m,n,o,p=[],q=0;q<a.length;q++)i=new ga,j=K(a[q],[],i,0===q?e:c,f),k=j.length?P(j,a[q],i,b,d,null,[],[],g):null,k&&k.scope&&G.$$addScopeClass(i.$$element),m=k&&k.terminal||!(l=a[q].childNodes)||!l.length?null:I(l,k?(k.transcludeOnThisElement||!k.templateOnThisElement)&&k.transclude:b),(k||m)&&(p.push(q,k,m),n=!0,o=o||k),g=null;return n?h:null}function J(a,b,c){var d=function(d,e,f,g,h){return d||(d=a.$new(!1,h),d.$$transcluded=!0),b(d,e,{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})};return d}function K(a,b,c,d,e){var f,g,h=a.nodeType,i=c.$attr;switch(h){case Xd:T(b,lb(M(a)),"E",d,e);for(var j,k,l,o,p,q,r=a.attributes,s=0,t=r&&r.length;t>s;s++){var u=!1,w=!1;j=r[s],k=j.name,p=Qd(j.value),o=lb(k),(q=ma.test(o))&&(k=k.replace(Ie,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()}));var y=o.match(na);y&&U(y[1])&&(u=k,w=k.substr(0,k.length-5)+"end",k=k.substr(0,k.length-6)),l=lb(k.toLowerCase()),i[l]=k,(q||!c.hasOwnProperty(l))&&(c[l]=p,Sa(a,l)&&(c[l]=!0)),ba(a,b,p,l,q),T(b,l,"A",d,e,u,w)}if(g=a.className,v(g)&&(g=g.animVal),x(g)&&""!==g)for(;f=n.exec(g);)l=lb(f[2]),T(b,l,"C",d,e)&&(c[l]=Qd(f[3])),g=g.substr(f.index+f[0].length);break;case Zd:if(11===Bd)for(;a.parentNode&&a.nextSibling&&a.nextSibling.nodeType===Zd;)a.nodeValue=a.nodeValue+a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);Z(b,a.nodeValue);break;case $d:try{f=m.exec(a.nodeValue),f&&(l=lb(f[1]),T(b,l,"M",d,e)&&(c[l]=Qd(f[2])))}catch(z){}}return b.sort(X),b}function L(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw He("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",b,c);a.nodeType==Xd&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--),d.push(a),a=a.nextSibling}while(e>0)}else d.push(a);return Cd(d)}function O(a,b,c){return function(d,e,f,g,h){return e=L(e[0],b,c),a(d,e,f,g,h)}}function P(a,d,f,g,h,j,k,l,m){function n(a,b,c,d){a&&(c&&(a=O(a,c,d)),a.require=r.require,a.directiveName=s,(E===r||r.$$isolateScope)&&(a=da(a,{isolateScope:!0})),k.push(a)),b&&(c&&(b=O(b,c,d)),b.require=r.require,b.directiveName=s,(E===r||r.$$isolateScope)&&(b=da(b,{isolateScope:!0})),l.push(b))}function o(a,b,c,d){var e;if(x(b)){var f=b.match(w),g=b.substring(f[0].length),h=f[1]||f[3],i="?"===f[2];if("^^"===h?c=c.parent():(e=d&&d[g],e=e&&e.instance),!e){var j="$"+g+"Controller";e=h?c.inheritedData(j):c.data(j)}if(!e&&!i)throw He("ctreq","Controller '{0}', required by directive '{1}', can't be found!",g,a)}else if(Od(b)){e=[];for(var k=0,l=b.length;l>k;k++)e[k]=o(a,b[k],c,d)}return e||null}function p(a,b,c,d,e,f){var g=qa();for(var h in d){var j=d[h],k={$scope:j===E||j.$$isolateScope?e:f,$element:a,$attrs:b,$transclude:c},l=j.controller;"@"==l&&(l=b[j.name]);var m=i(l,k,!0,j.controllerAs);g[j.name]=m,M||a.data("$"+j.name+"Controller",m.instance)}return g}function q(a,b,e,g,h){function i(a,b,d){var e;return D(a)||(d=b,b=a,a=c),M&&(e=q),d||(d=M?s.parent():s),h(a,b,e,d,H)}var j,m,n,q,r,s,t,u,v;d===e?(t=f,s=f.$$element):(s=Cd(e),t=new ga(s,f)),n=b,E?m=b.$new(!0):B&&(n=b.$parent),h&&(r=i,r.$$boundTransclude=h),C&&(q=p(s,t,r,C,m,b)),E&&(G.$$addScopeInfo(s,m,!0,!(F&&(F===E||F===E.$$originalDirective))),G.$$addScopeClass(s,!0),m.$$isolateBindings=E.$$isolateBindings,u=fa(b,t,m,m.$$isolateBindings,E),u&&m.$on("$destroy",u));for(var w in q){var x=C[w],y=q[w],z=x.$$bindings.bindToController;y.identifier&&z&&(v=fa(n,t,y.instance,z,x));var A=y();A!==y.instance&&(y.instance=A,s.data("$"+x.name+"Controller",A),v&&v(),v=fa(n,t,y.instance,z,x))}for(T=0,U=k.length;U>T;T++)j=k[T],ea(j,j.isolateScope?m:b,s,t,j.require&&o(j.directiveName,j.require,s,q),r);var H=b;for(E&&(E.template||null===E.templateUrl)&&(H=m),a&&a(H,e.childNodes,c,h),T=l.length-1;T>=0;T--)j=l[T],ea(j,j.isolateScope?m:b,s,t,j.require&&o(j.directiveName,j.require,s,q),r)}m=m||{};for(var r,s,t,u,y,z=-Number.MAX_VALUE,B=m.newScopeDirective,C=m.controllerDirectives,E=m.newIsolateScopeDirective,F=m.templateDirective,H=m.nonTlbTranscludeDirective,I=!1,J=!1,M=m.hasElementTranscludeDirective,N=f.$$element=Cd(d),P=j,Q=g,T=0,U=a.length;U>T;T++){r=a[T];var X=r.$$start,Z=r.$$end;if(X&&(N=L(d,X,Z)),t=c,z>r.priority)break;if((y=r.scope)&&(r.templateUrl||(v(y)?(Y("new/isolated scope",E||B,r,N),E=r):Y("new/isolated scope",E,r,N)),B=B||r),s=r.name,!r.templateUrl&&r.controller&&(y=r.controller,C=C||qa(),Y("'"+s+"' controller",C[s],r,N),C[s]=r),(y=r.transclude)&&(I=!0,r.$$tlb||(Y("transclusion",H,r,N),H=r),"element"==y?(M=!0,z=r.priority,t=N,N=f.$$element=Cd(b.createComment(" "+s+": "+f[s]+" ")),d=N[0],ca(h,S(t),d),Q=G(t,g,z,P&&P.name,{nonTlbTranscludeDirective:H})):(t=Cd(Da(d)).contents(),N.empty(),Q=G(t,g,c,c,{needsNewScope:r.$$isolateScope||r.$$newScope}))),r.template)if(J=!0,Y("template",F,r,N),F=r,y=A(r.template)?r.template(N,f):r.template,y=ka(y),r.replace){if(P=r,t=xa(y)?[]:nb(_(r.templateNamespace,Qd(y))),d=t[0],1!=t.length||d.nodeType!==Xd)throw He("tplrt","Template for directive '{0}' must have exactly one root element. {1}",s,"");ca(h,N,d);var aa={$attr:{}},ba=K(d,[],aa),ha=a.splice(T+1,a.length-(T+1));(E||B)&&R(ba,E,B),a=a.concat(ba).concat(ha),V(f,aa),U=a.length}else N.html(y);if(r.templateUrl)J=!0,Y("template",F,r,N),F=r,r.replace&&(P=r),q=W(a.splice(T,a.length-T),N,f,h,I&&Q,k,l,{controllerDirectives:C,newScopeDirective:B!==r&&B,newIsolateScopeDirective:E,templateDirective:F,nonTlbTranscludeDirective:H}),U=a.length;else if(r.compile)try{u=r.compile(N,f,Q),A(u)?n(null,u,X,Z):u&&n(u.pre,u.post,X,Z)}catch(ia){e(ia,$(N))}r.terminal&&(q.terminal=!0,z=Math.max(z,r.priority))}return q.scope=B&&B.scope===!0,q.transcludeOnThisElement=I,q.templateOnThisElement=J,q.transclude=Q,m.hasElementTranscludeDirective=M,q}function R(a,b,c){for(var d=0,e=a.length;e>d;d++)a[d]=o(a[d],{$$isolateScope:b,$$newScope:c})}function T(b,c,d,f,g,h,i){if(c===g)return null;var l=null;if(j.hasOwnProperty(c))for(var m,n=a.get(c+k),p=0,q=n.length;q>p;p++)try{m=n[p],(t(f)||f>m.priority)&&-1!=m.restrict.indexOf(d)&&(h&&(m=o(m,{$$start:h,$$end:i})),b.push(m),l=m)}catch(r){e(r)}return l}function U(b){if(j.hasOwnProperty(b))for(var c,d=a.get(b+k),e=0,f=d.length;f>e;e++)if(c=d[e],c.multiElement)return!0;return!1}function V(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;f(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))}),f(b,function(b,f){"class"==f?(F(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function W(a,b,c,d,e,h,i,j){var k,l,m=[],n=b[0],p=a.shift(),q=o(p,{templateUrl:null,transclude:null,replace:null,$$originalDirective:p}),r=A(p.templateUrl)?p.templateUrl(b,c):p.templateUrl,s=p.templateNamespace;return b.empty(),g(r).then(function(g){var o,t,u,w;if(g=ka(g),p.replace){if(u=xa(g)?[]:nb(_(s,Qd(g))),o=u[0],1!=u.length||o.nodeType!==Xd)throw He("tplrt","Template for directive '{0}' must have exactly one root element. {1}",p.name,r);t={$attr:{}},ca(d,b,o);var x=K(o,[],t);v(p.scope)&&R(x,!0),a=x.concat(a),V(c,t)}else o=n,b.html(g);for(a.unshift(q),k=P(a,o,c,e,b,p,h,i,j),f(d,function(a,c){a==o&&(d[c]=b[0])}),l=I(b[0].childNodes,e);m.length;){var y=m.shift(),z=m.shift(),A=m.shift(),B=m.shift(),C=b[0];if(!y.$$destroyed){if(z!==n){var D=z.className;j.hasElementTranscludeDirective&&p.replace||(C=Da(o)),ca(A,Cd(z),C),F(Cd(C),D)}w=k.transcludeOnThisElement?J(y,k.transclude,B):B,k(l,y,C,d,w)}}m=null}),function(a,b,c,d,e){var f=e;b.$$destroyed||(m?m.push(b,c,d,f):(k.transcludeOnThisElement&&(f=J(b,k.transclude,e)),k(l,b,c,d,f)))}}function X(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Y(a,b,c,d){function e(a){return a?" (module: "+a+")":""}if(b)throw He("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",b.name,e(b.$$moduleName),c.name,e(c.$$moduleName),a,$(d))}function Z(a,b){var c=d(b,!0);c&&a.push({priority:0,compile:function(a){var b=a.parent(),d=!!b.length;return d&&G.$$addBindingClass(b),function(a,b){var e=b.parent();d||G.$$addBindingClass(e),G.$$addBindingInfo(e,c.expressions),a.$watch(c,function(a){b[0].nodeValue=a})}}})}function _(a,c){switch(a=wd(a||"html")){case"svg":case"math":var d=b.createElement("div");return d.innerHTML="<"+a+">"+c+"</"+a+">",d.childNodes[0].childNodes;default:return c}}function aa(a,b){if("srcdoc"==b)return B.HTML;var c=M(a);return"xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b)?B.RESOURCE_URL:void 0}function ba(a,b,c,e,f){var g=aa(a,e);f=s[e]||f;var h=d(c,!0,g,f);if(h){if("multiple"===e&&"select"===M(a))throw He("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",$(a));b.push({priority:100,compile:function(){return{pre:function(a,b,i){var j=i.$$observers||(i.$$observers=qa());if(y.test(e))throw He("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var k=i[e];k!==c&&(h=k&&d(k,!0,g,f),c=k),h&&(i[e]=h(a),(j[e]||(j[e]=[])).$$inter=!0,(i.$$observers&&i.$$observers[e].$$scope||a).$watch(h,function(a,b){"class"===e&&a!=b?i.$updateClass(a,b):i.$set(e,a)}))}}}})}}function ca(a,c,d){var e,f,g=c[0],h=c.length,i=g.parentNode;if(a)for(e=0,f=a.length;f>e;e++)if(a[e]==g){a[e++]=d;for(var j=e,k=j+h-1,l=a.length;l>j;j++,k++)l>k?a[j]=a[k]:delete a[j];a.length-=h-1,a.context===g&&(a.context=d);break}i&&i.replaceChild(d,g);var m=b.createDocumentFragment();m.appendChild(g),Cd.hasData(g)&&(Cd.data(d,Cd.data(g)),Dd?(Nd=!0,Dd.cleanData([g])):delete Cd.cache[g[Cd.expando]]);for(var n=1,o=c.length;o>n;n++){var p=c[n];Cd(p).remove(),m.appendChild(p),delete c[n]}c[0]=d,c.length=1}function da(a,b){return l(function(){return a.apply(null,arguments)},a,b)}function ea(a,b,c,d,f,g){try{a(b,c,d,f,g)}catch(h){e(h,$(c))}}function fa(a,b,c,e,g){var i=[];return f(e,function(e,f){var j,k,l,m,n=e.attrName,o=e.optional,q=e.mode;switch(q){case"@":o||xd.call(b,n)||(c[f]=b[n]=void 0),b.$observe(n,function(a){x(a)&&(c[f]=a)}),b.$$observers[n].$$scope=a,x(b[n])&&(c[f]=d(b[n])(a));break;case"=":if(!xd.call(b,n)){if(o)break;b[n]=void 0}if(o&&!b[n])break;k=h(b[n]),m=k.literal?Q:function(a,b){return a===b||a!==a&&b!==b},l=k.assign||function(){throw j=c[f]=k(a),He("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",b[n],g.name)},j=c[f]=k(a);var r=function(b){return m(b,c[f])||(m(b,j)?l(a,b=c[f]):c[f]=b),j=b};r.$stateful=!0;var s;s=e.collection?a.$watchCollection(b[n],r):a.$watch(h(b[n],r),null,k.literal),i.push(s);break;case"&":if(k=b.hasOwnProperty(n)?h(b[n]):p,k===p&&o)break;c[f]=function(b){return k(a,b)}}}),i.length&&function(){for(var a=0,b=i.length;b>a;++a)i[a]()}}var ga=function(a,b){if(b){var c,d,e,f=Object.keys(b);for(c=0,d=f.length;d>c;c++)e=f[c],this[e]=b[e]}else this.$attr={};this.$$element=a};ga.prototype={$normalize:lb,$addClass:function(a){a&&a.length>0&&C.addClass(this.$$element,a)},$removeClass:function(a){a&&a.length>0&&C.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=mb(a,b);c&&c.length&&C.addClass(this.$$element,c);var d=mb(b,a);d&&d.length&&C.removeClass(this.$$element,d)},$set:function(a,b,c,d){var g,h=this.$$element[0],i=Sa(h,a),j=Ta(a),k=a;if(i?(this.$$element.prop(a,b),d=i):j&&(this[j]=b,k=j),this[a]=b,d?this.$attr[a]=d:(d=this.$attr[a],d||(this.$attr[a]=d=ja(a,"-"))),g=M(this.$$element),"a"===g&&"href"===a||"img"===g&&"src"===a)this[a]=b=E(b,"src"===a);else if("img"===g&&"srcset"===a){for(var l="",m=Qd(b),n=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,o=/\s/.test(m)?n:/(,)/,p=m.split(o),q=Math.floor(p.length/2),r=0;q>r;r++){var s=2*r;l+=E(Qd(p[s]),!0),l+=" "+Qd(p[s+1])}var u=Qd(p[2*r]).split(/\s/);l+=E(Qd(u[0]),!0),2===u.length&&(l+=" "+Qd(u[1])),this[a]=b=l}c!==!1&&(null===b||t(b)?this.$$element.removeAttr(d):this.$$element.attr(d,b));var v=this.$$observers;v&&f(v[k],function(a){try{a(b)}catch(c){e(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=qa()),e=d[a]||(d[a]=[]);return e.push(b),r.$evalAsync(function(){e.$$inter||!c.hasOwnProperty(a)||t(c[a])||b(c[a])}),function(){N(e,b)}}};var ha=d.startSymbol(),ia=d.endSymbol(),ka="{{"==ha||"}}"==ia?q:function(a){return a.replace(/\{\{/g,ha).replace(/}}/g,ia)},ma=/^ngAttr[A-Z]/,na=/^(.+)Start$/;return G.$$addBindingInfo=z?function(a,b){var c=a.data("$binding")||[];Od(b)?c=c.concat(b):c.push(b),a.data("$binding",c)}:p,G.$$addBindingClass=z?function(a){F(a,"ng-binding")}:p,G.$$addScopeInfo=z?function(a,b,c,d){var e=c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope";a.data(e,b)}:p,G.$$addScopeClass=z?function(a,b){F(a,b?"ng-isolate-scope":"ng-scope")}:p,G}]}function lb(a){return wa(a.replace(Ie,""))}function mb(a,b){var c="",d=a.split(/\s+/),e=b.split(/\s+/);a:for(var f=0;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;c+=(c.length>0?" ":"")+g}return c}function nb(a){a=Cd(a);var b=a.length;if(1>=b)return a;for(;b--;){var c=a[b];c.nodeType===$d&&Gd.call(a,b,1)}return a}function ob(a,b){if(b&&x(b))return b;if(x(a)){var c=Ke.exec(a);if(c)return c[3]}}function pb(){var a={},b=!1;this.register=function(b,c){na(b,"controller"),v(b)?l(a,b):a[b]=c},this.allowGlobals=function(){b=!0},this.$get=["$injector","$window",function(e,f){function g(a,b,c,e){if(!a||!v(a.$scope))throw d("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",e,b);a.$scope[b]=c}return function(d,h,i,j){var k,m,n,o;if(i=i===!0,j&&x(j)&&(o=j),x(d)){if(m=d.match(Ke),!m)throw Je("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",d);n=m[1],o=o||m[3],d=a.hasOwnProperty(n)?a[n]:oa(h.$scope,n,!0)||(b?oa(f,n,!0):c),ma(d,n,!0)}if(i){var p=(Od(d)?d[d.length-1]:d).prototype;k=Object.create(p||null),o&&g(h,o,k,n||d.name);var q;return q=l(function(){var a=e.invoke(d,k,h,n);return a!==k&&(v(a)||A(a))&&(k=a,o&&g(h,o,k,n||d.name)),k},{instance:k,identifier:o})}return k=e.instantiate(d,h,n),o&&g(h,o,k,n||d.name),k}}]}function qb(){this.$get=["$window",function(a){return Cd(a.document)}]}function rb(){this.$get=["$log",function(a){return function(b,c){a.error.apply(a,arguments)}}]}function sb(a){return v(a)?z(a)?a.toISOString():V(a):a}function tb(){this.$get=function(){return function(a){if(!a)return"";var b=[];return g(a,function(a,c){null===a||t(a)||(Od(a)?f(a,function(a,d){b.push(da(c)+"="+da(sb(a)))}):b.push(da(c)+"="+da(sb(a))))}),b.join("&")}}}function ub(){this.$get=function(){return function(a){function b(a,d,e){null===a||t(a)||(Od(a)?f(a,function(a,c){b(a,d+"["+(v(a)?c:"")+"]")}):v(a)&&!z(a)?g(a,function(a,c){b(a,d+(e?"":"[")+c+(e?"":"]"))}):c.push(da(d)+"="+da(sb(a))))}if(!a)return"";var c=[];return b(a,"",!0),c.join("&")}}}function vb(a,b){if(x(a)){var c=a.replace(Qe,"").trim();if(c){var d=b("Content-Type");(d&&0===d.indexOf(Me)||wb(c))&&(a=W(c))}}return a}function wb(a){var b=a.match(Oe);return b&&Pe[b[0]].test(a);
}function xb(a){function b(a,b){a&&(d[a]=d[a]?d[a]+", "+b:b)}var c,d=qa();return x(a)?f(a.split("\n"),function(a){c=a.indexOf(":"),b(wd(Qd(a.substr(0,c))),Qd(a.substr(c+1)))}):v(a)&&f(a,function(a,c){b(wd(c),Qd(a))}),d}function yb(a){var b;return function(c){if(b||(b=xb(a)),c){var d=b[wd(c)];return void 0===d&&(d=null),d}return b}}function zb(a,b,c,d){return A(d)?d(a,b,c):(f(d,function(d){a=d(a,b,c)}),a)}function Ab(a){return a>=200&&300>a}function Bb(){var a=this.defaults={transformResponse:[vb],transformRequest:[function(a){return!v(a)||E(a)||G(a)||F(a)?a:V(a)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:P(Ne),put:P(Ne),patch:P(Ne)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},b=!1;this.useApplyAsync=function(a){return u(a)?(b=!!a,this):b};var e=!0;this.useLegacyPromiseExtensions=function(a){return u(a)?(e=!!a,this):e};var g=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(h,i,j,k,m,n){function o(b){function g(a){var b=l({},a);return b.data=zb(a.data,a.headers,a.status,j.transformResponse),Ab(a.status)?b:m.reject(b)}function h(a,b){var c,d={};return f(a,function(a,e){A(a)?(c=a(b),null!=c&&(d[e]=c)):d[e]=a}),d}function i(b){var c,d,e,f=a.headers,g=l({},b.headers);f=l({},f.common,f[wd(b.method)]);a:for(c in f){d=wd(c);for(e in g)if(wd(e)===d)continue a;g[c]=f[c]}return h(g,P(b))}if(!Ld.isObject(b))throw d("$http")("badreq","Http request configuration must be an object.  Received: {0}",b);var j=l({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse,paramSerializer:a.paramSerializer},b);j.headers=i(b),j.method=yd(j.method),j.paramSerializer=x(j.paramSerializer)?n.get(j.paramSerializer):j.paramSerializer;var k=function(b){var d=b.headers,e=zb(b.data,yb(d),c,b.transformRequest);return t(e)&&f(d,function(a,b){"content-type"===wd(b)&&delete d[b]}),t(b.withCredentials)&&!t(a.withCredentials)&&(b.withCredentials=a.withCredentials),r(b,e).then(g,g)},o=[k,c],p=m.when(j);for(f(y,function(a){(a.request||a.requestError)&&o.unshift(a.request,a.requestError),(a.response||a.responseError)&&o.push(a.response,a.responseError)});o.length;){var q=o.shift(),s=o.shift();p=p.then(q,s)}return e?(p.success=function(a){return ma(a,"fn"),p.then(function(b){a(b.data,b.status,b.headers,j)}),p},p.error=function(a){return ma(a,"fn"),p.then(null,function(b){a(b.data,b.status,b.headers,j)}),p}):(p.success=Se("success"),p.error=Se("error")),p}function p(a){f(arguments,function(a){o[a]=function(b,c){return o(l({},c||{},{method:a,url:b}))}})}function q(a){f(arguments,function(a){o[a]=function(b,c,d){return o(l({},d||{},{method:a,url:b,data:c}))}})}function r(d,e){function f(a,c,d,e){function f(){g(c,a,d,e)}n&&(Ab(a)?n.put(y,[a,c,xb(d),e]):n.remove(y)),b?k.$applyAsync(f):(f(),k.$$phase||k.$apply())}function g(a,b,c,e){b=b>=-1?b:0,(Ab(b)?q.resolve:q.reject)({data:a,status:b,headers:yb(c),config:d,statusText:e})}function j(a){g(a.data,a.status,P(a.headers()),a.statusText)}function l(){var a=o.pendingRequests.indexOf(d);-1!==a&&o.pendingRequests.splice(a,1)}var n,p,q=m.defer(),r=q.promise,x=d.headers,y=s(d.url,d.paramSerializer(d.params));if(o.pendingRequests.push(d),r.then(l,l),!d.cache&&!a.cache||d.cache===!1||"GET"!==d.method&&"JSONP"!==d.method||(n=v(d.cache)?d.cache:v(a.cache)?a.cache:w),n&&(p=n.get(y),u(p)?I(p)?p.then(j,j):Od(p)?g(p[1],p[0],P(p[2]),p[3]):g(p,200,{},"OK"):n.put(y,r)),t(p)){var z=Cc(d.url)?i()[d.xsrfCookieName||a.xsrfCookieName]:c;z&&(x[d.xsrfHeaderName||a.xsrfHeaderName]=z),h(d.method,y,e,f,x,d.timeout,d.withCredentials,d.responseType)}return r}function s(a,b){return b.length>0&&(a+=(-1==a.indexOf("?")?"?":"&")+b),a}var w=j("$http");a.paramSerializer=x(a.paramSerializer)?n.get(a.paramSerializer):a.paramSerializer;var y=[];return f(g,function(a){y.unshift(x(a)?n.get(a):n.invoke(a))}),o.pendingRequests=[],p("get","delete","head","jsonp"),q("post","put","patch"),o.defaults=a,o}]}function Cb(){this.$get=function(){return function(){return new a.XMLHttpRequest}}}function Db(){this.$get=["$browser","$window","$document","$xhrFactory",function(a,b,c,d){return Eb(a,d,a.defer,b.angular.callbacks,c[0])}]}function Eb(a,b,c,d,e){function g(a,b,c){var f=e.createElement("script"),g=null;return f.type="text/javascript",f.src=a,f.async=!0,g=function(a){fe(f,"load",g),fe(f,"error",g),e.body.removeChild(f),f=null;var h=-1,i="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),i=a.type,h="error"===a.type?404:200),c&&c(h,i)},ee(f,"load",g),ee(f,"error",g),e.body.appendChild(f),g}return function(e,h,i,j,k,l,m,n){function o(){s&&s(),v&&v.abort()}function q(b,d,e,f,g){u(y)&&c.cancel(y),s=v=null,b(d,e,f,g),a.$$completeOutstandingRequest(p)}if(a.$$incOutstandingRequestCount(),h=h||a.url(),"jsonp"==wd(e)){var r="_"+(d.counter++).toString(36);d[r]=function(a){d[r].data=a,d[r].called=!0};var s=g(h.replace("JSON_CALLBACK","angular.callbacks."+r),r,function(a,b){q(j,a,d[r].data,"",b),d[r]=p})}else{var v=b(e,h);v.open(e,h,!0),f(k,function(a,b){u(a)&&v.setRequestHeader(b,a)}),v.onload=function(){var a=v.statusText||"",b="response"in v?v.response:v.responseText,c=1223===v.status?204:v.status;0===c&&(c=b?200:"file"==Bc(h).protocol?404:0),q(j,c,b,v.getAllResponseHeaders(),a)};var w=function(){q(j,-1,null,null,"")};if(v.onerror=w,v.onabort=w,m&&(v.withCredentials=!0),n)try{v.responseType=n}catch(x){if("json"!==n)throw x}v.send(t(i)?null:i)}if(l>0)var y=c(o,l);else I(l)&&l.then(o)}}function Fb(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a},this.endSymbol=function(a){return a?(b=a,this):b},this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function f(a){return"\\\\\\"+a}function g(c){return c.replace(m,a).replace(n,b)}function h(a){if(null==a)return"";switch(typeof a){case"string":break;case"number":a=""+a;break;default:a=V(a)}return a}function i(f,i,m,n){function o(a){try{return a=C(a),n&&!u(a)?a:h(a)}catch(b){d(Te.interr(f,b))}}n=!!n;for(var p,q,r,s=0,v=[],w=[],x=f.length,y=[],z=[];x>s;){if(-1==(p=f.indexOf(a,s))||-1==(q=f.indexOf(b,p+j))){s!==x&&y.push(g(f.substring(s)));break}s!==p&&y.push(g(f.substring(s,p))),r=f.substring(p+j,q),v.push(r),w.push(c(r,o)),s=q+k,z.push(y.length),y.push("")}if(m&&y.length>1&&Te.throwNoconcat(f),!i||v.length){var B=function(a){for(var b=0,c=v.length;c>b;b++){if(n&&t(a[b]))return;y[z[b]]=a[b]}return y.join("")},C=function(a){return m?e.getTrusted(m,a):e.valueOf(a)};return l(function(a){var b=0,c=v.length,e=new Array(c);try{for(;c>b;b++)e[b]=w[b](a);return B(e)}catch(g){d(Te.interr(f,g))}},{exp:f,expressions:v,$$watchDelegate:function(a,b){var c;return a.$watchGroup(w,function(d,e){var f=B(d);A(b)&&b.call(this,f,d!==e?c:f,a),c=f})}})}}var j=a.length,k=b.length,m=new RegExp(a.replace(/./g,f),"g"),n=new RegExp(b.replace(/./g,f),"g");return i.startSymbol=function(){return a},i.endSymbol=function(){return b},i}]}function Gb(){this.$get=["$rootScope","$window","$q","$$q",function(a,b,c,d){function e(e,g,h,i){var j=arguments.length>4,k=j?S(arguments,4):[],l=b.setInterval,m=b.clearInterval,n=0,o=u(i)&&!i,p=(o?d:c).defer(),q=p.promise;return h=u(h)?h:0,q.then(null,null,j?function(){e.apply(null,k)}:e),q.$$intervalId=l(function(){p.notify(n++),h>0&&n>=h&&(p.resolve(n),m(q.$$intervalId),delete f[q.$$intervalId]),o||a.$apply()},g),f[q.$$intervalId]=p,q}var f={};return e.cancel=function(a){return a&&a.$$intervalId in f?(f[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete f[a.$$intervalId],!0):!1},e}]}function Hb(a){for(var b=a.split("/"),c=b.length;c--;)b[c]=ca(b[c]);return b.join("/")}function Ib(a,b){var c=Bc(a);b.$$protocol=c.protocol,b.$$host=c.hostname,b.$$port=n(c.port)||Ve[c.protocol]||null}function Jb(a,b){var c="/"!==a.charAt(0);c&&(a="/"+a);var d=Bc(a);b.$$path=decodeURIComponent(c&&"/"===d.pathname.charAt(0)?d.pathname.substring(1):d.pathname),b.$$search=aa(d.search),b.$$hash=decodeURIComponent(d.hash),b.$$path&&"/"!=b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function Kb(a,b){return 0===b.indexOf(a)?b.substr(a.length):void 0}function Lb(a){var b=a.indexOf("#");return-1==b?a:a.substr(0,b)}function Mb(a){return a.replace(/(#.+)|#$/,"$1")}function Nb(a){return a.substr(0,Lb(a).lastIndexOf("/")+1)}function Ob(a){return a.substring(0,a.indexOf("/",a.indexOf("//")+2))}function Pb(a,b,c){this.$$html5=!0,c=c||"",Ib(a,this),this.$$parse=function(a){var c=Kb(b,a);if(!x(c))throw We("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',a,b);Jb(c,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var a=ba(this.$$search),c=this.$$hash?"#"+ca(this.$$hash):"";this.$$url=Hb(this.$$path)+(a?"?"+a:"")+c,this.$$absUrl=b+this.$$url.substr(1)},this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g,h;return u(f=Kb(a,d))?(g=f,h=u(f=Kb(c,f))?b+(Kb("/",f)||f):a+g):u(f=Kb(b,d))?h=b+f:b==d+"/"&&(h=b),h&&this.$$parse(h),!!h}}function Qb(a,b,c){Ib(a,this),this.$$parse=function(d){function e(a,b,c){var d,e=/^\/[A-Z]:(\/.*)/;return 0===b.indexOf(c)&&(b=b.replace(c,"")),e.exec(b)?a:(d=e.exec(a),d?d[1]:a)}var f,g=Kb(a,d)||Kb(b,d);t(g)||"#"!==g.charAt(0)?this.$$html5?f=g:(f="",t(g)&&(a=d,this.replace())):(f=Kb(c,g),t(f)&&(f=g)),Jb(f,this),this.$$path=e(this.$$path,f,a),this.$$compose()},this.$$compose=function(){var b=ba(this.$$search),d=this.$$hash?"#"+ca(this.$$hash):"";this.$$url=Hb(this.$$path)+(b?"?"+b:"")+d,this.$$absUrl=a+(this.$$url?c+this.$$url:"")},this.$$parseLinkUrl=function(b,c){return Lb(a)==Lb(b)?(this.$$parse(b),!0):!1}}function Rb(a,b,c){this.$$html5=!0,Qb.apply(this,arguments),this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;return a==Lb(d)?f=d:(g=Kb(b,d))?f=a+c+g:b===d+"/"&&(f=b),f&&this.$$parse(f),!!f},this.$$compose=function(){var b=ba(this.$$search),d=this.$$hash?"#"+ca(this.$$hash):"";this.$$url=Hb(this.$$path)+(b?"?"+b:"")+d,this.$$absUrl=a+c+this.$$url}}function Sb(a){return function(){return this[a]}}function Tb(a,b){return function(c){return t(c)?this[a]:(this[a]=b(c),this.$$compose(),this)}}function Ub(){var a="",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return u(b)?(a=b,this):a},this.html5Mode=function(a){return H(a)?(b.enabled=a,this):v(a)?(H(a.enabled)&&(b.enabled=a.enabled),H(a.requireBase)&&(b.requireBase=a.requireBase),H(a.rewriteLinks)&&(b.rewriteLinks=a.rewriteLinks),this):b},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(c,d,e,f,g){function h(a,b,c){var e=j.url(),f=j.$$state;try{d.url(a,b,c),j.$$state=d.state()}catch(g){throw j.url(e),j.$$state=f,g}}function i(a,b){c.$broadcast("$locationChangeSuccess",j.absUrl(),a,j.$$state,b)}var j,k,l,m=d.baseHref(),n=d.url();if(b.enabled){if(!m&&b.requireBase)throw We("nobase","$location in HTML5 mode requires a <base> tag to be present!");l=Ob(n)+(m||"/"),k=e.history?Pb:Rb}else l=Lb(n),k=Qb;var o=Nb(l);j=new k(l,o,"#"+a),j.$$parseLinkUrl(n,n),j.$$state=d.state();var p=/^\s*(javascript|mailto):/i;f.on("click",function(a){if(b.rewriteLinks&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!=a.which&&2!=a.button){for(var e=Cd(a.target);"a"!==M(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),i=e.attr("href")||e.attr("xlink:href");v(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=Bc(h.animVal).href),p.test(h)||!h||e.attr("target")||a.isDefaultPrevented()||j.$$parseLinkUrl(h,i)&&(a.preventDefault(),j.absUrl()!=d.url()&&(c.$apply(),g.angular["ff-684208-preventDefault"]=!0))}}),Mb(j.absUrl())!=Mb(n)&&d.url(j.absUrl(),!0);var q=!0;return d.onUrlChange(function(a,b){return t(Kb(o,a))?void(g.location.href=a):(c.$evalAsync(function(){var d,e=j.absUrl(),f=j.$$state;a=Mb(a),j.$$parse(a),j.$$state=b,d=c.$broadcast("$locationChangeStart",a,e,b,f).defaultPrevented,j.absUrl()===a&&(d?(j.$$parse(e),j.$$state=f,h(e,!1,f)):(q=!1,i(e,f)))}),void(c.$$phase||c.$digest()))}),c.$watch(function(){var a=Mb(d.url()),b=Mb(j.absUrl()),f=d.state(),g=j.$$replace,k=a!==b||j.$$html5&&e.history&&f!==j.$$state;(q||k)&&(q=!1,c.$evalAsync(function(){var b=j.absUrl(),d=c.$broadcast("$locationChangeStart",b,a,j.$$state,f).defaultPrevented;j.absUrl()===b&&(d?(j.$$parse(a),j.$$state=f):(k&&h(b,g,f===j.$$state?null:j.$$state),i(a,f)))})),j.$$replace=!1}),j}]}function Vb(){var a=!0,b=this;this.debugEnabled=function(b){return u(b)?(a=b,this):a},this.$get=["$window",function(c){function d(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function e(a){var b=c.console||{},e=b[a]||b.log||p,g=!1;try{g=!!e.apply}catch(h){}return g?function(){var a=[];return f(arguments,function(b){a.push(d(b))}),e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Wb(a,b){if("__defineGetter__"===a||"__defineSetter__"===a||"__lookupGetter__"===a||"__lookupSetter__"===a||"__proto__"===a)throw Ye("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",b);return a}function Xb(a,b){if(a+="",!x(a))throw Ye("iseccst","Cannot convert object to primitive value! Expression: {0}",b);return a}function Yb(a,b){if(a){if(a.constructor===a)throw Ye("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a.window===a)throw Ye("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",b);if(a.children&&(a.nodeName||a.prop&&a.attr&&a.find))throw Ye("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",b);if(a===Object)throw Ye("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",b)}return a}function Zb(a,b){if(a){if(a.constructor===a)throw Ye("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a===Ze||a===$e||a===_e)throw Ye("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",b)}}function $b(a,b){if(a&&(a===0..constructor||a===(!1).constructor||a==="".constructor||a==={}.constructor||a===[].constructor||a===Function.constructor))throw Ye("isecaf","Assigning to a constructor is disallowed! Expression: {0}",b)}function _b(a,b){return"undefined"!=typeof a?a:b}function ac(a,b){return"undefined"==typeof a?b:"undefined"==typeof b?a:a+b}function bc(a,b){var c=a(b);return!c.$stateful}function cc(a,b){var c,d;switch(a.type){case df.Program:c=!0,f(a.body,function(a){cc(a.expression,b),c=c&&a.expression.constant}),a.constant=c;break;case df.Literal:a.constant=!0,a.toWatch=[];break;case df.UnaryExpression:cc(a.argument,b),a.constant=a.argument.constant,a.toWatch=a.argument.toWatch;break;case df.BinaryExpression:cc(a.left,b),cc(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=a.left.toWatch.concat(a.right.toWatch);break;case df.LogicalExpression:cc(a.left,b),cc(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=a.constant?[]:[a];break;case df.ConditionalExpression:cc(a.test,b),cc(a.alternate,b),cc(a.consequent,b),a.constant=a.test.constant&&a.alternate.constant&&a.consequent.constant,a.toWatch=a.constant?[]:[a];break;case df.Identifier:a.constant=!1,a.toWatch=[a];break;case df.MemberExpression:cc(a.object,b),a.computed&&cc(a.property,b),a.constant=a.object.constant&&(!a.computed||a.property.constant),a.toWatch=[a];break;case df.CallExpression:c=a.filter?bc(b,a.callee.name):!1,d=[],f(a.arguments,function(a){cc(a,b),c=c&&a.constant,a.constant||d.push.apply(d,a.toWatch)}),a.constant=c,a.toWatch=a.filter&&bc(b,a.callee.name)?d:[a];break;case df.AssignmentExpression:cc(a.left,b),cc(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=[a];break;case df.ArrayExpression:c=!0,d=[],f(a.elements,function(a){cc(a,b),c=c&&a.constant,a.constant||d.push.apply(d,a.toWatch)}),a.constant=c,a.toWatch=d;break;case df.ObjectExpression:c=!0,d=[],f(a.properties,function(a){cc(a.value,b),c=c&&a.value.constant,a.value.constant||d.push.apply(d,a.value.toWatch)}),a.constant=c,a.toWatch=d;break;case df.ThisExpression:a.constant=!1,a.toWatch=[]}}function dc(a){if(1==a.length){var b=a[0].expression,d=b.toWatch;return 1!==d.length?d:d[0]!==b?d:c}}function ec(a){return a.type===df.Identifier||a.type===df.MemberExpression}function fc(a){return 1===a.body.length&&ec(a.body[0].expression)?{type:df.AssignmentExpression,left:a.body[0].expression,right:{type:df.NGValueParameter},operator:"="}:void 0}function gc(a){return 0===a.body.length||1===a.body.length&&(a.body[0].expression.type===df.Literal||a.body[0].expression.type===df.ArrayExpression||a.body[0].expression.type===df.ObjectExpression)}function hc(a){return a.constant}function ic(a,b){this.astBuilder=a,this.$filter=b}function jc(a,b){this.astBuilder=a,this.$filter=b}function kc(a){return"constructor"==a}function lc(a){return A(a.valueOf)?a.valueOf():ff.call(a)}function mc(){var a=qa(),b=qa();this.$get=["$filter",function(d){function e(a,b){return null==a||null==b?a===b:"object"==typeof a&&(a=lc(a),"object"==typeof a)?!1:a===b||a!==a&&b!==b}function g(a,b,d,f,g){var h,i=f.inputs;if(1===i.length){var j=e;return i=i[0],a.$watch(function(a){var b=i(a);return e(b,j)||(h=f(a,c,c,[b]),j=b&&lc(b)),h},b,d,g)}for(var k=[],l=[],m=0,n=i.length;n>m;m++)k[m]=e,l[m]=null;return a.$watch(function(a){for(var b=!1,d=0,g=i.length;g>d;d++){var j=i[d](a);(b||(b=!e(j,k[d])))&&(l[d]=j,k[d]=j&&lc(j))}return b&&(h=f(a,c,c,l)),h},b,d,g)}function h(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,c,d){f=a,A(b)&&b.apply(this,arguments),u(a)&&d.$$postDigest(function(){u(f)&&e()})},c)}function i(a,b,c,d){function e(a){var b=!0;return f(a,function(a){u(a)||(b=!1)}),b}var g,h;return g=a.$watch(function(a){return d(a)},function(a,c,d){h=a,A(b)&&b.call(this,a,c,d),e(a)&&d.$$postDigest(function(){e(h)&&g()})},c)}function j(a,b,c,d){var e;return e=a.$watch(function(a){return d(a)},function(a,c,d){A(b)&&b.apply(this,arguments),e()},c)}function k(a,b){if(!b)return a;var c=a.$$watchDelegate,d=!1,e=c!==i&&c!==h,f=e?function(c,e,f,g){var h=d&&g?g[0]:a(c,e,f,g);return b(h,c,e)}:function(c,d,e,f){var g=a(c,d,e,f),h=b(g,c,d);return u(g)?h:g};return a.$$watchDelegate&&a.$$watchDelegate!==g?f.$$watchDelegate=a.$$watchDelegate:b.$stateful||(f.$$watchDelegate=g,d=!a.inputs,f.inputs=a.inputs?a.inputs:[a]),f}var l=Sd().noUnsafeEval,m={csp:l,expensiveChecks:!1},n={csp:l,expensiveChecks:!0};return function(c,e,f){var l,o,q;switch(typeof c){case"string":c=c.trim(),q=c;var r=f?b:a;if(l=r[q],!l){":"===c.charAt(0)&&":"===c.charAt(1)&&(o=!0,c=c.substring(2));var s=f?n:m,t=new cf(s),u=new ef(t,d,s);l=u.parse(c),l.constant?l.$$watchDelegate=j:o?l.$$watchDelegate=l.literal?i:h:l.inputs&&(l.$$watchDelegate=g),r[q]=l}return k(l,e);case"function":return k(c,e);default:return p}}}]}function nc(){this.$get=["$rootScope","$exceptionHandler",function(a,b){return pc(function(b){a.$evalAsync(b)},b)}]}function oc(){this.$get=["$browser","$exceptionHandler",function(a,b){return pc(function(b){a.defer(b)},b)}]}function pc(a,b){function e(a,b,c){function d(b){return function(c){e||(e=!0,b.call(a,c))}}var e=!1;return[d(b),d(c)]}function g(){this.$$state={status:0}}function h(a,b){return function(c){b.call(a,c)}}function i(a){var d,e,f;f=a.pending,a.processScheduled=!1,a.pending=c;for(var g=0,h=f.length;h>g;++g){e=f[g][0],d=f[g][a.status];try{A(d)?e.resolve(d(a.value)):1===a.status?e.resolve(a.value):e.reject(a.value)}catch(i){e.reject(i),b(i)}}}function j(b){!b.processScheduled&&b.pending&&(b.processScheduled=!0,a(function(){i(b)}))}function k(){this.promise=new g,this.resolve=h(this,this.resolve),this.reject=h(this,this.reject),this.notify=h(this,this.notify)}function m(a){var b=new k,c=0,d=Od(a)?[]:{};return f(a,function(a,e){c++,s(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})}),0===c&&b.resolve(d),b.promise}var n=d("$q",TypeError),o=function(){return new k};l(g.prototype,{then:function(a,b,c){if(t(a)&&t(b)&&t(c))return this;var d=new k;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([d,a,b,c]),this.$$state.status>0&&j(this.$$state),d.promise},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return r(b,!0,a)},function(b){return r(b,!1,a)},b)}}),l(k.prototype,{resolve:function(a){this.promise.$$state.status||(a===this.promise?this.$$reject(n("qcycle","Expected promise to be resolved with value other than itself '{0}'",a)):this.$$resolve(a))},$$resolve:function(a){var c,d;d=e(this,this.$$resolve,this.$$reject);try{(v(a)||A(a))&&(c=a&&a.then),A(c)?(this.promise.$$state.status=-1,c.call(a,d[0],d[1],this.notify)):(this.promise.$$state.value=a,this.promise.$$state.status=1,j(this.promise.$$state))}catch(f){d[1](f),b(f)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a,this.promise.$$state.status=2,j(this.promise.$$state)},notify:function(c){var d=this.promise.$$state.pending;this.promise.$$state.status<=0&&d&&d.length&&a(function(){for(var a,e,f=0,g=d.length;g>f;f++){e=d[f][0],a=d[f][3];try{e.notify(A(a)?a(c):c)}catch(h){b(h)}}})}});var p=function(a){var b=new k;return b.reject(a),b.promise},q=function(a,b){var c=new k;return b?c.resolve(a):c.reject(a),c.promise},r=function(a,b,c){var d=null;try{A(c)&&(d=c())}catch(e){return q(e,!1)}return I(d)?d.then(function(){return q(a,b)},function(a){return q(a,!1)}):q(a,b)},s=function(a,b,c,d){var e=new k;return e.resolve(a),e.promise.then(b,c,d)},u=s,w=function x(a){function b(a){d.resolve(a)}function c(a){d.reject(a)}if(!A(a))throw n("norslvr","Expected resolverFn, got '{0}'",a);if(!(this instanceof x))return new x(a);var d=new k;return a(b,c),d.promise};return w.defer=o,w.reject=p,w.when=s,w.resolve=u,w.all=m,w}function qc(){this.$get=["$window","$timeout",function(a,b){var c=a.requestAnimationFrame||a.webkitRequestAnimationFrame,d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};return f.supported=e,f}]}function rc(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=i(),this.$$ChildScope=null}return b.prototype=a,b}var b=10,c=d("$rootScope"),g=null,h=null;this.digestTtl=function(a){return arguments.length&&(b=a),b},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,j,k,l){function m(a){a.currentScope.$$destroyed=!0}function n(a){9===Bd&&(a.$$childHead&&n(a.$$childHead),a.$$nextSibling&&n(a.$$nextSibling)),a.$parent=a.$$nextSibling=a.$$prevSibling=a.$$childHead=a.$$childTail=a.$root=a.$$watchers=null}function o(){this.$id=i(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function q(a){if(z.$$phase)throw c("inprog","{0} already in progress",z.$$phase);z.$$phase=a}function r(){z.$$phase=null}function s(a,b){do a.$$watchersCount+=b;while(a=a.$parent)}function u(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function w(){}function x(){for(;D.length;)try{D.shift()()}catch(a){j(a)}h=null}function y(){null===h&&(h=l.defer(function(){z.$apply(x)}))}o.prototype={constructor:o,$new:function(b,c){var d;return c=c||this,b?(d=new o,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope),d.$parent=c,d.$$prevSibling=c.$$childTail,c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):c.$$childHead=c.$$childTail=d,(b||c!=this)&&d.$on("$destroy",m),d},$watch:function(a,b,c,d){var e=k(a);if(e.$$watchDelegate)return e.$$watchDelegate(this,b,c,e,a);var f=this,h=f.$$watchers,i={fn:b,last:w,get:e,exp:d||a,eq:!!c};return g=null,A(b)||(i.fn=p),h||(h=f.$$watchers=[]),h.unshift(i),s(this,1),function(){N(h,i)>=0&&s(f,-1),g=null}},$watchGroup:function(a,b){function c(){i=!1,j?(j=!1,b(e,e,h)):b(e,d,h)}var d=new Array(a.length),e=new Array(a.length),g=[],h=this,i=!1,j=!0;if(!a.length){var k=!0;return h.$evalAsync(function(){k&&b(e,e,h)}),function(){k=!1}}return 1===a.length?this.$watch(a[0],function(a,c,f){e[0]=a,d[0]=c,b(e,a===c?e:d,f)}):(f(a,function(a,b){var f=h.$watch(a,function(a,f){e[b]=a,d[b]=f,i||(i=!0,h.$evalAsync(c))});g.push(f)}),function(){for(;g.length;)g.shift()()})},$watchCollection:function(a,b){function c(a){f=a;var b,c,d,h,i;if(!t(f)){if(v(f))if(e(f)){g!==n&&(g=n,q=g.length=0,l++),b=f.length,q!==b&&(l++,g.length=q=b);for(var j=0;b>j;j++)i=g[j],h=f[j],d=i!==i&&h!==h,d||i===h||(l++,g[j]=h)}else{g!==o&&(g=o={},q=0,l++),b=0;for(c in f)xd.call(f,c)&&(b++,h=f[c],i=g[c],c in g?(d=i!==i&&h!==h,d||i===h||(l++,g[c]=h)):(q++,g[c]=h,l++));if(q>b){l++;for(c in g)xd.call(f,c)||(q--,delete g[c])}}else g!==f&&(g=f,l++);return l}}function d(){if(p?(p=!1,b(f,f,i)):b(f,h,i),j)if(v(f))if(e(f)){h=new Array(f.length);for(var a=0;a<f.length;a++)h[a]=f[a]}else{h={};for(var c in f)xd.call(f,c)&&(h[c]=f[c])}else h=f}c.$stateful=!0;var f,g,h,i=this,j=b.length>1,l=0,m=k(a,c),n=[],o={},p=!0,q=0;return this.$watch(m,d)},$digest:function(){var a,d,e,f,i,k,m,n,o,p,s=b,t=this,u=[];q("$digest"),l.$$checkUrlChange(),this===z&&null!==h&&(l.defer.cancel(h),x()),g=null;do{for(k=!1,n=t;B.length;){try{p=B.shift(),p.scope.$eval(p.expression,p.locals)}catch(v){j(v)}g=null}a:do{if(f=n.$$watchers)for(i=f.length;i--;)try{if(a=f[i])if((d=a.get(n))===(e=a.last)||(a.eq?Q(d,e):"number"==typeof d&&"number"==typeof e&&isNaN(d)&&isNaN(e))){if(a===g){k=!1;break a}}else k=!0,g=a,a.last=a.eq?O(d,null):d,a.fn(d,e===w?d:e,n),5>s&&(o=4-s,u[o]||(u[o]=[]),u[o].push({msg:A(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:d,oldVal:e}))}catch(v){j(v)}if(!(m=n.$$watchersCount&&n.$$childHead||n!==t&&n.$$nextSibling))for(;n!==t&&!(m=n.$$nextSibling);)n=n.$parent}while(n=m);if((k||B.length)&&!s--)throw r(),c("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",b,u)}while(k||B.length);for(r();C.length;)try{C.shift()()}catch(v){j(v)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===z&&l.$$applicationDestroyed(),s(this,-this.$$watchersCount);for(var b in this.$$listenerCount)u(this,this.$$listenerCount[b],b);a&&a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a&&a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=p,this.$on=this.$watch=this.$watchGroup=function(){return p},this.$$listeners={},this.$$nextSibling=null,n(this)}},$eval:function(a,b){return k(a)(this,b)},$evalAsync:function(a,b){z.$$phase||B.length||l.defer(function(){B.length&&z.$digest()}),B.push({scope:this,expression:a,locals:b})},$$postDigest:function(a){C.push(a)},$apply:function(a){try{q("$apply");try{return this.$eval(a)}finally{r()}}catch(b){j(b)}finally{try{z.$digest()}catch(b){throw j(b),b}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&D.push(b),y()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]),c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,u(e,1,a))}},$emit:function(a,b){var c,d,e,f=[],g=this,h=!1,i={name:a,targetScope:g,stopPropagation:function(){h=!0},preventDefault:function(){i.defaultPrevented=!0},defaultPrevented:!1},k=R([i],arguments,1);do{for(c=g.$$listeners[a]||f,i.currentScope=g,d=0,e=c.length;e>d;d++)if(c[d])try{c[d].apply(null,k)}catch(l){j(l)}else c.splice(d,1),d--,e--;if(h)return i.currentScope=null,i;g=g.$parent}while(g);return i.currentScope=null,i},$broadcast:function(a,b){var c=this,d=c,e=c,f={name:a,targetScope:c,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1};if(!c.$$listenerCount[a])return f;for(var g,h,i,k=R([f],arguments,1);d=e;){for(f.currentScope=d,g=d.$$listeners[a]||[],h=0,i=g.length;i>h;h++)if(g[h])try{g[h].apply(null,k)}catch(l){j(l)}else g.splice(h,1),h--,i--;if(!(e=d.$$listenerCount[a]&&d.$$childHead||d!==c&&d.$$nextSibling))for(;d!==c&&!(e=d.$$nextSibling);)d=d.$parent}return f.currentScope=null,f}};var z=new o,B=z.$$asyncQueue=[],C=z.$$postDigestQueue=[],D=z.$$applyAsyncQueue=[];return z}]}function sc(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return u(b)?(a=b,this):a},this.imgSrcSanitizationWhitelist=function(a){return u(a)?(b=a,this):b},this.$get=function(){return function(c,d){var e,f=d?b:a;return e=Bc(c).href,""===e||e.match(f)?c:"unsafe:"+e}}}function tc(a){if("self"===a)return a;if(x(a)){if(a.indexOf("***")>-1)throw gf("iwcard","Illegal sequence *** in string matcher.  String: {0}",a);return a=Rd(a).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+a+"$")}if(B(a))return new RegExp("^"+a.source+"$");throw gf("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function uc(a){var b=[];return u(a)&&f(a,function(a){b.push(tc(a))}),b}function vc(){this.SCE_CONTEXTS=hf;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){return arguments.length&&(a=uc(b)),a},this.resourceUrlBlacklist=function(a){return arguments.length&&(b=uc(a)),b},this.$get=["$injector",function(c){function d(a,b){return"self"===a?Cc(b):!!a.exec(b.href)}function e(c){var e,f,g=Bc(c.toString()),h=!1;for(e=0,f=a.length;f>e;e++)if(d(a[e],g)){h=!0;break}if(h)for(e=0,f=b.length;f>e;e++)if(d(b[e],g)){h=!1;break}return h}function f(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};return a&&(b.prototype=new a),b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},b}function g(a,b){var c=l.hasOwnProperty(a)?l[a]:null;if(!c)throw gf("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",a,b);if(null===b||t(b)||""===b)return b;if("string"!=typeof b)throw gf("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",a);return new c(b)}function h(a){return a instanceof k?a.$$unwrapTrustedValue():a}function i(a,b){if(null===b||t(b)||""===b)return b;var c=l.hasOwnProperty(a)?l[a]:null;if(c&&b instanceof c)return b.$$unwrapTrustedValue();if(a===hf.RESOURCE_URL){if(e(b))return b;throw gf("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",b.toString())}if(a===hf.HTML)return j(b);throw gf("unsafe","Attempting to use an unsafe value in a safe context.")}var j=function(a){throw gf("unsafe","Attempting to use an unsafe value in a safe context.")};c.has("$sanitize")&&(j=c.get("$sanitize"));var k=f(),l={};return l[hf.HTML]=f(k),l[hf.CSS]=f(k),l[hf.URL]=f(k),l[hf.JS]=f(k),l[hf.RESOURCE_URL]=f(l[hf.URL]),{trustAs:g,getTrusted:i,valueOf:h}}]}function wc(){var a=!0;this.enabled=function(b){return arguments.length&&(a=!!b),a},this.$get=["$parse","$sceDelegate",function(b,c){if(a&&8>Bd)throw gf("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var d=P(hf);d.isEnabled=function(){return a},d.trustAs=c.trustAs,d.getTrusted=c.getTrusted,d.valueOf=c.valueOf,
a||(d.trustAs=d.getTrusted=function(a,b){return b},d.valueOf=q),d.parseAs=function(a,c){var e=b(c);return e.literal&&e.constant?e:b(c,function(b){return d.getTrusted(a,b)})};var e=d.parseAs,g=d.getTrusted,h=d.trustAs;return f(hf,function(a,b){var c=wd(b);d[wa("parse_as_"+c)]=function(b){return e(a,b)},d[wa("get_trusted_"+c)]=function(b){return g(a,b)},d[wa("trust_as_"+c)]=function(b){return h(a,b)}}),d}]}function xc(){this.$get=["$window","$document",function(a,b){var c,d,e={},f=n((/android (\d+)/.exec(wd((a.navigator||{}).userAgent))||[])[1]),g=/Boxee/i.test((a.navigator||{}).userAgent),h=b[0]||{},i=/^(Moz|webkit|ms)(?=[A-Z])/,j=h.body&&h.body.style,k=!1,l=!1;if(j){for(var m in j)if(d=i.exec(m)){c=d[0],c=c.substr(0,1).toUpperCase()+c.substr(1);break}c||(c="WebkitOpacity"in j&&"webkit"),k=!!("transition"in j||c+"Transition"in j),l=!!("animation"in j||c+"Animation"in j),!f||k&&l||(k=x(j.webkitTransition),l=x(j.webkitAnimation))}return{history:!(!a.history||!a.history.pushState||4>f||g),hasEvent:function(a){if("input"===a&&11>=Bd)return!1;if(t(e[a])){var b=h.createElement("div");e[a]="on"+a in b}return e[a]},csp:Sd(),vendorPrefix:c,transitions:k,animations:l,android:f}}]}function yc(){this.$get=["$templateCache","$http","$q","$sce",function(a,b,c,d){function e(f,g){function h(a){if(!g)throw He("tpload","Failed to load template: {0} (HTTP status: {1} {2})",f,a.status,a.statusText);return c.reject(a)}e.totalPendingRequests++,x(f)&&a.get(f)||(f=d.getTrustedResourceUrl(f));var i=b.defaults&&b.defaults.transformResponse;Od(i)?i=i.filter(function(a){return a!==vb}):i===vb&&(i=null);var j={cache:a,transformResponse:i};return b.get(f,j)["finally"](function(){e.totalPendingRequests--}).then(function(b){return a.put(f,b.data),b.data},h)}return e.totalPendingRequests=0,e}]}function zc(){this.$get=["$rootScope","$browser","$location",function(a,b,c){var d={};return d.findBindings=function(a,b,c){var d=a.getElementsByClassName("ng-binding"),e=[];return f(d,function(a){var d=Ld.element(a).data("$binding");d&&f(d,function(d){if(c){var f=new RegExp("(^|\\s)"+Rd(b)+"(\\s|\\||$)");f.test(d)&&e.push(a)}else-1!=d.indexOf(b)&&e.push(a)})}),e},d.findModels=function(a,b,c){for(var d=["ng-","data-ng-","ng\\:"],e=0;e<d.length;++e){var f=c?"=":"*=",g="["+d[e]+"model"+f+'"'+b+'"]',h=a.querySelectorAll(g);if(h.length)return h}},d.getLocation=function(){return c.url()},d.setLocation=function(b){b!==c.url()&&(c.url(b),a.$digest())},d.whenStable=function(a){b.notifyWhenNoOutstandingRequests(a)},d}]}function Ac(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,c,d,e){function f(f,h,i){A(f)||(i=h,h=f,f=p);var j,k=S(arguments,3),l=u(i)&&!i,m=(l?d:c).defer(),n=m.promise;return j=b.defer(function(){try{m.resolve(f.apply(null,k))}catch(b){m.reject(b),e(b)}finally{delete g[n.$$timeoutId]}l||a.$apply()},h),n.$$timeoutId=j,g[j]=m,n}var g={};return f.cancel=function(a){return a&&a.$$timeoutId in g?(g[a.$$timeoutId].reject("canceled"),delete g[a.$$timeoutId],b.defer.cancel(a.$$timeoutId)):!1},f}]}function Bc(a){var b=a;return Bd&&(jf.setAttribute("href",b),b=jf.href),jf.setAttribute("href",b),{href:jf.href,protocol:jf.protocol?jf.protocol.replace(/:$/,""):"",host:jf.host,search:jf.search?jf.search.replace(/^\?/,""):"",hash:jf.hash?jf.hash.replace(/^#/,""):"",hostname:jf.hostname,port:jf.port,pathname:"/"===jf.pathname.charAt(0)?jf.pathname:"/"+jf.pathname}}function Cc(a){var b=x(a)?Bc(a):a;return b.protocol===kf.protocol&&b.host===kf.host}function Dc(){this.$get=r(a)}function Ec(a){function b(a){try{return decodeURIComponent(a)}catch(b){return a}}var c=a[0]||{},d={},e="";return function(){var a,f,g,h,i,j=c.cookie||"";if(j!==e)for(e=j,a=e.split("; "),d={},g=0;g<a.length;g++)f=a[g],h=f.indexOf("="),h>0&&(i=b(f.substring(0,h)),t(d[i])&&(d[i]=b(f.substring(h+1))));return d}}function Fc(){this.$get=Ec}function Gc(a){function b(d,e){if(v(d)){var g={};return f(d,function(a,c){g[c]=b(c,a)}),g}return a.factory(d+c,e)}var c="Filter";this.register=b,this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}],b("currency",Lc),b("date",Yc),b("filter",Hc),b("json",Zc),b("limitTo",$c),b("lowercase",pf),b("number",Mc),b("orderBy",_c),b("uppercase",qf)}function Hc(){return function(a,b,c){if(!e(a)){if(null==a)return a;throw d("filter")("notarray","Expected array but received: {0}",a)}var f,g,h=Kc(b);switch(h){case"function":f=b;break;case"boolean":case"null":case"number":case"string":g=!0;case"object":f=Ic(b,c,g);break;default:return a}return Array.prototype.filter.call(a,f)}}function Ic(a,b,c){var d,e=v(a)&&"$"in a;return b===!0?b=Q:A(b)||(b=function(a,b){return t(a)?!1:null===a||null===b?a===b:v(b)||v(a)&&!s(a)?!1:(a=wd(""+a),b=wd(""+b),-1!==a.indexOf(b))}),d=function(d){return e&&!v(d)?Jc(d,a.$,b,!1):Jc(d,a,b,c)}}function Jc(a,b,c,d,e){var f=Kc(a),g=Kc(b);if("string"===g&&"!"===b.charAt(0))return!Jc(a,b.substring(1),c,d);if(Od(a))return a.some(function(a){return Jc(a,b,c,d)});switch(f){case"object":var h;if(d){for(h in a)if("$"!==h.charAt(0)&&Jc(a[h],b,c,!0))return!0;return e?!1:Jc(a,b,c,!1)}if("object"===g){for(h in b){var i=b[h];if(!A(i)&&!t(i)){var j="$"===h,k=j?a:a[h];if(!Jc(k,i,c,j,j))return!1}}return!0}return c(a,b);case"function":return!1;default:return c(a,b)}}function Kc(a){return null===a?"null":typeof a}function Lc(a){var b=a.NUMBER_FORMATS;return function(a,c,d){return t(c)&&(c=b.CURRENCY_SYM),t(d)&&(d=b.PATTERNS[1].maxFrac),null==a?a:Nc(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,d).replace(/\u00A4/g,c)}}function Mc(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:Nc(a,b.PATTERNS[0],b.GROUP_SEP,b.DECIMAL_SEP,c)}}function Nc(a,b,c,d,e){if(v(a))return"";var f=0>a;a=Math.abs(a);var g=a===1/0;if(!g&&!isFinite(a))return"";var h=a+"",i="",j=!1,k=[];if(g&&(i="∞"),!g&&-1!==h.indexOf("e")){var l=h.match(/([\d\.]+)e(-?)(\d+)/);l&&"-"==l[2]&&l[3]>e+1?a=0:(i=h,j=!0)}if(g||j)e>0&&1>a&&(i=a.toFixed(e),a=parseFloat(i),i=i.replace(lf,d));else{var m=(h.split(lf)[1]||"").length;t(e)&&(e=Math.min(Math.max(b.minFrac,m),b.maxFrac)),a=+(Math.round(+(a.toString()+"e"+e)).toString()+"e"+-e);var n=(""+a).split(lf),o=n[0];n=n[1]||"";var p,q=0,r=b.lgSize,s=b.gSize;if(o.length>=r+s)for(q=o.length-r,p=0;q>p;p++)(q-p)%s===0&&0!==p&&(i+=c),i+=o.charAt(p);for(p=q;p<o.length;p++)(o.length-p)%r===0&&0!==p&&(i+=c),i+=o.charAt(p);for(;n.length<e;)n+="0";e&&"0"!==e&&(i+=d+n.substr(0,e))}return 0===a&&(f=!1),k.push(f?b.negPre:b.posPre,i,f?b.negSuf:b.posSuf),k.join("")}function Oc(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function Pc(a,b,c,d){return c=c||0,function(e){var f=e["get"+a]();return(c>0||f>-c)&&(f+=c),0===f&&-12==c&&(f=12),Oc(f,b,d)}}function Qc(a,b){return function(c,d){var e=c["get"+a](),f=yd(b?"SHORT"+a:a);return d[f][e]}}function Rc(a,b,c){var d=-1*c,e=d>=0?"+":"";return e+=Oc(Math[d>0?"floor":"ceil"](d/60),2)+Oc(Math.abs(d%60),2)}function Sc(a){var b=new Date(a,0,1).getDay();return new Date(a,0,(4>=b?5:12)-b)}function Tc(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate()+(4-a.getDay()))}function Uc(a){return function(b){var c=Sc(b.getFullYear()),d=Tc(b),e=+d-+c,f=1+Math.round(e/6048e5);return Oc(f,a)}}function Vc(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function Wc(a,b){return a.getFullYear()<=0?b.ERAS[0]:b.ERAS[1]}function Xc(a,b){return a.getFullYear()<=0?b.ERANAMES[0]:b.ERANAMES[1]}function Yc(a){function b(a){var b;if(b=a.match(c)){var d=new Date(0),e=0,f=0,g=b[8]?d.setUTCFullYear:d.setFullYear,h=b[8]?d.setUTCHours:d.setHours;b[9]&&(e=n(b[9]+b[10]),f=n(b[9]+b[11])),g.call(d,n(b[1]),n(b[2])-1,n(b[3]));var i=n(b[4]||0)-e,j=n(b[5]||0)-f,k=n(b[6]||0),l=Math.round(1e3*parseFloat("0."+(b[7]||0)));return h.call(d,i,j,k,l),d}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,d,e){var g,h,i="",j=[];if(d=d||"mediumDate",d=a.DATETIME_FORMATS[d]||d,x(c)&&(c=of.test(c)?n(c):b(c)),y(c)&&(c=new Date(c)),!z(c)||!isFinite(c.getTime()))return c;for(;d;)h=nf.exec(d),h?(j=R(j,h,1),d=j.pop()):(j.push(d),d=null);var k=c.getTimezoneOffset();return e&&(k=X(e,c.getTimezoneOffset()),c=Z(c,e,!0)),f(j,function(b){g=mf[b],i+=g?g(c,a.DATETIME_FORMATS,k):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}function Zc(){return function(a,b){return t(b)&&(b=2),V(a,b)}}function $c(){return function(a,b,c){return b=Math.abs(Number(b))===1/0?Number(b):n(b),isNaN(b)?a:(y(a)&&(a=a.toString()),Od(a)||x(a)?(c=!c||isNaN(c)?0:n(c),c=0>c?Math.max(0,a.length+c):c,b>=0?a.slice(c,c+b):0===c?a.slice(b,a.length):a.slice(Math.max(0,c+b),c)):a)}}function _c(a){function b(b,c){return c=c?-1:1,b.map(function(b){var d=1,e=q;if(A(b))e=b;else if(x(b)&&(("+"==b.charAt(0)||"-"==b.charAt(0))&&(d="-"==b.charAt(0)?-1:1,b=b.substring(1)),""!==b&&(e=a(b),e.constant))){var f=e();e=function(a){return a[f]}}return{get:e,descending:d*c}})}function c(a){switch(typeof a){case"number":case"boolean":case"string":return!0;default:return!1}}function d(a,b){return"function"==typeof a.valueOf&&(a=a.valueOf(),c(a))?a:s(a)&&(a=a.toString(),c(a))?a:b}function f(a,b){var c=typeof a;return null===a?(c="string",a="null"):"string"===c?a=a.toLowerCase():"object"===c&&(a=d(a,b)),{value:a,type:c}}function g(a,b){var c=0;return a.type===b.type?a.value!==b.value&&(c=a.value<b.value?-1:1):c=a.type<b.type?-1:1,c}return function(a,c,d){function h(a,b){return{value:a,predicateValues:j.map(function(c){return f(c.get(a),b)})}}function i(a,b){for(var c=0,d=0,e=j.length;e>d&&!(c=g(a.predicateValues[d],b.predicateValues[d])*j[d].descending);++d);return c}if(!e(a))return a;Od(c)||(c=[c]),0===c.length&&(c=["+"]);var j=b(c,d);j.push({get:function(){return{}},descending:d?-1:1});var k=Array.prototype.map.call(a,h);return k.sort(i),a=k.map(function(a){return a.value})}}function ad(a){return A(a)&&(a={link:a}),a.restrict=a.restrict||"AC",r(a)}function bd(a,b){a.$name=b}function cd(a,b,d,e,g){var h=this,i=[];h.$error={},h.$$success={},h.$pending=c,h.$name=g(b.name||b.ngForm||"")(d),h.$dirty=!1,h.$pristine=!0,h.$valid=!0,h.$invalid=!1,h.$submitted=!1,h.$$parentForm=tf,h.$rollbackViewValue=function(){f(i,function(a){a.$rollbackViewValue()})},h.$commitViewValue=function(){f(i,function(a){a.$commitViewValue()})},h.$addControl=function(a){na(a.$name,"input"),i.push(a),a.$name&&(h[a.$name]=a),a.$$parentForm=h},h.$$renameControl=function(a,b){var c=a.$name;h[c]===a&&delete h[c],h[b]=a,a.$name=b},h.$removeControl=function(a){a.$name&&h[a.$name]===a&&delete h[a.$name],f(h.$pending,function(b,c){h.$setValidity(c,null,a)}),f(h.$error,function(b,c){h.$setValidity(c,null,a)}),f(h.$$success,function(b,c){h.$setValidity(c,null,a)}),N(i,a),a.$$parentForm=tf},rd({ctrl:this,$element:a,set:function(a,b,c){var d=a[b];if(d){var e=d.indexOf(c);-1===e&&d.push(c)}else a[b]=[c]},unset:function(a,b,c){var d=a[b];d&&(N(d,c),0===d.length&&delete a[b])},$animate:e}),h.$setDirty=function(){e.removeClass(a,bg),e.addClass(a,cg),h.$dirty=!0,h.$pristine=!1,h.$$parentForm.$setDirty()},h.$setPristine=function(){e.setClass(a,bg,cg+" "+uf),h.$dirty=!1,h.$pristine=!0,h.$submitted=!1,f(i,function(a){a.$setPristine()})},h.$setUntouched=function(){f(i,function(a){a.$setUntouched()})},h.$setSubmitted=function(){e.addClass(a,uf),h.$submitted=!0,h.$$parentForm.$setSubmitted()}}function dd(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function ed(a,b,c,d,e,f){fd(a,b,c,d,e,f),dd(d)}function fd(a,b,c,d,e,f){var g=wd(b[0].type);if(!e.android){var h=!1;b.on("compositionstart",function(a){h=!0}),b.on("compositionend",function(){h=!1,i()})}var i=function(a){if(j&&(f.defer.cancel(j),j=null),!h){var e=b.val(),i=a&&a.type;"password"===g||c.ngTrim&&"false"===c.ngTrim||(e=Qd(e)),(d.$viewValue!==e||""===e&&d.$$hasNativeValidators)&&d.$setViewValue(e,i)}};if(e.hasEvent("input"))b.on("input",i);else{var j,k=function(a,b,c){j||(j=f.defer(function(){j=null,b&&b.value===c||i(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||b>15&&19>b||b>=37&&40>=b||k(a,this,this.value)}),e.hasEvent("paste")&&b.on("paste cut",k)}b.on("change",i),d.$render=function(){var a=d.$isEmpty(d.$viewValue)?"":d.$viewValue;b.val()!==a&&b.val(a)}}function gd(a,b){if(z(a))return a;if(x(a)){Ef.lastIndex=0;var c=Ef.exec(a);if(c){var d=+c[1],e=+c[2],f=0,g=0,h=0,i=0,j=Sc(d),k=7*(e-1);return b&&(f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds()),new Date(d,0,j.getDate()+k,f,g,h,i)}}return NaN}function hd(a,b){return function(c,d){var e,g;if(z(c))return c;if(x(c)){if('"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substring(1,c.length-1)),yf.test(c))return new Date(c);if(a.lastIndex=0,e=a.exec(c))return e.shift(),g=d?{yyyy:d.getFullYear(),MM:d.getMonth()+1,dd:d.getDate(),HH:d.getHours(),mm:d.getMinutes(),ss:d.getSeconds(),sss:d.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},f(e,function(a,c){c<b.length&&(g[b[c]]=+a)}),new Date(g.yyyy,g.MM-1,g.dd,g.HH,g.mm,g.ss||0,1e3*g.sss||0)}return NaN}}function id(a,b,d,e){return function(f,g,h,i,j,k,l){function m(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function n(a){return u(a)&&!z(a)?d(a)||c:a}jd(f,g,h,i),fd(f,g,h,i,j,k);var o,p=i&&i.$options&&i.$options.timezone;if(i.$$parserName=a,i.$parsers.push(function(a){if(i.$isEmpty(a))return null;if(b.test(a)){var e=d(a,o);return p&&(e=Z(e,p)),e}return c}),i.$formatters.push(function(a){if(a&&!z(a))throw gg("datefmt","Expected `{0}` to be a date",a);return m(a)?(o=a,o&&p&&(o=Z(o,p,!0)),l("date")(a,e,p)):(o=null,"")}),u(h.min)||h.ngMin){var q;i.$validators.min=function(a){return!m(a)||t(q)||d(a)>=q},h.$observe("min",function(a){q=n(a),i.$validate()})}if(u(h.max)||h.ngMax){var r;i.$validators.max=function(a){return!m(a)||t(r)||d(a)<=r},h.$observe("max",function(a){r=n(a),i.$validate()})}}}function jd(a,b,d,e){var f=b[0],g=e.$$hasNativeValidators=v(f.validity);g&&e.$parsers.push(function(a){var d=b.prop(vd)||{};return d.badInput&&!d.typeMismatch?c:a})}function kd(a,b,d,e,f,g){if(jd(a,b,d,e),fd(a,b,d,e,f,g),e.$$parserName="number",e.$parsers.push(function(a){return e.$isEmpty(a)?null:Bf.test(a)?parseFloat(a):c}),e.$formatters.push(function(a){if(!e.$isEmpty(a)){if(!y(a))throw gg("numfmt","Expected `{0}` to be a number",a);a=a.toString()}return a}),u(d.min)||d.ngMin){var h;e.$validators.min=function(a){return e.$isEmpty(a)||t(h)||a>=h},d.$observe("min",function(a){u(a)&&!y(a)&&(a=parseFloat(a,10)),h=y(a)&&!isNaN(a)?a:c,e.$validate()})}if(u(d.max)||d.ngMax){var i;e.$validators.max=function(a){return e.$isEmpty(a)||t(i)||i>=a},d.$observe("max",function(a){u(a)&&!y(a)&&(a=parseFloat(a,10)),i=y(a)&&!isNaN(a)?a:c,e.$validate()})}}function ld(a,b,c,d,e,f){fd(a,b,c,d,e,f),dd(d),d.$$parserName="url",d.$validators.url=function(a,b){var c=a||b;return d.$isEmpty(c)||zf.test(c)}}function md(a,b,c,d,e,f){fd(a,b,c,d,e,f),dd(d),d.$$parserName="email",d.$validators.email=function(a,b){var c=a||b;return d.$isEmpty(c)||Af.test(c)}}function nd(a,b,c,d){t(c.name)&&b.attr("name",i());var e=function(a){b[0].checked&&d.$setViewValue(c.value,a&&a.type)};b.on("click",e),d.$render=function(){var a=c.value;b[0].checked=a==d.$viewValue},c.$observe("value",d.$render)}function od(a,b,c,d,e){var f;if(u(d)){if(f=a(d),!f.constant)throw gg("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",c,d);return f(b)}return e}function pd(a,b,c,d,e,f,g,h){var i=od(h,a,"ngTrueValue",c.ngTrueValue,!0),j=od(h,a,"ngFalseValue",c.ngFalseValue,!1),k=function(a){d.$setViewValue(b[0].checked,a&&a.type)};b.on("click",k),d.$render=function(){b[0].checked=d.$viewValue},d.$isEmpty=function(a){return a===!1},d.$formatters.push(function(a){return Q(a,i)}),d.$parsers.push(function(a){return a?i:j})}function qd(a,b){return a="ngClass"+a,["$animate",function(c){function d(a,b){var c=[];a:for(var d=0;d<a.length;d++){for(var e=a[d],f=0;f<b.length;f++)if(e==b[f])continue a;c.push(e)}return c}function e(a){var b=[];return Od(a)?(f(a,function(a){b=b.concat(e(a))}),b):x(a)?a.split(" "):v(a)?(f(a,function(a,c){a&&(b=b.concat(c.split(" ")))}),b):a}return{restrict:"AC",link:function(g,h,i){function j(a){var b=l(a,1);i.$addClass(b)}function k(a){var b=l(a,-1);i.$removeClass(b)}function l(a,b){var c=h.data("$classCounts")||qa(),d=[];return f(a,function(a){(b>0||c[a])&&(c[a]=(c[a]||0)+b,c[a]===+(b>0)&&d.push(a))}),h.data("$classCounts",c),d.join(" ")}function m(a,b){var e=d(b,a),f=d(a,b);e=l(e,1),f=l(f,-1),e&&e.length&&c.addClass(h,e),f&&f.length&&c.removeClass(h,f)}function n(a){if(b===!0||g.$index%2===b){var c=e(a||[]);if(o){if(!Q(a,o)){var d=e(o);m(d,c)}}else j(c)}o=P(a)}var o;g.$watch(i[a],n,!0),i.$observe("class",function(b){n(g.$eval(i[a]))}),"ngClass"!==a&&g.$watch("$index",function(c,d){var f=1&c;if(f!==(1&d)){var h=e(g.$eval(i[a]));f===b?j(h):k(h)}})}}}]}function rd(a){function b(a,b,i){t(b)?d("$pending",a,i):e("$pending",a,i),H(b)?b?(l(h.$error,a,i),k(h.$$success,a,i)):(k(h.$error,a,i),l(h.$$success,a,i)):(l(h.$error,a,i),l(h.$$success,a,i)),h.$pending?(f(fg,!0),h.$valid=h.$invalid=c,g("",null)):(f(fg,!1),h.$valid=sd(h.$error),h.$invalid=!h.$valid,g("",h.$valid));var j;j=h.$pending&&h.$pending[a]?c:h.$error[a]?!1:h.$$success[a]?!0:null,g(a,j),h.$$parentForm.$setValidity(a,j,h)}function d(a,b,c){h[a]||(h[a]={}),k(h[a],b,c)}function e(a,b,d){h[a]&&l(h[a],b,d),sd(h[a])&&(h[a]=c)}function f(a,b){b&&!j[a]?(m.addClass(i,a),j[a]=!0):!b&&j[a]&&(m.removeClass(i,a),j[a]=!1)}function g(a,b){a=a?"-"+ja(a,"-"):"",f(_f+a,b===!0),f(ag+a,b===!1)}var h=a.ctrl,i=a.$element,j={},k=a.set,l=a.unset,m=a.$animate;j[ag]=!(j[_f]=i.hasClass(_f)),h.$setValidity=b}function sd(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function td(a){a[0].hasAttribute("selected")&&(a[0].selected=!0)}var ud=/^\/(.+)\/([a-z]*)$/,vd="validity",wd=function(a){return x(a)?a.toLowerCase():a},xd=Object.prototype.hasOwnProperty,yd=function(a){return x(a)?a.toUpperCase():a},zd=function(a){return x(a)?a.replace(/[A-Z]/g,function(a){return String.fromCharCode(32|a.charCodeAt(0))}):a},Ad=function(a){return x(a)?a.replace(/[a-z]/g,function(a){return String.fromCharCode(-33&a.charCodeAt(0))}):a};"i"!=="I".toLowerCase()&&(wd=zd,yd=Ad);var Bd,Cd,Dd,Ed,Fd=[].slice,Gd=[].splice,Hd=[].push,Id=Object.prototype.toString,Jd=Object.getPrototypeOf,Kd=d("ng"),Ld=a.angular||(a.angular={}),Md=0;Bd=b.documentMode,p.$inject=[],q.$inject=[];var Nd,Od=Array.isArray,Pd=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,Qd=function(a){return x(a)?a.trim():a},Rd=function(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Sd=function(){function a(){try{return new Function(""),!1}catch(a){return!0}}if(!u(Sd.rules)){var c=b.querySelector("[ng-csp]")||b.querySelector("[data-ng-csp]");if(c){var d=c.getAttribute("ng-csp")||c.getAttribute("data-ng-csp");Sd.rules={noUnsafeEval:!d||-1!==d.indexOf("no-unsafe-eval"),noInlineStyle:!d||-1!==d.indexOf("no-inline-style")}}else Sd.rules={noUnsafeEval:a(),noInlineStyle:!1}}return Sd.rules},Td=function(){if(u(Td.name_))return Td.name_;var a,c,d,e,f=Ud.length;for(c=0;f>c;++c)if(d=Ud[c],a=b.querySelector("["+d.replace(":","\\:")+"jq]")){e=a.getAttribute(d+"jq");break}return Td.name_=e},Ud=["ng-","data-ng-","ng:","x-ng-"],Vd=/[A-Z]/g,Wd=!1,Xd=1,Yd=2,Zd=3,$d=8,_d=9,ae=11,be={full:"1.4.8",major:1,minor:4,dot:8,codeName:"ice-manipulation"};Ca.expando="ng339";var ce=Ca.cache={},de=1,ee=function(a,b,c){a.addEventListener(b,c,!1)},fe=function(a,b,c){a.removeEventListener(b,c,!1)};Ca._data=function(a){return this.cache[a[this.expando]]||{}};var ge=/([\:\-\_]+(.))/g,he=/^moz([A-Z])/,ie={mouseleave:"mouseout",mouseenter:"mouseover"},je=d("jqLite"),ke=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,le=/<|&#?\w+;/,me=/<([\w:-]+)/,ne=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,oe={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};oe.optgroup=oe.option,oe.tbody=oe.tfoot=oe.colgroup=oe.caption=oe.thead,oe.th=oe.td;var pe=Node.prototype.contains||function(a){return!!(16&this.compareDocumentPosition(a))},qe=Ca.prototype={ready:function(c){function d(){e||(e=!0,c())}var e=!1;"complete"===b.readyState?setTimeout(d):(this.on("DOMContentLoaded",d),Ca(a).on("load",d))},toString:function(){var a=[];return f(this,function(b){a.push(""+b)}),"["+a.join(", ")+"]"},eq:function(a){return Cd(a>=0?this[a]:this[this.length+a])},length:0,push:Hd,sort:[].sort,splice:[].splice},re={};f("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(a){re[wd(a)]=a});var se={};f("input,select,option,textarea,button,form,details".split(","),function(a){se[a]=!0});var te={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};f({data:Ia,removeData:Ga,hasData:za},function(a,b){Ca[b]=a}),f({data:Ia,inheritedData:Oa,scope:function(a){return Cd.data(a,"$scope")||Oa(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return Cd.data(a,"$isolateScope")||Cd.data(a,"$isolateScopeNoTemplate")},controller:Na,injector:function(a){return Oa(a,"$injector")},removeAttr:function(a,b){a.removeAttribute(b)},hasClass:Ja,css:function(a,b,c){return b=wa(b),u(c)?void(a.style[b]=c):a.style[b]},attr:function(a,b,d){var e=a.nodeType;if(e!==Zd&&e!==Yd&&e!==$d){var f=wd(b);if(re[f]){if(!u(d))return a[b]||(a.attributes.getNamedItem(b)||p).specified?f:c;d?(a[b]=!0,a.setAttribute(b,f)):(a[b]=!1,a.removeAttribute(f))}else if(u(d))a.setAttribute(b,d);else if(a.getAttribute){var g=a.getAttribute(b,2);return null===g?c:g}}},prop:function(a,b,c){return u(c)?void(a[b]=c):a[b]},text:function(){function a(a,b){if(t(b)){var c=a.nodeType;return c===Xd||c===Zd?a.textContent:""}a.textContent=b}return a.$dv="",a}(),val:function(a,b){if(t(b)){if(a.multiple&&"select"===M(a)){var c=[];return f(a.options,function(a){a.selected&&c.push(a.value||a.text)}),0===c.length?null:c}return a.value}a.value=b},html:function(a,b){return t(b)?a.innerHTML:(Ea(a,!0),void(a.innerHTML=b))},empty:Pa},function(a,b){Ca.prototype[b]=function(b,c){var d,e,f=this.length;if(a!==Pa&&t(2==a.length&&a!==Ja&&a!==Na?b:c)){if(v(b)){for(d=0;f>d;d++)if(a===Ia)a(this[d],b);else for(e in b)a(this[d],e,b[e]);return this}for(var g=a.$dv,h=t(g)?Math.min(f,1):f,i=0;h>i;i++){var j=a(this[i],b,c);g=g?g+j:j}return g}for(d=0;f>d;d++)a(this[d],b,c);return this}}),f({removeData:Ga,on:function(a,b,d,e){if(u(e))throw je("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(ya(a)){var f=Ha(a,!0),g=f.events,h=f.handle;h||(h=f.handle=Ua(a,g));for(var i=b.indexOf(" ")>=0?b.split(" "):[b],j=i.length,k=function(b,c,e){var f=g[b];f||(f=g[b]=[],f.specialHandlerWrapper=c,"$destroy"===b||e||ee(a,b,h)),f.push(d)};j--;)b=i[j],ie[b]?(k(ie[b],Wa),k(b,c,!0)):k(b)}},off:Fa,one:function(a,b,c){a=Cd(a),a.on(b,function d(){a.off(b,c),a.off(b,d)}),a.on(b,c)},replaceWith:function(a,b){var c,d=a.parentNode;Ea(a),f(new Ca(b),function(b){c?d.insertBefore(b,c.nextSibling):d.replaceChild(b,a),c=b})},children:function(a){var b=[];return f(a.childNodes,function(a){a.nodeType===Xd&&b.push(a)}),b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var c=a.nodeType;if(c===Xd||c===ae){b=new Ca(b);for(var d=0,e=b.length;e>d;d++){var f=b[d];a.appendChild(f)}}},prepend:function(a,b){if(a.nodeType===Xd){var c=a.firstChild;f(new Ca(b),function(b){a.insertBefore(b,c)})}},wrap:function(a,b){b=Cd(b).eq(0).clone()[0];var c=a.parentNode;c&&c.replaceChild(b,a),b.appendChild(a)},remove:Qa,detach:function(a){Qa(a,!0)},after:function(a,b){var c=a,d=a.parentNode;b=new Ca(b);for(var e=0,f=b.length;f>e;e++){var g=b[e];d.insertBefore(g,c.nextSibling),c=g}},addClass:La,removeClass:Ka,toggleClass:function(a,b,c){b&&f(b.split(" "),function(b){var d=c;t(d)&&(d=!Ja(a,b)),(d?La:Ka)(a,b)})},parent:function(a){var b=a.parentNode;return b&&b.nodeType!==ae?b:null},next:function(a){return a.nextElementSibling},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:Da,triggerHandler:function(a,b,c){var d,e,g,h=b.type||b,i=Ha(a),j=i&&i.events,k=j&&j[h];k&&(d={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:p,type:h,target:a},b.type&&(d=l(d,b)),e=P(k),g=c?[d].concat(c):[d],f(e,function(b){d.isImmediatePropagationStopped()||b.apply(a,g)}))}},function(a,b){Ca.prototype[b]=function(b,c,d){for(var e,f=0,g=this.length;g>f;f++)t(e)?(e=a(this[f],b,c,d),u(e)&&(e=Cd(e))):Ma(e,a(this[f],b,c,d));return u(e)?e:this},Ca.prototype.bind=Ca.prototype.on,Ca.prototype.unbind=Ca.prototype.off}),Za.prototype={put:function(a,b){this[Ya(a,this.nextUid)]=b},get:function(a){return this[Ya(a,this.nextUid)]},remove:function(a){var b=this[a=Ya(a,this.nextUid)];return delete this[a],b}};var ue=[function(){this.$get=[function(){return Za}]}],ve=/^[^\(]*\(\s*([^\)]*)\)/m,we=/,/,xe=/^\s*(_?)(\S+?)\1\s*$/,ye=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,ze=d("$injector");ab.$$annotate=_a;var Ae=d("$animate"),Be=1,Ce="ng-animate",De=function(){this.$get=["$q","$$rAF",function(a,b){function c(){}return c.all=p,c.chain=p,c.prototype={end:p,cancel:p,resume:p,pause:p,complete:p,then:function(c,d){return a(function(a){b(function(){a()})}).then(c,d)}},c}]},Ee=function(){var a=new Za,b=[];this.$get=["$$AnimateRunner","$rootScope",function(c,d){function e(a,b,c){var d=!1;return b&&(b=x(b)?b.split(" "):Od(b)?b:[],f(b,function(b){b&&(d=!0,a[b]=c)})),d}function g(){f(b,function(b){var c=a.get(b);if(c){var d=eb(b.attr("class")),e="",g="";f(c,function(a,b){var c=!!d[b];a!==c&&(a?e+=(e.length?" ":"")+b:g+=(g.length?" ":"")+b)}),f(b,function(a){e&&La(a,e),g&&Ka(a,g)}),a.remove(b)}}),b.length=0}function h(c,f,h){var i=a.get(c)||{},j=e(i,f,!0),k=e(i,h,!1);(j||k)&&(a.put(c,i),b.push(c),1===b.length&&d.$$postDigest(g))}return{enabled:p,on:p,off:p,pin:p,push:function(a,b,d,e){return e&&e(),d=d||{},d.from&&a.css(d.from),d.to&&a.css(d.to),(d.addClass||d.removeClass)&&h(a,d.addClass,d.removeClass),new c}}}]},Fe=["$provide",function(a){var b=this;this.$$registeredAnimations=Object.create(null),this.register=function(c,d){if(c&&"."!==c.charAt(0))throw Ae("notcsel","Expecting class selector starting with '.' got '{0}'.",c);var e=c+"-animation";b.$$registeredAnimations[c.substr(1)]=e,a.factory(e,d)},this.classNameFilter=function(a){if(1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null,this.$$classNameFilter)){var b=new RegExp("(\\s+|\\/)"+Ce+"(\\s+|\\/)");if(b.test(this.$$classNameFilter.toString()))throw Ae("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',Ce)}return this.$$classNameFilter},this.$get=["$$animateQueue",function(a){function b(a,b,c){if(c){var d=db(c);!d||d.parentNode||d.previousElementSibling||(c=null)}c?c.after(a):b.prepend(a)}return{on:a.on,off:a.off,pin:a.pin,enabled:a.enabled,cancel:function(a){a.end&&a.end()},enter:function(c,d,e,f){return d=d&&Cd(d),e=e&&Cd(e),d=d||e.parent(),b(c,d,e),a.push(c,"enter",fb(f))},move:function(c,d,e,f){return d=d&&Cd(d),e=e&&Cd(e),d=d||e.parent(),b(c,d,e),a.push(c,"move",fb(f))},leave:function(b,c){return a.push(b,"leave",fb(c),function(){b.remove()})},addClass:function(b,c,d){return d=fb(d),d.addClass=cb(d.addclass,c),a.push(b,"addClass",d)},removeClass:function(b,c,d){return d=fb(d),d.removeClass=cb(d.removeClass,c),a.push(b,"removeClass",d)},setClass:function(b,c,d,e){return e=fb(e),e.addClass=cb(e.addClass,c),e.removeClass=cb(e.removeClass,d),a.push(b,"setClass",e)},animate:function(b,c,d,e,f){return f=fb(f),f.from=f.from?l(f.from,c):c,f.to=f.to?l(f.to,d):d,e=e||"ng-inline-animate",f.tempClasses=cb(f.tempClasses,e),a.push(b,"animate",f)}}}]}],Ge=function(){this.$get=["$$rAF","$q",function(a,b){var c=function(){};return c.prototype={done:function(a){this.defer&&this.defer[a===!0?"reject":"resolve"]()},end:function(){this.done()},cancel:function(){this.done(!0)},getPromise:function(){return this.defer||(this.defer=b.defer()),this.defer.promise},then:function(a,b){return this.getPromise().then(a,b)},"catch":function(a){return this.getPromise()["catch"](a)},"finally":function(a){return this.getPromise()["finally"](a)}},function(b,d){function e(){return a(function(){f(),g||h.done(),g=!0}),h}function f(){d.addClass&&(b.addClass(d.addClass),d.addClass=null),d.removeClass&&(b.removeClass(d.removeClass),d.removeClass=null),d.to&&(b.css(d.to),d.to=null)}d.cleanupStyles&&(d.from=d.to=null),d.from&&(b.css(d.from),d.from=null);var g,h=new c;return{start:e,end:e}}}]},He=d("$compile");kb.$inject=["$provide","$$sanitizeUriProvider"];var Ie=/^((?:x|data)[\:\-_])/i,Je=d("$controller"),Ke=/^(\S+)(\s+as\s+(\w+))?$/,Le=function(){this.$get=["$document",function(a){return function(b){return b?!b.nodeType&&b instanceof Cd&&(b=b[0]):b=a[0].body,b.offsetWidth+1}}]},Me="application/json",Ne={"Content-Type":Me+";charset=utf-8"},Oe=/^\[|^\{(?!\{)/,Pe={"[":/]$/,"{":/}$/},Qe=/^\)\]\}',?\n/,Re=d("$http"),Se=function(a){return function(){throw Re("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",a)}},Te=Ld.$interpolateMinErr=d("$interpolate");Te.throwNoconcat=function(a){throw Te("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",a)},Te.interr=function(a,b){return Te("interr","Can't interpolate: {0}\n{1}",a,b.toString())};var Ue=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Ve={http:80,https:443,ftp:21},We=d("$location"),Xe={$$html5:!1,$$replace:!1,absUrl:Sb("$$absUrl"),url:function(a){if(t(a))return this.$$url;var b=Ue.exec(a);return(b[1]||""===a)&&this.path(decodeURIComponent(b[1])),(b[2]||b[1]||""===a)&&this.search(b[3]||""),this.hash(b[5]||""),this},protocol:Sb("$$protocol"),host:Sb("$$host"),port:Sb("$$port"),path:Tb("$$path",function(a){return a=null!==a?a.toString():"","/"==a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;case 1:if(x(a)||y(a))a=a.toString(),this.$$search=aa(a);else{if(!v(a))throw We("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");a=O(a,{}),f(a,function(b,c){null==b&&delete a[c]}),this.$$search=a}break;default:t(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}return this.$$compose(),this},hash:Tb("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){return this.$$replace=!0,this}};f([Rb,Qb,Pb],function(a){a.prototype=Object.create(Xe),a.prototype.state=function(b){if(!arguments.length)return this.$$state;if(a!==Pb||!this.$$html5)throw We("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=t(b)?null:b,this}});var Ye=d("$parse"),Ze=Function.prototype.call,$e=Function.prototype.apply,_e=Function.prototype.bind,af=qa();f("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){af[a]=!0});var bf={n:"\n",f:"\f",r:"\r",t:"	",v:"\x0B","'":"'",'"':'"'},cf=function(a){this.options=a};cf.prototype={constructor:cf,lex:function(a){for(this.text=a,this.index=0,this.tokens=[];this.index<this.text.length;){var b=this.text.charAt(this.index);if('"'===b||"'"===b)this.readString(b);else if(this.isNumber(b)||"."===b&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(b))this.readIdent();else if(this.is(b,"(){}[].,;:?"))this.tokens.push({index:this.index,text:b}),this.index++;else if(this.isWhitespace(b))this.index++;else{var c=b+this.peek(),d=c+this.peek(2),e=af[b],f=af[c],g=af[d];if(e||f||g){var h=g?d:f?c:b;this.tokens.push({index:this.index,text:h,operator:!0}),
this.index+=h.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){var b=a||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(a){return a>="0"&&"9">=a&&"string"==typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||"\x0B"===a||" "===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=u(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw Ye("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,d,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=wd(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=this.index;this.index<this.text.length;){var b=this.text.charAt(this.index);if(!this.isIdent(b)&&!this.isNumber(b))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=bf[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,constant:!0,value:c});c+=f}this.index++}this.throwError("Unterminated quote",b)}};var df=function(a,b){this.lexer=a,this.options=b};df.Program="Program",df.ExpressionStatement="ExpressionStatement",df.AssignmentExpression="AssignmentExpression",df.ConditionalExpression="ConditionalExpression",df.LogicalExpression="LogicalExpression",df.BinaryExpression="BinaryExpression",df.UnaryExpression="UnaryExpression",df.CallExpression="CallExpression",df.MemberExpression="MemberExpression",df.Identifier="Identifier",df.Literal="Literal",df.ArrayExpression="ArrayExpression",df.Property="Property",df.ObjectExpression="ObjectExpression",df.ThisExpression="ThisExpression",df.NGValueParameter="NGValueParameter",df.prototype={ast:function(a){this.text=a,this.tokens=this.lexer.lex(a);var b=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),b},program:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),!this.expect(";"))return{type:df.Program,body:a}},expressionStatement:function(){return{type:df.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a,b=this.expression();a=this.expect("|");)b=this.filter(b);return b},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();return this.expect("=")&&(a={type:df.AssignmentExpression,left:a,right:this.assignment(),operator:"="}),a},ternary:function(){var a,b,c=this.logicalOR();return this.expect("?")&&(a=this.expression(),this.consume(":"))?(b=this.expression(),{type:df.ConditionalExpression,test:c,alternate:a,consequent:b}):c},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:df.LogicalExpression,operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:df.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var a,b=this.relational();a=this.expect("==","!=","===","!==");)b={type:df.BinaryExpression,operator:a.text,left:b,right:this.relational()};return b},relational:function(){for(var a,b=this.additive();a=this.expect("<",">","<=",">=");)b={type:df.BinaryExpression,operator:a.text,left:b,right:this.additive()};return b},additive:function(){for(var a,b=this.multiplicative();a=this.expect("+","-");)b={type:df.BinaryExpression,operator:a.text,left:b,right:this.multiplicative()};return b},multiplicative:function(){for(var a,b=this.unary();a=this.expect("*","/","%");)b={type:df.BinaryExpression,operator:a.text,left:b,right:this.unary()};return b},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:df.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.constants.hasOwnProperty(this.peek().text)?a=O(this.constants[this.consume().text]):this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:df.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:df.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):"."===b.text?a={type:df.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){for(var b=[a],c={type:df.CallExpression,callee:this.identifier(),arguments:b,filter:!0};this.expect(":");)b.push(this.expression());return c},parseArguments:function(){var a=[];if(")"!==this.peekToken().text)do a.push(this.expression());while(this.expect(","));return a},identifier:function(){var a=this.consume();return a.identifier||this.throwError("is not a valid identifier",a),{type:df.Identifier,name:a.text}},constant:function(){return{type:df.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:df.ArrayExpression,elements:a}},object:function(){var a,b=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;a={type:df.Property,kind:"init"},this.peek().constant?a.key=this.constant():this.peek().identifier?a.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),a.value=this.expression(),b.push(a)}while(this.expect(","));return this.consume("}"),{type:df.ObjectExpression,properties:b}},throwError:function(a,b){throw Ye("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},consume:function(a){if(0===this.tokens.length)throw Ye("ueoe","Unexpected end of expression: {0}",this.text);var b=this.expect(a);return b||this.throwError("is unexpected, expecting ["+a+"]",this.peek()),b},peekToken:function(){if(0===this.tokens.length)throw Ye("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){return this.peekAhead(0,a,b,c,d)},peekAhead:function(a,b,c,d,e){if(this.tokens.length>a){var f=this.tokens[a],g=f.text;if(g===b||g===c||g===d||g===e||!b&&!c&&!d&&!e)return f}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return e?(this.tokens.shift(),e):!1},constants:{"true":{type:df.Literal,value:!0},"false":{type:df.Literal,value:!1},"null":{type:df.Literal,value:null},undefined:{type:df.Literal,value:c},"this":{type:df.ThisExpression}}},ic.prototype={compile:function(a,b){var d=this,e=this.astBuilder.ast(a);this.state={nextId:0,filters:{},expensiveChecks:b,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},cc(e,d.$filter);var g,h="";if(this.stage="assign",g=fc(e)){this.state.computing="assign";var i=this.nextId();this.recurse(g,i),this.return_(i),h="fn.assign="+this.generateFunction("assign","s,v,l")}var j=dc(e.body);d.stage="inputs",f(j,function(a,b){var c="fn"+b;d.state[c]={vars:[],body:[],own:{}},d.state.computing=c;var e=d.nextId();d.recurse(a,e),d.return_(e),d.state.inputs.push(c),a.watchId=b}),this.state.computing="fn",this.stage="main",this.recurse(e);var k='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+h+this.watchFns()+"return fn;",l=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",k)(this.$filter,Wb,Yb,Zb,Xb,$b,_b,ac,a);return this.state=this.stage=c,l.literal=gc(e),l.constant=hc(e),l},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,c=this;return f(b,function(b){a.push("var "+b+"="+c.generateFunction(b,"s"))}),b.length&&a.push("fn.inputs=["+b.join(",")+"];"),a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;return f(this.state.filters,function(c,d){a.push(c+"=$filter("+b.escape(d)+")")}),a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},recurse:function(a,b,d,e,g,h){var i,j,k,l,m=this;if(e=e||p,!h&&u(a.watchId))return b=b||this.nextId(),void this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,d,e,g,!0));switch(a.type){case df.Program:f(a.body,function(b,d){m.recurse(b.expression,c,c,function(a){j=a}),d!==a.body.length-1?m.current().body.push(j,";"):m.return_(j)});break;case df.Literal:l=this.escape(a.value),this.assign(b,l),e(l);break;case df.UnaryExpression:this.recurse(a.argument,c,c,function(a){j=a}),l=a.operator+"("+this.ifDefined(j,0)+")",this.assign(b,l),e(l);break;case df.BinaryExpression:this.recurse(a.left,c,c,function(a){i=a}),this.recurse(a.right,c,c,function(a){j=a}),l="+"===a.operator?this.plus(i,j):"-"===a.operator?this.ifDefined(i,0)+a.operator+this.ifDefined(j,0):"("+i+")"+a.operator+"("+j+")",this.assign(b,l),e(l);break;case df.LogicalExpression:b=b||this.nextId(),m.recurse(a.left,b),m.if_("&&"===a.operator?b:m.not(b),m.lazyRecurse(a.right,b)),e(b);break;case df.ConditionalExpression:b=b||this.nextId(),m.recurse(a.test,b),m.if_(b,m.lazyRecurse(a.alternate,b),m.lazyRecurse(a.consequent,b)),e(b);break;case df.Identifier:b=b||this.nextId(),d&&(d.context="inputs"===m.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",a.name)+"?l:s"),d.computed=!1,d.name=a.name),Wb(a.name),m.if_("inputs"===m.stage||m.not(m.getHasOwnProperty("l",a.name)),function(){m.if_("inputs"===m.stage||"s",function(){g&&1!==g&&m.if_(m.not(m.nonComputedMember("s",a.name)),m.lazyAssign(m.nonComputedMember("s",a.name),"{}")),m.assign(b,m.nonComputedMember("s",a.name))})},b&&m.lazyAssign(b,m.nonComputedMember("l",a.name))),(m.state.expensiveChecks||kc(a.name))&&m.addEnsureSafeObject(b),e(b);break;case df.MemberExpression:i=d&&(d.context=this.nextId())||this.nextId(),b=b||this.nextId(),m.recurse(a.object,i,c,function(){m.if_(m.notNull(i),function(){a.computed?(j=m.nextId(),m.recurse(a.property,j),m.getStringValue(j),m.addEnsureSafeMemberName(j),g&&1!==g&&m.if_(m.not(m.computedMember(i,j)),m.lazyAssign(m.computedMember(i,j),"{}")),l=m.ensureSafeObject(m.computedMember(i,j)),m.assign(b,l),d&&(d.computed=!0,d.name=j)):(Wb(a.property.name),g&&1!==g&&m.if_(m.not(m.nonComputedMember(i,a.property.name)),m.lazyAssign(m.nonComputedMember(i,a.property.name),"{}")),l=m.nonComputedMember(i,a.property.name),(m.state.expensiveChecks||kc(a.property.name))&&(l=m.ensureSafeObject(l)),m.assign(b,l),d&&(d.computed=!1,d.name=a.property.name))},function(){m.assign(b,"undefined")}),e(b)},!!g);break;case df.CallExpression:b=b||this.nextId(),a.filter?(j=m.filter(a.callee.name),k=[],f(a.arguments,function(a){var b=m.nextId();m.recurse(a,b),k.push(b)}),l=j+"("+k.join(",")+")",m.assign(b,l),e(b)):(j=m.nextId(),i={},k=[],m.recurse(a.callee,j,i,function(){m.if_(m.notNull(j),function(){m.addEnsureSafeFunction(j),f(a.arguments,function(a){m.recurse(a,m.nextId(),c,function(a){k.push(m.ensureSafeObject(a))})}),i.name?(m.state.expensiveChecks||m.addEnsureSafeObject(i.context),l=m.member(i.context,i.name,i.computed)+"("+k.join(",")+")"):l=j+"("+k.join(",")+")",l=m.ensureSafeObject(l),m.assign(b,l)},function(){m.assign(b,"undefined")}),e(b)}));break;case df.AssignmentExpression:if(j=this.nextId(),i={},!ec(a.left))throw Ye("lval","Trying to assing a value to a non l-value");this.recurse(a.left,c,i,function(){m.if_(m.notNull(i.context),function(){m.recurse(a.right,j),m.addEnsureSafeObject(m.member(i.context,i.name,i.computed)),m.addEnsureSafeAssignContext(i.context),l=m.member(i.context,i.name,i.computed)+a.operator+j,m.assign(b,l),e(b||l)})},1);break;case df.ArrayExpression:k=[],f(a.elements,function(a){m.recurse(a,m.nextId(),c,function(a){k.push(a)})}),l="["+k.join(",")+"]",this.assign(b,l),e(l);break;case df.ObjectExpression:k=[],f(a.properties,function(a){m.recurse(a.value,m.nextId(),c,function(b){k.push(m.escape(a.key.type===df.Identifier?a.key.name:""+a.key.value)+":"+b)})}),l="{"+k.join(",")+"}",this.assign(b,l),e(l);break;case df.ThisExpression:this.assign(b,"s"),e("s");break;case df.NGValueParameter:this.assign(b,"v"),e("v")}},getHasOwnProperty:function(a,b){var c=a+"."+b,d=this.current().own;return d.hasOwnProperty(c)||(d[c]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")")),d[c]},assign:function(a,b){return a?(this.current().body.push(a,"=",b,";"),a):void 0},filter:function(a){return this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=this.nextId(!0)),this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,b,c){if(a===!0)b();else{var d=this.current().body;d.push("if(",a,"){"),b(),d.push("}"),c&&(d.push("else{"),c(),d.push("}"))}},not:function(a){return"!("+a+")"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,b){return a+"."+b},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,c){return c?this.computedMember(a,b):this.nonComputedMember(a,b)},addEnsureSafeObject:function(a){this.current().body.push(this.ensureSafeObject(a),";")},addEnsureSafeMemberName:function(a){this.current().body.push(this.ensureSafeMemberName(a),";")},addEnsureSafeFunction:function(a){this.current().body.push(this.ensureSafeFunction(a),";")},addEnsureSafeAssignContext:function(a){this.current().body.push(this.ensureSafeAssignContext(a),";")},ensureSafeObject:function(a){return"ensureSafeObject("+a+",text)"},ensureSafeMemberName:function(a){return"ensureSafeMemberName("+a+",text)"},ensureSafeFunction:function(a){return"ensureSafeFunction("+a+",text)"},getStringValue:function(a){this.assign(a,"getStringValue("+a+",text)")},ensureSafeAssignContext:function(a){return"ensureSafeAssignContext("+a+",text)"},lazyRecurse:function(a,b,c,d,e,f){var g=this;return function(){g.recurse(a,b,c,d,e,f)}},lazyAssign:function(a,b){var c=this;return function(){c.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(x(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(y(a))return a.toString();if(a===!0)return"true";if(a===!1)return"false";if(null===a)return"null";if("undefined"==typeof a)return"undefined";throw Ye("esc","IMPOSSIBLE")},nextId:function(a,b){var c="v"+this.state.nextId++;return a||this.current().vars.push(c+(b?"="+b:"")),c},current:function(){return this.state[this.state.computing]}},jc.prototype={compile:function(a,b){var c=this,d=this.astBuilder.ast(a);this.expression=a,this.expensiveChecks=b,cc(d,c.$filter);var e,g;(e=fc(d))&&(g=this.recurse(e));var h,i=dc(d.body);i&&(h=[],f(i,function(a,b){var d=c.recurse(a);a.input=d,h.push(d),a.watchId=b}));var j=[];f(d.body,function(a){j.push(c.recurse(a.expression))});var k=0===d.body.length?function(){}:1===d.body.length?j[0]:function(a,b){var c;return f(j,function(d){c=d(a,b)}),c};return g&&(k.assign=function(a,b,c){return g(a,c,b)}),h&&(k.inputs=h),k.literal=gc(d),k.constant=hc(d),k},recurse:function(a,b,d){var e,g,h,i=this;if(a.input)return this.inputs(a.input,a.watchId);switch(a.type){case df.Literal:return this.value(a.value,b);case df.UnaryExpression:return g=this.recurse(a.argument),this["unary"+a.operator](g,b);case df.BinaryExpression:return e=this.recurse(a.left),g=this.recurse(a.right),this["binary"+a.operator](e,g,b);case df.LogicalExpression:return e=this.recurse(a.left),g=this.recurse(a.right),this["binary"+a.operator](e,g,b);case df.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),b);case df.Identifier:return Wb(a.name,i.expression),i.identifier(a.name,i.expensiveChecks||kc(a.name),b,d,i.expression);case df.MemberExpression:return e=this.recurse(a.object,!1,!!d),a.computed||(Wb(a.property.name,i.expression),g=a.property.name),a.computed&&(g=this.recurse(a.property)),a.computed?this.computedMember(e,g,b,d,i.expression):this.nonComputedMember(e,g,i.expensiveChecks,b,d,i.expression);case df.CallExpression:return h=[],f(a.arguments,function(a){h.push(i.recurse(a))}),a.filter&&(g=this.$filter(a.callee.name)),a.filter||(g=this.recurse(a.callee,!0)),a.filter?function(a,d,e,f){for(var i=[],j=0;j<h.length;++j)i.push(h[j](a,d,e,f));var k=g.apply(c,i,f);return b?{context:c,name:c,value:k}:k}:function(a,c,d,e){var f,j=g(a,c,d,e);if(null!=j.value){Yb(j.context,i.expression),Zb(j.value,i.expression);for(var k=[],l=0;l<h.length;++l)k.push(Yb(h[l](a,c,d,e),i.expression));f=Yb(j.value.apply(j.context,k),i.expression)}return b?{value:f}:f};case df.AssignmentExpression:return e=this.recurse(a.left,!0,1),g=this.recurse(a.right),function(a,c,d,f){var h=e(a,c,d,f),j=g(a,c,d,f);return Yb(h.value,i.expression),$b(h.context),h.context[h.name]=j,b?{value:j}:j};case df.ArrayExpression:return h=[],f(a.elements,function(a){h.push(i.recurse(a))}),function(a,c,d,e){for(var f=[],g=0;g<h.length;++g)f.push(h[g](a,c,d,e));return b?{value:f}:f};case df.ObjectExpression:return h=[],f(a.properties,function(a){h.push({key:a.key.type===df.Identifier?a.key.name:""+a.key.value,value:i.recurse(a.value)})}),function(a,c,d,e){for(var f={},g=0;g<h.length;++g)f[h[g].key]=h[g].value(a,c,d,e);return b?{value:f}:f};case df.ThisExpression:return function(a){return b?{value:a}:a};case df.NGValueParameter:return function(a,c,d,e){return b?{value:d}:d}}},"unary+":function(a,b){return function(c,d,e,f){var g=a(c,d,e,f);return g=u(g)?+g:0,b?{value:g}:g}},"unary-":function(a,b){return function(c,d,e,f){var g=a(c,d,e,f);return g=u(g)?-g:0,b?{value:g}:g}},"unary!":function(a,b){return function(c,d,e,f){var g=!a(c,d,e,f);return b?{value:g}:g}},"binary+":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g),i=b(d,e,f,g),j=ac(h,i);return c?{value:j}:j}},"binary-":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g),i=b(d,e,f,g),j=(u(h)?h:0)-(u(i)?i:0);return c?{value:j}:j}},"binary*":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)*b(d,e,f,g);return c?{value:h}:h}},"binary/":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)/b(d,e,f,g);return c?{value:h}:h}},"binary%":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)%b(d,e,f,g);return c?{value:h}:h}},"binary===":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)===b(d,e,f,g);return c?{value:h}:h}},"binary!==":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)!==b(d,e,f,g);return c?{value:h}:h}},"binary==":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)==b(d,e,f,g);return c?{value:h}:h}},"binary!=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)!=b(d,e,f,g);return c?{value:h}:h}},"binary<":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)<b(d,e,f,g);return c?{value:h}:h}},"binary>":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)>b(d,e,f,g);return c?{value:h}:h}},"binary<=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)<=b(d,e,f,g);return c?{value:h}:h}},"binary>=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)>=b(d,e,f,g);return c?{value:h}:h}},"binary&&":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)&&b(d,e,f,g);return c?{value:h}:h}},"binary||":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)||b(d,e,f,g);return c?{value:h}:h}},"ternary?:":function(a,b,c,d){return function(e,f,g,h){var i=a(e,f,g,h)?b(e,f,g,h):c(e,f,g,h);return d?{value:i}:i}},value:function(a,b){return function(){return b?{context:c,name:c,value:a}:a}},identifier:function(a,b,d,e,f){return function(g,h,i,j){var k=h&&a in h?h:g;e&&1!==e&&k&&!k[a]&&(k[a]={});var l=k?k[a]:c;return b&&Yb(l,f),d?{context:k,name:a,value:l}:l}},computedMember:function(a,b,c,d,e){return function(f,g,h,i){var j,k,l=a(f,g,h,i);return null!=l&&(j=b(f,g,h,i),j=Xb(j),Wb(j,e),d&&1!==d&&l&&!l[j]&&(l[j]={}),k=l[j],Yb(k,e)),c?{context:l,name:j,value:k}:k}},nonComputedMember:function(a,b,d,e,f,g){return function(h,i,j,k){var l=a(h,i,j,k);f&&1!==f&&l&&!l[b]&&(l[b]={});var m=null!=l?l[b]:c;return(d||kc(b))&&Yb(m,g),e?{context:l,name:b,value:m}:m}},inputs:function(a,b){return function(c,d,e,f){return f?f[b]:a(c,d,e)}}};var ef=function(a,b,c){this.lexer=a,this.$filter=b,this.options=c,this.ast=new df(this.lexer),this.astCompiler=c.csp?new jc(this.ast,b):new ic(this.ast,b)};ef.prototype={constructor:ef,parse:function(a){return this.astCompiler.compile(a,this.options.expensiveChecks)}};var ff=(qa(),qa(),Object.prototype.valueOf),gf=d("$sce"),hf={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},He=d("$compile"),jf=b.createElement("a"),kf=Bc(a.location.href);Ec.$inject=["$document"],Gc.$inject=["$provide"],Lc.$inject=["$locale"],Mc.$inject=["$locale"];var lf=".",mf={yyyy:Pc("FullYear",4),yy:Pc("FullYear",2,0,!0),y:Pc("FullYear",1),MMMM:Qc("Month"),MMM:Qc("Month",!0),MM:Pc("Month",2,1),M:Pc("Month",1,1),dd:Pc("Date",2),d:Pc("Date",1),HH:Pc("Hours",2),H:Pc("Hours",1),hh:Pc("Hours",2,-12),h:Pc("Hours",1,-12),mm:Pc("Minutes",2),m:Pc("Minutes",1),ss:Pc("Seconds",2),s:Pc("Seconds",1),sss:Pc("Milliseconds",3),EEEE:Qc("Day"),EEE:Qc("Day",!0),a:Vc,Z:Rc,ww:Uc(2),w:Uc(1),G:Wc,GG:Wc,GGG:Wc,GGGG:Xc},nf=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,of=/^\-?\d+$/;Yc.$inject=["$locale"];var pf=r(wd),qf=r(yd);_c.$inject=["$parse"];var rf=r({restrict:"E",compile:function(a,b){return b.href||b.xlinkHref?void 0:function(a,b){if("a"===b[0].nodeName.toLowerCase()){var c="[object SVGAnimatedString]"===Id.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(c)||a.preventDefault()})}}}}),sf={};f(re,function(a,b){function c(a,c,e){a.$watch(e[d],function(a){e.$set(b,!!a)})}if("multiple"!=a){var d=lb("ng-"+b),e=c;"checked"===a&&(e=function(a,b,e){e.ngModel!==e[d]&&c(a,b,e)}),sf[d]=function(){return{restrict:"A",priority:100,link:e}}}}),f(te,function(a,b){sf[b]=function(){return{priority:100,link:function(a,c,d){if("ngPattern"===b&&"/"==d.ngPattern.charAt(0)){var e=d.ngPattern.match(ud);if(e)return void d.$set("ngPattern",new RegExp(e[1],e[2]))}a.$watch(d[b],function(a){d.$set(b,a)})}}}}),f(["src","srcset","href"],function(a){var b=lb("ng-"+a);sf[b]=function(){return{priority:99,link:function(c,d,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===Id.call(d.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null),e.$observe(b,function(b){return b?(e.$set(g,b),void(Bd&&f&&d.prop(f,e[g]))):void("href"===a&&e.$set(g,null))})}}}});var tf={$addControl:p,$$renameControl:bd,$removeControl:p,$setValidity:p,$setDirty:p,$setPristine:p,$setSubmitted:p},uf="ng-submitted";cd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var vf=function(a){return["$timeout","$parse",function(b,d){function e(a){return""===a?d('this[""]').assign:d(a).assign||p}var f={name:"form",restrict:a?"EAC":"E",require:["form","^^?form"],controller:cd,compile:function(d,f){d.addClass(bg).addClass(_f);var g=f.name?"name":a&&f.ngForm?"ngForm":!1;return{pre:function(a,d,f,h){var i=h[0];if(!("action"in f)){var j=function(b){a.$apply(function(){i.$commitViewValue(),i.$setSubmitted()}),b.preventDefault()};ee(d[0],"submit",j),d.on("$destroy",function(){b(function(){fe(d[0],"submit",j)},0,!1)})}var k=h[1]||i.$$parentForm;k.$addControl(i);var m=g?e(i.$name):p;g&&(m(a,i),f.$observe(g,function(b){i.$name!==b&&(m(a,c),i.$$parentForm.$$renameControl(i,b),(m=e(i.$name))(a,i))})),d.on("$destroy",function(){i.$$parentForm.$removeControl(i),m(a,c),l(i,tf)})}}}};return f}]},wf=vf(),xf=vf(!0),yf=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,zf=/^[A-Za-z][A-Za-z\d.+-]*:\/*(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?(?:\/[\w#!:.?+=&%@\-/]*)?$/,Af=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Bf=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,Cf=/^(\d{4})-(\d{2})-(\d{2})$/,Df=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Ef=/^(\d{4})-W(\d\d)$/,Ff=/^(\d{4})-(\d\d)$/,Gf=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Hf={text:ed,date:id("date",Cf,hd(Cf,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":id("datetimelocal",Df,hd(Df,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:id("time",Gf,hd(Gf,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:id("week",Ef,gd,"yyyy-Www"),month:id("month",Ff,hd(Ff,["yyyy","MM"]),"yyyy-MM"),number:kd,url:ld,email:md,radio:nd,checkbox:pd,hidden:p,button:p,submit:p,reset:p,file:p},If=["$browser","$sniffer","$filter","$parse",function(a,b,c,d){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,h){h[0]&&(Hf[wd(g.type)]||Hf.text)(e,f,g,h[0],b,a,c,d)}}}}],Jf=/^(true|false|\d+)$/,Kf=function(){return{restrict:"A",priority:100,compile:function(a,b){return Jf.test(b.ngValue)?function(a,b,c){c.$set("value",a.$eval(c.ngValue))}:function(a,b,c){a.$watch(c.ngValue,function(a){c.$set("value",a)})}}}},Lf=["$compile",function(a){return{restrict:"AC",compile:function(b){return a.$$addBindingClass(b),function(b,c,d){a.$$addBindingInfo(c,d.ngBind),c=c[0],b.$watch(d.ngBind,function(a){c.textContent=t(a)?"":a})}}}}],Mf=["$interpolate","$compile",function(a,b){return{compile:function(c){return b.$$addBindingClass(c),function(c,d,e){var f=a(d.attr(e.$attr.ngBindTemplate));b.$$addBindingInfo(d,f.expressions),d=d[0],e.$observe("ngBindTemplate",function(a){d.textContent=t(a)?"":a})}}}}],Nf=["$sce","$parse","$compile",function(a,b,c){return{restrict:"A",compile:function(d,e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(a){return(a||"").toString()});return c.$$addBindingClass(d),function(b,d,e){c.$$addBindingInfo(d,e.ngBindHtml),b.$watch(g,function(){d.html(a.getTrustedHtml(f(b))||"")})}}}}],Of=r({restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$viewChangeListeners.push(function(){a.$eval(c.ngChange)})}}),Pf=qd("",!0),Qf=qd("Odd",0),Rf=qd("Even",1),Sf=ad({compile:function(a,b){b.$set("ngCloak",c),a.removeClass("ng-cloak")}}),Tf=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Uf={},Vf={blur:!0,focus:!0};f("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=lb("ng-"+a);Uf[b]=["$parse","$rootScope",function(c,d){return{restrict:"A",compile:function(e,f){var g=c(f[b],null,!0);return function(b,c){c.on(a,function(c){var e=function(){g(b,{$event:c})};Vf[a]&&d.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var Wf=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,i,j;c.$watch(e.ngIf,function(c){c?i||g(function(c,f){i=f,c[c.length++]=b.createComment(" end ngIf: "+e.ngIf+" "),h={clone:c},a.enter(c,d.parent(),d)}):(j&&(j.remove(),j=null),i&&(i.$destroy(),i=null),h&&(j=pa(h.clone),a.leave(j).then(function(){j=null}),h=null))})}}}],Xf=["$templateRequest","$anchorScroll","$animate",function(a,b,c){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ld.noop,compile:function(d,e){var f=e.ngInclude||e.src,g=e.onload||"",h=e.autoscroll;return function(d,e,i,j,k){var l,m,n,o=0,p=function(){m&&(m.remove(),m=null),l&&(l.$destroy(),l=null),n&&(c.leave(n).then(function(){m=null}),m=n,n=null)};d.$watch(f,function(f){var i=function(){!u(h)||h&&!d.$eval(h)||b()},m=++o;f?(a(f,!0).then(function(a){if(m===o){var b=d.$new();j.template=a;var h=k(b,function(a){p(),c.enter(a,null,e).then(i)});l=b,n=h,l.$emit("$includeContentLoaded",f),d.$eval(g)}},function(){m===o&&(p(),d.$emit("$includeContentError",f))}),d.$emit("$includeContentRequested",f)):(p(),j.template=null)})}}}}],Yf=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){return/SVG/.test(d[0].toString())?(d.empty(),void a(Aa(f.template,b).childNodes)(c,function(a){d.append(a)},{futureParentElement:d})):(d.html(f.template),void a(d.contents())(c))}}}],Zf=ad({priority:450,compile:function(){return{pre:function(a,b,c){a.$eval(c.ngInit)}}}}),$f=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,e){var g=b.attr(d.$attr.ngList)||", ",h="false"!==d.ngTrim,i=h?Qd(g):g,j=function(a){if(!t(a)){var b=[];return a&&f(a.split(i),function(a){a&&b.push(h?Qd(a):a)}),b}};e.$parsers.push(j),e.$formatters.push(function(a){return Od(a)?a.join(g):c}),e.$isEmpty=function(a){return!a||!a.length}}}},_f="ng-valid",ag="ng-invalid",bg="ng-pristine",cg="ng-dirty",dg="ng-untouched",eg="ng-touched",fg="ng-pending",gg=d("ngModel"),hg=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,b,d,e,g,h,i,j,k,l){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=c,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=c,this.$name=l(d.name||"",!1)(a),this.$$parentForm=tf;var m,n=g(d.ngModel),o=n.assign,q=n,r=o,s=null,v=this;this.$$setOptions=function(a){if(v.$options=a,a&&a.getterSetter){var b=g(d.ngModel+"()"),c=g(d.ngModel+"($$$p)");q=function(a){var c=n(a);return A(c)&&(c=b(a)),c},r=function(a,b){A(n(a))?c(a,{$$$p:v.$modelValue}):o(a,v.$modelValue)}}else if(!n.assign)throw gg("nonassign","Expression '{0}' is non-assignable. Element: {1}",d.ngModel,$(e))},this.$render=p,this.$isEmpty=function(a){return t(a)||""===a||null===a||a!==a};var w=0;rd({ctrl:this,$element:e,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]},$animate:h}),this.$setPristine=function(){v.$dirty=!1,v.$pristine=!0,h.removeClass(e,cg),h.addClass(e,bg)},this.$setDirty=function(){v.$dirty=!0,v.$pristine=!1,h.removeClass(e,bg),h.addClass(e,cg),v.$$parentForm.$setDirty()},this.$setUntouched=function(){v.$touched=!1,v.$untouched=!0,h.setClass(e,dg,eg)},this.$setTouched=function(){v.$touched=!0,v.$untouched=!1,h.setClass(e,eg,dg)},this.$rollbackViewValue=function(){i.cancel(s),v.$viewValue=v.$$lastCommittedViewValue,v.$render()},this.$validate=function(){if(!y(v.$modelValue)||!isNaN(v.$modelValue)){var a=v.$$lastCommittedViewValue,b=v.$$rawModelValue,d=v.$valid,e=v.$modelValue,f=v.$options&&v.$options.allowInvalid;v.$$runValidators(b,a,function(a){f||d===a||(v.$modelValue=a?b:c,v.$modelValue!==e&&v.$$writeModelToScope())})}},this.$$runValidators=function(a,b,d){function e(){var a=v.$$parserName||"parse";return t(m)?(i(a,null),!0):(m||(f(v.$validators,function(a,b){i(b,null)}),f(v.$asyncValidators,function(a,b){i(b,null)})),i(a,m),m)}function g(){var c=!0;return f(v.$validators,function(d,e){var f=d(a,b);c=c&&f,i(e,f)}),c?!0:(f(v.$asyncValidators,function(a,b){i(b,null)}),!1)}function h(){
var d=[],e=!0;f(v.$asyncValidators,function(f,g){var h=f(a,b);if(!I(h))throw gg("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",h);i(g,c),d.push(h.then(function(){i(g,!0)},function(a){e=!1,i(g,!1)}))}),d.length?k.all(d).then(function(){j(e)},p):j(!0)}function i(a,b){l===w&&v.$setValidity(a,b)}function j(a){l===w&&d(a)}w++;var l=w;return e()&&g()?void h():void j(!1)},this.$commitViewValue=function(){var a=v.$viewValue;i.cancel(s),(v.$$lastCommittedViewValue!==a||""===a&&v.$$hasNativeValidators)&&(v.$$lastCommittedViewValue=a,v.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function b(){v.$modelValue!==g&&v.$$writeModelToScope()}var d=v.$$lastCommittedViewValue,e=d;if(m=t(e)?c:!0)for(var f=0;f<v.$parsers.length;f++)if(e=v.$parsers[f](e),t(e)){m=!1;break}y(v.$modelValue)&&isNaN(v.$modelValue)&&(v.$modelValue=q(a));var g=v.$modelValue,h=v.$options&&v.$options.allowInvalid;v.$$rawModelValue=e,h&&(v.$modelValue=e,b()),v.$$runValidators(e,v.$$lastCommittedViewValue,function(a){h||(v.$modelValue=a?e:c,b())})},this.$$writeModelToScope=function(){r(a,v.$modelValue),f(v.$viewChangeListeners,function(a){try{a()}catch(c){b(c)}})},this.$setViewValue=function(a,b){v.$viewValue=a,(!v.$options||v.$options.updateOnDefault)&&v.$$debounceViewValueCommit(b)},this.$$debounceViewValueCommit=function(b){var c,d=0,e=v.$options;e&&u(e.debounce)&&(c=e.debounce,y(c)?d=c:y(c[b])?d=c[b]:y(c["default"])&&(d=c["default"])),i.cancel(s),d?s=i(function(){v.$commitViewValue()},d):j.$$phase?v.$commitViewValue():a.$apply(function(){v.$commitViewValue()})},a.$watch(function(){var b=q(a);if(b!==v.$modelValue&&(v.$modelValue===v.$modelValue||b===b)){v.$modelValue=v.$$rawModelValue=b,m=c;for(var d=v.$formatters,e=d.length,f=b;e--;)f=d[e](f);v.$viewValue!==f&&(v.$viewValue=v.$$lastCommittedViewValue=f,v.$render(),v.$$runValidators(b,f,p))}return b})}],ig=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:hg,priority:1,compile:function(b){return b.addClass(bg).addClass(dg).addClass(_f),{pre:function(a,b,c,d){var e=d[0],f=d[1]||e.$$parentForm;e.$$setOptions(d[2]&&d[2].$options),f.$addControl(e),c.$observe("name",function(a){e.$name!==a&&e.$$parentForm.$$renameControl(e,a)}),a.$on("$destroy",function(){e.$$parentForm.$removeControl(e)})},post:function(b,c,d,e){var f=e[0];f.$options&&f.$options.updateOn&&c.on(f.$options.updateOn,function(a){f.$$debounceViewValueCommit(a&&a.type)}),c.on("blur",function(c){f.$touched||(a.$$phase?b.$evalAsync(f.$setTouched):b.$apply(f.$setTouched))})}}}}}],jg=/(\s+|^)default(\s+|$)/,kg=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,b){var c=this;this.$options=O(a.$eval(b.ngModelOptions)),u(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=Qd(this.$options.updateOn.replace(jg,function(){return c.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},lg=ad({terminal:!0,priority:1e3}),mg=d("ngOptions"),ng=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,og=["$compile","$parse",function(a,c){function d(a,b,d){function f(a,b,c,d,e){this.selectValue=a,this.viewValue=b,this.label=c,this.group=d,this.disabled=e}function g(a){var b;if(!j&&e(a))b=a;else{b=[];for(var c in a)a.hasOwnProperty(c)&&"$"!==c.charAt(0)&&b.push(c)}return b}var h=a.match(ng);if(!h)throw mg("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",a,$(b));var i=h[5]||h[7],j=h[6],k=/ as /.test(h[0])&&h[1],l=h[9],m=c(h[2]?h[1]:i),n=k&&c(k),o=n||m,p=l&&c(l),q=l?function(a,b){return p(d,b)}:function(a){return Ya(a)},r=function(a,b){return q(a,x(a,b))},s=c(h[2]||h[1]),t=c(h[3]||""),u=c(h[4]||""),v=c(h[8]),w={},x=j?function(a,b){return w[j]=b,w[i]=a,w}:function(a){return w[i]=a,w};return{trackBy:l,getTrackByValue:r,getWatchables:c(v,function(a){var b=[];a=a||[];for(var c=g(a),e=c.length,f=0;e>f;f++){var i=a===c?f:c[f],j=(a[i],x(a[i],i)),k=q(a[i],j);if(b.push(k),h[2]||h[1]){var l=s(d,j);b.push(l)}if(h[4]){var m=u(d,j);b.push(m)}}return b}),getOptions:function(){for(var a=[],b={},c=v(d)||[],e=g(c),h=e.length,i=0;h>i;i++){var j=c===e?i:e[i],k=c[j],m=x(k,j),n=o(d,m),p=q(n,m),w=s(d,m),y=t(d,m),z=u(d,m),A=new f(p,n,w,y,z);a.push(A),b[p]=A}return{items:a,selectValueMap:b,getOptionFromViewValue:function(a){return b[r(a)]},getViewValueFromOption:function(a){return l?Ld.copy(a.viewValue):a.viewValue}}}}}function g(b,c,e,g){function j(a,b){a.element=b,b.disabled=a.disabled,a.label!==b.label&&(b.label=a.label,b.textContent=a.label),a.value!==b.value&&(b.value=a.selectValue)}function k(a,b,c,d){var e;return b&&wd(b.nodeName)===c?e=b:(e=d.cloneNode(!1),b?a.insertBefore(e,b):a.appendChild(e)),e}function l(a){for(var b;a;)b=a.nextSibling,Qa(a),a=b}function m(a){var b=p&&p[0],c=w&&w[0];if(b||c)for(;a&&(a===b||a===c||a.nodeType===$d||""===a.value);)a=a.nextSibling;return a}function n(){var a=x&&q.readValue();x=y.getOptions();var b={},d=c[0].firstChild;if(v&&c.prepend(p),d=m(d),x.items.forEach(function(a){var e,f,g;a.group?(e=b[a.group],e||(f=k(c[0],d,"optgroup",i),d=f.nextSibling,f.label=a.group,e=b[a.group]={groupElement:f,currentOptionElement:f.firstChild}),g=k(e.groupElement,e.currentOptionElement,"option",h),j(a,g),e.currentOptionElement=g.nextSibling):(g=k(c[0],d,"option",h),j(a,g),d=g.nextSibling)}),Object.keys(b).forEach(function(a){l(b[a].currentOptionElement)}),l(d),o.$render(),!o.$isEmpty(a)){var e=q.readValue();(y.trackBy?Q(a,e):a===e)||(o.$setViewValue(e),o.$render())}}var o=g[1];if(o){for(var p,q=g[0],r=e.multiple,s=0,t=c.children(),u=t.length;u>s;s++)if(""===t[s].value){p=t.eq(s);break}var v=!!p,w=Cd(h.cloneNode(!1));w.val("?");var x,y=d(e.ngOptions,c,b),z=function(){v||c.prepend(p),c.val(""),p.prop("selected",!0),p.attr("selected",!0)},A=function(){v||p.remove()},B=function(){c.prepend(w),c.val("?"),w.prop("selected",!0),w.attr("selected",!0)},C=function(){w.remove()};r?(o.$isEmpty=function(a){return!a||0===a.length},q.writeValue=function(a){x.items.forEach(function(a){a.element.selected=!1}),a&&a.forEach(function(a){var b=x.getOptionFromViewValue(a);b&&!b.disabled&&(b.element.selected=!0)})},q.readValue=function(){var a=c.val()||[],b=[];return f(a,function(a){var c=x.selectValueMap[a];c&&!c.disabled&&b.push(x.getViewValueFromOption(c))}),b},y.trackBy&&b.$watchCollection(function(){return Od(o.$viewValue)?o.$viewValue.map(function(a){return y.getTrackByValue(a)}):void 0},function(){o.$render()})):(q.writeValue=function(a){var b=x.getOptionFromViewValue(a);b&&!b.disabled?c[0].value!==b.selectValue&&(C(),A(),c[0].value=b.selectValue,b.element.selected=!0,b.element.setAttribute("selected","selected")):null===a||v?(C(),z()):(A(),B())},q.readValue=function(){var a=x.selectValueMap[c.val()];return a&&!a.disabled?(A(),C(),x.getViewValueFromOption(a)):null},y.trackBy&&b.$watch(function(){return y.getTrackByValue(o.$viewValue)},function(){o.$render()})),v?(p.remove(),a(p)(b),p.removeClass("ng-scope")):p=Cd(h.cloneNode(!1)),n(),b.$watchCollection(y.getWatchables,n)}}var h=b.createElement("option"),i=b.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","?ngModel"],link:{pre:function(a,b,c,d){d[0].registerOption=p},post:g}}}],pg=["$locale","$interpolate","$log",function(a,b,c){var d=/{}/g,e=/^when(Minus)?(.+)$/;return{link:function(g,h,i){function j(a){h.text(a||"")}var k,l=i.count,m=i.$attr.when&&h.attr(i.$attr.when),n=i.offset||0,o=g.$eval(m)||{},q={},r=b.startSymbol(),s=b.endSymbol(),u=r+l+"-"+n+s,v=Ld.noop;f(i,function(a,b){var c=e.exec(b);if(c){var d=(c[1]?"-":"")+wd(c[2]);o[d]=h.attr(i.$attr[b])}}),f(o,function(a,c){q[c]=b(a.replace(d,u))}),g.$watch(l,function(b){var d=parseFloat(b),e=isNaN(d);if(e||d in o||(d=a.pluralCat(d-n)),d!==k&&!(e&&y(k)&&isNaN(k))){v();var f=q[d];t(f)?(null!=b&&c.debug("ngPluralize: no rule defined for '"+d+"' in "+m),v=p,j()):v=g.$watch(f,j),k=d}})}}}],qg=["$parse","$animate",function(a,g){var h="$$NG_REMOVED",i=d("ngRepeat"),j=function(a,b,c,d,e,f,g){a[c]=d,e&&(a[e]=f),a.$index=b,a.$first=0===b,a.$last=b===g-1,a.$middle=!(a.$first||a.$last),a.$odd=!(a.$even=0===(1&b))},k=function(a){return a.clone[0]},l=function(a){return a.clone[a.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(d,m){var n=m.ngRepeat,o=b.createComment(" end ngRepeat: "+n+" "),p=n.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!p)throw i("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",n);var q=p[1],r=p[2],s=p[3],t=p[4];if(p=q.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!p)throw i("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",q);var u=p[3]||p[1],v=p[2];if(s&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(s)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(s)))throw i("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",s);var w,x,y,z,A={$id:Ya};return t?w=a(t):(y=function(a,b){return Ya(b)},z=function(a){return a}),function(a,b,d,m,p){w&&(x=function(b,c,d){return v&&(A[v]=b),A[u]=c,A.$index=d,w(a,A)});var q=qa();a.$watchCollection(r,function(d){var m,r,t,w,A,B,C,D,E,F,G,H,I=b[0],J=qa();if(s&&(a[s]=d),e(d))E=d,D=x||y;else{D=x||z,E=[];for(var K in d)xd.call(d,K)&&"$"!==K.charAt(0)&&E.push(K)}for(w=E.length,G=new Array(w),m=0;w>m;m++)if(A=d===E?m:E[m],B=d[A],C=D(A,B,m),q[C])F=q[C],delete q[C],J[C]=F,G[m]=F;else{if(J[C])throw f(G,function(a){a&&a.scope&&(q[a.id]=a)}),i("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",n,C,B);G[m]={id:C,scope:c,clone:c},J[C]=!0}for(var L in q){if(F=q[L],H=pa(F.clone),g.leave(H),H[0].parentNode)for(m=0,r=H.length;r>m;m++)H[m][h]=!0;F.scope.$destroy()}for(m=0;w>m;m++)if(A=d===E?m:E[m],B=d[A],F=G[m],F.scope){t=I;do t=t.nextSibling;while(t&&t[h]);k(F)!=t&&g.move(pa(F.clone),null,Cd(I)),I=l(F),j(F.scope,m,u,B,v,A,w)}else p(function(a,b){F.scope=b;var c=o.cloneNode(!1);a[a.length++]=c,g.enter(a,null,Cd(I)),I=c,F.clone=a,J[F.id]=F,j(F.scope,m,u,B,v,A,w)});q=J})}}}}],rg="ng-hide",sg="ng-hide-animate",tg=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,c,d){b.$watch(d.ngShow,function(b){a[b?"removeClass":"addClass"](c,rg,{tempClasses:sg})})}}}],ug=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,c,d){b.$watch(d.ngHide,function(b){a[b?"addClass":"removeClass"](c,rg,{tempClasses:sg})})}}}],vg=ad(function(a,b,c){a.$watch(c.ngStyle,function(a,c){c&&a!==c&&f(c,function(a,c){b.css(c,"")}),a&&b.css(a)},!0)}),wg=["$animate",function(a){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,g){var h=e.ngSwitch||e.on,i=[],j=[],k=[],l=[],m=function(a,b){return function(){a.splice(b,1)}};c.$watch(h,function(c){var d,e;for(d=0,e=k.length;e>d;++d)a.cancel(k[d]);for(k.length=0,d=0,e=l.length;e>d;++d){var h=pa(j[d].clone);l[d].$destroy();var n=k[d]=a.leave(h);n.then(m(k,d))}j.length=0,l.length=0,(i=g.cases["!"+c]||g.cases["?"])&&f(i,function(c){c.transclude(function(d,e){l.push(e);var f=c.element;d[d.length++]=b.createComment(" end ngSwitchWhen: ");var g={clone:d};j.push(g),a.enter(d,f.parent(),f)})})})}}}],xg=ad({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,c,d,e){d.cases["!"+c.ngSwitchWhen]=d.cases["!"+c.ngSwitchWhen]||[],d.cases["!"+c.ngSwitchWhen].push({transclude:e,element:b})}}),yg=ad({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,c,d,e){d.cases["?"]=d.cases["?"]||[],d.cases["?"].push({transclude:e,element:b})}}),zg=ad({restrict:"EAC",link:function(a,b,c,e,f){if(!f)throw d("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",$(b));f(function(a){b.empty(),b.append(a)})}}),Ag=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,c){if("text/ng-template"==c.type){var d=c.id,e=b[0].text;a.put(d,e)}}}}],Bg={$setViewValue:p,$render:p},Cg=["$element","$scope","$attrs",function(a,d,e){var f=this,g=new Za;f.ngModelCtrl=Bg,f.unknownOption=Cd(b.createElement("option")),f.renderUnknownOption=function(b){var c="? "+Ya(b)+" ?";f.unknownOption.val(c),a.prepend(f.unknownOption),a.val(c)},d.$on("$destroy",function(){f.renderUnknownOption=p}),f.removeUnknownOption=function(){f.unknownOption.parent()&&f.unknownOption.remove()},f.readValue=function(){return f.removeUnknownOption(),a.val()},f.writeValue=function(b){f.hasOption(b)?(f.removeUnknownOption(),a.val(b),""===b&&f.emptyOption.prop("selected",!0)):null==b&&f.emptyOption?(f.removeUnknownOption(),a.val("")):f.renderUnknownOption(b)},f.addOption=function(a,b){na(a,'"option value"'),""===a&&(f.emptyOption=b);var c=g.get(a)||0;g.put(a,c+1),f.ngModelCtrl.$render(),td(b)},f.removeOption=function(a){var b=g.get(a);b&&(1===b?(g.remove(a),""===a&&(f.emptyOption=c)):g.put(a,b-1))},f.hasOption=function(a){return!!g.get(a)},f.registerOption=function(a,b,c,d,e){if(d){var g;c.$observe("value",function(a){u(g)&&f.removeOption(g),g=a,f.addOption(a,b)})}else e?a.$watch(e,function(a,d){c.$set("value",a),d!==a&&f.removeOption(d),f.addOption(a,b)}):f.addOption(c.value,b);b.on("$destroy",function(){f.removeOption(c.value),f.ngModelCtrl.$render()})}}],Dg=function(){function a(a,b,c,d){var e=d[1];if(e){var g=d[0];if(g.ngModelCtrl=e,e.$render=function(){g.writeValue(e.$viewValue)},b.on("change",function(){a.$apply(function(){e.$setViewValue(g.readValue())})}),c.multiple){g.readValue=function(){var a=[];return f(b.find("option"),function(b){b.selected&&a.push(b.value)}),a},g.writeValue=function(a){var c=new Za(a);f(b.find("option"),function(a){a.selected=u(c.get(a.value))})};var h,i=NaN;a.$watch(function(){i!==e.$viewValue||Q(h,e.$viewValue)||(h=P(e.$viewValue),e.$render()),i=e.$viewValue}),e.$isEmpty=function(a){return!a||0===a.length}}}}return{restrict:"E",require:["select","?ngModel"],controller:Cg,priority:1,link:{pre:a}}},Eg=["$interpolate",function(a){return{restrict:"E",priority:100,compile:function(b,c){if(u(c.value))var d=a(c.value,!0);else{var e=a(b.text(),!0);e||c.$set("value",b.text())}return function(a,b,c){var f="$selectController",g=b.parent(),h=g.data(f)||g.parent().data(f);h&&h.registerOption(a,b,c,d,e)}}}}],Fg=r({restrict:"E",terminal:!1}),Gg=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){d&&(c.required=!0,d.$validators.required=function(a,b){return!c.required||!d.$isEmpty(b)},c.$observe("required",function(){d.$validate()}))}}},Hg=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,e,f){if(f){var g,h=e.ngPattern||e.pattern;e.$observe("pattern",function(a){if(x(a)&&a.length>0&&(a=new RegExp("^"+a+"$")),a&&!a.test)throw d("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",h,a,$(b));g=a||c,f.$validate()}),f.$validators.pattern=function(a,b){return f.$isEmpty(b)||t(g)||g.test(b)}}}}},Ig=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){var e=-1;c.$observe("maxlength",function(a){var b=n(a);e=isNaN(b)?-1:b,d.$validate()}),d.$validators.maxlength=function(a,b){return 0>e||d.$isEmpty(b)||b.length<=e}}}}},Jg=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){var e=0;c.$observe("minlength",function(a){e=n(a)||0,d.$validate()}),d.$validators.minlength=function(a,b){return d.$isEmpty(b)||b.length>=e}}}}};a.angular.bootstrap||(ka(),ua(Ld),Ld.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}function d(a,d){var e=d;c===e&&(e=Math.min(b(a),3));var f=Math.pow(10,e),g=(a*f|0)%f;return{v:e,f:g}}var e={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",pluralCat:function(a,b){var c=0|a,f=d(a,b);return 1==c&&0==f.v?e.ONE:e.OTHER}})}]),Cd(b).ready(function(){fa(b,ga)}))}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(a,b,c){function d(a,b){return N(new(N(function(){},{prototype:a})),b)}function e(a){return M(arguments,function(b){b!==a&&M(b,function(b,c){a.hasOwnProperty(c)||(a[c]=b)})}),a}function f(a,b){var c=[];for(var d in a.path){if(a.path[d]!==b.path[d])break;c.push(a.path[d])}return c}function g(a){if(Object.keys)return Object.keys(a);var b=[];return M(a,function(a,c){b.push(c)}),b}function h(a,b){if(Array.prototype.indexOf)return a.indexOf(b,Number(arguments[2])||0);var c=a.length>>>0,d=Number(arguments[2])||0;for(d=0>d?Math.ceil(d):Math.floor(d),0>d&&(d+=c);c>d;d++)if(d in a&&a[d]===b)return d;return-1}function i(a,b,c,d){var e,i=f(c,d),j={},k=[];for(var l in i)if(i[l].params&&(e=g(i[l].params),e.length))for(var m in e)h(k,e[m])>=0||(k.push(e[m]),j[e[m]]=a[e[m]]);return N({},j,b)}function j(a,b,c){if(!c){c=[];for(var d in a)c.push(d)}for(var e=0;e<c.length;e++){var f=c[e];if(a[f]!=b[f])return!1}return!0}function k(a,b){var c={};return M(a,function(a){c[a]=b[a]}),c}function l(a){var b={},c=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return M(c,function(c){c in a&&(b[c]=a[c])}),b}function m(a){var b={},c=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var d in a)-1==h(c,d)&&(b[d]=a[d]);return b}function n(a,b){var c=L(a),d=c?[]:{};return M(a,function(a,e){b(a,e)&&(d[c?d.length:e]=a)}),d}function o(a,b){var c=L(a)?[]:{};return M(a,function(a,d){c[d]=b(a,d)}),c}function p(a,b){var d=1,f=2,i={},j=[],k=i,l=N(a.when(i),{$$promises:i,$$values:i});this.study=function(i){function n(a,c){if(s[c]!==f){if(r.push(c),s[c]===d)throw r.splice(0,h(r,c)),new Error("Cyclic dependency: "+r.join(" -> "));if(s[c]=d,J(a))q.push(c,[function(){return b.get(a)}],j);else{var e=b.annotate(a);M(e,function(a){a!==c&&i.hasOwnProperty(a)&&n(i[a],a)}),q.push(c,a,e)}r.pop(),s[c]=f}}function o(a){return K(a)&&a.then&&a.$$promises}if(!K(i))throw new Error("'invocables' must be an object");var p=g(i||{}),q=[],r=[],s={};return M(i,n),i=r=s=null,function(d,f,g){function h(){--u||(v||e(t,f.$$values),r.$$values=t,r.$$promises=r.$$promises||!0,delete r.$$inheritedValues,n.resolve(t))}function i(a){r.$$failure=a,n.reject(a)}function j(c,e,f){function j(a){l.reject(a),i(a)}function k(){if(!H(r.$$failure))try{l.resolve(b.invoke(e,g,t)),l.promise.then(function(a){t[c]=a,h()},j)}catch(a){j(a)}}var l=a.defer(),m=0;M(f,function(a){s.hasOwnProperty(a)&&!d.hasOwnProperty(a)&&(m++,s[a].then(function(b){t[a]=b,--m||k()},j))}),m||k(),s[c]=l.promise}if(o(d)&&g===c&&(g=f,f=d,d=null),d){if(!K(d))throw new Error("'locals' must be an object")}else d=k;if(f){if(!o(f))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else f=l;var n=a.defer(),r=n.promise,s=r.$$promises={},t=N({},d),u=1+q.length/3,v=!1;if(H(f.$$failure))return i(f.$$failure),r;f.$$inheritedValues&&e(t,m(f.$$inheritedValues,p)),N(s,f.$$promises),f.$$values?(v=e(t,m(f.$$values,p)),r.$$inheritedValues=m(f.$$values,p),h()):(f.$$inheritedValues&&(r.$$inheritedValues=m(f.$$inheritedValues,p)),f.then(h,i));for(var w=0,x=q.length;x>w;w+=3)d.hasOwnProperty(q[w])?h():j(q[w],q[w+1],q[w+2]);return r}},this.resolve=function(a,b,c,d){return this.study(a)(b,c,d)}}function q(a,b,c){this.fromConfig=function(a,b,c){return H(a.template)?this.fromString(a.template,b):H(a.templateUrl)?this.fromUrl(a.templateUrl,b):H(a.templateProvider)?this.fromProvider(a.templateProvider,b,c):null},this.fromString=function(a,b){return I(a)?a(b):a},this.fromUrl=function(c,d){return I(c)&&(c=c(d)),null==c?null:a.get(c,{cache:b,headers:{Accept:"text/html"}}).then(function(a){return a.data})},this.fromProvider=function(a,b,d){return c.invoke(a,null,d||{params:b})}}function r(a,b,e){function f(b,c,d,e){if(q.push(b),o[b])return o[b];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(b))throw new Error("Invalid parameter name '"+b+"' in pattern '"+a+"'");if(p[b])throw new Error("Duplicate parameter name '"+b+"' in pattern '"+a+"'");return p[b]=new P.Param(b,c,d,e),p[b]}function g(a,b,c,d){var e=["",""],f=a.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!b)return f;switch(c){case!1:e=["(",")"+(d?"?":"")];break;case!0:e=["?(",")?"];break;default:e=["("+c+"|",")?"]}return f+e[0]+b+e[1]}function h(e,f){var g,h,i,j,k;return g=e[2]||e[3],k=b.params[g],i=a.substring(m,e.index),h=f?e[4]:e[4]||("*"==e[1]?".*":null),j=P.type(h||"string")||d(P.type("string"),{pattern:new RegExp(h,b.caseInsensitive?"i":c)}),{id:g,regexp:h,segment:i,type:j,cfg:k}}b=N({params:{}},K(b)?b:{});var i,j=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,k=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,l="^",m=0,n=this.segments=[],o=e?e.params:{},p=this.params=e?e.params.$$new():new P.ParamSet,q=[];this.source=a;for(var r,s,t;(i=j.exec(a))&&(r=h(i,!1),!(r.segment.indexOf("?")>=0));)s=f(r.id,r.type,r.cfg,"path"),l+=g(r.segment,s.type.pattern.source,s.squash,s.isOptional),n.push(r.segment),m=j.lastIndex;t=a.substring(m);var u=t.indexOf("?");if(u>=0){var v=this.sourceSearch=t.substring(u);if(t=t.substring(0,u),this.sourcePath=a.substring(0,m+u),v.length>0)for(m=0;i=k.exec(v);)r=h(i,!0),s=f(r.id,r.type,r.cfg,"search"),m=j.lastIndex}else this.sourcePath=a,this.sourceSearch="";l+=g(t)+(b.strict===!1?"/?":"")+"$",n.push(t),this.regexp=new RegExp(l,b.caseInsensitive?"i":c),this.prefix=n[0],this.$$paramNames=q}function s(a){N(this,a)}function t(){function a(a){return null!=a?a.toString().replace(/\//g,"%2F"):a}function e(a){return null!=a?a.toString().replace(/%2F/g,"/"):a}function f(){return{strict:p,caseInsensitive:m}}function i(a){return I(a)||L(a)&&I(a[a.length-1])}function j(){for(;w.length;){var a=w.shift();if(a.pattern)throw new Error("You cannot override a type's .pattern at runtime.");b.extend(u[a.name],l.invoke(a.def))}}function k(a){N(this,a||{})}P=this;var l,m=!1,p=!0,q=!1,u={},v=!0,w=[],x={string:{encode:a,decode:e,is:function(a){return null==a||!H(a)||"string"==typeof a},pattern:/[^/]*/},"int":{encode:a,decode:function(a){return parseInt(a,10)},is:function(a){return H(a)&&this.decode(a.toString())===a},pattern:/\d+/},bool:{encode:function(a){return a?1:0},decode:function(a){return 0!==parseInt(a,10)},is:function(a){return a===!0||a===!1},pattern:/0|1/},date:{encode:function(a){return this.is(a)?[a.getFullYear(),("0"+(a.getMonth()+1)).slice(-2),("0"+a.getDate()).slice(-2)].join("-"):c},decode:function(a){if(this.is(a))return a;var b=this.capture.exec(a);return b?new Date(b[1],b[2]-1,b[3]):c},is:function(a){return a instanceof Date&&!isNaN(a.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:b.toJson,decode:b.fromJson,is:b.isObject,equals:b.equals,pattern:/[^/]*/},any:{encode:b.identity,decode:b.identity,equals:b.equals,pattern:/.*/}};t.$$getDefaultValue=function(a){if(!i(a.value))return a.value;if(!l)throw new Error("Injectable functions cannot be called at configuration time");return l.invoke(a.value)},this.caseInsensitive=function(a){return H(a)&&(m=a),m},this.strictMode=function(a){return H(a)&&(p=a),p},this.defaultSquashPolicy=function(a){if(!H(a))return q;if(a!==!0&&a!==!1&&!J(a))throw new Error("Invalid squash policy: "+a+". Valid policies: false, true, arbitrary-string");return q=a,a},this.compile=function(a,b){return new r(a,N(f(),b))},this.isMatcher=function(a){if(!K(a))return!1;var b=!0;return M(r.prototype,function(c,d){I(c)&&(b=b&&H(a[d])&&I(a[d]))}),b},this.type=function(a,b,c){if(!H(b))return u[a];if(u.hasOwnProperty(a))throw new Error("A type named '"+a+"' has already been defined.");return u[a]=new s(N({name:a},b)),c&&(w.push({name:a,def:c}),v||j()),this},M(x,function(a,b){u[b]=new s(N({name:b},a))}),u=d(u,{}),this.$get=["$injector",function(a){return l=a,v=!1,j(),M(x,function(a,b){u[b]||(u[b]=new s(a))}),this}],this.Param=function(a,b,d,e){function f(a){var b=K(a)?g(a):[],c=-1===h(b,"value")&&-1===h(b,"type")&&-1===h(b,"squash")&&-1===h(b,"array");return c&&(a={value:a}),a.$$fn=i(a.value)?a.value:function(){return a.value},a}function j(b,c,d){if(b.type&&c)throw new Error("Param '"+a+"' has two type configurations.");return c?c:b.type?b.type instanceof s?b.type:new s(b.type):"config"===d?u.any:u.string}function k(){var b={array:"search"===e?"auto":!1},c=a.match(/\[\]$/)?{array:!0}:{};return N(b,c,d).array}function m(a,b){var c=a.squash;if(!b||c===!1)return!1;if(!H(c)||null==c)return q;if(c===!0||J(c))return c;throw new Error("Invalid squash policy: '"+c+"'. Valid policies: false, true, or arbitrary string")}function p(a,b,d,e){var f,g,i=[{from:"",to:d||b?c:""},{from:null,to:d||b?c:""}];return f=L(a.replace)?a.replace:[],J(e)&&f.push({from:e,to:c}),g=o(f,function(a){return a.from}),n(i,function(a){return-1===h(g,a.from)}).concat(f)}function r(){if(!l)throw new Error("Injectable functions cannot be called at configuration time");var a=l.invoke(d.$$fn);if(null!==a&&a!==c&&!w.type.is(a))throw new Error("Default value ("+a+") for parameter '"+w.id+"' is not an instance of Type ("+w.type.name+")");return a}function t(a){function b(a){return function(b){return b.from===a}}function c(a){var c=o(n(w.replace,b(a)),function(a){return a.to});return c.length?c[0]:a}return a=c(a),H(a)?w.type.$normalize(a):r()}function v(){return"{Param:"+a+" "+b+" squash: '"+z+"' optional: "+y+"}"}var w=this;d=f(d),b=j(d,b,e);var x=k();b=x?b.$asArray(x,"search"===e):b,"string"!==b.name||x||"path"!==e||d.value!==c||(d.value="");var y=d.value!==c,z=m(d,y),A=p(d,x,y,z);N(this,{id:a,type:b,location:e,array:x,squash:z,replace:A,isOptional:y,value:t,dynamic:c,config:d,toString:v})},k.prototype={$$new:function(){return d(this,N(new k,{$$parent:this}))},$$keys:function(){for(var a=[],b=[],c=this,d=g(k.prototype);c;)b.push(c),c=c.$$parent;return b.reverse(),M(b,function(b){M(g(b),function(b){-1===h(a,b)&&-1===h(d,b)&&a.push(b)})}),a},$$values:function(a){var b={},c=this;return M(c.$$keys(),function(d){b[d]=c[d].value(a&&a[d])}),b},$$equals:function(a,b){var c=!0,d=this;return M(d.$$keys(),function(e){var f=a&&a[e],g=b&&b[e];d[e].type.equals(f,g)||(c=!1)}),c},$$validates:function(a){var d,e,f,g,h,i=this.$$keys();for(d=0;d<i.length&&(e=this[i[d]],f=a[i[d]],f!==c&&null!==f||!e.isOptional);d++){if(g=e.type.$normalize(f),!e.type.is(g))return!1;if(h=e.type.encode(g),b.isString(h)&&!e.type.pattern.exec(h))return!1}return!0},$$parent:c},this.ParamSet=k}function u(a,d){function e(a){var b=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(a.source);return null!=b?b[1].replace(/\\(.)/g,"$1"):""}function f(a,b){return a.replace(/\$(\$|\d{1,2})/,function(a,c){return b["$"===c?0:Number(c)]})}function g(a,b,c){if(!c)return!1;var d=a.invoke(b,b,{$match:c});return H(d)?d:!0}function h(d,e,f,g){function h(a,b,c){return"/"===p?a:b?p.slice(0,-1)+a:c?p.slice(1)+a:a}function m(a){function b(a){var b=a(f,d);return b?(J(b)&&d.replace().url(b),!0):!1}if(!a||!a.defaultPrevented){o&&d.url()===o;o=c;var e,g=j.length;for(e=0;g>e;e++)if(b(j[e]))return;k&&b(k)}}function n(){return i=i||e.$on("$locationChangeSuccess",m)}var o,p=g.baseHref(),q=d.url();return l||n(),{sync:function(){m()},listen:function(){return n()},update:function(a){return a?void(q=d.url()):void(d.url()!==q&&(d.url(q),d.replace()))},push:function(a,b,e){var f=a.format(b||{});null!==f&&b&&b["#"]&&(f+="#"+b["#"]),d.url(f),o=e&&e.$$avoidResync?d.url():c,e&&e.replace&&d.replace()},href:function(c,e,f){if(!c.validates(e))return null;var g=a.html5Mode();b.isObject(g)&&(g=g.enabled);var i=c.format(e);if(f=f||{},g||null===i||(i="#"+a.hashPrefix()+i),null!==i&&e&&e["#"]&&(i+="#"+e["#"]),i=h(i,g,f.absolute),!f.absolute||!i)return i;var j=!g&&i?"/":"",k=d.port();return k=80===k||443===k?"":":"+k,[d.protocol(),"://",d.host(),k,j,i].join("")}}}var i,j=[],k=null,l=!1;this.rule=function(a){if(!I(a))throw new Error("'rule' must be a function");return j.push(a),this},this.otherwise=function(a){if(J(a)){var b=a;a=function(){return b}}else if(!I(a))throw new Error("'rule' must be a function");return k=a,this},this.when=function(a,b){var c,h=J(b);if(J(a)&&(a=d.compile(a)),!h&&!I(b)&&!L(b))throw new Error("invalid 'handler' in when()");var i={matcher:function(a,b){return h&&(c=d.compile(b),b=["$match",function(a){return c.format(a)}]),N(function(c,d){return g(c,b,a.exec(d.path(),d.search()))},{prefix:J(a.prefix)?a.prefix:""})},regex:function(a,b){if(a.global||a.sticky)throw new Error("when() RegExp must not be global or sticky");return h&&(c=b,b=["$match",function(a){return f(c,a)}]),N(function(c,d){return g(c,b,a.exec(d.path()))},{prefix:e(a)})}},j={matcher:d.isMatcher(a),regex:a instanceof RegExp};for(var k in j)if(j[k])return this.rule(i[k](a,b));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(a){a===c&&(a=!0),l=a},this.$get=h,h.$inject=["$location","$rootScope","$injector","$browser"]}function v(a,e){function f(a){return 0===a.indexOf(".")||0===a.indexOf("^")}function m(a,b){if(!a)return c;var d=J(a),e=d?a:a.name,g=f(e);if(g){if(!b)throw new Error("No reference point given for path '"+e+"'");b=m(b);for(var h=e.split("."),i=0,j=h.length,k=b;j>i;i++)if(""!==h[i]||0!==i){if("^"!==h[i])break;if(!k.parent)throw new Error("Path '"+e+"' not valid for state '"+b.name+"'");k=k.parent}else k=b;h=h.slice(i).join("."),e=k.name+(k.name&&h?".":"")+h}var l=z[e];return!l||!d&&(d||l!==a&&l.self!==a)?c:l}function n(a,b){A[a]||(A[a]=[]),A[a].push(b)}function p(a){for(var b=A[a]||[];b.length;)q(b.shift())}function q(b){b=d(b,{self:b,resolve:b.resolve||{},toString:function(){return this.name}});var c=b.name;if(!J(c)||c.indexOf("@")>=0)throw new Error("State must have a valid name");if(z.hasOwnProperty(c))throw new Error("State '"+c+"'' is already defined");var e=-1!==c.indexOf(".")?c.substring(0,c.lastIndexOf(".")):J(b.parent)?b.parent:K(b.parent)&&J(b.parent.name)?b.parent.name:"";if(e&&!z[e])return n(e,b.self);for(var f in C)I(C[f])&&(b[f]=C[f](b,C.$delegates[f]));return z[c]=b,!b[B]&&b.url&&a.when(b.url,["$match","$stateParams",function(a,c){y.$current.navigable==b&&j(a,c)||y.transitionTo(b,a,{inherit:!0,location:!1})}]),p(c),
b}function r(a){return a.indexOf("*")>-1}function s(a){for(var b=a.split("."),c=y.$current.name.split("."),d=0,e=b.length;e>d;d++)"*"===b[d]&&(c[d]="*");return"**"===b[0]&&(c=c.slice(h(c,b[1])),c.unshift("**")),"**"===b[b.length-1]&&(c.splice(h(c,b[b.length-2])+1,Number.MAX_VALUE),c.push("**")),b.length!=c.length?!1:c.join("")===b.join("")}function t(a,b){return J(a)&&!H(b)?C[a]:I(b)&&J(a)?(C[a]&&!C.$delegates[a]&&(C.$delegates[a]=C[a]),C[a]=b,this):this}function u(a,b){return K(a)?b=a:b.name=a,q(b),this}function v(a,e,f,h,l,n,p,q,t){function u(b,c,d,f){var g=a.$broadcast("$stateNotFound",b,c,d);if(g.defaultPrevented)return p.update(),D;if(!g.retry)return null;if(f.$retry)return p.update(),E;var h=y.transition=e.when(g.retry);return h.then(function(){return h!==y.transition?A:(b.options.$retry=!0,y.transitionTo(b.to,b.toParams,b.options))},function(){return D}),p.update(),h}function v(a,c,d,g,i,j){function m(){var c=[];return M(a.views,function(d,e){var g=d.resolve&&d.resolve!==a.resolve?d.resolve:{};g.$template=[function(){return f.load(e,{view:d,locals:i.globals,params:n,notify:j.notify})||""}],c.push(l.resolve(g,i.globals,i.resolve,a).then(function(c){if(I(d.controllerProvider)||L(d.controllerProvider)){var f=b.extend({},g,i.globals);c.$$controller=h.invoke(d.controllerProvider,null,f)}else c.$$controller=d.controller;c.$$state=a,c.$$controllerAs=d.controllerAs,i[e]=c}))}),e.all(c).then(function(){return i.globals})}var n=d?c:k(a.params.$$keys(),c),o={$stateParams:n};i.resolve=l.resolve(a.resolve,o,i.resolve,a);var p=[i.resolve.then(function(a){i.globals=a})];return g&&p.push(g),e.all(p).then(m).then(function(a){return i})}var A=e.reject(new Error("transition superseded")),C=e.reject(new Error("transition prevented")),D=e.reject(new Error("transition aborted")),E=e.reject(new Error("transition failed"));return x.locals={resolve:null,globals:{$stateParams:{}}},y={params:{},current:x.self,$current:x,transition:null},y.reload=function(a){return y.transitionTo(y.current,n,{reload:a||!0,inherit:!1,notify:!0})},y.go=function(a,b,c){return y.transitionTo(a,b,N({inherit:!0,relative:y.$current},c))},y.transitionTo=function(b,c,f){c=c||{},f=N({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},f||{});var g,j=y.$current,l=y.params,o=j.path,q=m(b,f.relative),r=c["#"];if(!H(q)){var s={to:b,toParams:c,options:f},t=u(s,j.self,l,f);if(t)return t;if(b=s.to,c=s.toParams,f=s.options,q=m(b,f.relative),!H(q)){if(!f.relative)throw new Error("No such state '"+b+"'");throw new Error("Could not resolve '"+b+"' from state '"+f.relative+"'")}}if(q[B])throw new Error("Cannot transition to abstract state '"+b+"'");if(f.inherit&&(c=i(n,c||{},y.$current,q)),!q.params.$$validates(c))return E;c=q.params.$$values(c),b=q;var z=b.path,D=0,F=z[D],G=x.locals,I=[];if(f.reload){if(J(f.reload)||K(f.reload)){if(K(f.reload)&&!f.reload.name)throw new Error("Invalid reload state object");var L=f.reload===!0?o[0]:m(f.reload);if(f.reload&&!L)throw new Error("No such reload state '"+(J(f.reload)?f.reload:f.reload.name)+"'");for(;F&&F===o[D]&&F!==L;)G=I[D]=F.locals,D++,F=z[D]}}else for(;F&&F===o[D]&&F.ownParams.$$equals(c,l);)G=I[D]=F.locals,D++,F=z[D];if(w(b,c,j,l,G,f))return r&&(c["#"]=r),y.params=c,O(y.params,n),f.location&&b.navigable&&b.navigable.url&&(p.push(b.navigable.url,c,{$$avoidResync:!0,replace:"replace"===f.location}),p.update(!0)),y.transition=null,e.when(y.current);if(c=k(b.params.$$keys(),c||{}),f.notify&&a.$broadcast("$stateChangeStart",b.self,c,j.self,l).defaultPrevented)return a.$broadcast("$stateChangeCancel",b.self,c,j.self,l),p.update(),C;for(var M=e.when(G),P=D;P<z.length;P++,F=z[P])G=I[P]=d(G),M=v(F,c,F===b,M,G,f);var Q=y.transition=M.then(function(){var d,e,g;if(y.transition!==Q)return A;for(d=o.length-1;d>=D;d--)g=o[d],g.self.onExit&&h.invoke(g.self.onExit,g.self,g.locals.globals),g.locals=null;for(d=D;d<z.length;d++)e=z[d],e.locals=I[d],e.self.onEnter&&h.invoke(e.self.onEnter,e.self,e.locals.globals);return r&&(c["#"]=r),y.transition!==Q?A:(y.$current=b,y.current=b.self,y.params=c,O(y.params,n),y.transition=null,f.location&&b.navigable&&p.push(b.navigable.url,b.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===f.location}),f.notify&&a.$broadcast("$stateChangeSuccess",b.self,c,j.self,l),p.update(!0),y.current)},function(d){return y.transition!==Q?A:(y.transition=null,g=a.$broadcast("$stateChangeError",b.self,c,j.self,l,d),g.defaultPrevented||p.update(),e.reject(d))});return Q},y.is=function(a,b,d){d=N({relative:y.$current},d||{});var e=m(a,d.relative);return H(e)?y.$current!==e?!1:b?j(e.params.$$values(b),n):!0:c},y.includes=function(a,b,d){if(d=N({relative:y.$current},d||{}),J(a)&&r(a)){if(!s(a))return!1;a=y.$current.name}var e=m(a,d.relative);return H(e)?H(y.$current.includes[e.name])?b?j(e.params.$$values(b),n,g(b)):!0:!1:c},y.href=function(a,b,d){d=N({lossy:!0,inherit:!0,absolute:!1,relative:y.$current},d||{});var e=m(a,d.relative);if(!H(e))return null;d.inherit&&(b=i(n,b||{},y.$current,e));var f=e&&d.lossy?e.navigable:e;return f&&f.url!==c&&null!==f.url?p.href(f.url,k(e.params.$$keys().concat("#"),b||{}),{absolute:d.absolute}):null},y.get=function(a,b){if(0===arguments.length)return o(g(z),function(a){return z[a].self});var c=m(a,b||y.$current);return c&&c.self?c.self:null},y}function w(a,b,c,d,e,f){function g(a,b,c){function d(b){return"search"!=a.params[b].location}var e=a.params.$$keys().filter(d),f=l.apply({},[a.params].concat(e)),g=new P.ParamSet(f);return g.$$equals(b,c)}return!f.reload&&a===c&&(e===c.locals||a.self.reloadOnSearch===!1&&g(c,d,b))?!0:void 0}var x,y,z={},A={},B="abstract",C={parent:function(a){if(H(a.parent)&&a.parent)return m(a.parent);var b=/^(.+)\.[^.]+$/.exec(a.name);return b?m(b[1]):x},data:function(a){return a.parent&&a.parent.data&&(a.data=a.self.data=N({},a.parent.data,a.data)),a.data},url:function(a){var b=a.url,c={params:a.params||{}};if(J(b))return"^"==b.charAt(0)?e.compile(b.substring(1),c):(a.parent.navigable||x).url.concat(b,c);if(!b||e.isMatcher(b))return b;throw new Error("Invalid url '"+b+"' in state '"+a+"'")},navigable:function(a){return a.url?a:a.parent?a.parent.navigable:null},ownParams:function(a){var b=a.url&&a.url.params||new P.ParamSet;return M(a.params||{},function(a,c){b[c]||(b[c]=new P.Param(c,null,a,"config"))}),b},params:function(a){return a.parent&&a.parent.params?N(a.parent.params.$$new(),a.ownParams):new P.ParamSet},views:function(a){var b={};return M(H(a.views)?a.views:{"":a},function(c,d){d.indexOf("@")<0&&(d+="@"+a.parent.name),b[d]=c}),b},path:function(a){return a.parent?a.parent.path.concat(a):[]},includes:function(a){var b=a.parent?N({},a.parent.includes):{};return b[a.name]=!0,b},$delegates:{}};x=q({name:"",url:"^",views:null,"abstract":!0}),x.navigable=null,this.decorator=t,this.state=u,this.$get=v,v.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function w(){function a(a,b){return{load:function(c,d){var e,f={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return d=N(f,d),d.view&&(e=b.fromConfig(d.view,d.params,d.locals)),e&&d.notify&&a.$broadcast("$viewContentLoading",d),e}}}this.$get=a,a.$inject=["$rootScope","$templateFactory"]}function x(){var a=!1;this.useAnchorScroll=function(){a=!0},this.$get=["$anchorScroll","$timeout",function(b,c){return a?b:function(a){return c(function(){a[0].scrollIntoView()},0,!1)}}]}function y(a,c,d,e){function f(){return c.has?function(a){return c.has(a)?c.get(a):null}:function(a){try{return c.get(a)}catch(b){return null}}}function g(a,b){var c=function(){return{enter:function(a,b,c){b.after(a),c()},leave:function(a,b){a.remove(),b()}}};if(j)return{enter:function(a,b,c){var d=j.enter(a,null,b,c);d&&d.then&&d.then(c)},leave:function(a,b){var c=j.leave(a,b);c&&c.then&&c.then(b)}};if(i){var d=i&&i(b,a);return{enter:function(a,b,c){d.enter(a,null,b),c()},leave:function(a,b){d.leave(a),b()}}}return c()}var h=f(),i=h("$animator"),j=h("$animate"),k={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(c,f,h){return function(c,f,i){function j(){l&&(l.remove(),l=null),n&&(n.$destroy(),n=null),m&&(r.leave(m,function(){l=null}),l=m,m=null)}function k(g){var k,l=A(c,i,f,e),s=l&&a.$current&&a.$current.locals[l];if(g||s!==o){k=c.$new(),o=a.$current.locals[l];var t=h(k,function(a){r.enter(a,f,function(){n&&n.$emit("$viewContentAnimationEnded"),(b.isDefined(q)&&!q||c.$eval(q))&&d(a)}),j()});m=t,n=k,n.$emit("$viewContentLoaded"),n.$eval(p)}}var l,m,n,o,p=i.onload||"",q=i.autoscroll,r=g(i,c);c.$on("$stateChangeSuccess",function(){k(!1)}),c.$on("$viewContentLoading",function(){k(!1)}),k(!0)}}};return k}function z(a,b,c,d){return{restrict:"ECA",priority:-400,compile:function(e){var f=e.html();return function(e,g,h){var i=c.$current,j=A(e,h,g,d),k=i&&i.locals[j];if(k){g.data("$uiView",{name:j,state:k.$$state}),g.html(k.$template?k.$template:f);var l=a(g.contents());if(k.$$controller){k.$scope=e,k.$element=g;var m=b(k.$$controller,k);k.$$controllerAs&&(e[k.$$controllerAs]=m),g.data("$ngControllerController",m),g.children().data("$ngControllerController",m)}l(e)}}}}}function A(a,b,c,d){var e=d(b.uiView||b.name||"")(a),f=c.inheritedData("$uiView");return e.indexOf("@")>=0?e:e+"@"+(f?f.state.name:"")}function B(a,b){var c,d=a.match(/^\s*({[^}]*})\s*$/);if(d&&(a=b+"("+d[1]+")"),c=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!c||4!==c.length)throw new Error("Invalid state ref '"+a+"'");return{state:c[1],paramExpr:c[3]||null}}function C(a){var b=a.parent().inheritedData("$uiView");return b&&b.state&&b.state.name?b.state:void 0}function D(a,c){var d=["location","inherit","reload","absolute"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(e,f,g,h){var i=B(g.uiSref,a.current.name),j=null,k=C(f)||a.$current,l="[object SVGAnimatedString]"===Object.prototype.toString.call(f.prop("href"))?"xlink:href":"href",m=null,n="A"===f.prop("tagName").toUpperCase(),o="FORM"===f[0].nodeName,p=o?"action":l,q=!0,r={relative:k,inherit:!0},s=e.$eval(g.uiSrefOpts)||{};b.forEach(d,function(a){a in s&&(r[a]=s[a])});var t=function(c){if(c&&(j=b.copy(c)),q){m=a.href(i.state,j,r);var d=h[1]||h[0];return d&&d.$$addStateInfo(i.state,j),null===m?(q=!1,!1):void g.$set(p,m)}};i.paramExpr&&(e.$watch(i.paramExpr,function(a,b){a!==j&&t(a)},!0),j=b.copy(e.$eval(i.paramExpr))),t(),o||f.bind("click",function(b){var d=b.which||b.button;if(!(d>1||b.ctrlKey||b.metaKey||b.shiftKey||f.attr("target"))){var e=c(function(){a.go(i.state,j,r)});b.preventDefault();var g=n&&!m?1:0;b.preventDefault=function(){g--<=0&&c.cancel(e)}}})}}}function E(a,b,c){return{restrict:"A",controller:["$scope","$element","$attrs",function(b,d,e){function f(){g()?d.addClass(i):d.removeClass(i)}function g(){for(var a=0;a<j.length;a++)if(h(j[a].state,j[a].params))return!0;return!1}function h(b,c){return"undefined"!=typeof e.uiSrefActiveEq?a.is(b.name,c):a.includes(b.name,c)}var i,j=[];i=c(e.uiSrefActiveEq||e.uiSrefActive||"",!1)(b),this.$$addStateInfo=function(b,c){var e=a.get(b,C(d));j.push({state:e||{name:b},params:c}),f()},b.$on("$stateChangeSuccess",f)}]}}function F(a){var b=function(b){return a.is(b)};return b.$stateful=!0,b}function G(a){var b=function(b){return a.includes(b)};return b.$stateful=!0,b}var H=b.isDefined,I=b.isFunction,J=b.isString,K=b.isObject,L=b.isArray,M=b.forEach,N=b.extend,O=b.copy;b.module("ui.router.util",["ng"]),b.module("ui.router.router",["ui.router.util"]),b.module("ui.router.state",["ui.router.router","ui.router.util"]),b.module("ui.router",["ui.router.state"]),b.module("ui.router.compat",["ui.router"]),p.$inject=["$q","$injector"],b.module("ui.router.util").service("$resolve",p),q.$inject=["$http","$templateCache","$injector"],b.module("ui.router.util").service("$templateFactory",q);var P;r.prototype.concat=function(a,b){var c={caseInsensitive:P.caseInsensitive(),strict:P.strictMode(),squash:P.defaultSquashPolicy()};return new r(this.sourcePath+a+this.sourceSearch,N(c,b),this)},r.prototype.toString=function(){return this.source},r.prototype.exec=function(a,b){function c(a){function b(a){return a.split("").reverse().join("")}function c(a){return a.replace(/\\-/g,"-")}var d=b(a).split(/-(?!\\)/),e=o(d,b);return o(e,c).reverse()}var d=this.regexp.exec(a);if(!d)return null;b=b||{};var e,f,g,h=this.parameters(),i=h.length,j=this.segments.length-1,k={};if(j!==d.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(e=0;j>e;e++){g=h[e];var l=this.params[g],m=d[e+1];for(f=0;f<l.replace;f++)l.replace[f].from===m&&(m=l.replace[f].to);m&&l.array===!0&&(m=c(m)),k[g]=l.value(m)}for(;i>e;e++)g=h[e],k[g]=this.params[g].value(b[g]);return k},r.prototype.parameters=function(a){return H(a)?this.params[a]||null:this.$$paramNames},r.prototype.validates=function(a){return this.params.$$validates(a)},r.prototype.format=function(a){function b(a){return encodeURIComponent(a).replace(/-/g,function(a){return"%5C%"+a.charCodeAt(0).toString(16).toUpperCase()})}a=a||{};var c=this.segments,d=this.parameters(),e=this.params;if(!this.validates(a))return null;var f,g=!1,h=c.length-1,i=d.length,j=c[0];for(f=0;i>f;f++){var k=h>f,l=d[f],m=e[l],n=m.value(a[l]),p=m.isOptional&&m.type.equals(m.value(),n),q=p?m.squash:!1,r=m.type.encode(n);if(k){var s=c[f+1];if(q===!1)null!=r&&(j+=L(r)?o(r,b).join("-"):encodeURIComponent(r)),j+=s;else if(q===!0){var t=j.match(/\/$/)?/\/?(.*)/:/(.*)/;j+=s.match(t)[1]}else J(q)&&(j+=q+s)}else{if(null==r||p&&q!==!1)continue;L(r)||(r=[r]),r=o(r,encodeURIComponent).join("&"+l+"="),j+=(g?"&":"?")+(l+"="+r),g=!0}}return j},s.prototype.is=function(a,b){return!0},s.prototype.encode=function(a,b){return a},s.prototype.decode=function(a,b){return a},s.prototype.equals=function(a,b){return a==b},s.prototype.$subPattern=function(){var a=this.pattern.toString();return a.substr(1,a.length-2)},s.prototype.pattern=/.*/,s.prototype.toString=function(){return"{Type:"+this.name+"}"},s.prototype.$normalize=function(a){return this.is(a)?a:this.decode(a)},s.prototype.$asArray=function(a,b){function d(a,b){function d(a,b){return function(){return a[b].apply(a,arguments)}}function e(a){return L(a)?a:H(a)?[a]:[]}function f(a){switch(a.length){case 0:return c;case 1:return"auto"===b?a[0]:a;default:return a}}function g(a){return!a}function h(a,b){return function(c){c=e(c);var d=o(c,a);return b===!0?0===n(d,g).length:f(d)}}function i(a){return function(b,c){var d=e(b),f=e(c);if(d.length!==f.length)return!1;for(var g=0;g<d.length;g++)if(!a(d[g],f[g]))return!1;return!0}}this.encode=h(d(a,"encode")),this.decode=h(d(a,"decode")),this.is=h(d(a,"is"),!0),this.equals=i(d(a,"equals")),this.pattern=a.pattern,this.$normalize=h(d(a,"$normalize")),this.name=a.name,this.$arrayMode=b}if(!a)return this;if("auto"===a&&!b)throw new Error("'auto' array mode is for query parameters only");return new d(this,a)},b.module("ui.router.util").provider("$urlMatcherFactory",t),b.module("ui.router.util").run(["$urlMatcherFactory",function(a){}]),u.$inject=["$locationProvider","$urlMatcherFactoryProvider"],b.module("ui.router.router").provider("$urlRouter",u),v.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],b.module("ui.router.state").value("$stateParams",{}).provider("$state",v),w.$inject=[],b.module("ui.router.state").provider("$view",w),b.module("ui.router.state").provider("$uiViewScroll",x),y.$inject=["$state","$injector","$uiViewScroll","$interpolate"],z.$inject=["$compile","$controller","$state","$interpolate"],b.module("ui.router.state").directive("uiView",y),b.module("ui.router.state").directive("uiView",z),D.$inject=["$state","$timeout"],E.$inject=["$state","$stateParams","$interpolate"],b.module("ui.router.state").directive("uiSref",D).directive("uiSrefActive",E).directive("uiSrefActiveEq",E),F.$inject=["$state"],G.$inject=["$state"],b.module("ui.router.state").filter("isState",F).filter("includedByState",G)}(window,window.angular),function(a,b,c){function d(a,b,c){return a.addEventListener?void a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return r[a.which]?r[a.which]:s[a.which]?s[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a,b){return a.sort().join(",")===b.sort().join(",")}function g(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function h(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function i(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function j(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function k(){if(!q){q={};for(var a in r)a>95&&112>a||r.hasOwnProperty(a)&&(q[r[a]]=a)}return q}function l(a,b,c){return c||(c=k()[a]?"keydown":"keypress"),"keypress"==c&&b.length&&(c="keydown"),c}function m(a){return"+"===a?["+"]:(a=a.replace(/\+{2}/g,"+plus"),a.split("+"))}function n(a,b){var c,d,e,f=[];for(c=m(a),e=0;e<c.length;++e)d=c[e],u[d]&&(d=u[d]),b&&"keypress"!=b&&t[d]&&(d=t[d],f.push("shift")),j(d)&&f.push(d);return b=l(d,f,b),{key:d,modifiers:f,action:b}}function o(a,c){return null===a||a===b?!1:a===c?!0:o(a.parentNode,c)}function p(a){function c(a){a=a||{};var b,c=!1;for(b in u)a[b]?c=!0:u[b]=0;c||(x=!1)}function k(a,b,c,d,e,g){var h,i,k=[],l=c.type;if(!s._callbacks[a])return[];for("keyup"==l&&j(a)&&(b=[a]),h=0;h<s._callbacks[a].length;++h)if(i=s._callbacks[a][h],(d||!i.seq||u[i.seq]==i.level)&&l==i.action&&("keypress"==l&&!c.metaKey&&!c.ctrlKey||f(b,i.modifiers))){var m=!d&&i.combo==e,n=d&&i.seq==d&&i.level==g;(m||n)&&s._callbacks[a].splice(h,1),k.push(i)}return k}function l(a,b,c,d){s.stopCallback(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(h(b),i(b))}function m(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);if(b)return"keyup"==a.type&&v===b?void(v=!1):void s.handleKey(b,g(a),a)}function o(){clearTimeout(t),t=setTimeout(c,1e3)}function q(a,b,d,f){function g(b){return function(){x=b,++u[a],o()}}function h(b){l(d,b,a),"keyup"!==f&&(v=e(b)),setTimeout(c,10)}u[a]=0;for(var i=0;i<b.length;++i){var j=i+1===b.length,k=j?h:g(f||n(b[i+1]).action);r(b[i],k,f,a,i)}}function r(a,b,c,d,e){s._directMap[a+":"+c]=b,a=a.replace(/\s+/g," ");var f,g=a.split(" ");return g.length>1?void q(a,g,b,c):(f=n(a,c),s._callbacks[f.key]=s._callbacks[f.key]||[],k(f.key,f.modifiers,{type:f.action},d,a,e),void s._callbacks[f.key][d?"unshift":"push"]({callback:b,modifiers:f.modifiers,action:f.action,seq:d,level:e,combo:a}))}var s=this;if(a=a||b,!(s instanceof p))return new p(a);s.target=a,s._callbacks={},s._directMap={};var t,u={},v=!1,w=!1,x=!1;s._handleKey=function(a,b,d){var e,f=k(a,b,d),g={},h=0,i=!1;for(e=0;e<f.length;++e)f[e].seq&&(h=Math.max(h,f[e].level));for(e=0;e<f.length;++e)if(f[e].seq){if(f[e].level!=h)continue;i=!0,g[f[e].seq]=1,l(f[e].callback,d,f[e].combo,f[e].seq)}else i||l(f[e].callback,d,f[e].combo);var m="keypress"==d.type&&w;d.type!=x||j(a)||m||c(g),w=i&&"keydown"==d.type},s._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)r(a[d],b,c)},d(a,"keypress",m),d(a,"keydown",m),d(a,"keyup",m)}for(var q,r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},s={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},t={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},v=1;20>v;++v)r[111+v]="f"+v;for(v=0;9>=v;++v)r[v+96]=v;p.prototype.bind=function(a,b,c){var d=this;return a=a instanceof Array?a:[a],d._bindMultiple.call(d,a,b,c),d},p.prototype.unbind=function(a,b){var c=this;return c.bind.call(c,a,function(){},b)},p.prototype.trigger=function(a,b,c){var d=this;return d._directMap[a+":"+b]&&d._directMap[a+":"+b](c||{},a),d},p.prototype.reset=function(){var a=this;return a._callbacks={},a._directMap={},a},p.prototype.stopCallback=function(a,b){var c=this;return(" "+b.className+" ").indexOf(" mousetrap ")>-1?!1:o(b,c.target)?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},p.prototype.handleKey=function(){var a=this;return a._handleKey.apply(a,arguments)},p.init=function(){var a=p(b);for(var c in a)"_"!==c.charAt(0)&&(p[c]=function(b){return function(){return a[b].apply(a,arguments)}}(c))},p.init(),a.Mousetrap=p,"undefined"!=typeof module&&module.exports&&(module.exports=p),"function"==typeof define&&define.amd&&define(function(){return p})}(window,document),function(a){function b(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function c(a,c,f){var g=this;if(!g.recording)return void o.apply(g,arguments);if(b(f),"keydown"==f.type){for(1===a.length&&m&&e(),i=0;i<c.length;++i)d(c[i]);d(a)}else"keyup"==f.type&&l.length>0&&e()}function d(a){var b;for(b=0;b<l.length;++b)if(l[b]===a)return;l.push(a),1===a.length&&(m=!0)}function e(){j.push(l),l=[],m=!1,h()}function f(a){var b;for(b=0;b<a.length;++b)a[b].sort(function(a,b){return a.length>1&&1===b.length?-1:1===a.length&&b.length>1?1:a>b?1:-1}),a[b]=a[b].join("+")}function g(){k&&(f(j),k(j)),j=[],k=null,l=[]}function h(){clearTimeout(n),n=setTimeout(g,1e3)}var j=[],k=null,l=[],m=!1,n=null,o=a.prototype.handleKey;a.prototype.record=function(a){var b=this;b.recording=!0,k=function(){b.recording=!1,a.apply(b,arguments)}},a.prototype.handleKey=function(){var a=this;c.apply(a,arguments)},a.init()}(Mousetrap),R.countWatchers=function(){var a=angular.element(document.getElementsByTagName("body")),b=[],c=function e(a){angular.forEach(["$scope","$isolateScope"],function(c){a.data()&&a.data().hasOwnProperty(c)&&angular.forEach(a.data()[c].$$watchers,function(a){b.push(a)})}),angular.forEach(a.children(),function(a){e(angular.element(a))})};c(a);var d=[];angular.forEach(b,function(a){d.indexOf(a)<0&&d.push(a)})},R.curryService=function(){return function(a){R.pipe(R.keys,R.filter(R.compose(R.equals("Function"),R.type,R.flip(R.prop)(a))),R.reject(R.compose(R.not,R.isEmpty,R.match(/\$$/))),R.forEach(function(b){a[b+"$"]=R.curry(a[b])}))(a)}}(),R.extend=function(){return function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return R.forEach(function(b){for(var c in b)a[c]=b[c]},c),a}}(),R.deepExtend=function(){return function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];var e=/#{\s*?_\s*?}/;return R.forEach(function(b){for(var c in b)if(R.isNil(a[c])||"Function"===R.type(a[c])||"Date"===R.type(b[c]))a[c]=b[c];else if("String"===R.type(b[c])&&e.test(b[c]))"String"===R.type(a[c])&&(a[c]=b[c].replace(e,a[c]));else if("Array"===R.type(a[c])||"Array"===R.type(b[c])){if("Array"!==R.type(a[c])||"Array"!==R.type(b[c]))throw new Error("Trying to combine an array with a non-array ("+c+")");a[c]=R.deepExtend(a[c],b[c])}else if("Object"===R.type(a[c])||"Object"===R.type(b[c])){if("Object"!==R.type(a[c])||"Object"!==R.type(b[c]))throw new Error("Trying to combine an object with a non-object ("+c+")");a[c]=R.deepExtend(a[c],b[c])}else a[c]=b[c]},c),a}}(),R.exists=function(a){return!R.isNil(a)},R.promiseAll=R.bind(self.Promise.all,self.Promise),R.pipePromise=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return R.pipeP.apply(R,R.prepend(R.bind(self.Promise.resolve,self.Promise),b))},R.random=function(){var a=function b(a,c){var d=0,e=c-a,f=R.exists(Math.log2)?Math.ceil(Math.log2(e)):30;if(f>53)throw new self.Exception("We cannot generate numbers larger than 53 bits.");var g=Math.ceil(f/8),h=Math.pow(2,f)-1,i=new Uint8Array(g);self.crypto.getRandomValues(i);for(var j=8*(g-1),k=0;g>k;k++)d+=i[k]*Math.pow(2,j),j-=8;return d&=h,d>=e?b(a,c):a+d};return function(){return a(0,1e9)/1e9}}(),R.randomRange=function(a,b){return a+R.random()*(b-a+1)|0},R.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*R.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},R.rejectIf=R.curry(function(a,b,c){return a(c)?self.Promise.reject(b):c}),R.spy=function(){return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return function(a){return a}}}(),R.spyDebug=function(){return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return function(a){return a}}}(),R.spyInfo=function(){return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return function(a){return a}}}(),R.spyWarn=function(){return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return function(a){return a}}}(),R.spyError=function(){return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return function(a){return a}}}(),angular.module("clickApp.controllers",[]),angular.module("clickApp.directives",[]),angular.module("clickApp.filters",[]),angular.module("clickApp.services",[]),angular.module("clickApp",["ui.router","clickApp.controllers","clickApp.services","clickApp.filters","clickApp.directives"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/lounge"),a.state("lounge",{url:"/lounge",templateUrl:"partials/lounge.html",controller:"loungeCtrl",data:{}}).state("user",{url:"/user",templateUrl:"partials/user.html",controller:"userCtrl",data:{}}).state("settings",{"abstract":!0,url:"/settings",templateUrl:"partials/settings.html",controller:"settingsCtrl",data:{}}).state("settings.Main",{url:"/main",templateUrl:"partials/settings/main.html",controller:"settingsMainCtrl"}).state("settings.Models",{url:"/models",templateUrl:"partials/settings/models.html",controller:"settingsModelsCtrl"}).state("settings.Bindings",{url:"/bindings",templateUrl:"partials/settings/bindings.html",controller:"settingsBindingsCtrl"}).state("settings.Moves",{url:"/moves",templateUrl:"partials/settings/moves.html",controller:"settingsMovesCtrl"}).state("game",{"abstract":!0,url:"/game/:online/:private/:id",templateUrl:"partials/game.html",controller:"gameCtrl",data:{hide_nav:!0}}).state("game.main",{url:"/main",templateUrl:"partials/game/main.html",controller:"gameMainCtrl",data:{hide_nav:!0}}).state("game.model",{url:"/model",templateUrl:"partials/game/model.html",controller:"gameModelCtrl",data:{hide_nav:!0}}).state("game.setup",{url:"/setup",templateUrl:"partials/game/setup.html",controller:"gameSetupCtrl",data:{hide_nav:!0}}).state("game.save",{url:"/save",templateUrl:"partials/game/save.html",controller:"gameSaveCtrl",data:{hide_nav:!0}}).state("game.help",{url:"/help",templateUrl:"partials/game/help.html",controller:"gameHelpCtrl",data:{hide_nav:!0}}).state("game.log",{url:"/log",templateUrl:"partials/game/log.html",controller:"gameLogCtrl",data:{hide_nav:!0}}).state("game.online",{url:"/online",templateUrl:"partials/game/online.html",controller:"gameOnlineCtrl",data:{hide_nav:!0}}).state("debug",{url:"/debug",templateUrl:"partials/debug.html",controller:"debugCtrl"}).state("info",{url:"/info",templateUrl:"partials/info.html",controller:"infoCtrl",data:{}})}]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|blob):/)}]),angular.module("clickApp.controllers").controller("mainCtrl",["$scope","$state","state","user",function(a,b,c,d){a.state=c.init(),a.stateEvent=function(){for(var b=arguments.length,d=Array(b),e=0;b>e;e++)d[e]=arguments[e];return c.event.apply(null,[].concat(d,[a.state]))},a.onStateChangeEvent=function(b,d,e){var f=c.onChangeEvent(b,d,a.state);e.$on("$destroy",function(){f()})},a.digestOnStateChangeEvent=function(b,c){a.onStateChangeEvent(b,function(){c.$digest()},c)},a.reloadFactions=function(){c.event("Factions.reload",a.state)},a.userIsValid=function(){return d.isValid(a.state.user)},a.checkUser=function(){a.userIsValid()||b.go("user")},a.onStateChangeEvent("User.change",a.checkUser,a),a.digestOnStateChangeEvent("User.change",a),a.goToState=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];self.setTimeout(function(){b.go.apply(b,c)},100)},a.stateIs=function(a){return b.is(a)},a.stateMatches=function(a){return 0<=b.current.name.indexOf(a)},a.currentState=function(){return b.current}}]),angular.module("clickApp.controllers").controller("debugCtrl",["$scope",function(a){a.onStateChangeEvent("State.loadDumpFile",function(b,c){a.result=c,a.$digest()},a),a.onStateChangeEvent("Games.local.load",function(b,c){a.goToState("game",{where:"offline",id:c})},a),a.doLoadDumpFile=function(b){a.stateEvent("State.loadDumpFile",b[0])}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.controllers").controller("gameCtrl",["$scope","$stateParams","modes",function(a,b,c){function d(){a.action_bindings=R.pipe(R.path(["state","modes"]),c.currentModeBindings,R.clone)(a),a.action_buttons=R.pipe(R.path(["state","modes"]),c.currentModeButtons,R.clone)(a),a.$digest()}var e=R.propEq("online","online",b),f=R.propEq("private","private",b),g=R.prop("id",b);a.stateEvent("Game.load",e,f,g),a.$on("$destroy",function(){a.stateEvent("Modes.exit")}),a.digestOnStateChangeEvent("Game.load.success",a),a.digestOnStateChangeEvent("Game.layers.change",a),a.digestOnStateChangeEvent("Game.board.change",a),a.digestOnStateChangeEvent("Game.scenario.change",a),a.digestOnStateChangeEvent("Game.model.create.enable",a),a.digestOnStateChangeEvent("Game.template.create.enable",a),a.digestOnStateChangeEvent("Game.terrain.create.enable",a),a.onStateChangeEvent("Game.load.error",function(){a.goToState("lounge")},a),a.hints={},a.onStateChangeEvent("Game.chat",function(b,c){c.from!==a.user.state.name&&(a.hints.go_to_main=!a.stateIs("game.main"),a.$digest())},a),a.onStateChangeEvent("User.chat",function(b,c){c.from!==a.user.state.stamp&&(a.hints.go_to_online=!a.stateIs("game.online"),a.$digest())},a),a.onStateChangeEvent("Modes.change",d,a),a.onStateChangeEvent("Game.loaded",d,a),a.currentModeName=function(){return R.pipe(R.pathOr({},["state","modes"]),c.currentModeName)(a)},a.currentModeIs=function(b){return a.currentModeName()===b},a.show_action_group=null,a.doModeAction=function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];a.stateEvent("Modes.current.action",b,[].concat(d,[{}]))},a.doActionButton=function(b){var c=_slicedToArray(b,3),d=c[0],e=c[1],f=c[2];return d=d,"toggle"===e?void(a.show_action_group=a.show_action_group===f?null:f):void a.stateEvent("Modes.current.action",e,[{}])}}]),angular.module("clickApp.controllers").controller("gameHelpCtrl",["$scope","modes",function(a,b){function c(){a.dump=R.path(["state","exports","dump"],a),a.$digest()}function d(){a.bindings=R.pipe(R.path(["state","modes"]),b.currentModeBindingsPairs)(a),a.$digest()}a.onStateChangeEvent("Exports.dump",c,a),self.requestAnimationFrame(c),a.onStateChangeEvent("Modes.change",d,a),self.requestAnimationFrame(d)}]),angular.module("clickApp.controllers").controller("gameLogCtrl",["$scope",function(a){function b(){a.undo=R.path(["state","game","undo"],a),a.undo_log=R.path(["state","game","undo_log"],a),a.commands_log=R.path(["state","game","commands_log"],a),a.commands=R.path(["state","game","commands"],a),a.$digest()}a.onStateChangeEvent("Game.command.execute",b,a),a.onStateChangeEvent("Game.command.replay",b,a),a.onStateChangeEvent("Game.command.undo",b,a),
a.onStateChangeEvent("Game.loaded",b,a),self.requestAnimationFrame(b)}]),angular.module("clickApp.controllers").controller("gameMainCtrl",["$scope",function(a){a.hints.go_to_main=!1,a.doUseRuler=function(){a.currentModeIs("Ruler")?a.doModeAction("modeBackToDefault"):a.doModeAction("enterRulerMode")},a.doToggleShowRuler=function(){a.stateEvent("Game.command.execute","setRuler",["toggleDisplay",[]])},a.digestOnStateChangeEvent("Game.ruler.remote.change",a),a.doUseLos=function(){a.currentModeIs("LoS")?a.doModeAction("modeBackToDefault"):a.doModeAction("enterLosMode")},a.doToggleShowLos=function(){a.stateEvent("Game.command.execute","setLos",["toggleDisplay",[]])},a.digestOnStateChangeEvent("Game.los.remote.change",a),a.doCreateTemplate=function(b){a.stateEvent("Game.template.create",b)}}]),angular.module("clickApp.controllers").controller("gameModelCtrl",["$scope",function(a){function b(){a.factions=R.path(["state","factions","current"],a),a.faction=R.head(R.keys(a.factions)),a.onFactionChange(),a.$digest()}function c(){var b=a.getEntries();return R.isNil(b)?[a.faction,"models",a.section,a.entry]:[a.faction,"models",a.section,a.entry,"entries",a.type,a.model]}a.state.data_ready.then(b),a.onFactionChange=function(){a.section=R.head(R.keys(a.factions[a.faction].models)),a.onSectionChange()},a.onSectionChange=function(){a.entry=R.head(R.keys(a.factions[a.faction].models[a.section])),a.onEntryChange()},a.onEntryChange=function(){var b=a.getEntries();return R.isNil(b)?(a.model=a.entry,void a.onModelChange()):(a.type=R.head(R.keys(b)),void a.onTypeChange())},a.onTypeChange=function(){var b=a.getEntries();a.model=R.pipe(R.defaultTo({}),R.prop(a.type),R.defaultTo({}),R.keys(),R.head())(b),a.onModelChange()},a.onModelChange=function(){a.repeat=1},a.getEntries=function(){return R.path([a.faction,"models",a.section,a.entry,"entries"],a.factions)},a.getModel=function(){var b=a.getEntries();return R.isNil(b)?R.path([a.faction,"models",a.section,a.entry],a.factions):R.path([a.type,a.model],b)},a.doCreateModel=function(){var b=c();a.stateEvent("Game.model.create",b,a.repeat)},a["import"]={list:null},a.doImportList=function(){a.stateEvent("Game.model.importList",a["import"].list)},a.doImportModelsFile=function(b){a.stateEvent("Game.model.importFile",b[0])}}]),angular.module("clickApp.controllers").controller("gameOnlineCtrl",["$scope","user",function(a,b){}]),angular.module("clickApp.controllers").controller("gameSaveCtrl",["$scope","fileExport","game","gameModels","gameModelSelection","gameTerrains",function(a){function b(){a.exports=R.path(["state","exports"],a),a.$digest()}a.onStateChangeEvent("Exports.game",b,a),a.onStateChangeEvent("Exports.board",b,a),a.onStateChangeEvent("Exports.models",b,a),self.requestAnimationFrame(b)}]),angular.module("clickApp.controllers").controller("gameSetupCtrl",["$scope","gameBoard","gameScenario",function(a,b,c){function d(){a.board_name=R.path(["state","game","board","name"],a),a.$digest()}function e(){a.scenario_name=R.path(["state","game","scenario","name"],a),a.scenario_group=c.groupForName(a.scenario_name,a.scenarios),a.$digest()}function f(){a.layers=R.path(["state","game","layers"],a),a.$digest()}function g(){return[a.ambiance,a.category,a.entry]}a.$on("$destroy",function(){a.state.changeEvent("Game.scenario.refresh")}),a.state.changeEvent("Game.scenario.refresh"),a.state.data_ready.then(function(){a.boards=a.state.boards,a.terrains=a.state.terrains,a.scenarios=a.state.scenarios,a.ambiance=R.head(R.keys(a.terrains)),a.onAmbianceChange(),a.$digest()}),a.onStateChangeEvent("Game.board.change",d,a),self.requestAnimationFrame(d),a.doSetBoard=function(){a.stateEvent("Game.board.set",a.board_name)},a.doSetRandomBoard=function(){a.stateEvent("Game.board.setRandom")},a.onStateChangeEvent("Game.scenario.change",e,a),self.requestAnimationFrame(e),a.doSetScenario=function(){a.stateEvent("Game.scenario.set",a.scenario_name,a.scenario_group)},a.doSetRandomScenario=function(){a.stateEvent("Game.scenario.setRandom")},a.doGenerateObjectives=function(){a.stateEvent("Game.scenario.generateObjectives")},a.onStateChangeEvent("Game.layers.change",f,a),a.onStateChangeEvent("Game.load.success",f,a),self.requestAnimationFrame(f),a.doToggleLayer=function(b){a.stateEvent("Game.command.execute","setLayers",["toggle",b])},a.onAmbianceChange=function(){a.category=R.head(R.keys(a.terrains[a.ambiance])),a.onCategoryChange()},a.onCategoryChange=function(){a.entry=R.head(R.keys(a.terrains[a.ambiance][a.category])),a.onEntryChange()},a.onEntryChange=function(){},a.getTerrain=function(){return R.path([a.ambiance,a.category,a.entry],a.terrains)},a.doCreateTerrain=function(){var b=g();a.stateEvent("Game.terrain.create",b)},a.doResetTerrain=function(){a.stateEvent("Game.terrain.reset")},a.doImportBoardFile=function(b){a.stateEvent("Game.board.importFile",b[0])}}]),angular.module("clickApp.controllers").controller("infoCtrl",[function(){}]),angular.module("clickApp.controllers").controller("loungeCtrl",["$scope",function(a){a.onStateChangeEvent("Games.local.load",function(b,c){a.goToState("game.main",{online:"offline","private":"private",id:c}),a.$digest()},a),a.local_games_selection={},a.digestOnStateChangeEvent("Games.local.change",a),a.doCreateLocalGame=function(){a.stateEvent("Games.local.create")},a.doLoadLocalGame=function(){a.stateEvent("Games.local.load",a.local_games_selection.list[0])},a.doOpenLocalGameFile=function(b){a.stateEvent("Games.local.loadFile",b[0])},a.doDeleteLocalGame=function(){a.stateEvent("Games.local.delete",a.local_games_selection.list[0])},a.doUserToggleOnline=function(){a.stateEvent("User.toggleOnline")}}]),angular.module("clickApp.controllers").controller("settingsCtrl",["$scope",function(a){function b(){a.edit_settings=JSON.parse(JSON.stringify(a.state.settings.current)),a.menu=R.concat(["Main","Models"],R.keys(a.state.settings["default"])),a.$digest()}a.state.data_ready.then(b),a.onStateChangeEvent("Settings.change",b,a),a.doUpdateSettings=function(){a.stateEvent("Settings.reset",a.edit_settings)}}]),angular.module("clickApp.controllers").controller("settingsBindingsCtrl",["$scope",function(a){function b(){a.modes=R.keys(a.state.settings["default"].Bindings).sort(),a.mode=R.defaultTo(R.head(a.modes),a.mode)}a.getBindingsKeys=function(b){return R.keys(a.state.settings["default"].Bindings[b]).sort()},a.state.data_ready.then(b),a.doRecordBinding=function(b){a.recording||(a.recording=b,R.pipeP(function(){return new self.Promise(function(a){Mousetrap.record(function(b){a(b)})})},function(c){R.isNil(c)||R.isEmpty(c)||(a.edit_settings.Bindings[a.mode][b]=c.join(" "))},function(){a.recording=null,a.$digest()})())},a.$on("$destroy",a.doUpdateSettings)}]),angular.module("clickApp.controllers").controller("settingsMainCtrl",["$scope",function(a){a.digestOnStateChangeEvent("Exports.settings",a),a.onStateChangeEvent("Settings.loadFile",function(b,c){a.load_settings_result=c,a.$digest()},a),a.doLoadSettingsFile=function(b){a.stateEvent("Settings.loadFile",b[0])},a.doResetSettings=function(){a.stateEvent("Settings.reset",{})}}]),angular.module("clickApp.controllers").controller("settingsModelsCtrl",["$scope",function(a){a.hasDesc=function(b){return"Object"===R.type(R.path(["state","factions","desc",b],a))},a.digestOnStateChangeEvent("Factions.change",a),a.onStateChangeEvent("Factions.loadDescFile",function(b,c){a.result=c,a.$digest()},a),a.doOpenFactionFile=function(b,c){a.stateEvent("Factions.loadDescFile",b,c[0])},a.doClearFactionDesc=function(b){a.stateEvent("Factions.clearDesc",b)},a.doClearAllDesc=function(){a.stateEvent("Factions.clearAllDesc")}}]),angular.module("clickApp.controllers").controller("settingsMovesCtrl",["$scope",function(a){function b(){a.modes=R.keys(a.state.settings["default"].Moves).sort(),a.mode=R.defaultTo(R.head(a.modes),a.mode)}a.state.data_ready.then(b),a.$on("$destroy",a.doUpdateSettings)}]),angular.module("clickApp.controllers").controller("userCtrl",["$scope","$state","user",function(a,b){a.state.user_ready.then(function(){a.edit_user=R.clone(a.state.user.state),a.$digest()}),a.doSaveUser=function(){b.go("lounge"),a.stateEvent("User.set",a.edit_user)}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("commands",[function(){var a={},b={registerCommand:function(b,c){a[b]=c},execute:function(b,c,d,e){return R.pipePromise(R.prop(b),R.rejectIf(R.isNil,'execute unknown command "'+b+'"'),function(a){return a.execute.apply(null,[].concat(_toConsumableArray(c),[d,e]))},function(a){var c=_slicedToArray(a,2),d=c[0],e=c[1];return[R.assoc("type",b,d),e]})(a)},undo:function(b,c,d){return R.pipePromise(R.prop(b.type),R.rejectIf(R.isNil,'undo unknown command "'+b.type+'"'),function(a){return a.undo(b,c,d)})(a)},replay:function(b,c,d){return R.pipePromise(R.prop(b.type),R.rejectIf(R.isNil,"replay unknown command "+b.type),function(a){return a.replay(b,c,d)})(a)},replayBatch:function(a,c,d){return R.pipePromise(function(){return R.isEmpty(a)?d:R.pipeP(function(d){return b.replay(a[0],c,d)["catch"](R.always(d))},b.replayBatch$(R.tail(a),c))(d)})()}};return R.curryService(b),b}]).factory("allCommands",["createModelCommand","deleteModelCommand","setModelSelectionCommand","lockModelsCommand","onModelsCommand","createTemplateCommand","deleteTemplatesCommand","lockTemplatesCommand","onTemplatesCommand","createTerrainCommand","deleteTerrainCommand","lockTerrainsCommand","onTerrainsCommand","rollDiceCommand","rollDeviationCommand","setBoardCommand","setLayersCommand","setLosCommand","setRulerCommand","setScenarioCommand",function(){return{}}]),angular.module("clickApp.services").factory("createModelCommand",["commands","point","model","gameModels","gameModelSelection",function(a,b,c,d,e){var f={execute:function(a,f,g,h){var i=b.addToWithFlip$(f);return R.pipePromise(R.prop("models"),R.map(function(b){return R.pipe(i(a.base),R.omit(["stamp"]),function(a){return c.create(g.factions,a)["catch"](R.always(null))})(b)}),R.promiseAll,R.reject(R.isNil),function(a){if(R.isEmpty(a))return self.Promise.reject("No valid model definition");var b={models:R.map(c.saveState,a),desc:a[0].state.info.join(".")};return R.pipe(d.add$(a),function(b){return h=R.assoc("models",b,h),e.set("local",R.map(R.path(["state","stamp"]),a),g,h.model_selection)},function(a){return h=R.assoc("model_selection",a,h),g.changeEvent("Game.model.create"),[b,h]})(h.models)})(a)},replay:function(a,b,f){return R.pipePromise(R.prop("models"),R.map(function(a){return c.create(b.factions,a)["catch"](R.always(null))}),R.promiseAll,R.reject(R.isNil),function(a){return R.isEmpty(a)?self.Promise.reject("No valid model definition"):R.pipe(d.add$(a),function(c){return f=R.assoc("models",c,f),e.set("remote",R.map(R.path(["state","stamp"]),a),b,f.model_selection)},function(a){return f=R.assoc("model_selection",a,f),b.changeEvent("Game.model.create"),f})(f.models)})(a)},undo:function(a,b,c){var f=R.pluck("stamp",a.models);return c=R.pipe(R.over(R.lensProp("models"),d.removeStamps$(f)),R.over(R.lensProp("model_selection"),e.removeFrom$("local",f,b)),R.over(R.lensProp("model_selection"),e.removeFrom$("remote",f,b)))(c),R.forEach(function(a){b.changeEvent("Game.model.delete."+a)},f),b.changeEvent("Game.model.create"),c}};return a.registerCommand("createModel",f),f}]),angular.module("clickApp.services").factory("deleteModelCommand",["commands","model","gameModels","gameModelSelection",function(a,b,c,d){var e={execute:function(a,e,f){return R.pipeP(function(a){return c.findAnyStamps(a,f.models)},R.reject(R.isNil),R.map(b.saveState),function(b){var g={models:b,desc:""};return R.pipe(c.removeStamps$(a),function(b){return f=R.assoc("models",b,f),d.removeFrom("local",a,e,f.model_selection)},d.removeFrom$("remote",a,e),function(b){return f=R.assoc("model_selection",b,f),R.forEach(function(a){e.changeEvent("Game.model.delete."+a)},a),e.changeEvent("Game.model.create"),[g,f]})(f.models)})(a)},replay:function(a,b,e){return R.pipe(R.pluck("stamp"),function(a){return R.pipe(function(){return c.removeStamps(a,e.models)},function(c){return e=R.assoc("models",c,e),d.removeFrom("local",a,b,e.model_selection)},d.removeFrom$("remote",a,b),function(c){return e=R.assoc("model_selection",c,e),R.forEach(function(a){b.changeEvent("Game.model.delete."+a)},a),b.changeEvent("Game.model.create"),e})()})(a.models)},undo:function(a,e,f){return R.pipePromise(R.map(function(a){return b.create(e.factions,a)["catch"](R.always(null))}),R.promiseAll,R.reject(R.isNil),function(a){return R.isEmpty(a)?self.Promise.reject("No valid model definition"):R.pipe(c.add$(a),function(b){f=R.assoc("models",b,f);var c=R.map(R.path(["state","stamp"]),a);return d.set("remote",c,e,f.model_selection)},function(a){return f=R.assoc("model_selection",a,f),e.changeEvent("Game.model.create"),f})(f.models)})(a.models)}};return a.registerCommand("deleteModel",e),e}]),angular.module("clickApp.services").factory("setModelSelectionCommand",["commands","gameModelSelection",function(a,b){var c={execute:function(a,c,d,e){if("Function"!==R.type(b[a]))return self.Promise.reject("SetModelSelection unknown method "+a);var f=b[a]("local",c,d,e.model_selection);e=R.assoc("model_selection",f,e);var g={after:b.get("local",e.model_selection),desc:"",do_not_log:!0};return[g,e]},replay:function(a,c,d){var e=b.set("remote",a.after,c,d.model_selection);return d=R.assoc("model_selection",e,d)},undo:function(){return self.Promise.reject("!!! ERROR : WE SHOULD NOT BE HERE !!!")}};return a.registerCommand("setModelSelection",c),c}]),angular.module("clickApp.services").factory("onModelsCommand",["commands","model","gameModels","gameModelSelection",function(a,b,c,d){var e={execute:function(a,d,e,f,g){if("Function"!==R.type(b[a]))return self.Promise.reject("Unknown method "+a+" on model");var h={before:[],after:[],desc:a};return R.pipeP(c.fromStamps$("saveState",[],e),function(b){return h.before=b,c.onStamps(a,d,e,g.models)},function(a){return g=R.assoc("models",a,g),c.fromStamps("saveState",[],e,g.models)},function(a){return h.after=a,R.forEach(function(a){f.changeEvent("Game.model.change."+a)},e),[h,g]})(g.models)},replay:function(a,b,e){var f=R.pluck("stamp",a.after);return R.pipeP(c.setStateStamps$(a.after,f),function(a){return e=R.assoc("models",a,e),d.set("remote",f,b,e.model_selection)},function(a){return e=R.assoc("model_selection",a,e),R.forEach(function(a){b.changeEvent("Game.model.change."+a)},f),e})(e.models)},undo:function(a,b,e){var f=R.pluck("stamp",a.before);return R.pipeP(c.setStateStamps$(a.before,f),function(a){return e=R.assoc("models",a,e),d.set("remote",f,b,e.model_selection)},function(a){return e=R.assoc("model_selection",a,e),R.forEach(function(a){b.changeEvent("Game.model.change."+a)},f),e})(e.models)}};return a.registerCommand("onModels",e),e}]),angular.module("clickApp.services").factory("lockModelsCommand",["commands","gameModels",function(a,b){var c={execute:function(a,c,d,e){var f={desc:a,stamps:c};return R.pipeP(b.lockStamps$(a,c),function(a){return e=R.assoc("models",a,e),R.forEach(function(a){d.changeEvent("Game.model.change."+a)},c),[f,e]})(e.models)},replay:function(a,c,d){return R.pipeP(b.lockStamps$(a.desc,a.stamps),function(b){return d=R.assoc("models",b,d),R.forEach(function(a){c.changeEvent("Game.model.change."+a)},a.stamps),d})(d.models)},undo:function(a,c,d){return R.pipeP(b.lockStamps$(!a.desc,a.stamps),function(b){return d=R.assoc("models",b,d),R.forEach(function(a){c.changeEvent("Game.model.change."+a)},a.stamps),d})(d.models)}};return a.registerCommand("lockModels",c),c}]),angular.module("clickApp.services").factory("createTemplateCommand",["commands","point","template","gameTemplates","gameTemplateSelection",function(a,b,c,d,e){var f={execute:function(a,f,g,h){var i=b.addToWithFlip$(f);return R.pipePromise(R.prop("templates"),R.map(function(b){return R.pipe(i(a.base),R.omit(["stamp"]),function(a){return c.create(a)["catch"](R.always(null))})(b)}),R.promiseAll,R.reject(R.isNil),function(a){if(R.isEmpty(a))return self.Promise.reject("No valid template definition");var b={templates:R.map(c.saveState,a),desc:a[0].type};return R.pipe(d.add$(a),function(b){return h=R.assoc("templates",b,h),e.set("local",R.map(R.path(["state","stamp"]),a),g,h.template_selection)},function(a){return h=R.assoc("template_selection",a,h),g.changeEvent("Game.template.create"),[b,h]})(h.templates)})(a)},replay:function(a,b,f){return R.pipePromise(R.map(function(a){return c.create(a)["catch"](R.always(null))}),R.promiseAll,R.reject(R.isNil),function(a){return R.isEmpty(a)?self.Promise.reject("No valid template definition"):a},function(a){return R.pipe(d.add$(a),function(c){return f=R.assoc("templates",c,f),e.set("remote",R.map(R.path(["state","stamp"]),a),b,f.template_selection)},function(a){return f=R.assoc("template_selection",a,f),b.changeEvent("Game.template.create"),f})(f.templates)})(a.templates)},undo:function(a,b,c){return R.pipe(R.pluck("stamp"),function(a){return R.pipe(d.removeStamps$(a),function(d){return c=R.assoc("templates",d,c),e.removeFrom("local",a,b,c.template_selection)},function(d){return c=R.assoc("template_selection",d,c),e.removeFrom("remote",a,b,c.template_selection)},function(a){return c=R.assoc("template_selection",a,c),b.changeEvent("Game.template.create"),c})(c.templates)})(a.templates)}};return a.registerCommand("createTemplate",f),f}]),angular.module("clickApp.services").factory("deleteTemplatesCommand",["commands","template","gameTemplates","gameTemplateSelection",function(a,b,c,d){var e={execute:function(a,e,f){return R.pipeP(c.findAnyStamps$(a),R.reject(R.isNil),R.map(b.saveState),function(b){var g={templates:b,desc:""};return R.pipe(c.removeStamps$(a),function(b){return f=R.assoc("templates",b,f),d.removeFrom("local",a,e,f.template_selection)},d.removeFrom$("remote",a,e),function(a){return f=R.assoc("template_selection",a,f),e.changeEvent("Game.template.create"),[g,f]})(f.templates)})(f.templates)},replay:function(a,b,e){return R.pipe(R.pluck("stamp"),function(a){return R.pipe(c.removeStamps$(a),function(c){return e=R.assoc("templates",c,e),d.removeFrom("local",a,b,e.template_selection)},d.removeFrom$("remote",a,b),function(a){return e=R.assoc("template_selection",a,e),b.changeEvent("Game.template.create"),e})(e.templates)})(a.templates)},undo:function(a,e,f){return R.pipePromise(R.map(b.create),R.promiseAll,R.reject(R.isNil),function(a){return R.isEmpty(a)?self.Promise.reject("No valid template definition"):R.pipe(c.add$(a),function(b){return f=R.assoc("templates",b,f),d.set("remote",R.map(R.path(["state","stamp"]),a),e,f.template_selection)},function(a){return f=R.assoc("template_selection",a,f),e.changeEvent("Game.template.create"),f})(f.templates)})(a.templates)}};return a.registerCommand("deleteTemplates",e),e}]),angular.module("clickApp.services").factory("lockTemplatesCommand",["commands","gameTemplates",function(a,b){var c={execute:function(a,c,d,e){var f={stamps:c,desc:a};return R.pipeP(b.lockStamps$(a,c),function(a){return e=R.assoc("templates",a,e),d.changeEvent("Game.template.create"),[f,e]})(e.templates)},replay:function(a,c,d){return R.pipeP(b.lockStamps$(a.desc,a.stamps),function(a){return d=R.assoc("templates",a,d),c.changeEvent("Game.template.create"),d})(d.templates)},undo:function(a,c,d){return R.pipeP(b.lockStamps$(!a.desc,a.stamps),function(a){return d=R.assoc("templates",a,d),c.changeEvent("Game.template.create"),d})(d.templates)}};return a.registerCommand("lockTemplates",c),c}]),angular.module("clickApp.services").factory("onTemplatesCommand",["commands","template","gameTemplates","gameTemplateSelection",function(a,b,c,d){var e={execute:function(a,b,d,e,f){var g={before:[],after:[],desc:a};return R.pipePromise(c.fromStamps$("saveState",[],d),function(e){return g.before=e,c.onStamps(a,b,d,f.templates)},function(a){return f=R.assoc("templates",a,f),c.fromStamps("saveState",[],d,f.templates)},function(a){return g.after=a,R.forEach(function(a){e.changeEvent("Game.template.change."+a)},d),[g,f]})(f.templates)},replay:function(a,b,e){var f=R.pluck("stamp",a.after);return R.pipePromise(c.setStateStamps$(a.after,f),function(a){return e=R.assoc("templates",a,e),d.set("remote",f,b,e.template_selection)},function(a){return e=R.assoc("template_selection",a,e),R.forEach(function(a){b.changeEvent("Game.template.change."+a)},f),e})(e.templates)},undo:function(a,b,e){var f=R.pluck("stamp",a.before);return R.pipePromise(c.setStateStamps$(a.before,f),function(a){return e=R.assoc("templates",a,e),d.set("remote",f,b,e.template_selection)},function(a){return e=R.assoc("template_selection",a,e),R.forEach(function(a){b.changeEvent("Game.template.change."+a)},f),e})(e.templates)}};return a.registerCommand("onTemplates",e),e}]),angular.module("clickApp.services").factory("createTerrainCommand",["commands","point","terrain","gameTerrains","gameTerrainSelection",function(a,b,c,d,e){var f={execute:function(a,f,g,h){var i=b.addToWithFlip$(f);return R.pipePromise(R.prop("terrains"),R.map(function(b){return R.pipe(i(a.base),R.omit(["stamp"]),R.spyError("terrain",a,f),function(a){return self.Promise.resolve(c.create(a))["catch"](R.always(null))})(b)}),R.promiseAll,R.reject(R.isNil),R.rejectIf(R.isEmpty,"No valid terrain definition"),R.spyError("terrains"),function(a){var b={terrains:R.map(c.saveState,a),desc:a[0].state.info.join(".")};return R.pipe(d.add$(a),function(b){return h=R.assoc("terrains",b,h),e.set("local",R.map(R.path(["state","stamp"]),a),g,h.terrain_selection)},function(a){return h=R.assoc("terrain_selection",a,h),g.changeEvent("Game.terrain.create"),[b,h]})(h.terrains)})(a)},replay:function(a,b,f){return R.pipePromise(R.prop("terrains"),R.map(function(a){return self.Promise.resolve(c.create(a))["catch"](R.always(null))}),R.promiseAll,R.reject(R.isNil),R.rejectIf(R.isEmpty,"No valid terrain definition"),function(a){return R.pipe(d.add$(a),function(c){return f=R.assoc("terrains",c,f),e.set("remote",R.map(R.path(["state","stamp"]),a),b,f.terrain_selection)},function(a){return f=R.assoc("terrain_selection",a,f),b.changeEvent("Game.terrain.create"),f})(f.terrains)})(a)},undo:function(a,b,c){var f=R.pluck("stamp",a.terrains);return c=R.pipe(R.over(R.lensProp("terrains"),d.removeStamps$(f)),R.over(R.lensProp("terrain_selection"),e.removeFrom$("local",f,b)),R.over(R.lensProp("terrain_selection"),e.removeFrom$("remote",f,b)))(c),b.changeEvent("Game.terrain.create"),c}};return a.registerCommand("createTerrain",f),f}]),angular.module("clickApp.services").factory("deleteTerrainCommand",["commands","terrain","gameTerrains","gameTerrainSelection",function(a,b,c,d){var e={execute:function(a,e,f){return R.pipeP(function(a){return c.findAnyStamps(a,f.terrains)},R.reject(R.isNil),R.map(b.saveState),function(b){var g={terrains:b,desc:""};return R.pipe(c.removeStamps$(a),function(b){return f=R.assoc("terrains",b,f),d.removeFrom("local",a,e,f.terrain_selection)},d.removeFrom$("remote",a,e),function(a){return f=R.assoc("terrain_selection",a,f),e.changeEvent("Game.terrain.create"),[g,f]})(f.terrains)})(a)},replay:function(a,b,e){return R.pipe(R.pluck("stamp"),function(a){return R.pipe(function(){return c.removeStamps(a,e.terrains)},function(c){return e=R.assoc("terrains",c,e),d.removeFrom("local",a,b,e.terrain_selection)},d.removeFrom$("remote",a,b),function(a){return e=R.assoc("terrain_selection",a,e),b.changeEvent("Game.terrain.create"),e})()})(a.terrains)},undo:function(a,e,f){return R.pipePromise(R.map(function(a){return self.Promise.resolve(b.create(a))["catch"](R.always(null))}),R.promiseAll,R.reject(R.isNil),function(a){return R.isEmpty(a)?self.Promise.reject("No valid terrain definition"):R.pipe(c.add$(a),function(b){f=R.assoc("terrains",b,f);var c=R.map(R.path(["state","stamp"]),a);return d.set("remote",c,e,f.terrain_selection)},function(a){return f=R.assoc("terrain_selection",a,f),e.changeEvent("Game.terrain.create"),f})(f.terrains)})(a.terrains)}};return a.registerCommand("deleteTerrain",e),e}]),angular.module("clickApp.services").factory("onTerrainsCommand",["commands","terrain","gameTerrains","gameTerrainSelection",function(a,b,c,d){var e={execute:function(a,d,e,f,g){if("Function"!==R.type(b[a]))return self.Promise.reject('Unknown method "'+a+'" on terrain');var h={before:[],after:[],desc:a};return R.pipeP(c.fromStamps$("saveState",[],e),function(b){return h.before=b,c.onStamps(a,d,e,g.terrains)},function(a){return g=R.assoc("terrains",a,g),c.fromStamps("saveState",[],e,g.terrains)},function(a){return h.after=a,R.forEach(function(a){f.changeEvent("Game.terrain.change."+a)},e),[h,g]})(g.terrains)},replay:function(a,b,e){var f=R.pluck("stamp",a.after);return R.pipeP(c.setStateStamps$(a.after,f),function(a){return e=R.assoc("terrains",a,e),d.set("remote",f,b,e.terrain_selection)},function(a){return e=R.assoc("terrain_selection",a,e),R.forEach(function(a){b.changeEvent("Game.terrain.change."+a)},f),e})(e.terrains)},undo:function(a,b,e){var f=R.pluck("stamp",a.before);return R.pipeP(c.setStateStamps$(a.before,f),function(a){return e=R.assoc("terrains",a,e),d.set("remote",f,b,e.terrain_selection)},function(a){return e=R.assoc("terrain_selection",a,e),R.forEach(function(a){b.changeEvent("Game.terrain.change."+a)},f),e})(e.terrains)}};return a.registerCommand("onTerrains",e),e}]),angular.module("clickApp.services").factory("lockTerrainsCommand",["commands","gameTerrains",function(a,b){var c={execute:function(a,c,d,e){var f={desc:a,stamps:c};return R.pipeP(b.lockStamps$(a,c),function(a){return e=R.assoc("terrains",a,e),R.forEach(function(a){d.changeEvent("Game.terrain.change."+a)},c),d.changeEvent("Game.terrain.create"),[f,e]})(e.terrains)},replay:function(a,c,d){return R.pipeP(b.lockStamps$(a.desc,a.stamps),function(b){return d=R.assoc("terrains",b,d),R.forEach(function(a){c.changeEvent("Game.terrain.change."+a)},a.stamps),c.changeEvent("Game.terrain.create"),d})(d.terrains)},undo:function(a,c,d){return R.pipeP(b.lockStamps$(!a.desc,a.stamps),function(b){return d=R.assoc("terrains",b,d),R.forEach(function(a){c.changeEvent("Game.terrain.change."+a)},a.stamps),c.changeEvent("Game.terrain.create"),d})(d.terrains)}};return a.registerCommand("lockTerrains",c),c}]),angular.module("clickApp.services").factory("rollDiceCommand",["commands",function(a){var b={execute:function(a,b,c,d){var e=R.times(function(){return R.randomRange(1,a)},b),f=R.reduce(R.add,0,e),g={desc:"d"+a+"["+e.join(",")+"] = "+f,s:a,n:b,d:e};return c.changeEvent("Game.dice.roll"),[g,d]},replay:function(a,b,c){var d=R.propOr([],"dice",c);return c=R.assoc("dice",R.append(a,d),c),b.changeEvent("Game.dice.roll"),c},undo:function(a,b,c){var d=R.propOr([],"dice",c);return c=R.assoc("dice",R.reject(R.propEq("stamp",a.stamp),d),c),b.changeEvent("Game.dice.roll"),c}};return a.registerCommand("rollDice",b),b}]),angular.module("clickApp.services").factory("rollDeviationCommand",["commands",function(a){var b={execute:function(a,b){var c=R.randomRange(1,6),d=R.randomRange(1,6),e={desc:"AoE deviation : direction "+c+", distance "+d+'"',r:c,d:d};return a.changeEvent("Game.dice.roll"),[e,b]},replay:function(a,b,c){var d=R.propOr([],"dice",c);return c=R.assoc("dice",R.append(a,d),c),b.changeEvent("Game.dice.roll"),c},undo:function(a,b,c){var d=R.propOr([],"dice",c);return c=R.assoc("dice",R.reject(R.propEq("stamp",a.stamp),d),c),b.changeEvent("Game.dice.roll"),c}};return a.registerCommand("rollDeviation",b),b}]),angular.module("clickApp.services").factory("setBoardCommand",["commands",function(a){var b={execute:function(a,b,c){var d={before:c.board,after:a,desc:a.name};return c=R.assoc("board",a,c),b.changeEvent("Game.board.change"),[d,c]},replay:function(a,b,c){return c=R.assoc("board",a.after,c),b.changeEvent("Game.board.change"),c},undo:function(a,b,c){return c=R.assoc("board",a.before,c),b.changeEvent("Game.board.change"),c}};return a.registerCommand("setBoard",b),b}]),angular.module("clickApp.services").factory("setLayersCommand",["commands","gameLayers",function(a,b){var c={execute:function(a,c,d,e){if("Function"!==R.type(b[a]))return self.Promise.reject('Layers unknown method "'+a+'"');var f={before:e.layers,desc:a+"("+c+")"};return e=R.assoc("layers",b[a](c,e.layers),e),f.after=e.layers,d.changeEvent("Game.layers.change"),[f,e]},replay:function(a,b,c){return c=R.assoc("layers",a.after,c),b.changeEvent("Game.layers.change"),c},undo:function(a,b,c){return c=R.assoc("layers",a.before,c),b.changeEvent("Game.layers.change"),c}};return a.registerCommand("setLayers",c),c}]),angular.module("clickApp.services").factory("setLosCommand",["commands","gameLos",function(a,b){var c={execute:function(a,c,d,e){if("Function"!==R.type(b[a]))return self.Promise.reject("Los unknown method "+a);var f={before:[],after:[],desc:a};return R.pipePromise(b.saveRemoteState,function(g){return f.before=g,b[a].apply(null,[].concat(_toConsumableArray(c),[d,e,e.los]))},function(a){return e=R.assoc("los",a,e),b.saveRemoteState(e.los)},function(a){return f.after=a,d.changeEvent("Game.los.remote.change"),[f,e]})(e.los)},replay:function(a,c,d){return R.pipeP(b.resetRemote$(a.after,c,d),function(a){return c.changeEvent("Game.los.remote.change"),R.assoc("los",a,d)})(d.los)},undo:function(a,c,d){return R.pipeP(b.resetRemote$(a.before,c,d),function(a){return c.changeEvent("Game.los.remote.change"),R.assoc("los",a,d)})(d.los)}};return a.registerCommand("setLos",c),c}]),angular.module("clickApp.services").factory("setRulerCommand",["commands","gameRuler",function(a,b){var c={execute:function(a,c,d,e){if("Function"!==R.type(b[a]))return self.Promise.reject("Ruler unknown method "+a);var f={before:[],after:[],desc:a};return R.pipePromise(b.saveRemoteState,function(g){return f.before=g,b[a].apply(null,[].concat(_toConsumableArray(c),[d,e.ruler]))},function(a){return e=R.assoc("ruler",a,e),b.saveRemoteState(e.ruler)},function(a){return f.after=a,d.changeEvent("Game.ruler.remote.change"),[f,e]})(e.ruler)},replay:function(a,c,d){return d=R.over(R.lensProp("ruler"),b.resetRemote$(a.after,c),d),c.changeEvent("Game.ruler.remote.change"),d},undo:function(a,c,d){return d=R.over(R.lensProp("ruler"),b.resetRemote$(a.before,c),d),c.changeEvent("Game.ruler.remote.change"),d}};return a.registerCommand("setRuler",c),c}]),angular.module("clickApp.services").factory("setScenarioCommand",["commands",function(a){var b={execute:function(a,b,c){var d={before:c.scenario,after:a,desc:a.name};return c=R.assoc("scenario",a,c),b.changeEvent("Game.scenario.change"),[d,c]},replay:function(a,b,c){return c=R.assoc("scenario",a.after,c),b.changeEvent("Game.scenario.change"),c},undo:function(a,b,c){return c=R.assoc("scenario",a.before,c),b.changeEvent("Game.scenario.change"),c}};return a.registerCommand("setScenario",b),b}]),angular.module("clickApp.services").factory("fileExport",["jsonStringifier",function(a){self.URL=self.URL||self.webkitURL;var b={json:a},c={generate:function(a,c){return R.pipeP(b[a].stringify,function(a){return new self.Blob([a],{type:"text/plain"})},self.URL.createObjectURL)(c)},cleanup:function(a){R.isNil(a)||self.URL.revokeObjectURL(a)}};return R.curryService(c),c}]),angular.module("clickApp.services").factory("fileImport",["jsonParser",function(a){var b={json:a},c={read:function(a,c){return new self.Promise(function(d,e){var f=new self.FileReader;f.onload=function(c){b[a].parse(c.target.result).then(d)["catch"](e)},f.onerror=function(){e(["Error reading file"])},f.onabort=function(){e(["Abort reading file"])},f.readAsText(c)})}};return R.curryService(c),c}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){
e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("game",["jsonStringifier","commands","gameConnection","gameLayers","gameLos","gameModels","gameModelSelection","gameRuler","gameTemplates","gameTemplateSelection","gameTerrains","gameTerrainSelection",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,c,d){return R.isEmpty(a)?d:R.pipeP(b.replayBatch$(a[0],c),function(b){return new self.Promise(function(d){self.requestAnimationFrame(function(){d(m(R.tail(a),c,b))})})})(d)}var n={create:function(a){var b={players:{p1:{name:R.propOr("player1","name",a)},p2:{name:null}}};return b},load:function(a,b){return R.pipe(function(){return Object.create({toJSON:function(){return n.pickForJson(this)}})},function(a){return R.deepExtend(a,{players:{p1:{name:null},p2:{name:null}},board:{},scenario:{},chat:[],commands:[],commands_log:[],undo:[],undo_log:[],dice:[],ruler:h.create(),los:e.create(),models:f.create(),model_selection:g.create(),templates:i.create(),template_selection:j.create(),terrains:k.create(),terrain_selection:l.create(),layers:d.create()},b)},c.create,o(a))()},pickForJson:function(a){return R.pick(["players","commands","undo","chat"],a)},toJson:function(b){return R.pipePromise(n.pickForJson,a.stringify)(b)},playerName:function(a,b){return R.pathOr("John Doe",["players",a,"name"],b)},description:function(a){return[s.capitalize(n.playerName("p1",a)),"vs",s.capitalize(n.playerName("p2",a))].join(" ")},executeCommand:function(a,d,e,f){return R.pipeP(function(){return b.execute.apply(null,[a,d,e,f])},function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return[R.pipe(R.assoc("user",R.pathOr("Unknown",["user","state","name"],e)),R.assoc("stamp",R.guid()))(c),d]},function(a){var b=_slicedToArray(a,2),d=b[0],e=b[1];return c.active(e)?c.sendReplayCommand(d,e):(d.do_not_log||(e=R.over(R.lensProp("commands"),R.append(d),e)),("rollDice"===d.type||"rollDeviation"===d.type)&&(e=R.over(R.lensProp("dice"),R.append(d),e)),e)},function(a){return e.changeEvent("Game.command.execute"),a})()},undoCommand:function(a,c,d){return R.pipePromise(R.propOr([],"undo_log"),R.find(R.propEq("stamp",a.stamp)),function(e){if(R.exists(e)){var f=R.propOr([],"undo_log",d);return R.assoc("undo_log",R.reject(R.propEq("stamp",a.stamp),f),d)}return b.undo(a,c,d)},function(b){var c=R.propOr([],"commands",b),d=R.propOr([],"undo",b);return R.pipe(R.assoc("commands",R.reject(R.propEq("stamp",a.stamp),c)),R.assoc("undo",R.append(a,d)))(b)},function(a){return c.changeEvent("Game.command.undo"),a})(d)},undoLastCommand:function(a,d){return R.pipePromise(R.propOr([],"commands"),R.last,R.rejectIf(R.isNil,"Command history empty"),function(c){return R.pipeP(b.undo$(c,a),function(a){return[c,a]})(d)},function(a){var b=_slicedToArray(a,2),d=b[0],e=b[1];return R.pipePromise(R.assoc("commands",R.init(e.commands)),function(a){return c.active(a)?c.sendUndoCommand(d,a):R.over(R.lensProp("undo"),R.append(d),a)})(e)},function(b){return a.changeEvent("Game.command.undo"),b})(d)},replayCommand:function(a,c,d){return R.pipePromise(R.propOr([],"commands_log"),R.find(R.propEq("stamp",a.stamp)),function(e){return R.exists(e)?R.over(R.lensProp("commands_log"),R.reject(R.propEq("stamp",a.stamp)),d):b.replay(a,c,d)},function(b){return R.pipe(R.over(R.lensProp("undo"),R.reject(R.propEq("stamp",a.stamp))),function(b){return a.do_not_log?b:R.over(R.lensProp("commands"),R.append(a),b)})(b)},function(a){return c.changeEvent("Game.command.replay"),a})(d)},replayCommandsBatch:function(a,c,d){return R.pipeP(b.replayBatch$(a,c),R.over(R.lensProp("commands"),R.flip(R.concat)(a)))(d)},replayNextCommand:function(a,d){return R.pipePromise(R.propOr([],"undo"),R.last,function(c){return R.isNil(c)?self.Promise.reject("Undo history empty"):R.pipeP(b.replay$(c,a),function(a){return[c,a]})(d)},function(a){var b=_slicedToArray(a,2),d=b[0],e=b[1];return R.pipePromise(R.assoc("undo",R.init(e.undo)),function(a){if(c.active(a))return c.sendReplayCommand(d,a);var b=R.propOr([],"commands",a);return R.assoc("commands",R.append(d,b),a)})(e)},function(b){return a.changeEvent("Game.command.replay"),b})(d)},sendChat:function(a,b,d){return c.sendEvent({type:"chat",chat:{from:a,msg:b}},d)}},o=R.curry(function(a,b){return new self.Promise(function(c){R.isEmpty(b.commands)&&c(b);var d=R.splitEvery(b.commands.length,b.commands);self.requestAnimationFrame(function(){c(m(d,a,b))})})});return R.curryService(n),n}]),angular.module("clickApp.services").factory("games",["localStorage","http","game",function(a,b,c){var d="clickApp.games",e={loadLocalGames:function(){return R.pipeP(function(){return a.load(d)["catch"](R.spy("games: Failed to load local games"))},R.defaultTo([]),R.spyWarn("Games local load"))()},storeLocalGames:function(b){return R.pipePromise(R.map(c.pickForJson),R.spyWarn("Games local store"),a.save$(d))(b)},newLocalGame:function(a,b){return R.append(a,b)},loadLocalGame:function(a,b){return new self.Promise(function(c,d){return a>=R.length(b)?void d("Unknown local game id "+a):void R.pipe(R.nth(a),R.spyError("Games: load local game"),c)(b)})},removeLocalGame:function(a,b){return R.remove(a,1,b)},updateLocalGame:function(a,b,c){return R.update(parseInt(a),b,c)},newOnlineGame:function(a){return R.pipePromise(c.pickForJson,R.spyWarn("upload game"),b.post$("/api/games"),R.spyWarn("upload game response"))(a)},loadOnlineGame:function(a,c){var d=["/api/games",a?"private":"public",c].join("/");return R.pipeP(b.get,R.spyError("Games: load online game"))(d)}};return R.curryService(e),e}]),angular.module("clickApp.services").factory("gameBoard",["http",function(a){var b={init:function(){return a.get("/data/boards.json")["catch"](function(a){return[]})},name:function(a){return R.prop("name",a)},forName:function(a,b){return R.find(R.propEq("name",a),b)}};return R.curryService(b),b}]),angular.module("clickApp.services").factory("gameConnection",["websocket",function(a){function b(a){return function(){a.event("Game.connection.close")}}var c={create:function(a){var b={state:{socket:null}};return R.assoc("connection",b,a)},open:function(c,j,k){if(R.exists(k.connection.state.socket))return self.Promise.resolve(k);c=s.trim(c);var l={close:b(j),chat:g(j),replayCmd:d(j),undoCmd:e(j),cmdBatch:f(j),setCmds:h(j),players:i(j)};k=R.assocPath(["connection","state","socket"],null,k);var m=["/api/games",R.prop("private_stamp",k)?"private":"public",R.prop("private_stamp",k)?R.prop("private_stamp",k):R.prop("public_stamp",k)].join("/");return m+="?name="+c,R.pipeP(function(){return a.create(m,"game",l)},function(a){return R.assocPath(["connection","state","socket"],a,k)})()},close:function(b){return R.pipePromise(R.path(["connection","state","socket"]),function(c){return R.isNil(b)?null:a.close(c)},R.always(b),c.cleanup)(b)},cleanup:function(a){return R.assocPath(["connection","state","socket"],null,a)},active:function(a){return R.pipe(R.path(["connection","state","socket"]),R.exists)(a)},sendReplayCommand:function(a,b){return R.pipeP(c.sendEvent$({type:"replayCmd",cmd:a}),function(b){return R.over(R.lensProp("commands_log"),R.compose(R.append(a),R.defaultTo([])),b)})(b)},sendUndoCommand:function(a,b){return R.pipeP(c.sendEvent$({type:"undoCmd",cmd:a}),function(b){return R.over(R.lensProp("undo_log"),R.compose(R.append(a),R.defaultTo([])),b)})(b)},sendEvent:function(b,d){return R.pipePromise(function(){return c.active(d)?a.send(b,d.connection.state.socket):self.Promise.reject("Not active")},R.always(d))()}},d=R.curry(function(a,b){a.event("Game.command.replay",b.cmd)}),e=R.curry(function(a,b){a.event("Game.command.undo",b.cmd)}),f=R.curry(function(a,b){a.event("Game.command.replayBatch",b.cmds)}),g=R.curry(function(a,b){a.event("Game.newChatMsg",b)}),h=R.curry(function(a,b){a.event("Game.setCmds",b)}),i=R.curry(function(a,b){a.event("Game.setPlayers",b.players)});return R.curryService(c),c}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("gameFactions",["localStorage","http",function(a,b){function c(a){return R.pipe(R.assoc("wreck",l(a.wreck)),function(a){return R.assoc("models",d(a,a.models),a)})(a)}function d(a,b){return R.reduce(function(c,d){return R.assoc(d,e(a,b[d]),c)},{},R.keys(b))}function e(a,b){return R.pipe(R.keys,R.sortBy(function(a){return b[a].name}),R.reduce(function(c,d){return R.assoc(d,f(a,b[d]),c)},{}))(b)}function f(a,b){return R.exists(b.entries)?g(a,b):j(a,null,b)}function g(a,b){return R.assoc("entries",h(a,b,b.entries),b)}function h(a,b,c){return R.reduce(function(d,e){return R.assoc(e,i(a,b,c[e]),d)},{},R.keys(c))}function i(a,b,c){return R.reduce(function(d,e){return R.assoc(e,j(a,b,c[e]),d)},{},R.keys(c))}function j(a,b,c){var d=c.name;return R.exists(b)&&(d=R.exists(b.fk_name)?b.fk_name:b.name+".*(?<nb_grunts>\\d+)\\s+grunt"),b=R.defaultTo({},b),R.pipe(R.assoc("fk_name",R.defaultTo(d,c.fk_name)),R.assoc("unit_name",b.name),R.assoc("img",k(c.img)),R.assoc("damage",n(c.damage)),R.assoc("base_color",a.color),R.assoc("base_radius",t[c.base]),function(b){return"jack"===b.type&&R.exists(a.wreck)&&R.exists(a.wreck[b.base])?R.assoc("img",R.append(a.wreck[b.base],b.img),b):b})(c)}function k(a){return R.pipe(R.defaultTo([]),function(a){return R.isEmpty(a)?R.append({},a):a},R.map(m))(a)}function l(a){return R.pipe(R.defaultTo({}),function(a){return R.pipe(R.keys,R.reduce(function(b,c){return R.assoc(c,m(R.assoc("type","wreck",a[c])),b)},{}))(a)})(a)}function m(a){return R.pipe(R.assoc("type",R.defaultTo("default",a.type)),R.assoc("width",R.defaultTo(60,a.width)),R.assoc("height",R.defaultTo(60,a.height)))(a)}function n(a){return R.pipe(R.defaultTo({type:"warrior",n:1}),function(a){return R.assoc("type",R.defaultTo("warrior",a.type),a)},function(a){return R.assoc("total",o(a),a)},function(a){return R.assoc("depth",p(a),a)})(a)}function o(a){return"warrior"===a.type?a.n:R.pipe(R.keys,R.reject(R.equals("type")),R.reject(R.equals("total")),R.reject(R.equals("field")),R.reduce(function(b,c){return b+R.pipe(R.reject(R.isNil),R.length)(a[c])},0))(a)}function p(a){return"warrior"===a.type?a.n:R.pipe(R.keys,R.reject(R.equals("type")),R.reject(R.equals("total")),R.reject(R.equals("field")),R.map(function(b){return R.length(a[b])}),R.reduce(R.max,0))(a)}function q(a,b,c){var d=r(b.fk_name,c),e=R.defaultTo([],d.entries[a]);e.push(b),d.entries[a]=e,c[b.fk_name]=d}function r(a,b){var c=v.buildReferenceRegexp(a);return R.defaultTo({regexp:c,entries:{}},b[a])}var t={huge:24.605,large:9.842,medium:7.874,small:5.905},u="clickApp.factions_desc",v={init:function(){return R.pipeP(v.loadDefault,function(a){return R.pipeP(v.loadDesc,function(b){return{base:a,desc:b}})()},v.updateDesc,R.spy("Factions"))()},loadDefault:function(){return R.pipeP(b.get,function(a){return R.pipe(R.keys,R.map(function(c){return b.get(a[c]).then(function(a){return[c,a]})}))(a)},R.promiseAll,R.reduce(function(a,b){var c=_slicedToArray(b,2),d=c[0],e=c[1];return R.assoc(d,e,a)},{}))("/data/model/factions.json")},updateDesc:function(a){return R.pipe(v.applyDesc,v.updateInfo,v.buildReferences)(a)},loadDesc:function(){return R.pipeP(function(){return a.load(u)["catch"](R.spyError("Factions: no stored desc"))},R.defaultTo({}),R.spyWarn("Factions Desc load"))()},applyDesc:function(a){var b=a.base,c=a.desc;return{base:b,desc:c,current:R.deepExtend(b,c)}},updateInfo:function(a){var b=a.base,d=a.desc,e=a.current;return{base:b,desc:d,current:R.pipe(R.toPairs,R.sortBy(R.compose(R.prop("name"),R.nth(1))),R.reduce(function(a,b){var d=_slicedToArray(b,2),e=d[0],f=d[1];return R.assoc(e,c(f),a)},{}))(e)}},storeDesc:function(b){return R.pipePromise(R.prop("desc"),R.spyWarn("Factions Desc store"),a.save$(u))(b)},buildReferences:function(a){var b=a.base,c=a.desc,d=a.current;return{base:b,desc:c,current:d,references:R.reduce(w(d),{},R.keys(d))}},getModelInfo:function(a,b){return new self.Promise(function(c,d){var e=R.path(["current"].concat(_toConsumableArray(a)),b);R.isNil(e)?d("Model info "+a.join(".")+" not found"):c(e)})},getListInfo:function(a,b){function c(a){return R.pipe(R.values,R.find(d(a)),e(a))(b)}var d=R.curry(function(a,b){return XRegExp.exec(a,b.regexp)}),e=R.curry(function(a,b){if(R.isNil(b))return b;var c=XRegExp.exec(a,b.regexp);return[R.prop("entries",b),f(c.nb_grunts),g(c.nb_repeat)]}),f=function(a){return R.pipe(R.defaultTo("0"),function(a){return parseFloat(a)+1})(a)},g=function(a){return R.pipe(R.defaultTo("0"),function(a){return parseFloat(a)})(a)};return R.pipe(s.lines,R.map(c),R.reject(R.isNil))(a)},buildModelsList:function(a,b,c){function d(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],h=b[2],i=e(c,d),j=f(c,h),k=[].concat(_toConsumableArray(i),_toConsumableArray(j));return g(c,R.length(i),k),k}function e(a,b){var c=[],d=R.propOr([],"grunt",a),e=_slicedToArray(d,1),f=e[0];if(R.exists(f)&&R.exists(f.fk_grunts)&&(b=f.fk_grunts),b>0){var g=R.propOr([],"leader",a),h=_slicedToArray(g,1),j=h[0];R.exists(j)&&(c=R.concat(c,i(1,j)),b--),R.exists(f)&&R.times(function(){c=R.concat(c,i(1,f))},b),R.isEmpty(c)||(c[0].dsp=["l","i"])}return c}function f(a,b){return R.pipe(R.omit(["grunt","leader"]),R.values,R.flatten,R.chain(function(a){return i(b,a)}))(a)}function g(a,b,c){var d=h(a);(R.isNil(d)||d!==k.name||b>0)&&k.number++,k.name=d,R.forEach(function(a){a.u=k.number},c)}function h(a){return R.pipe(R.values,R.find(function(a){return R.find(function(a){return R.exists(a.unit_name)},a)}),R.defaultTo([{}]),R.head,R.prop("unit_name"))(a)}function i(a,c){var d=[];return R.pipe(R.propOr(1,"fk_repeat"),R.max(a),R.times(function(){d.push({user:b,info:c.path,x:m+c.base_radius,y:n+c.base_radius,r:0}),m+=2*c.base_radius,o=Math.max(o,2*c.base_radius),m>l&&(m=0,n+=o,o=0)}))(c),d}var j=v.getListInfo(a,c),k={name:null,number:0},l=240,m=0,n=0,o=0;return{base:{x:240,y:240,r:0},models:R.chain(d,j)}},buildReferenceRegexp:function(a){var b="^\\**\\s*"+a;return XRegExp(b,"i")}},w=R.curry(function(a,b,c){var d=a[c].models;return R.reduce(x(c,d),b,R.keys(d))}),x=R.curry(function(a,b,c,d){var e=b[d];return R.reduce(y(a,d,e),c,R.keys(e))}),y=R.curry(function(a,b,c,d,e){var f=c[e].entries;return R.isNil(f)?z(a,b,c,e,d):R.reduce(A(a,b,e,f),d,R.keys(f))}),z=R.curry(function(a,b,c,d,e){return d=R.assoc("path",[a,"models",b,d],c[d]),q("default",d,e),e}),A=R.curry(function(a,b,c,d,e,f){var g=d[f];return R.reduce(B(a,b,c,f,g),e,R.keys(g))}),B=R.curry(function(a,b,c,d,e,f,g){var h=R.assoc("path",[a,"models",b,c,"entries",d,g],e[g]);return q(g,h,f),f});return R.curryService(v),v}]),angular.module("clickApp.services").factory("gameLayers",[function(){var a={create:function(){return["b","d","s","m","t"]},isDisplayed:function(a){var b=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return R.find(R.equals(a),b)},set:function(a){var b=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return R.uniq(R.append(a,b))},unset:function(a){var b=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return R.reject(R.equals(a),b)},toggle:function(b,c){return a.isDisplayed(b,c)?a.unset(b,c):a.set(b,c)}};return R.curryService(a),a}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("gameLos",["point","circle","gameFactions","gameModels",function(a,b,c,d){function e(a,c,d,e,j,k,l){return l=R.pipe(R.assocPath(["remote","origin"],a),R.assocPath(["remote","target"],c),R.assocPath(["remote","display"],e),R.assocPath(["remote","ignore"],[]))(l),l=R.pipe(R.assocPath(["computed","envelope"],null),R.assocPath(["computed","darkness"],[]),R.assocPath(["computed","shadow"],[]))(l),l.remote.origin&&l.remote.target?(l=R.over(R.lensPath(["remote","ignore"]),R.defaultTo([]),l),R.pipeP(function(){return f(j,k,l.remote.origin,l.remote.target)},function(d){var e=_slicedToArray(d,4),f=e[0],h=e[1],i=e[2],m=e[3],n={x:f.x,y:f.y,radius:h.base_radius},o={x:i.x,y:i.y,radius:m.base_radius},p=b.envelopeTo(o,n);return l=R.assocPath(["computed","envelope"],p,l),R.pipeP(function(){return g(j,k,l.remote.ignore,c,o,a,p)},function(a){return[n,a]})()},function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1],e=h(c,d);l=R.assocPath(["computed","darkness"],e,l);var f=i(c,d);return l=R.assocPath(["computed","shadow"],f,l),j.changeEvent("Game.los.remote.change"),l})()):(j.changeEvent("Game.los.remote.change"),self.Promise.resolve(l))}function f(a,b,e,f){return R.pipePromise(function(){return[d.findStamp(e,b.models),d.findStamp(f,b.models)]},R.promiseAll,function(b){var d=_slicedToArray(b,2),e=d[0].state,f=d[1].state;return R.pipePromise(function(){return[c.getModelInfo(e.info,a.factions),c.getModelInfo(f.info,a.factions)]},R.promiseAll,function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return[e,c,f,d]})()})()}function g(a,e,f,g,h,i,j){return R.pipePromise(d.all,R.map(function(b){return R.pipeP(function(){return c.getModelInfo(b.state.info,a.factions)},function(a){return R.assoc("radius",a.base_radius,b.state)})()}),R.promiseAll,R.reject(function(a){return g===a.stamp||i===a.stamp||h.radius>a.radius||R.find(R.equals(a.stamp),f)}),R.filter(b.isInEnvelope$(j)))(e.models)}function h(a,c){return R.map(function(c){return b.outsideEnvelopeTo(c,[],a)},c)}function i(a,c){return R.map(function(d){return b.outsideEnvelopeTo(d,c,a)},c)}var j={create:function(){return{local:{display:!1,start:{x:0,y:0},end:{x:0,y:0}},remote:{display:!1,start:{x:0,y:0},end:{x:0,y:0}},computed:{}}},isDisplayed:function(a){return R.path(["remote","display"],a)},origin:function(a){return R.path(["remote","origin"],a)},clearOrigin:function(a,b,c){return e(null,c.remote.target,null,!1,a,b,c)},setOrigin:function(a,b,c,d){var f=a.state.stamp,g=j.target(d);g=g===f?null:g;var h=g&&f;return e(f,g,null,h,b,c,d)},setOriginResetTarget:function(a,b,c,d){var f=a.state.stamp;return e(f,null,null,!1,b,c,d)},target:function(a){return R.path(["remote","target"],a)},clearTarget:function(a,b,c){return e(c.remote.origin,null,null,!1,a,b,c)},setTarget:function(a,b,c,d){var f=j.origin(d),g=a.state.stamp;f=f===g?null:f;var h=g&&f;return e(f,g,null,h,b,c,d)},toggleIgnoreModel:function(a,b,c,d){var f=R.pathOr([],["remote","ignore"],d),g=R.find(R.equals(a.state.stamp),f);return f=g?R.reject(R.equals(a.state.stamp),f):R.append(a.state.stamp,f),e(d.remote.origin,d.remote.target,f,d.remote.display,b,c,d)},updateOriginTarget:function(a,b,c){return e(c.remote.origin,c.remote.target,c.remote.ignore,c.remote.display,a,b,c)},toggleDisplay:function(a,b,c){var d=["remote","display"],f=!R.path(d,c);return e(c.remote.origin,c.remote.target,c.remote.ignore,f,a,b,c)},setLocal:function(a,b,c,d){return R.pipe(R.prop("local"),R.assoc("start",R.clone(a)),R.assoc("end",R.clone(b)),R.assoc("display",!0),function(a){return c.changeEvent("Game.los.local.change"),R.assoc("local",a,d)})(d)},setRemote:function(a,b,c,d,f){return f=R.assocPath(["local","display"],!1,f),c.changeEvent("Game.los.local.change"),f=R.pipe(R.assocPath(["remote","start"],R.clone(a)),R.assocPath(["remote","end"],R.clone(b)))(f),c.changeEvent("Game.los.remote.change"),e(f.remote.origin,f.remote.target,f.remote.ignore,!0,c,d,f)},saveRemoteState:function(a){return R.clone(R.prop("remote",a))},resetRemote:function(a,b,c,d){return d=R.assoc("remote",R.clone(a),d),e(d.remote.origin,d.remote.target,d.remote.ignore,d.remote.display,b,c,d)}};return R.curryService(j),j}]),angular.module("clickApp.services").factory("gameMap",["gameModels","gameTemplates","gameTerrains",function(a,b,c){var d={isFlipped:function(a){return a.classList.contains("flipped")},zoomFactor:function(a){var b=a.getBoundingClientRect();return b.width/480},eventToMapCoordinates:function(a,b){var c=d.isFlipped(a),e=a.getBoundingClientRect(),f=480*(b.clientX-e.left)/e.width,g=480*(b.clientY-e.top)/e.height;return f=c?480-f:f,g=c?480-g:g,{x:f,y:g}},mapToScreenCoordinates:function(a,b){var c=d.isFlipped(a),e=a.getBoundingClientRect(),f=b.x*e.width/480,g=b.y*e.height/480;return c&&(f=e.width-f,g=e.height-g),f+=e.left,g+=e.top,{x:f,y:g}},findEventTarget:function(d,e){var f,g={type:"Map",target:null};return e.target.classList.contains("template")&&e.target.hasAttribute("data-stamp")?(f=e.target.getAttribute("data-stamp"),R.pipeP(b.findStamp$(f),function(a){return{type:"Template",target:a}})(d.templates)["catch"](R.always(g))):e.target.classList.contains("model-base")&&e.target.hasAttribute("data-stamp")?(f=e.target.getAttribute("data-stamp"),R.pipeP(a.findStamp$(f),function(a){return{type:"Model",target:a}})(d.models)["catch"](R.always(g))):e.target.classList.contains("terrain-image")&&e.target.hasAttribute("data-stamp")?(f=e.target.getAttribute("data-stamp"),R.pipeP(c.findStamp$(f),function(a){return{type:"Terrain",target:a}})(d.terrains)["catch"](R.always(g))):self.Promise.resolve(g)}};return R.curryService(d),d}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("gameModels",["point","model",function(a,b){var c={create:function(){return{active:[],locked:[]}},all:function(a){return R.concat(a.active,a.locked)},findStamp:function(a,b){return new self.Promise(function(d,e){var f=R.pipe(c.all,R.find(R.pathEq(["state","stamp"],a)))(b);R.isNil(f)?e("Model "+a+" not found"):d(f)})},findAnyStamps:function(a,b){return R.pipePromise(R.map(function(a){return c.findStamp(a,b)["catch"](R.always(null))}),R.promiseAll,function(a){return R.isEmpty(R.reject(R.isNil,a))?self.Promise.reject("No model found"):a})(a)},findStampsBetweenPoints:function(a,d,e){return new self.Promise(function(f,g){e=c.all(e);var h=R.pipe(R.filter(b.isBetweenPoints$(a,d)),R.map(R.path(["state","stamp"])))(e);R.isEmpty(h)?g("No model found between points"):f(h)})},fromStamps:function(a,b,c,e){return d(R.compose(R.always,R.always(null)),a,b,c,e)},onStamps:function(a,b,c,f){return R.pipeP(d(R.always,a,b,c),e(f))(f)},setStateStamps:function(a,d,f){return R.pipeP(c.findAnyStamps$(d),R.addIndex(R.map)(function(c,d){return R.isNil(c)?null:b.setState(a[d],c)}),R.reject(R.isNil),e(f))(f)},lockStamps:function(a,d,f){return R.pipeP(c.findAnyStamps$(d),R.reject(R.isNil),R.map(b.setLock$(a)),e(f))(f)},add:function(a,b){return R.pipe(c.removeStamps$(R.map(R.path(["state","stamp"]),a)),function(b){return R.assoc("active",R.concat(b.active,a),b)})(b)},removeStamps:function(a,b){function c(b){return R.find(R.equals(R.path(["state","stamp"],b)),a)}return R.pipe(R.assoc("active",R.reject(c,b.active)),R.assoc("locked",R.reject(c,b.locked)))(b)},modeForStamp:function(a,d){return R.pipeP(function(){return c.findStamp(a,d)},b.modeFor$)()},copyStamps:function(d,e){return R.pipeP(c.findAnyStamps$(d),R.reject(R.isNil),function(c){var d=R.pick(["x","y","r"],c[0].state);return{base:d,models:R.map(R.compose(a.differenceFrom$(d),b.saveState),c)}})(e)}},d=R.curry(function(a,d,e,f,g){return"Function"!==R.type(b[d])?self.Promise.reject("Unknown method "+d+" on models"):R.pipeP(c.findAnyStamps$(f),R.reject(R.isNil),R.map(function(c){return self.Promise.resolve(b[d].apply(null,[].concat(_toConsumableArray(e),[c])))["catch"](a(c))}),R.promiseAll)(g)}),e=R.curry(function(a,d){return R.pipe(c.all,R.concat(d),R.uniqBy(R.path(["state","stamp"])),R.partition(b.isLocked),function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return{active:d,locked:c}})(a)});return R.curryService(c),c}]),angular.module("clickApp.services").factory("gameModelSelection",["modes","gameModels",function(a,b){function c(a,b){"local"===a&&(b.event("Modes.switchTo","Default"),b.changeEvent("Game.model.selection.local.change"))}var d={create:function(){return{local:[],remote:[]}},"in":function(a,b,c){var d=R.prop(a,c);return R.find(R.equals(b),d)},inSingle:function(a,b,c){var d=R.prop(a,c);return 1===R.length(d)&&d[0]===b},get:function(a,b){return R.pipe(R.defaultTo({}),R.propOr([],a))(b)},modeFor:function(a,c){var e=d.get("local",c);return R.isEmpty(e)?self.Promise.reject("No model selection"):1===R.length(e)?b.modeForStamp(e[0],a):"Models"},checkMode:function(a,b){return R.pipePromise(d.modeFor$(a.game.models),function(b){a.event("Modes.switchTo",b)})(b)},set:function(a,b,e,f){var g=d.get(a,f),h=R.assoc(a,b,f);return c(a,e),R.forEach(function(a){e.changeEvent("Game.model.change."+a)},b),R.forEach(function(a){e.changeEvent("Game.model.change."+a)},g),h},addTo:function(a,b,e,f){var g=d.get(a,f),h=R.uniq(R.concat(g,b)),i=R.assoc(a,h,f);return c(a,e),R.forEach(function(a){e.changeEvent("Game.model.change."+a)},h),i},removeFrom:function(a,b,d,e){var f=R.prop(a,e),g=R.difference(f,b),h=R.assoc(a,g,e);return c(a,d),R.forEach(function(a){d.changeEvent("Game.model.change."+a)},R.uniq(R.concat(f,b))),h},clear:function(a,b,c,e){var f=R.prop(a,e);return d.removeFrom(a,f,c,e)}};return R.curryService(d),d}]),angular.module("clickApp.services").factory("gameRuler",["point","model","gameModels",function(a,b,c){function d(a,b,c,d,f){var g=R.exists(a)&&R.exists(b);return f=R.assoc("remote",R.pipe(R.assoc("origin",a),R.assoc("target",b),R.assoc("display",g),function(a){return R.exists(c)?R.assoc("max",c,a):a})(f.remote),f),e(d,f)}function e(d,e){return R.pipeP(function(){var a=R.path(["remote","origin"],e);return R.exists(a)?c.findStamp(a,d.game.models)["catch"](R.always(null)):self.Promise.resolve(null)},function(f){return R.pipeP(function(){var a=R.path(["remote","target"],e);return R.exists(a)?c.findStamp(a,d.game.models)["catch"](R.always(null)):self.Promise.resolve(null)},function(a){return R.exists(f)&&R.exists(a)?b.shortestLineTo(d.factions,a,f):R.exists(f)?{start:R.pick(["x","y"],f.state),end:R.pick(["x","y"],f.state)}:R.exists(a)?{start:R.pick(["x","y"],a.state),end:R.pick(["x","y"],a.state)}:R.pick(["start","end"],R.prop("remote",e))},function(b){var c=b.start,f=b.end,h=a.distanceTo(f,c);return e=R.over(R.lensProp("remote"),R.pipe(R.assoc("start",c),g(f),function(b){var c=a.distanceTo(b.end,b.start);return R.pipe(R.assoc("reached",c>=h-.1),R.assoc("length",Math.round(10*c)/100))(b)}),e),d.changeEvent("Game.ruler.remote.change"),e})()})()}var f={create:function(){return{local:{display:!1,start:{x:0,y:0},end:{x:0,y:0},length:null},remote:{display:!1,start:{x:0,y:0},end:{x:0,y:0},length:null}}},isDisplayed:function(a){return R.path(["remote","display"],a)},maxLength:function(a){return R.pathOr(0,["remote","max"],a)},setMaxLength:function(a,b,c){return c=R.pipe(R.assocPath(["local","max"],a),R.assocPath(["remote","max"],a))(c),e(b,c)},origin:function(a){return R.path(["remote","origin"],a)},clearOrigin:function(a,b){return d(null,b.remote.target,b.remote.max,a,b)},setOrigin:function(a,c,e){var g=a.state.stamp,h=f.target(e);h=h===g?null:h;var i=b.rulerMaxLength(a);return d(g,h,i,c,e)},setOriginResetTarget:function(a,c,e){var f=a.state.stamp,g=b.rulerMaxLength(a);return d(f,null,g,c,e)},target:function(a){return R.path(["remote","target"],a)},targetReached:function(a){return R.path(["remote","reached"],a)},clearTarget:function(a,b){return d(b.remote.origin,null,null,a,b)},setTarget:function(a,b,c){var e=f.origin(c),g=a.state.stamp;return e=e===g?null:e,d(e,g,null,b,c)},updateOriginTarget:function(a,b){return e(a,b)},toggleDisplay:function(a,b){var c=["remote","display"];return b=R.assocPath(c,!R.path(c,b),b),a.changeEvent("Game.ruler.remote.change"),b},setLocal:function(a,b,c,d){return R.pipe(R.prop("local"),R.assoc("start",R.clone(a)),g(b),R.assoc("length",null),R.assoc("display",!0),function(a){return c.changeEvent("Game.ruler.local.change"),R.assoc("local",a,d)})(d)},setRemote:function(a,b,c,d){d=R.assocPath(["local","display"],!1,d),c.changeEvent("Game.ruler.local.change");var f=R.pipe(R.assoc("origin",null),R.assoc("target",null),R.assoc("start",R.clone(a)),R.assoc("end",R.clone(b)),R.assoc("display",!0))(d.remote);return d=R.assoc("remote",f,d),e(c,d)},saveRemoteState:function(a){return R.clone(R.prop("remote",a))},resetRemote:function(a,b,c){var d=R.assoc("remote",R.clone(a),c);return b.changeEvent("Game.ruler.remote.change"),d},targetAoEPosition:function(b,d){var e=a.directionTo(d.remote.end,d.remote.start),g=d.remote.length/2,h=d.remote.end,i=f.target(d);return R.pipePromise(function(a){return R.exists(i)&&f.targetReached(d)?R.pipeP(c.findStamp$(i),R.prop("state"))(b):a},R.pick(["x","y"]),R.assoc("r",e),R.assoc("m",g))(h)}},g=R.curry(function(b,c){var d=a.distanceTo(b,c.start),e=a.directionTo(b,c.start),f=10*R.defaultTo(d/10,c.max);return d=Math.min(d,f),b=a.translateInDirection(d,e,c.start),R.assoc("end",b,c)});return R.curryService(f),f}]),angular.module("clickApp.services").factory("gameScenario",["http","point","line","circle",function(a,b,c,d){function e(a,b){var d={start:a,end:b},e=c.length(d);return e<=a.radius+b.r}function f(a,b){var d={start:a,end:b},e=c.length(d);return e<=a.radius+40+7.874}function g(a,b){var c={low:{x:b.x-b.width/2,y:b.y-b.height/2},high:{x:b.x+b.width/2,y:b.y+b.height/2}};return d.isInBox(c,a)}function h(a,b){var c={low:{x:b,y:b},high:{x:480-b,y:480-b}};return!d.isInBox(c,a)}var i={init:function(){return a.get("/data/scenarios.json")["catch"](function(a){return[]})},name:function(a){return R.prop("name",a)},group:function(a,b){return R.find(R.compose(R.equals(a),R.head),b)},forName:function(a,b){return R.find(R.propEq("name",a),b[1])},groupForName:function(a,b){return R.isNil(a)?void 0:R.find(R.compose(R.find(R.propEq("name",a)),R.last),b)},createObjectives:function(a){return new self.Promise(function(c,d){var e=R.concat(R.propOr([],"objectives",a),R.propOr([],"flags",a));R.isEmpty(e)&&d("No objectives");var f=R.assoc("r",0,R.head(e));c({base:R.pick(["x","y","r"],f),models:R.map(function(a){return R.pipe(R.assoc("r",0),R.assoc("info",R.concat(["scenario","models"],R.prop("info",a))),b.differenceFrom$(f))(a)},e)})})},isContesting:function(a,b){return R.exists(R.find(function(b){return e(a,b)},R.propOr([],"circle",b))||R.find(function(b){return g(a,b)},R.propOr([],"rect",b))||R.find(function(b){return f(a,b)},R.propOr([],"flags",b)))},isKillboxing:function(a,b){return R.exists(b.killbox)&&h(a,b.killbox)}};return i}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("gameTemplates",["template",function(a){var b={create:function(){return{active:[],locked:[]}},all:function(a){return R.concat(a.active,a.locked)},findStampIn:function(a,b,c){return new self.Promise(function(d,e){var f=R.pipe(R.prop(b),R.find(R.pathEq(["state","stamp"],a)))(c);return R.exists(f)?d(f):e("stamp "+a+" not found in "+b);
})},findStamp:function(a,c){return b.findStampIn(a,"active",c)["catch"](function(){return b.findStampIn(a,"locked",c)})},findAnyStamps:function(a,c){return R.pipePromise(R.map(function(a){return b.findStamp(a,c)["catch"](R.always(null))}),R.promiseAll,function(a){return R.isEmpty(R.reject(R.isNil,a))?self.Promise.reject("No template found"):a})(a)},fromStamps:function(a,b,d,e){return c(R.compose(R.always,R.always(null)),a,b,d,e)},onStamps:function(a,b,e,f){return R.pipeP(c(R.always,a,b,e),d(f))(f)},setStateStamps:function(c,e,f){return R.pipeP(b.findAnyStamps$(e),R.addIndex(R.map)(function(b,d){return R.isNil(b)?null:a.setState(c[d],b)}),R.reject(R.isNil),d(f))(f)},add:function(a,c){return R.pipe(b.removeStamps$(R.map(R.path(["state","stamp"]),a)),function(b){return R.assoc("active",R.concat(b.active,a),b)})(c)},removeStamps:function(a,b){function c(b){return R.find(R.equals(R.path(["state","stamp"],b)),a)}return R.pipe(R.assoc("active",R.reject(c,b.active)),R.assoc("locked",R.reject(c,b.locked)))(b)},isActive:function(a,b){return R.find(R.pathEq(["state","stamp"],a),b.active)},isLocked:function(a,b){return R.find(R.pathEq(["state","stamp"],a),b.locked)},lockStamps:function(c,e,f){return R.pipePromise(b.findAnyStamps$(e),R.reject(R.isNil),R.map(a.setLock$(c)),d(f))(f)},modeForStamp:function(a,c){return R.pipeP(b.findStamp$(a),R.path(["state","type"]),R.defaultTo("aoe"),function(a){return a+"Template"})(c)}},c=R.curry(function(c,d,e,f,g){return R.pipeP(b.findAnyStamps$(f),R.reject(R.isNil),R.map(function(b){return self.Promise.resolve(a.call(d,e,b))["catch"](c(b))}),R.promiseAll)(g)}),d=R.curry(function(c,d){return R.pipe(b.all,R.concat(d),R.uniqBy(R.path(["state","stamp"])),R.partition(a.isLocked),function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return{active:d,locked:c}})(c)});return R.curryService(b),b}]),angular.module("clickApp.services").factory("gameTemplateSelection",["modes","gameTemplates",function(a,b){function c(a,b){"local"===a&&(b.event("Modes.switchTo","Default"),b.changeEvent("Game.template.selection.local.change"))}var d={create:function(){return{local:[],remote:[]}},"in":function(a,b,c){var d=R.prop(a,c);return R.find(R.equals(b),d)},get:function(a,b){return R.propOr([],a,b)},checkMode:function(a,c){return R.pipePromise(d.get$("local"),R.head,function(c){return R.isNil(c)?self.Promise.reject("No template selection"):R.pipeP(b.modeForStamp$(c),function(b){return a.event("Modes.switchTo",b)})(a.game.templates)})(c)},set:function(a,b,e,f){var g=d.get(a,f),h=R.assoc(a,b,f);return c(a,e),R.forEach(function(a){e.changeEvent("Game.template.change."+a)},b),R.forEach(function(a){e.changeEvent("Game.template.change."+a)},g),h},removeFrom:function(a,b,d,e){var f=R.prop(a,e),g=R.difference(f,b),h=R.assoc(a,g,e);return c(a,d),R.forEach(function(a){d.changeEvent("Game.template.change."+a)},R.uniq(R.concat(f,b))),h},clear:function(a,b,c){var e=R.prop(a,c);return d.removeFrom(a,e,b,c)}};return R.curryService(d),d}]),angular.module("clickApp.services").factory("gameTerrainInfo",["http",function(a){function b(a){return R.pipe(R.keys,R.sortBy(R.identity),R.reduce(function(b,d){return b[d]=c(a[d]),b},{}))(a)}function c(a){return R.pipe(R.keys,R.sortBy(R.identity),R.reduce(function(b,c){return b[c]=d(a[c]),b},{}))(a)}function d(a){return R.pipe(R.keys,R.sortBy(R.identity),R.reduce(function(b,c){return b[c]=e(a[c]),b},{}))(a)}function e(a){return R.pipe(R.over(R.lensPath(["img","width"]),R.divide(R.__,3)),R.over(R.lensPath(["img","height"]),R.divide(R.__,3)))(a)}var f={init:function(){return a.get("/data/terrains.json")["catch"](function(a){return[]}).then(b)},getInfo:function(a,b){return new self.Promise(function(c,d){var e=R.path(a,b);R.isNil(e)?d("Terrain info "+a.join(".")+" not found"):c(e)})}};return R.curryService(f),f}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("gameTerrains",["point","terrain",function(a,b){var c={create:function(){return{active:[],locked:[]}},all:function(a){return R.concat(a.active,a.locked)},findStamp:function(a,b){return new self.Promise(function(d,e){var f=R.pipe(c.all,R.find(R.pathEq(["state","stamp"],a)))(b);R.isNil(f)?e("Terrain "+a+" not found"):d(f)})},findAnyStamps:function(a,b){return R.pipePromise(R.map(function(a){return c.findStamp(a,b)["catch"](R.always(null))}),R.promiseAll,function(a){return R.isEmpty(R.reject(R.isNil,a))?self.Promise.reject("No terrain found"):a})(a)},fromStamps:function(a,b,c,e){return d(R.compose(R.always,R.always(null)),a,b,c,e)},onStamps:function(a,b,c,f){return R.pipeP(d(R.always,a,b,c),e(f))(f)},setStateStamps:function(a,d,f){return R.pipeP(c.findAnyStamps$(d),R.addIndex(R.map)(function(c,d){return R.isNil(c)?null:b.setState(a[d],c)}),R.reject(R.isNil),e(f))(f)},lockStamps:function(a,d,f){return R.pipeP(c.findAnyStamps$(d),R.reject(R.isNil),R.map(b.setLock$(a)),e(f))(f)},add:function(a,b){return R.pipe(c.removeStamps$(R.map(R.path(["state","stamp"]),a)),R.flip(e)(a))(b)},removeStamps:function(a,b){function c(b){return R.find(R.equals(R.path(["state","stamp"],b)),a)}return R.pipe(R.assoc("active",R.reject(c,b.active)),R.assoc("locked",R.reject(c,b.locked)))(b)},copyStamps:function(d,e){return R.pipeP(c.findAnyStamps$(d),R.reject(R.isNil),function(c){var d=R.pick(["x","y","r"],c[0].state);return{base:d,terrains:R.map(R.compose(a.differenceFrom$(d),b.saveState),c)}})(e)}},d=R.curry(function(a,d,e,f,g){return"Function"!==R.type(b[d])?self.Promise.reject("Unknown method "+d+" on terrains"):R.pipeP(c.findAnyStamps$(f),R.reject(R.isNil),R.map(function(c){return self.Promise.resolve(b[d].apply(null,[].concat(_toConsumableArray(e),[c])))["catch"](a(c))}),R.promiseAll)(g)}),e=R.curry(function(a,d){return R.pipe(c.all,R.concat(d),R.uniqBy(R.path(["state","stamp"])),R.partition(b.isLocked),function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];return{active:d,locked:c}})(a)});return R.curryService(c),c}]),angular.module("clickApp.services").factory("gameTerrainSelection",[function(){function a(a,b){"local"===a&&(b.event("Modes.switchTo","Default"),b.changeEvent("Game.terrain.selection.local.change"))}var b={create:function(){return{local:[],remote:[]}},"in":function(a,b,c){var d=R.prop(a,c);return R.find(R.equals(b),d)},get:function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return R.spyError("titi",arguments),R.propOr([],a,b)},checkMode:function(a,c){return R.pipePromise(function(a){return b.get("local",a)},R.head,function(b){return R.isNil(b)?self.Promise.reject("No terrain selection"):a.event("Modes.switchTo","Terrain")})(c)},set:function(c,d,e,f){var g=b.get(c,f),h=R.assoc(c,d,f);return a(c,e),R.forEach(function(a){e.changeEvent("Game.terrain.change."+a)},d),R.forEach(function(a){e.changeEvent("Game.terrain.change."+a)},g),h},addTo:function(c,d,e,f){var g=b.get(c,f),h=R.uniq(R.concat(g,d)),i=R.assoc(c,h,f);return a(c,e),R.forEach(function(a){e.changeEvent("Game.terrain.change."+a)},h),i},removeFrom:function(b,c,d,e){var f=R.prop(b,e),g=R.difference(f,c),h=R.assoc(b,g,e);return a(b,d),R.forEach(function(a){d.changeEvent("Game.terrain.change."+a)},R.uniq(R.concat(f,c))),h},clear:function(a,c,d){var e=R.prop(a,d);return b.removeFrom(a,e,c,d)}};return R.curryService(b),b}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("point",[function(){var a={moveFront:function(a,b){var c=b.r*Math.PI/180;return R.pipe(R.assoc("x",b.x+a*Math.sin(c)),R.assoc("y",b.y-a*Math.cos(c)))(b)},moveBack:function(a,b){var c=b.r*Math.PI/180;return R.pipe(R.assoc("x",b.x-a*Math.sin(c)),R.assoc("y",b.y+a*Math.cos(c)))(b)},rotateLeft:function(a,b){return R.assoc("r",b.r-a,b)},rotateLeftAround:function(b,c,d){var e=a.directionTo(d,c),f=a.distanceTo(d,c),g=e-b;return R.pipe(R.assoc("x",c.x+f*Math.sin(g*Math.PI/180)),R.assoc("y",c.y-f*Math.cos(g*Math.PI/180)))(d)},rotateRight:function(a,b){return R.assoc("r",b.r+a,b)},rotateRightAround:function(b,c,d){var e=a.directionTo(d,c),f=a.distanceTo(d,c),g=e+b;return R.pipe(R.assoc("x",c.x+f*Math.sin(g*Math.PI/180)),R.assoc("y",c.y-f*Math.cos(g*Math.PI/180)))(d)},rotateAroundTo:function(b,c,d){var e=a.distanceTo(d,c);return R.pipe(R.assoc("x",c.x+e*Math.sin(b*Math.PI/180)),R.assoc("y",c.y-e*Math.cos(b*Math.PI/180)))(d)},shiftLeft:function(a,b){return R.assoc("x",b.x-a,b)},shiftRight:function(a,b){return R.assoc("x",b.x+a,b)},shiftUp:function(a,b){return R.assoc("y",b.y-a,b)},shiftDown:function(a,b){return R.assoc("y",b.y+a,b)},distanceTo:function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},directionTo:function(a,b){return 180*Math.atan2(a.x-b.x,b.y-a.y)/Math.PI},translateInDirection:function(a,b,c){return b=b*Math.PI/180,R.pipe(R.assoc("x",c.x+a*Math.sin(b)),R.assoc("y",c.y-a*Math.cos(b)))(c)},translateInVector:function(a,b,c){return R.pipe(R.assoc("x",c.x+a*b.x),R.assoc("y",c.y+a*b.y))(c)},addToWithFlip:function(a,b,c){var d=a?-1:1,e=a?180:0;return R.pipe(R.assoc("x",b.x+d*c.x),R.assoc("y",b.y+d*c.y),R.assoc("r",b.r+c.r+e))(c)},differenceFrom:function(a,b){return R.pipe(R.assoc("x",b.x-a.x),R.assoc("y",b.y-a.y),R.assoc("r",b.r-a.r))(b)},vectorProduct:function(a,b){return a.y*b.x-a.x*b.y},scalarProduct:function(a,b){return a.x*b.x+a.y*b.y}};return R.curryService(a),a}]).factory("line",["point",function(a){var b={length:function(b){return a.distanceTo(b.end,b.start)},vector:function(a){var c=b.length(a);return{x:(a.end.x-a.start.x)/c,y:(a.end.y-a.start.y)/c}}};return R.curryService(b),b}]).factory("circle",["point","line",function(a,b){function c(a,c,d,f){for(var g=(a.right-a.left)/180,h={start:null,end:null},i=a.left;i<a.right;i+=g){h.start=e.pointOnEdgeInDirection(i,f),h.end=e.pointOnEdgeTangentTo(h.start,!0,c),h.length=b.length(h),h.vector=b.vector(h);var j=R.find(function(a){return e.intersectLine(h,a)},d);if(R.isNil(j))return h}return h}function d(a,c,d,f){for(var g=(a.right-a.left)/180,h={start:null,end:null},i=a.right;i>a.left;i-=g){h.start=e.pointOnEdgeInDirection(i,f),h.end=e.pointOnEdgeTangentTo(h.start,!1,c),h.length=b.length(h),h.vector=b.vector(h);var j=R.find(function(a){return e.intersectLine(h,a)},d);if(R.isNil(j))return h}return h}var e={positionToLine:function(c,d){var e=a.differenceFrom(c.start,d),f=b.length(c),g=b.vector(c),h=a.vectorProduct(g,e),i=a.scalarProduct(g,e);return[h,i,f]},isLeftOfLine:function(a,b){var c=e.positionToLine(a,b),d=_slicedToArray(c,3),f=d[0],g=d[1],h=d[2];return f+b.radius>=0&&g+b.radius>=0&&g-b.radius<=h},isRightOfLine:function(a,b){var c=e.positionToLine(a,b),d=_slicedToArray(c,3),f=d[0],g=d[1],h=d[2];return f-b.radius<=0&&g+b.radius>=0&&g-b.radius<=h},isInEnvelope:function(a,b){return e.isRightOfLine(a.left,b)&&e.isLeftOfLine(a.right,b)},isInBox:function(a,b){var c,d;return b.x>=a.low.x&&b.x<=a.high.x&&b.y>=a.low.y&&b.y<=a.high.x?!0:b.x>=a.low.x-b.radius&&b.x<a.low.x?(c=a.low.x-b.x,d=Math.sqrt(b.radius*b.radius-c*c),b.y+d>=a.low.y&&b.y-d<=a.high.y):b.x<=a.high.x+b.radius&&b.x>a.high.x?(c=a.high.x-b.x,d=Math.sqrt(b.radius*b.radius-c*c),b.y+d>=a.low.y&&b.y-d<=a.high.y):b.y>=a.low.y-b.radius&&b.y<a.low.y?(d=a.low.y-b.y,c=Math.sqrt(b.radius*b.radius-d*d),b.x+c>=a.low.x&&b.x-c<=a.high.x):b.y<=a.high.y+b.radius&&b.y>a.high.y?(d=a.high.y-b.y,c=Math.sqrt(b.radius*b.radius-d*d),b.x+c>=a.low.x&&b.x-c<=a.high.x):!1},intersectLine:function(a,b){var c=e.positionToLine(a,b),d=_slicedToArray(c,3),f=d[0],g=d[1],h=d[2];return Math.abs(f)<b.radius&&g+b.radius>=0&&g-b.radius<=h},pointOnEdgeInDirection:function(a,b){return{x:b.x+Math.sin(Math.PI*a/180)*b.radius,y:b.y-Math.cos(Math.PI*a/180)*b.radius}},pointOnEdgeTangentTo:function(b,c,d){var f=a.distanceTo(d,b),g=a.directionTo(d,b),h=180*Math.acos(d.radius/f)/Math.PI,i=c?g-180+h:g+180-h;return e.pointOnEdgeInDirection(i,d)},envelopeDirectionsTo:function(b,c){var d=a.directionTo(b,c),e=a.distanceTo(b,c),f=Math.abs(c.radius-b.radius),g=180*(Math.asin(f/e)*(c.radius>=b.radius?1:-1))/Math.PI;return{right:d-g+90,left:d+g-90}},envelopeTo:function(a,b){var c=e.envelopeDirectionsTo(a,b),d={left:{start:e.pointOnEdgeInDirection(c.left,b),end:e.pointOnEdgeInDirection(c.left,a)},right:{start:e.pointOnEdgeInDirection(c.right,b),end:e.pointOnEdgeInDirection(c.right,a)}};return d},outsideEnvelopeTo:function(f,g,h){var i=e.envelopeDirectionsTo(f,h),j={left:c(i,f,g,h),right:d(i,f,g,h)};j.left.vector=b.vector(j.left),j.right.vector=b.vector(j.right);var k={left:{start:{x:j.left.end.x,y:j.left.end.y}},right:{start:{x:j.right.end.x,y:j.right.end.y}}},l=800,m=800,n=a.vectorProduct(j.left.vector,j.right.vector);if(n>.001){var o={start:j.left.end,end:j.right.end};o.length=b.length(o),o.vector=b.vector(o);var p=Math.acos(a.scalarProduct(o.vector,j.left.vector)),q=Math.acos(-a.scalarProduct(o.vector,j.right.vector));l=o.length*Math.sin(p)/Math.sin(p+q),m=o.length*Math.sin(q)/Math.sin(p+q)}return l=Math.min(800,l),m=Math.min(800,m),k.left.end=a.translateInVector(l,j.left.vector,k.left.start),k.right.end=a.translateInVector(m,j.right.vector,k.right.start),k}};return R.curryService(e),e}]),angular.module("clickApp.services").factory("http",[function(){function a(a,b,c){return new self.Promise(function(d,e){var f=new self.XMLHttpRequest;f.open(a,b),f.responseType="json",R.exists(c)?f.send(JSON.stringify(c)):f.send(),f.onload=function(){f.status>=200&&f.status<300?d(f.response):e(f.statusText)},f.onerror=function(){e(f.statusText)}})}var b={get:function(b){return a("GET",b)},post:function(b,c){return a("POST",b,c)},put:function(b,c){return a("PUT",b,c)},"delete":function(b){return a("DELETE",b)}};return R.curryService(b),b}]),angular.module("clickApp.services").factory("jsonParser",[function(){var a={parse:function(a){return self.Promise.resolve(a).then(function(a){return JSON.parse(a)})["catch"](function(a){return self.Promise.reject(a.message)})}};return R.curryService(a),a}]),angular.module("clickApp.services").factory("jsonStringifier",[function(){function a(a,b){return s.startsWith(a,"$$")?void 0:b}var b={stringify:function(b){return self.Promise.resolve(JSON.stringify(b,a))}};return R.curryService(b),b}]),angular.module("clickApp.services").factory("localStorage",["jsonParser","jsonStringifier",function(a,b){var c={getItem:function(a){return new self.Promise(function(b){b(self.localStorage.getItem(a))})},load:function(b){return c.getItem(b).then(a.parse)},setItem:function(a,b){return new self.Promise(function(c){self.localStorage.setItem(a,b),c(b)})},save:function(a,d){return b.stringify(d).then(c.setItem$(a)).then(R.always(d))},removeItem:function(a){return new self.Promise(function(b){b(self.localStorage.removeItem(a))})}};return R.curryService(c),c}]),angular.module("clickApp.services").factory("model",["settings","point","gameFactions","modelArea","modelAura","modelCharge","modelCounter","modelDamage","modelEffect","modelGeom","modelImage","modelIncorporeal","modelLabel","modelLeader","modelMelee","modelMove","modelPlace","modelRuler","modelUnit","modelWreck",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(a){return"warrior"===a.type?{n:0,t:0}:R.pipe(R.keys,R.reject(R.equals("type")),R.reject(R.equals("field")),R.reject(R.equals("total")),R.reject(R.equals("depth")),R.reduce(function(b,c){return R.assoc(c,R.map(R.always(0),a[c]),b)},{}),R.assoc("f",0),R.assoc("t",0))(a)}var v={Move:10,MoveSmall:5,Rotate:15,RotateSmall:5,Shift:10,ShiftSmall:1,RotateCharge:10,RotateChargeSmall:2},w=R.clone(v);a.register("Moves","Model",v,function(a){R.extend(w,a)});var x={create:function(a,b){return R.pipeP(c.getModelInfo$(b.info),function(c){var d={state:{x:0,y:0,r:0,img:0,dsp:["i"],eff:[],l:[],c:0,s:0,u:null,aur:null,are:null,rml:null,cml:null,pml:[null,!1],cha:null,pla:null,dmg:u(c.damage),stamp:R.guid()}};return("wardude"===c.type||"beast"===c.type||"jack"===c.type)&&(d.state.dsp=R.append("c",d.state.dsp)),c.immovable&&(d.state.dsp=R.append("lk",d.state.dsp)),d.state=R.deepExtend(d.state,b),x.checkState(a,null,d)})(a)},stamp:function(a){return R.path(["state","stamp"],a)},eventName:function(a){return R.path(["state","stamp"],a)},user:function(a){return R.path(["state","user"],a)},userIs:function(a,b){return R.pathEq(["state","user"],a,b)},state:function(a){return R.prop("state",a)},saveState:function(a){return R.clone(R.prop("state",a))},setState:function(a,b){return R.assoc("state",R.clone(a),b)},state_checkers:[],state_updaters:[],checkState:function(a,b,d){return R.pipeP(c.getModelInfo$(d.state.info),function(a){var c=a.base_radius;return R.pipe(R.assoc("x",Math.max(0+c,Math.min(480-c,d.state.x))),R.assoc("y",Math.max(0+c,Math.min(480-c,d.state.y))),function(c){return R.reduce(function(c,d){return d(a,b,c)},c,x.state_checkers)},function(a){return R.reduce(function(a,b){return b(a)},a,x.state_updaters)})(d.state)},function(a){return R.assoc("state",a,d)})(a)},isLocked:function(a){return R.pipe(R.pathOr([],["state","dsp"]),R.find(R.equals("lk")),R.exists)(a)},setLock:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("lk")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("lk")),b)},modeFor:function(a){return x.isCharging(a)?"ModelCharge":x.isPlacing(a)?"ModelPlace":"Model"},descriptionFromInfo:function(a,b){return R.pipe(R.props(["unit_name","name"]),R.prepend(x.user(b)),R.reject(R.isNil),R.join("/"))(a)}};return R.extend(x,d(x),e(x),f(w,x),g(x),h(x),i(x),j(x),k(x),l(x),m(x),n(x),q(w,x),o(x),p(w,x),r(x),s(x),t(x)),R.curryService(x),x}]),angular.module("clickApp.services").factory("modelArea",["gameFactions",function(a){return function(){var b={isCtrlAreaDisplayed:function(b,c){return R.pipeP(a.getModelInfo$(c.state.info),function(a){return"wardude"===a.type&&("Number"===R.type(a.focus)||"Number"===R.type(a.fury))&&!!R.find(R.equals("a"),c.state.dsp)})(b)},setCtrlAreaDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("a")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("a")),b)},toggleCtrlAreaDisplay:function(a){return R.find(R.equals("a"),a.state.dsp)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("a")),a):R.over(R.lensPath(["state","dsp"]),R.append("a"),a)},isAreaDisplayed:function(a){return R.exists(a.state.are)},areaDisplay:function(a){return a.state.are},setAreaDisplay:function(a,b){return R.assocPath(["state","are"],a,b)},toggleAreaDisplay:function(a,b){return R.over(R.lensPath(["state","are"]),function(b){return a===b?null:a},b)}};return b}}]),angular.module("clickApp.services").factory("modelAura",[function(){return function(){var a={isAuraDisplayed:function(a){return R.exists(a.state.aur)},auraDisplay:function(a){return a.state.aur},setAuraDisplay:function(a,b){return R.assocPath(["state","aur"],a,b)},toggleAuraDisplay:function(a,b){return R.over(R.lensPath(["state","aur"]),function(b){return a===b?null:a},b)}};return a}}]),angular.module("clickApp.services").factory("modelCharge",["point",function(a){var b=.1;return function(c,d){var e={startCharge:function(a){return d.isLocked(a)?self.Promise.reject("Model is locked"):R.assocPath(["state","cha"],{s:R.pick(["x","y","r"],a.state),t:null},a)},isCharging:function(a){return R.exists(a.state.cha)},chargeTarget:function(a){return new self.Promise(function(b,c){return d.isCharging(a)?void b(R.path(["state","cha","t"],a)):void c("Model is not charging")})},endCharge:function(a){return R.assocPath(["state","cha"],null,a)},setChargeTarget:function(b,c,e){return d.isLocked(e)?self.Promise.reject("Model is locked"):(e=R.exists(c)?R.pipe(R.over(R.lensPath(["state","cha"]),R.assoc("t",c.state.stamp)),R.over(R.lensProp("state"),R.assoc("r",a.directionTo(c.state,e.state))))(e):R.assocPath(["state","cha","t"],null,e),d.checkState(b,c,e))},chargeMaxLength:function(a){return R.path(["state","cml"],a)},setChargeMaxLength:function(a,b,c){return c=R.assocPath(["state","cml"],b,c),d.checkState(a,null,c)},moveFrontCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"MoveSmall":"Move"],i=g.state.cha.s.r;return g=R.over(R.lensProp("state"),a.translateInDirection$(h,i),g),d.checkState(b,e,g)},moveBackCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"MoveSmall":"Move"],i=g.state.cha.s.r+180,j=a.distanceTo(g.state,g.state.cha.s);return h>j&&(h=j),g=R.over(R.lensProp("state"),a.translateInDirection$(h,i),g),d.checkState(b,e,g)},rotateLeftCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"RotateChargeSmall":"RotateCharge"];return g=R.pipe(R.over(R.lensProp("state"),a.rotateLeftAround$(h,g.state.cha.s)),R.over(R.lensPath(["state","cha","s","r"]),R.subtract(R.__,h)))(g),d.checkState(b,e,g)},rotateRightCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"RotateChargeSmall":"RotateCharge"];return g=R.pipe(R.over(R.lensProp("state"),a.rotateRightAround$(h,g.state.cha.s)),R.over(R.lensPath(["state","cha","s","r"]),R.add(h)))(g),d.checkState(b,e,g)},shiftLeftCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"ShiftSmall":"Shift"];return g=R.over(R.lensProp("state"),a.shiftLeft$(h),g),d.checkState(b,e,g)},shiftRightCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"ShiftSmall":"Shift"];return g=R.over(R.lensProp("state"),a.shiftRight$(h),g),d.checkState(b,e,g)},shiftUpCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"ShiftSmall":"Shift"];return g=R.over(R.lensProp("state"),a.shiftUp$(h),g),d.checkState(b,e,g)},shiftDownCharge:function(b,e,f,g){if(d.isLocked(g))return self.Promise.reject("Model is locked");var h=c[f?"ShiftSmall":"Shift"];return g=R.over(R.lensProp("state"),a.shiftDown$(h),g),d.checkState(b,e,g)}},f=R.curry(function(b,c,d){if(R.exists(d.cha)&&R.exists(d.cml)&&d.cml>0){var e=a.distanceTo(d,d.cha.s);if(e>10*d.cml){var f=a.directionTo(d,d.cha.s),g=a.translateInDirection(10*d.cml,f,d.cha.s);return R.pipe(R.assoc("x",g.x),R.assoc("y",g.y))(d)}}return d});d.state_checkers=R.append(f,d.state_checkers);var g=R.curry(function(c,d,e){if(R.exists(e.cha)){if(R.exists(d))return R.assoc("r",a.directionTo(d.state,e),e);var f=a.distanceTo(e,e.cha.s),g=b>f?e.r:a.directionTo(e,e.cha.s);return R.assoc("r",g,e)}return e});d.state_checkers=R.append(g,d.state_checkers);var h=R.curry(function(c){if(R.exists(c.cha)){var d=a.distanceTo(c,c.cha.s);if(d>b){var e=a.directionTo(c,c.cha.s);return R.assocPath(["cha","s","r"],e,c)}}return c});return d.state_updaters=R.append(h,d.state_updaters),e}}]),angular.module("clickApp.services").factory("modelCounter",[function(){return function(a){var b={isCounterDisplayed:function(a,b){return!!R.find(R.equals(a),b.state.dsp)},incrementCounter:function(a,b){var c=R.defaultTo(0,b.state[a])+1;return R.assocPath(["state",a],c,b)},decrementCounter:function(a,b){var c=Math.max(0,R.defaultTo(0,b.state[a])-1);return R.assocPath(["state",a],c,b)},setCounterDisplay:function(a,b,c){return b?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append(a)),c):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals(a)),c)},toggleCounterDisplay:function(b,c){return a.isCounterDisplayed(b,c)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals(b)),c):R.over(R.lensPath(["state","dsp"]),R.append(b),c)}};return b}}]),angular.module("clickApp.services").factory("modelDamage",["gameFactions",function(a){return function(){function b(a){return R.pipe(R.keys,R.reject(R.equals("t")),R.reject(R.equals("f")),R.reject(R.equals("n")),R.reduce(function(b,c){return b+R.reduce(R.add,0,a[c])},0))(a)}var c={resetDamage:function(a){return R.over(R.lensPath(["state","dmg"]),R.pipe(R.keys,R.reduce(function(b,c){var d=a.state.dmg[c];return d="Array"===R.type(d)?R.map(R.always(0),d):0,R.assoc(c,d,b)},{})),a)},setWarriorDamage:function(b,c,d){return R.pipeP(a.getModelInfo$(d.state.info),function(a){var b=R.defaultTo(0,d.state.dmg.n);return b=b===c?0:c,b=Math.min(b,a.damage.n),R.over(R.lensPath(["state","dmg"]),R.pipe(R.assoc("n",b),R.assoc("t",b)),d)})(b)},setFieldDamage:function(b,c,d){return R.pipeP(a.getModelInfo$(d.state.info),function(a){var b=R.defaultTo(0,d.state.dmg.f);return b=b===c?0:c,b=Math.min(b,a.damage.field),R.assocPath(["state","dmg","f"],b,d)})(b)},setGridDamage:function(c,d,e,f){return R.pipeP(a.getModelInfo$(f.state.info),function(a){var c=f.state.dmg[e][d];return c=0===c?1:0,c=R.exists(a.damage[e][d])?c:0,R.over(R.lensPath(["state","dmg"]),R.pipe(R.over(R.lensProp(e),R.update(d,c)),function(a){return R.assoc("t",b(a),a)}),f)})(c)},setGridColDamage:function(c,d,e){return R.pipeP(a.getModelInfo$(e.state.info),function(a){var c=R.pipe(R.addIndex(R.filter)(function(b,c){return R.exists(a.damage[d][c])}),R.reject(R.equals(1)),R.isEmpty)(e.state.dmg[d]),f=c?0:1;return R.over(R.lensPath(["state","dmg"]),R.pipe(R.over(R.lensProp(d),R.addIndex(R.map)(function(b,c){return R.exists(a.damage[d][c])?f:0})),function(a){return R.assoc("t",b(a),a)}),e)})(c)}};return c}}]),angular.module("clickApp.services").factory("modelGeom",["point","gameFactions",function(a,b){return function(c){var d={isBetweenPoints:function(a,b,c){var d=R.path(["state","x"],c),e=R.path(["state","y"],c);return a.x<=d&&d<=b.x&&a.y<=e&&e<=b.y},shortestLineTo:function(c,d,e){var f=a.directionTo(d.state,e.state);return R.pipeP(b.getModelInfo$(e.state.info),function(g){var h=a.translateInDirection(g.base_radius,f,e.state);return R.pipeP(b.getModelInfo$(d.state.info),function(b){var c=a.translateInDirection(b.base_radius,f+180,d.state);return{start:R.pick(["x","y"],h),end:R.pick(["x","y"],c)}})(c)})(c)},baseEdgeInDirection:function(c,d,e){return R.pipeP(b.getModelInfo$(e.state.info),function(b){return R.pipe(a.translateInDirection$(b.base_radius,d),R.pick(["x","y"]))(e.state)})(c)},distanceTo:function(c,d,e){return R.pipeP(b.getModelInfo$(e.state.info),function(f){return R.pipeP(b.getModelInfo$(d.state.info),function(b){return a.distanceTo(d.state,e.state)-f.base_radius-b.base_radius})(c)})(c)},distanceToAoE:function(c,d,e){return R.pipeP(b.getModelInfo$(e.state.info),function(b){var c=d.state.s;return a.distanceTo(d.state,e.state)-b.base_radius-c})(c)},setB2B:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a.directionTo(f.state,e.state);return R.pipeP(b.getModelInfo$(f.state.info),function(h){return R.pipeP(b.getModelInfo$(e.state.info),function(b){var i=h.base_radius+b.base_radius,j=a.translateInDirection(i,g,e.state);return f=R.pipe(R.assocPath(["state","x"],j.x),R.assocPath(["state","y"],j.y))(f),c.checkState(d,null,f)})(d)})(d)}};return d}}]),angular.module("clickApp.services").factory("modelEffect",[function(){return function(a){var b={isEffectDisplayed:function(a,b){return!!R.find(R.equals(a),R.pathOr([],["state","eff"],b))},setEffectDisplay:function(a,b,c){return b?R.over(R.lensPath(["state","eff"]),R.compose(R.uniq,R.append(a),R.defaultTo([])),c):R.over(R.lensPath(["state","eff"]),R.compose(R.reject(R.equals(a)),R.defaultTo([])),c)},toggleEffectDisplay:function(b,c){return a.isEffectDisplayed(b,c)?R.over(R.lensPath(["state","eff"]),R.compose(R.reject(R.equals(b)),R.defaultTo([])),c):R.over(R.lensPath(["state","eff"]),R.compose(R.append(b),R.defaultTo([])),c)}};return b}}]),angular.module("clickApp.services").factory("modelImage",["gameFactions",function(a){return function(b){var c={isImageDisplayed:function(a){return!!R.find(R.equals("i"),a.state.dsp)},getImage:function(c,d){return R.pipeP(a.getModelInfo$(d.state.info),R.prop("img"),function(a){var c=R.pipe(R.filter(R.propEq("type","default")),R.prop(d.state.img))(a);b.isLeaderDisplayed(d)&&(c=R.pipe(R.filter(R.propEq("type","leader")),R.head,R.defaultTo(c))(a)),b.isIncorporealDisplayed(d)&&(c=R.pipe(R.filter(R.propEq("type","incorporeal")),R.head,R.defaultTo(c))(a));var e=b.isImageDisplayed(d)?c.link:null;return R.assoc("link",e,c)})(c)},setNextImage:function(b,c){return R.pipeP(a.getModelInfo$(c.state.info),R.prop("img"),R.filter(R.propEq("type","default")),function(a){return c.state.img>=a.length-1?0:c.state.img+1},function(a){return R.assocPath(["state","img"],a,c)})(b)},setImageDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("i")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("i")),b)},toggleImageDisplay:function(a){return b.isImageDisplayed(a)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("i")),a):R.over(R.lensPath(["state","dsp"]),R.append("i"),a)}};return c}}]),angular.module("clickApp.services").factory("modelIncorporeal",[function(){return function(a){var b={isIncorporealDisplayed:function(a){return!!R.find(R.equals("in"),a.state.dsp)},setIncorporealDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("in")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("in")),b)},toggleIncorporealDisplay:function(b){return a.isIncorporealDisplayed(b)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("in")),b):R.over(R.lensPath(["state","dsp"]),R.append("in"),b)}};return b}}]),angular.module("clickApp.services").factory("modelLabel",[function(){return function(){var a={addLabel:function(a,b){return R.over(R.lensPath(["state","l"]),R.compose(R.uniq,R.append(a)),b)},removeLabel:function(a,b){return R.over(R.lensPath(["state","l"]),R.reject(R.equals(a)),b)},clearLabel:function(a){return R.assocPath(["state","l"],[],a)},fullLabel:function(a){return R.pathOr([],["state","l"],a).join(" ")}};return a}}]),angular.module("clickApp.services").factory("modelLeader",[function(){return function(a){var b={isLeaderDisplayed:function(a){return!!R.find(R.equals("l"),a.state.dsp)},setLeaderDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("l")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("l")),b)},toggleLeaderDisplay:function(b){return a.isLeaderDisplayed(b)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("l")),b):R.over(R.lensPath(["state","dsp"]),R.append("l"),b)}};return b}}]),angular.module("clickApp.services").factory("modelMelee",[function(){return function(a){var b={isMeleeDisplayed:function(a,b){return!!R.find(R.equals(a),b.state.dsp)},setMeleeDisplay:function(a,b,c){return b?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append(a)),c):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals(a)),c)},toggleMeleeDisplay:function(b,c){return a.isMeleeDisplayed(b,c)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals(b)),c):R.over(R.lensPath(["state","dsp"]),R.append(b),c)}};return b}}]),angular.module("clickApp.services").factory("modelMove",["settings","point",function(a,b){return function(a,c){var d={setPosition:function(a,b,d,e){return c.isLocked(e)?self.Promise.reject("Model is locked"):(e=R.pipe(R.assocPath(["state","x"],d.x),R.assocPath(["state","y"],d.y))(e),c.checkState(a,b,e))},setPosition_:function(a,b,d,e){return c.isLocked(e)?self.Promise.reject("Model is locked"):(e.state=R.pipe(R.assoc("x",d.x),R.assoc("y",d.y))(e.state),R.pipePromise(function(){return c.checkState(a,b,e)},function(a){return e.state=a.state,e})())},shiftPosition:function(a,b,d,e){return c.isLocked(e)?self.Promise.reject("Model is locked"):(e=R.pipe(R.over(R.lensPath(["state","x"]),R.add(d.x)),R.over(R.lensPath(["state","y"]),R.add(d.y)))(e),
c.checkState(a,b,e))},setOrientation:function(a,b,d){return c.isLocked(d)?self.Promise.reject("Model is locked"):(d=R.assocPath(["state","r"],b,d),c.checkState(a,null,d))},orientTo:function(a,d,e){return c.isLocked(e)?self.Promise.reject("Model is locked"):(e=R.assocPath(["state","r"],b.directionTo(d.state,e.state),e),c.checkState(a,null,e))},moveFront:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"MoveSmall":"Move"];return f=R.over(R.lensProp("state"),b.moveFront$(g),f),c.checkState(d,null,f)},moveBack:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"MoveSmall":"Move"];return f=R.over(R.lensProp("state"),b.moveBack$(g),f),c.checkState(d,null,f)},rotateLeft:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"RotateSmall":"Rotate"];return f=R.over(R.lensProp("state"),b.rotateLeft$(g),f),c.checkState(d,null,f)},rotateRight:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"RotateSmall":"Rotate"];return f=R.over(R.lensProp("state"),b.rotateRight$(g),f),c.checkState(d,null,f)},shiftLeft:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),b.shiftLeft$(g),f),c.checkState(d,null,f)},shiftRight:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),b.shiftRight$(g),f),c.checkState(d,null,f)},shiftUp:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),b.shiftUp$(g),f),c.checkState(d,null,f)},shiftDown:function(d,e,f){if(c.isLocked(f))return self.Promise.reject("Model is locked");var g=a[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),b.shiftDown$(g),f),c.checkState(d,null,f)}};return d}}]),angular.module("clickApp.services").factory("modelPlace",["point",function(a){var b=.1;return function(c,d){var e={startPlace:function(a){return d.isLocked(a)?self.Promise.reject("Model is locked"):R.assocPath(["state","pla"],{s:R.pick(["x","y","r"],a.state)},a)},isPlacing:function(a){return R.exists(a.state.pla)},endPlace:function(a){return R.assocPath(["state","pla"],null,a)},setPlaceOrigin:function(b,c,e){if(d.isLocked(e))return self.Promise.reject("Model is locked");var f=a.directionTo(e.state.pla.s,c.state);return e=R.pipe(R.over(R.lensProp("state"),a.rotateAroundTo$(f,e.state.pla.s)),R.assocPath(["state","pla","s","r"],f))(e),d.checkState(b,null,e)},setPlaceTarget:function(b,c,e){if(d.isLocked(e))return self.Promise.reject("Model is locked");var f=a.directionTo(c.state,e.state.pla.s);return e=R.pipe(R.over(R.lensProp("state"),a.rotateAroundTo$(f,e.state.pla.s)),R.assocPath(["state","pla","s","r"],f))(e),d.checkState(b,null,e)},placeMaxLength:function(a){return R.head(R.path(["state","pml"],a))},setPlaceMaxLength:function(a,b,c){return c=R.assocPath(["state","pml"],[b,c.state.pml[1]],c),d.checkState(a,null,c)},placeWithin:function(a){return R.nth(1,R.pathOr([],["state","pml"],a))},setPlaceWithin:function(a,b,c){return c=R.assocPath(["state","pml"],[c.state.pml[0],b],c),d.checkState(a,null,c)},moveFrontPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"MoveSmall":"Move"],h=f.state.pla.s.r;return f=R.over(R.lensProp("state"),a.translateInDirection$(g,h),f),d.checkState(b,null,f)},moveBackPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"MoveSmall":"Move"],h=f.state.pla.s.r+180,i=a.distanceTo(f.state,f.state.pla.s);return g>i&&(g=i),f=R.over(R.lensProp("state"),a.translateInDirection$(g,h),f),d.checkState(b,null,f)},rotateLeftPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"RotateChargeSmall":"RotateCharge"];return f=R.pipe(R.over(R.lensProp("state"),a.rotateLeftAround$(g,f.state.pla.s)),R.over(R.lensPath(["state","pla","s","r"]),R.subtract(R.__,g)))(f),d.checkState(b,null,f)},rotateRightPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"RotateChargeSmall":"RotateCharge"];return f=R.pipe(R.over(R.lensProp("state"),a.rotateRightAround$(g,f.state.pla.s)),R.over(R.lensPath(["state","pla","s","r"]),R.add(g)))(f),d.checkState(b,null,f)},shiftLeftPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),a.shiftLeft$(g),f),d.checkState(b,null,f)},shiftRightPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),a.shiftRight$(g),f),d.checkState(b,null,f)},shiftUpPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),a.shiftUp$(g),f),d.checkState(b,null,f)},shiftDownPlace:function(b,e,f){if(d.isLocked(f))return self.Promise.reject("Model is locked");var g=c[e?"ShiftSmall":"Shift"];return f=R.over(R.lensProp("state"),a.shiftDown$(g),f),d.checkState(b,null,f)}},f=R.curry(function(b,c,d){if(R.exists(d.pla)&&R.exists(d.pml)&&d.pml[0]>0){var e=a.distanceTo(d,d.pla.s),f=10*d.pml[0]+(d.pml[1]?2*b.base_radius:0);if(e>f){var g=a.directionTo(d,d.pla.s),h=a.translateInDirection(f,g,d.pla.s);return R.pipe(R.assoc("x",h.x),R.assoc("y",h.y))(d)}}return d});d.state_checkers=R.append(f,d.state_checkers);var g=R.curry(function(c){if(R.exists(c.pla)){var d=a.distanceTo(c,c.pla.s);if(d>b){var e=a.directionTo(c,c.pla.s);return R.assocPath(["pla","s","r"],e,c)}}return c});return d.state_updaters=R.append(g,d.state_updaters),e}}]),angular.module("clickApp.services").factory("modelRuler",[function(){return function(){var a={rulerMaxLength:function(a){return R.path(["state","rml"],a)},setRulerMaxLength:function(a,b){return R.assocPath(["state","rml"],a,b)}};return a}}]),angular.module("clickApp.services").factory("modelUnit",[function(){return function(a){var b={isUnitDisplayed:function(a){return!!R.find(R.equals("u"),a.state.dsp)},unit:function(a){return R.prop("u",a.state)},unitIs:function(a,b){return R.propEq("u",a,b.state)},setUnit:function(a,b){return R.assocPath(["state","u"],a,b)},setUnitDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("u")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("u")),b)},toggleUnitDisplay:function(b){return a.isUnitDisplayed(b)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("u")),b):R.over(R.lensPath(["state","dsp"]),R.append("u"),b)}};return b}}]),angular.module("clickApp.services").factory("modelWreck",["gameFactions",function(a){return function(b){var c={isWreckDisplayed:function(a){return!!R.find(R.equals("w"),a.state.dsp)},getWreckImage:function(c,d){return R.pipeP(a.getModelInfo$(d.state.info),R.prop("img"),function(a){var b=R.find(R.propEq("type","wreck"),a);return R.isNil(b)&&(b=R.pipe(R.find(R.propEq("type","default")),R.defaultTo({}),R.assoc("link",null))(a)),b},function(a){var c=b.isImageDisplayed(d)?a.link:null;return R.assoc("link",c,a)})(c)},setWreckDisplay:function(a,b){return a?R.over(R.lensPath(["state","dsp"]),R.compose(R.uniq,R.append("w")),b):R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("w")),b)},toggleWreckDisplay:function(a){return b.isWreckDisplayed(a)?R.over(R.lensPath(["state","dsp"]),R.reject(R.equals("w")),a):R.over(R.lensPath(["state","dsp"]),R.append("w"),a)}};return c}}]),angular.module("clickApp.services").factory("modes",[function(){function a(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return R.pathOr({},["register",R.propOr("##","current",a)],a)}function b(a,b){var d=R.keys(a.bindings),e=R.keysIn(a.bindings),f=R.difference(e,d);R.forEach(function(d){Mousetrap.bind(a.bindings[d],c(d,b))},f),R.forEach(function(d){Mousetrap.bind(a.bindings[d],c(d,b))},d)}function c(a,b){return function(c,d){b.event("Modes.current.action",a,[c])}}var d={},e={registerMode:function(a){d[a.name]=a},init:function(a){var b={register:d};return Mousetrap.reset(),f("Default",a,b)},exit:function(a,b){return h(a,b)},currentModeName:function(b){return R.propOr("Unknown","name",a(b))},currentModeActions:function(b){return R.propOr({},"actions",a(b))},currentModeBindings:function(b){return R.propOr({},"bindings",a(b))},currentModeButtons:function(b){return R.propOr({},"buttons",a(b))},currentModeBindingsPairs:function(a){return R.pipe(e.currentModeBindings,R.toPairsIn,R.sortBy(R.head))(a)},currentModeAction:function(b,c,d){var f=e.currentModeName(d);return R.pipePromise(a,R.path(["actions",b]),R.rejectIf(R.isNil,'Unknown action "'+b+'" in "'+f+'" mode'),function(a){return a.apply(null,c)})(d)},switchToMode:function(b,c,d){var e=a(d);return R.pipePromise(R.path(["register",b]),R.rejectIf(R.isNil,"Mode "+b+" does not exists"),R.always(d),g(c),f(b,c),R.spy("Modes: switch mode from "+e.name+" to "+b))(d)}},f=R.curry(function(a,b,c){return R.pipePromise(R.path(["register",a]),function(a){return R.exists(a.onEnter)?a.onEnter(b):null},R.always(c),R.assoc("current",a),i(b))(c)}),g=R.curry(function(b,c){return R.pipePromise(a,function(a){return R.exists(a.onLeave)?a.onLeave(b):null},R.always(c),h(b),R.assoc("current",null))(c)}),h=R.curry(function(a,b){return Mousetrap.reset(),b}),i=R.curry(function(c,d){return b(a(d),c),d});return R.curryService(e),e}]).factory("allModes",["defaultMode","rulerMode","losMode","createModelMode","modelsMode","modelMode","modelChargeMode","modelPlaceMode","createTemplateMode","aoeTemplateMode","sprayTemplateMode","wallTemplateMode","createTerrainMode","terrainMode",function(){return{}}]),angular.module("clickApp.services").factory("commonMode",["modes","settings","game",function(a,b){var c={modeBackToDefault:function(a){return a.event("Modes.switchTo","Default")},commandUndoLast:function(a){return a.event("Game.command.undoLast")},commandReplayNext:function(a){return a.event("Game.command.replayNext")},viewScrollLeft:function(a){a.changeEvent("Game.view.scrollLeft")},viewScrollRight:function(a){a.changeEvent("Game.view.scrollRight")},viewScrollUp:function(a){a.changeEvent("Game.view.scrollUp")},viewScrollDown:function(a){a.changeEvent("Game.view.scrollDown")},viewZoomIn:function(a){a.changeEvent("Game.view.zoomIn")},viewZoomOut:function(a){a.changeEvent("Game.view.zoomOut")},viewZoomReset:function(a){a.changeEvent("Game.view.zoomReset")},flipMap:function(a){a.changeEvent("Game.view.flipMap")},toggleMenu:function(a){a.changeEvent("Game.toggleMenu")},roll1D6:function(a){return a.event("Game.command.execute","rollDice",[6,1])},roll2D6:function(a){return a.event("Game.command.execute","rollDice",[6,2])},roll3D6:function(a){return a.event("Game.command.execute","rollDice",[6,3])},roll4D6:function(a){return a.event("Game.command.execute","rollDice",[6,4])},roll5D6:function(a){return a.event("Game.command.execute","rollDice",[6,5])}},d={commandUndoLast:"ctrl+z",commandReplayNext:"ctrl+y",modeBackToDefault:"esc",viewScrollLeft:"alt+left",viewScrollRight:"alt+right",viewScrollUp:"alt+up",viewScrollDown:"alt+down",viewZoomIn:"alt++",viewZoomOut:"alt+-",viewZoomReset:"alt+z",flipMap:"ctrl+shift+f",toggleMenu:"ctrl+shift+m"},e={name:"Common",actions:c,buttons:[],bindings:R.clone(d)};return b.register("Bindings",e.name,d,function(a){R.extend(e.bindings,a)}),e}]),angular.module("clickApp.services").factory("defaultMode",["modes","settings","commonMode","game","template","gameTemplateSelection","gameModels","gameModelSelection","gameTerrainSelection",function(a,b,c,d,e,f,g,h,i){function j(a){return function(){return a.event("Game.update",R.lensProp("template_selection"),f.clear$("local",a))}}function k(a){return function(){return a.event("Game.update",R.lensProp("terrain_selection"),i.clear$("local",a))}}var l={DragEpsilon:3},m=R.clone(l);b.register("Moves","Default",l,function(a){R.extend(m,a)});var n=Object.create(c.actions);n.setModelSelection=function(a,b){return R.pipePromise(j(a),k(a),function(){var c=b["click#"].target.state.stamp;return a.event("Game.command.execute","setModelSelection",["set",[c]])})()},n.toggleModelSelection=function(a,b){return R.pipePromise(j(a),k(a),function(){var c=b["click#"].target.state.stamp;return h["in"]("local",c,a.game.model_selection)?a.event("Game.command.execute","setModelSelection",["removeFrom",[c]]):a.event("Game.command.execute","setModelSelection",["addTo",[c]])})()},n.modelSelectionDetail=function(a,b){return R.pipePromise(j(a),k(a),function(){var c=b["click#"].target.state.stamp;return a.changeEvent("Game.selectionDetail.open","model",b["click#"].target),a.event("Game.command.execute","setModelSelection",["set",[c]])})()},n.selectTemplate=function(a,b){return R.pipePromise(k(a),function(){return a.event("Game.update",R.lensProp("template_selection"),f.set$("local",[b["click#"].target.state.stamp],a))})()},n.templateSelectionDetail=function(a,b){return R.pipePromise(k(a),function(){return a.event("Game.update",R.lensProp("template_selection"),f.set$("local",[b["click#"].target.state.stamp],a))},function(){return a.changeEvent("Game.selectionDetail.open","template",b["click#"].target)})()},n.selectTerrain=function(a,b){return R.pipePromise(j(a),function(){return a.event("Game.update",R.lensProp("terrain_selection"),i.set$("local",[b["click#"].target.state.stamp],a))})()},n.enterRulerMode=function(a){return a.event("Modes.switchTo","Ruler")},n.enterLosMode=function(a){return a.event("Modes.switchTo","LoS")},n.dragStartMap=function(a,b){a.changeEvent("Game.dragBox.enable",b.start,b.now)},n.dragMap=function(a,b){a.changeEvent("Game.dragBox.enable",b.start,b.now)},n.dragEndMap=function(a,b){a.changeEvent("Game.dragBox.disable");var c={x:Math.min(b.now.x,b.start.x),y:Math.min(b.now.y,b.start.y)},d={x:Math.max(b.now.x,b.start.x),y:Math.max(b.now.y,b.start.y)};return R.pipeP(g.findStampsBetweenPoints$(c,d),function(b){return R.isEmpty(b)?null:a.event("Game.command.execute","setModelSelection",["set",b])})(a.game.models)};var o={enterRulerMode:"ctrl+r",enterLosMode:"ctrl+l",setModelSelection:"clickModel",toggleModelSelection:"ctrl+clickModel",modelSelectionDetail:"rightClickModel",selectTemplate:"clickTemplate",templateSelectionDetail:"rightClickTemplate",selectTerrain:"clickTerrain"},p=R.extend(Object.create(c.bindings),o),q=[],r={name:"Default",onEnter:function(a){f.checkMode(a,a.game.template_selection)["catch"](function(){return i.checkMode(a,a.game.terrain_selection)})["catch"](function(){return h.checkMode(a,a.game.model_selection)})["catch"](R.always(null))},actions:n,buttons:q,bindings:p,moves:function(){return m}};return a.registerMode(r),b.register("Bindings",r.name,o,function(a){R.extend(r.bindings,a)}),r}]),angular.module("clickApp.services").factory("losMode",["modes","settings","commonMode","game","gameLos","gameModels","gameModelSelection",function(a,b,c,d,e,f,g){var h=Object.create(c.actions);h.exitLosMode=c.actions.modeBackToDefault,h.dragStartMap=function(a,b){return a.event("Game.update",R.lensProp("los"),e.setLocal$(b.start,b.now,a))},h.dragMap=function(a,b){return a.event("Game.update",R.lensProp("los"),e.setLocal$(b.start,b.now,a))},h.dragEndMap=function(a,b){return a.event("Game.command.execute","setLos",["setRemote",[b.start,b.now]])},h.dragStartTemplate=h.dragStartMap,h.dragTemplate=h.dragMap,h.dragEndTemplate=h.dragEndMap,h.dragStartModel=h.dragStartMap,h.dragModel=h.dragMap,h.dragEndModel=h.dragEndMap,h.setOriginModel=function(a,b){return a.event("Game.command.execute","setLos",["setOrigin",[b["click#"].target]])},h.setTargetModel=function(a,b){return a.event("Game.command.execute","setLos",["setTarget",[b["click#"].target]])},h.toggleIgnoreModel=function(a,b){return a.event("Game.command.execute","setLos",["toggleIgnoreModel",[b["click#"].target]])};var i={exitLosMode:"ctrl+l",toggleIgnoreModel:"clickModel",setOriginModel:"ctrl+clickModel",setTargetModel:"shift+clickModel"},j=R.extend(Object.create(c.bindings),i),k=[],l={onEnter:function(a){return R.pipePromise(R.path(["game","model_selection"]),g.get$("local"),function(b){return 1!==R.length(b)?null:f.findStamp(b[0],a.game.models)["catch"](R.always(null))},function(b){return R.isNil(b)?null:a.event("Game.command.execute","setLos",["setOriginResetTarget",[b]])})(a)},onLeave:function(a){a.changeEvent("Game.los.remote.change")},name:"LoS",actions:h,buttons:k,bindings:j};return a.registerMode(l),b.register("Bindings",l.name,i,function(a){R.extend(l.bindings,a)}),l}]),angular.module("clickApp.services").factory("rulerMode",["modes","settings","commonMode","game","gameRuler","model","gameModels","gameModelSelection","prompt",function(a,b,c,d,e,f,g,h,i){function j(a){var b=e.maxLength(a.game.ruler);o.buttons[0][0]="Set Max Len. ("+b+")",a.changeEvent("Modes.buttons.update")}var k=Object.create(c.actions);k.exitRulerMode=c.actions.modeBackToDefault,k.dragStartMap=function(a,b){return a.event("Game.update",R.lensProp("ruler"),e.setLocal$(b.start,b.now,a))},k.dragMap=function(a,b){return a.event("Game.update",R.lensProp("ruler"),e.setLocal$(b.start,b.now,a))},k.dragEndMap=function(a,b){return a.event("Game.command.execute","setRuler",["setRemote",[b.start,b.now]])},k.dragStartTemplate=k.dragStartMap,k.dragTemplate=k.dragMap,k.dragEndTemplate=k.dragEndMap,k.dragStartModel=k.dragStartMap,k.dragModel=k.dragMap,k.dragEndModel=k.dragEndMap,k.setOriginModel=function(a,b){return R.pipePromise(function(){return a.event("Game.command.execute","setRuler",["setOrigin",[b["click#"].target]])},function(b){return j(a),b})()},k.setTargetModel=function(a,b){return a.event("Game.command.execute","setRuler",["setTarget",[b["click#"].target]])},k.setMaxLength=function(a){return R.pipeP(function(){return i.prompt("prompt","Set ruler max length :",e.maxLength(a.game.ruler))["catch"](R.always(null))},function(b){return b=0===b?null:b,R.pipePromise(function(){return a.event("Game.command.execute","setRuler",["setMaxLength",[b]])},function(c){var d=e.origin(a.game.ruler);return R.isNil(d)?c:a.event("Game.command.execute","onModels",["setRulerMaxLength",[b],[d]])})()},function(b){return j(a),b})()},k.createAoEOnTarget=function(a){return R.pipeP(function(){return e.targetAoEPosition(a.game.models,a.game.ruler)},function(b){b.type="aoe";var c={base:{x:0,y:0,r:0},templates:[b]};return a.event("Game.command.execute","createTemplate",[c,!1])})()};var l={exitRulerMode:"ctrl+r",setMaxLength:"shift+r",setOriginModel:"ctrl+clickModel",setTargetModel:"shift+clickModel",createAoEOnTarget:"ctrl+a"},m=R.extend(Object.create(c.bindings),l),n=[["Set Max Len.","setMaxLength"],["AoE on Target","createAoEOnTarget"]],o={onEnter:function(a){return R.pipePromise(function(){return h.get("local",a.game.model_selection)},function(b){return 1!==R.length(b)?null:g.findStamp(b[0],a.game.models)["catch"](R.always(null))},function(b){return R.isNil(b)?null:a.event("Game.command.execute","setRuler",["setOriginResetTarget",[b]])},function(){j(a)})()},onLeave:function(a){a.changeEvent("Game.ruler.remote.change")},name:"Ruler",actions:k,buttons:n,bindings:m};return a.registerMode(o),b.register("Bindings",o.name,l,function(a){R.extend(o.bindings,a)}),o}]),angular.module("clickApp.services").factory("createModelMode",["modes","settings","commonMode","game",function(a,b,c){function d(a,b){b.create=R.over(R.lensPath(["model","base"]),R.pipe(R.assoc("x",a.x),R.assoc("y",a.y)),b.create)}var e=Object.create(c.actions);e.moveMap=function(a,b){return d(b,a),a.changeEvent("Game.create.update")},e.create=function(a,b){var c=R.path(["ui_state","flip_map"],a);return d(b["click#"],a),a.event("Game.command.execute","createModel",[a.create.model,c])};var f={create:"clickMap"},g=R.extend(Object.create(c.bindings),f),h=[],i={onEnter:function(a){a.changeEvent("Game.model.create.enable"),a.changeEvent("Game.moveMap.enable")},onLeave:function(a){a.create.model=null,a.changeEvent("Game.moveMap.disable"),a.changeEvent("Game.model.create.disable")},name:"CreateModel",actions:e,buttons:h,bindings:g};return a.registerMode(i),b.register("Bindings",i.name,f,function(a){R.extend(i.bindings,a)}),i}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("modelsMode",["modes","settings","defaultMode","model","game","gameModels","gameModelSelection","point","prompt",function(a,b,c,d,e,f,g,h,i){function j(a){return a.event("Game.command.execute","setModelSelection",["clear",null])}function k(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=a.single,c=a.start_charge,d=a.end_charge,e=a.start_place,f=a.end_place,g=[["Delete","deleteSelection"],["Copy","copySelection"],["Lock","toggleLock"],["Ruler Max Len.","setRulerMaxLength"],["Clear Label","clearLabel"],["Image","toggle","image"],["Show/Hide","toggleImageDisplay","image"],["Next","setNextImage","image"],["Wreck","toggleWreckDisplay","image"],["Orient.","toggle","orientation"],["Face Up","setOrientationUp","orientation"],["Face Down","setOrientationDown","orientation"],["Counter","toggle","counter"],["Show/Hide","toggleCounterDisplay","counter"],["Inc.","incrementCounter","counter"],["Dec.","decrementCounter","counter"],["Souls","toggle","souls"],["Show/Hide","toggleSoulsDisplay","souls"],["Inc.","incrementSouls","souls"],["Dec.","decrementSouls","souls"],["Melee","toggle","melee"],['0.5"',"toggleMeleeDisplay","melee"],["Reach","toggleReachDisplay","melee"],["Strike","toggleStrikeDisplay","melee"]];return b&&(g=R.concat(g,[["Templates","toggle","templates"],["AoE","createAoEOnModel","templates"],["Spray","createSprayOnModel","templates"]])),g=R.append(["Areas","toggle","areas"],g),g=R.append(["CtrlArea","toggleCtrlAreaDisplay","areas"],g),g=R.concat(g,R.map(function(a){var b=a+1;return[b+'"',"toggle"+b+"InchesAreaDisplay","areas"]},o)),g=R.concat(g,R.map(function(a){var b=a+11;return[b+'"',"toggle"+b+"InchesAreaDisplay","areas"]},o)),g=R.append(["Auras","toggle","auras"],g),g=R.concat(g,R.map(function(a){var b=_slicedToArray(a,1),c=b[0];return[c,"toggle"+c+"AuraDisplay","auras"]},n)),g=R.append(["Effects","toggle","effects"],g),g=R.concat(g,R.map(function(a){var b=_slicedToArray(a,1),c=b[0];return[c,"toggle"+c+"EffectDisplay","effects"]},m)),g=R.append(["Incorp.","toggleIncorporealDisplay","effects"],g),g=R.append(["Charge","toggle","charge"],g),c&&(g=R.append(["Start","startCharge","charge"],g)),d&&(g=R.append(["End","endCharge","charge"],g)),g=R.append(["Max Len.","setChargeMaxLength","charge"],g),g=R.append(["Place","toggle","place"],g),e&&(g=R.append(["Start","startPlace","place"],g)),f&&(g=R.append(["End","endPlace","place"],g)),g=R.append(["Max Len.","setPlaceMaxLength","place"],g),g=R.append(["Within","togglePlaceWithin","place"],g),g=R.concat(g,[["Unit","toggle","unit"],["Show/Hide","toggleUnitDisplay","unit"],["Set #","setUnit","unit"],["Leader","toggleLeaderDisplay","unit"]]),b&&(g=R.append(["Select All","selectAllUnit","unit"],g),g=R.append(["Select Friends","selectAllFriendly"],g)),g}var l=Object.create(c.actions);l.clickMap=j,l.rightClickMap=j,l.modeBackToDefault=j,l.deleteSelection=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","deleteModel",[b])},l.toggleLock=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isLocked,function(c){return a.event("Game.command.execute","lockModels",[!c,b])})(a.game.models)},l.toggleImageDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isImageDisplayed,function(c){return a.event("Game.command.execute","onModels",["setImageDisplay",[!c],b])})(a.game.models)},l.setNextImage=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["setNextImage",[a.factions],b])},l.toggleWreckDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isWreckDisplayed,function(c){return a.event("Game.command.execute","onModels",["setWreckDisplay",[!c],b])})(a.game.models)},l.toggleUnitDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isUnitDisplayed,function(c){return a.event("Game.command.execute","onModels",["setUnitDisplay",[!c],b])})(a.game.models)},l.setUnit=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),function(a){var b=R.defaultTo(0,d.unit(a));return i.prompt("prompt","Set unit number :",b)["catch"](R.always(null))},function(c){return a.event("Game.command.execute","onModels",["setUnit",[c],b])})(a.game.models)},l.toggleMeleeDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isMeleeDisplayed$("mm"),function(c){return a.event("Game.command.execute","onModels",["setMeleeDisplay",["mm",!c],b])})(a.game.models)},l.toggleReachDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isMeleeDisplayed$("mr"),function(c){return a.event("Game.command.execute","onModels",["setMeleeDisplay",["mr",!c],b])})(a.game.models)},l.toggleStrikeDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isMeleeDisplayed$("ms"),function(c){return a.event("Game.command.execute","onModels",["setMeleeDisplay",["ms",!c],b])})(a.game.models)},l.toggleCounterDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isCounterDisplayed$("c"),function(c){return a.event("Game.command.execute","onModels",["setCounterDisplay",["c",!c],b])})(a.game.models)},l.incrementCounter=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["incrementCounter",["c"],b])},l.decrementCounter=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["decrementCounter",["c"],b])},l.toggleSoulsDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isCounterDisplayed$("s"),function(c){return a.event("Game.command.execute","onModels",["setCounterDisplay",["s",!c],b])})(a.game.models)},l.incrementSouls=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["incrementCounter",["s"],b])},l.decrementSouls=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["decrementCounter",["s"],b])},l.setRulerMaxLength=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.rulerMaxLength,R.defaultTo(0),function(a){return i.prompt("prompt","Set ruler max length :",a)["catch"](R.always(null))},function(c){return c=0===c?null:c,a.event("Game.command.execute","onModels",["setRulerMaxLength",[c],b])})(a.game.models)},l.setChargeMaxLength=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.chargeMaxLength,function(a){return i.prompt("prompt","Set charge max length :",a)["catch"](R.always(null))},function(c){return c=0===c?null:c,a.event("Game.command.execute","onModels",["setChargeMaxLength",[a.factions,c],b])})(a.game.models)},l.setPlaceMaxLength=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.placeMaxLength,R.defaultTo(0),function(a){return i.prompt("prompt","Set place max length :",a)["catch"](R.always(null))},function(c){return c=0===c?null:c,a.event("Game.command.execute","onModels",["setPlaceMaxLength",[a.factions,c],b])})(a.game.models)},l.togglePlaceWithin=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.placeWithin,function(c){return a.event("Game.command.execute","onModels",["setPlaceWithin",[a.factions,!c],b])})(a.game.models)},l.toggleLeaderDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isLeaderDisplayed,function(c){return a.event("Game.command.execute","onModels",["setLeaderDisplay",[!c],b])})(a.game.models)},l.toggleIncorporealDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isIncorporealDisplayed,function(c){return a.event("Game.command.execute","onModels",["setIncorporealDisplay",[!c],b])})(a.game.models)};var m=[["Blind","b"],["Corrosion","c"],["Disrupt","d"],["Fire","f"],["Fleeing","e"],["KD","k"],["Stationary","t"]];R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],e=b[1];l["toggle"+c+"EffectDisplay"]=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isEffectDisplayed$(e),function(c){return a.event("Game.command.execute","onModels",["setEffectDisplay",[e,!c],b])})(a.game.models)}},m);var n=[["Red","#F00"],["Green","#0F0"],["Blue","#00F"],["Yellow","#FF0"],["Purple","#F0F"],["Cyan","#0FF"]];R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],e=b[1];l["toggle"+c+"AuraDisplay"]=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.auraDisplay,function(c){return a.event("Game.command.execute","onModels",["setAuraDisplay",[c===e?null:e],b])})(a.game.models)}},n),l.toggleCtrlAreaDisplay=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),d.isCtrlAreaDisplayed$(a.factions),function(c){return a.event("Game.command.execute","onModels",["setCtrlAreaDisplay",[!c],b])})(a.game.models)};var o=R.range(0,10);R.forEach(function(a){var b=0===a?10:a;l["toggle"+b+"InchesAreaDisplay"]=function(a){var c=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(c[0]),function(e){var f=d.areaDisplay(e);return a.event("Game.command.execute","onModels",["setAreaDisplay",[f===b?null:b],c])})(a.game.models)};var c=b+10;l["toggle"+c+"InchesAreaDisplay"]=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(b[0]),function(e){var f=d.areaDisplay(e);return a.event("Game.command.execute","onModels",["setAreaDisplay",[f===c?null:c],b])})(a.game.models)}},o);var p=[["moveFront","up"],["moveBack","down"],["rotateLeft","left"],["rotateRight","right"]];R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];d=d,l[c]=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",[c,[a.factions,!1],b])},l[c+"Small"]=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",[c,[a.factions,!0],b])}},p);var q=[["shiftUp","ctrl+up","shiftDown"],["shiftDown","ctrl+down","shiftUp"],["shiftLeft","ctrl+left","shiftRight"],["shiftRight","ctrl+right","shiftLeft"]];R.forEach(function(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],e=b[2];d=d,l[c]=function(a){var b=g.get("local",a.game.model_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onModels",[d,[a.factions,!1],b])},l[c+"Small"]=function(a){var b=g.get("local",a.game.model_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onModels",[d,[a.factions,!0],b])}},q),l.setOrientationUp=function(a){var b=g.get("local",a.game.model_selection),c=a.ui_state.flip_map?180:0;a.event("Game.command.execute","onModels",["setOrientation",[a.factions,c],b])},l.setOrientationDown=function(a){var b=g.get("local",a.game.model_selection),c=a.ui_state.flip_map?0:180;a.event("Game.command.execute","onModels",["setOrientation",[a.factions,c],b])},l.setTargetModel=function(a,b){var c=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["orientTo",[a.factions,b["click#"].target],c]);
},function(){var a=void 0,b=void 0,e=void 0;l.dragStartModel=function(c,h){var i=h.target.state.stamp;return R.pipePromise(function(){var a=g["in"]("local",i,c.game.model_selection);return a?null:c.event("Game.command.execute","setModelSelection",["set",[i]])},function(){return g.get("local",c.game.model_selection)},function(a){return f.findAnyStamps(a,c.game.models)},R.reject(R.isNil),function(b){return a=null,1===R.length(b)&&R.pipeP(d.chargeTarget,function(a){return f.findStamp(a,c.game.models)},function(b){a=b})(b[0]),b},function(a){return e=a,R.map(d.saveState,a)},function(a){return b=a,l.dragModel(c,h)})()},c.actions.dragStartModel=l.dragStartModel,l.dragModel=function(c,f){return R.pipePromise(R.addIndex(R.map)(function(e,g){var h={x:b[g].x+f.now.x-f.start.x,y:b[g].y+f.now.y-f.start.y};return d.setPosition_(c.factions,a,h,e)}),R.promiseAll,R.forEach(function(a){c.changeEvent("Game.model.change."+a.state.stamp)}))(e)},l.dragEndModel=function(c,f){return R.pipePromise(R.addIndex(R.map)(function(e,f){return d.setPosition_(c.factions,a,b[f],e)}),R.promiseAll,R.map(R.path(["state","stamp"])),function(b){var d={x:f.now.x-f.start.x,y:f.now.y-f.start.y};return c.event("Game.command.execute","onModels",["shiftPosition",[c.factions,a,d],b])})(e)}}(),l.copySelection=function(a){var b=g.get("local",a.game.model_selection);return R.pipeP(f.copyStamps$(b),function(b){return a.event("Game.model.copy",b)})(a.game.models)},l.clearLabel=function(a){var b=g.get("local",a.game.model_selection);return a.event("Game.command.execute","onModels",["clearLabel",[],b])};var r={clickMap:"clickMap",rightClickMap:"rightClickMap",deleteSelection:"del",copySelection:"ctrl+c",toggleLock:"l",toggleImageDisplay:"alt+i",setNextImage:"shift+i",toggleWreckDisplay:"alt+w",setOrientationUp:"pageup",setOrientationDown:"pagedown",setTargetModel:"shift+clickModel",toggleCounterDisplay:"alt+n",incrementCounter:"+",decrementCounter:"-",toggleSoulsDisplay:"alt+o",incrementSouls:"ctrl++",decrementSouls:"ctrl+-",toggleCtrlAreaDisplay:"alt+a",setRulerMaxLength:"shift+r",setChargeMaxLength:"shift+c",setPlaceMaxLength:"shift+p",togglePlaceWithin:"alt+p",toggleMeleeDisplay:"alt+m",toggleReachDisplay:"alt+r",toggleStrikeDisplay:"alt+s",toggleUnitDisplay:"alt+u",setUnit:"shift+u",toggleLeaderDisplay:"alt+l",toggleIncorporealDisplay:"alt+g",clearLabel:"ctrl+shift+l"};R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];r[c]=d,r[c+"Small"]="shift+"+d},p),R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];r[c]=d,r[c+"Small"]="shift+"+d},q),R.forEach(function(a){var b=0===a?10:a;r["toggle"+b+"InchesAreaDisplay"]="alt+"+a,b+=10,r["toggle"+b+"InchesAreaDisplay"]="alt+shift+"+a},o),R.addIndex(R.forEach)(function(a,b){var c=_slicedToArray(a,1),d=c[0];r["toggle"+d+"AuraDisplay"]="ctrl+"+(b+1)},n),R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];r["toggle"+c+"EffectDisplay"]="alt+"+d},m);var s=R.extend(Object.create(c.bindings),r),t=k(),u={onEnter:function(){},onLeave:function(){},name:"Models",actions:l,buttons:t,buildButtons:k,bindings:s,areas:o,auras:n,effects:m};return a.registerMode(u),b.register("Bindings",u.name,r,function(a){R.extend(u.bindings,a)}),u}]),angular.module("clickApp.services").factory("modelBaseMode",["modes","settings","modelsMode","sprayTemplateMode","model","game","gameModels","gameModelSelection",function(a,b,c,d,e,f,g,h){var i=Object.create(c.actions);i.createAoEOnModel=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(function(){return g.findStamp(b[0],a.game.models)},function(b){var c=R.pick(["x","y"],b.state);c.type="aoe";var d={base:{x:0,y:0},templates:[c]},e=R.path(["ui_state","flip_map"],a);return a.event("Game.command.execute","createTemplate",[d,e])})()},i.createSprayOnModel=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(function(){return g.findStamp(b[0],a.game.models)},function(b){var c=R.pick(["x","y"],b.state);c.type="spray";var e={base:{x:0,y:0},templates:[c]},f=R.path(["ui_state","flip_map"],a);return R.pipePromise(function(){return a.event("Game.command.execute","createTemplate",[e,f])},function(){return d.actions.setOriginModel(a,{"click#":{target:b}})})()})()},i.selectAllFriendly=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(g.findStamp$(b[0]),function(b){var c=R.pipe(g.all,R.filter(e.userIs$(e.user(b))),R.map(e.stamp))(a.game.models);return a.event("Game.command.execute","setModelSelection",["set",c])})(a.game.models)},i.selectAllUnit=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(g.findStamp$(b[0]),function(b){var c=e.unit(b);if(R.isNil(c))return self.Promise.reject("Model not in unit");var d=R.pipe(g.all,R.filter(e.userIs$(e.user(b))),R.filter(e.unitIs$(c)),R.map(e.stamp))(a.game.models);return a.event("Game.command.execute","setModelSelection",["set",d])})(a.game.models)},i.setB2B=function(a,b){var c=h.get("local",a.game.model_selection);return R.pipeP(function(){return g.findStamp(c[0],a.game.models)},function(d){return d.state.stamp===b["click#"].target.state.stamp?null:a.event("Game.command.execute","onModels",["setB2B",[a.factions,b["click#"].target],c])})()},i.openEditLabel=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(function(){return g.findStamp(b[0],a.game.models)},function(b){a.changeEvent("Game.editLabel.open",b)})()},i.openEditDamage=function(a){var b=h.get("local",a.game.model_selection);return R.pipeP(function(){return g.findStamp(b[0],a.game.models)},function(b){a.changeEvent("Game.editDamage.toggle",b)})()};var j={createAoEOnModel:"ctrl+a",createSprayOnModel:"ctrl+s",selectAllUnit:"ctrl+u",selectAllFriendly:"ctrl+f",setB2B:"ctrl+shift+clickModel",openEditLabel:"shift+l",openEditDamage:"shift+d"},k=R.extend(Object.create(c.bindings),j),l={onEnter:function(){},onLeave:function(){},name:"ModelBase",actions:i,buttons:[],bindings:k};return b.register("Bindings",l.name,j,function(a){R.extend(l.bindings,a)}),l}]),angular.module("clickApp.services").factory("modelMode",["modes","settings","modelsMode","modelBaseMode","model","game","gameModels","gameModelSelection",function(a,b,c,d,e,f,g,h){var i=Object.create(d.actions);i.startCharge=function(a){var b=h.get("local",a.game.model_selection);return R.pipePromise(function(){return a.event("Game.command.execute","onModels",["startCharge",[],b])},function(){return a.event("Modes.switchTo","ModelCharge")})()},i.startPlace=function(a){var b=h.get("local",a.game.model_selection);return R.pipePromise(function(){return a.event("Game.command.execute","onModels",["startPlace",[],b])},function(){return a.event("Modes.switchTo","ModelPlace")})()};var j={startCharge:"c",startPlace:"p"},k=R.extend(Object.create(d.bindings),j),l=c.buildButtons({single:!0,start_charge:!0,start_place:!0}),m={onEnter:function(){},onLeave:function(){},name:"Model",actions:i,buttons:l,bindings:k};return a.registerMode(m),b.register("Bindings",m.name,j,function(a){R.extend(m.bindings,a)}),m}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("modelChargeMode",["modes","settings","modelsMode","modelBaseMode","model","game","gameModels","gameModelSelection",function(a,b,c,d,e,f,g,h){var i=Object.create(d.actions);i.endCharge=function(a){var b=h.get("local",a.game.model_selection);return R.pipePromise(function(){return a.event("Game.command.execute","onModels",["endCharge",[],b])},function(){return a.event("Modes.switchTo","Model")})()},i.setTargetModel=function(a,b){var c=h.get("local",a.game.model_selection);return R.pipeP(g.findStamp$(c[0]),function(d){return R.pipeP(function(){return e.chargeTarget(d)["catch"](R.always(null))},function(a){return a===b["click#"].target.state.stamp?null:b["click#"].target},function(b){return R.exists(b)&&d.state.stamp===b.state.stamp?null:a.event("Game.command.execute","onModels",["setChargeTarget",[a.factions,b],c])})()})(a.game.models)};var j=[["moveFront","up","moveFront"],["moveBack","down","moveBack"],["rotateLeft","left","rotateLeft"],["rotateRight","right","rotateRight"],["shiftUp","ctrl+up","shiftDown"],["shiftDown","ctrl+down","shiftUp"],["shiftLeft","ctrl+left","shiftRight"],["shiftRight","ctrl+right","shiftLeft"]],k=R.curry(function(a,b,c,d){var f=h.get("local",d.game.model_selection),i=R.path(["ui_state","flip_map"],d)?b:a;return R.pipeP(g.findStamp$(f[0]),function(a){return e.chargeTarget(a)["catch"](R.always(null))},function(a){return R.exists(a)?g.findStamp(a,d.game.models):null},function(a){return d.event("Game.command.execute","onModels",[i+"Charge",[d.factions,a,c],f])})(d.game.models)});R.forEach(function(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],e=b[2];d=d,i[c]=k(c,e,!1),i[c+"Small"]=k(c,e,!0)},j);var l={endCharge:"c",setTargetModel:"shift+clickModel"},m=R.extend(Object.create(d.bindings),l),n=c.buildButtons({single:!0,end_charge:!0}),o={onEnter:function(){},onLeave:function(){},name:"ModelCharge",actions:i,buttons:n,bindings:m};return a.registerMode(o),b.register("Bindings",o.name,l,function(a){R.extend(o.bindings,a)}),o}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("modelPlaceMode",["modes","settings","modelsMode","modelBaseMode","game","gameModels","gameModelSelection",function(a,b,c,d,e,f,g){var h=Object.create(d.actions);h.endPlace=function(a){var b=g.get("local",a.game.model_selection);return R.pipePromise(function(){return a.event("Game.command.execute","onModels",["endPlace",[],b])},function(){return a.event("Modes.switchTo","Model")})()},h.setTargetModel=function(a,b){var c=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(c[0]),function(d){return d.state.stamp===b["click#"].target.state.stamp?null:a.event("Game.command.execute","onModels",["setPlaceTarget",[a.factions,b["click#"].target],c])})(a.game.models)},h.setOriginModel=function(a,b){var c=g.get("local",a.game.model_selection);return R.pipeP(f.findStamp$(c[0]),function(d){return d.state.stamp===b["click#"].target.state.stamp?null:a.event("Game.command.execute","onModels",["setPlaceOrigin",[a.factions,b["click#"].target],c])})(a.game.models)};var i=[["moveFront","up","moveFront"],["moveBack","down","moveBack"],["rotateLeft","left","rotateLeft"],["rotateRight","right","rotateRight"],["shiftUp","ctrl+up","shiftDown"],["shiftDown","ctrl+down","shiftUp"],["shiftLeft","ctrl+left","shiftRight"],["shiftRight","ctrl+right","shiftLeft"]],j=R.curry(function(a,b,c,d){var e=g.get("local",d.game.model_selection),f=R.path(["ui_state","flip_map"],d)?b:a;return d.event("Game.command.execute","onModels",[f+"Place",[d.factions,c],e])});R.forEach(function(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],e=b[2];d=d,h[c]=j(c,e,!1),h[c+"Small"]=j(c,e,!0)},i);var k={endPlace:"p",setTargetModel:"shift+clickModel",setOriginModel:"ctrl+clickModel"},l=R.extend(Object.create(d.bindings),k),m=c.buildButtons({single:!0,end_place:!0}),n={onEnter:function(){},onLeave:function(){},name:"ModelPlace",actions:h,buttons:m,bindings:l};return a.registerMode(n),b.register("Bindings",n.name,k,function(a){R.extend(n.bindings,a)}),n}]),angular.module("clickApp.services").factory("createTemplateMode",["modes","settings","commonMode","game",function(a,b,c){function d(a,b){b.create=R.over(R.lensPath(["template","base"]),R.pipe(R.assoc("x",a.x),R.assoc("y",a.y)),b.create)}var e=Object.create(c.actions);e.moveMap=function(a,b){return d(b,a),a.changeEvent("Game.create.update")},e.create=function(a,b){var c=R.path(["ui_state","flip_map"],a);return d(b["click#"],a),a.event("Game.command.execute","createTemplate",[a.create.template,c])};var f={create:"clickMap"},g=R.extend(Object.create(c.bindings),f),h=[],i={onEnter:function(a){a.changeEvent("Game.template.create.enable"),a.changeEvent("Game.moveMap.enable")},onLeave:function(a){a.create=R.assoc("template",null,a.create),a.changeEvent("Game.moveMap.disable"),a.changeEvent("Game.template.create.disable")},name:"CreateTemplate",actions:e,buttons:h,bindings:g};return a.registerMode(i),b.register("Bindings",i.name,f,function(a){R.extend(i.bindings,a)}),i}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("templateMode",["modes","settings","defaultMode","template","game","gameTemplates","gameTemplateSelection",function(a,b,c,d,e,f,g){function h(a){return a.event("Game.update",R.lensProp("template_selection"),g.clear$("local",a))}var i=Object.create(c.actions);i.modeBackToDefault=h,i.clickMap=h,i.rightClickMap=h,i["delete"]=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","deleteTemplates",[b])},i.toggleLock=function(a){var b=g.get("local",a.game.template_selection);return R.pipeP(function(){return f.findStamp(b[0],a.game.templates)},function(c){var e=d.isLocked(c);return a.event("Game.command.execute","lockTemplates",[!e,b])})()};var j=[["moveFront","up"],["moveBack","down"],["rotateLeft","left"],["rotateRight","right"]];R.forEach(function(a){var b=_slicedToArray(a,1),c=b[0];i[c]=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",[c,[!1],b])},i[c+"Small"]=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",[c,[!0],b])}},j);var k=[["shiftUp","ctrl+up","shiftDown"],["shiftDown","ctrl+down","shiftUp"],["shiftLeft","ctrl+left","shiftRight"],["shiftRight","ctrl+right","shiftLeft"]];R.forEach(function(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],e=b[2];d=d,i[c]=function(a){var b=g.get("local",a.game.template_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onTemplates",[d,[!1],b])},i[c+"Small"]=function(a){var b=g.get("local",a.game.template_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onTemplates",[d,[!0],b])}},k),function(){function a(a,c){var d=a.now.x-a.start.x,e=a.now.y-a.start.y;c.x=b.x+d,c.y=b.y+e}var b=void 0;i.dragStartTemplate=function(a,c){return d.isLocked(c.target)?self.Promise.reject("Template is locked"):(b=R.clone(c.target.state),i.dragTemplate(a,c),a.event("Game.update",R.lensProp("template_selection"),g.set$("local",[c.target.state.stamp],a)))},c.actions.dragStartTemplate=i.dragStartTemplate,i.dragTemplate=function(b,c){return d.isLocked(c.target)?self.Promise.reject("Template is locked"):(a(c,c.target.state),b.changeEvent("Game.template.change."+c.target.state.stamp),null)},i.dragEndTemplate=function(c,e){if(d.isLocked(e.target))return self.Promise.reject("Template is locked");e.target.state.x=b.x,e.target.state.y=b.y;var f=R.clone(b);return a(e,f),c.event("Game.command.execute","onTemplates",["setPosition",[f],[e.target.state.stamp]])}}();var l={clickMap:"clickMap",rightClickMap:"rightClickMap","delete":"del",toggleLock:"l"};R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];l[c]=d,l[c+"Small"]="shift+"+d},j),R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];l[c]=d,l[c+"Small"]="shift+"+d},k);var m=R.extend(Object.create(c.bindings),l),n=[["Delete","delete"],["Lock/Unlock","toggleLock"]],o={onEnter:function(){},onLeave:function(){},name:"Template",actions:i,buttons:n,bindings:m};return b.register("Bindings",o.name,l,function(a){R.extend(o.bindings,a)}),o}]),angular.module("clickApp.services").factory("aoeTemplateMode",["modes","settings","templateMode","game","gameTemplates","gameTemplateSelection","gameRuler","prompt",function(a,b,c,d,e,f,g,h){var i=Object.create(c.actions);i.aoeSize3=function(a){var b=f.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[3],b])},i.aoeSize4=function(a){var b=f.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[4],b])},i.aoeSize5=function(a){var b=f.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[5],b])},i.setTargetModel=function(a,b){var c=f.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setTarget",[a.factions,null,b["click#"].target],c])},i.setMaxDeviation=function(a){var b=f.get("local",a.game.template_selection);return R.pipeP(e.fromStamps$("maxDeviation",[],b),function(a){var b=a[0];return h.prompt("prompt","Set AoE max deviation :",b)["catch"](function(a){return null})},function(c){return c=0===c?null:c,a.event("Game.update",R.lensProp("templates"),e.onStamps$("setMaxDeviation",[c],b))})(a.game.templates)},i.deviate=function(a){var b=f.get("local",a.game.template_selection);return R.pipePromise(function(){return a.event("Game.command.execute","rollDeviation",[])},R.always(a),R.path(["game","dice"]),R.last,function(c){return a.event("Game.command.execute","onTemplates",["deviate",[c.r,c.d],b])})()},i.setToRulerTarget=function(a){if(!g.isDisplayed(a.game.ruler))return null;var b=f.get("local",a.game.template_selection);return R.pipeP(g.targetAoEPosition$(a.game.models),function(c){return a.event("Game.command.execute","onTemplates",["setToRuler",[c],b])})(a.game.ruler)};var j={setTargetModel:"shift+clickModel",aoeSize3:"3",aoeSize4:"4",aoeSize5:"5",deviate:"d",setMaxDeviation:"shift+d",setToRulerTarget:"shift+r"},k=R.extend(Object.create(c.bindings),j),l=R.concat([["Size","toggle","size"],["Aoe3","aoeSize3","size"],["Aoe4","aoeSize4","size"],["Aoe5","aoeSize5","size"],["Deviate","deviate"],["Set to Ruler","setToRulerTarget"]],c.buttons),m={onEnter:function(){},onLeave:function(){},name:"aoe"+c.name,actions:i,buttons:l,bindings:k};return a.registerMode(m),b.register("Bindings",m.name,j,function(a){R.extend(m.bindings,a)}),m}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("sprayTemplateMode",["modes","settings","templateMode","sprayTemplate","game","gameTemplates","gameTemplateSelection","gameModels",function(a,b,c,d,e,f,g,h){var i=Object.create(c.actions);i.spraySize6=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[6],b])},i.spraySize8=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[8],b])},i.spraySize10=function(a){var b=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setSize",[10],b])},i.setOriginModel=function(a,b){var c=g.get("local",a.game.template_selection);return a.event("Game.command.execute","onTemplates",["setOrigin",[a.factions,b["click#"].target],c])},i.setTargetModel=function(a,b){var c=g.get("local",a.game.template_selection);return R.pipeP(f.findStamp$(c[0]),d.origin,function(b){return R.isNil(b)?null:h.findStamp(b,a.game.models)},function(d){return R.isNil(d)?null:a.event("Game.command.execute","onTemplates",["setTarget",[a.factions,d,b["click#"].target],c])})(a.game.templates)};var j=[["rotateLeft","left"],["rotateRight","right"]],k=R.curry(function(a,b,c){var e=g.get("local",c.game.template_selection);return R.pipeP(function(){return f.findStamp(e[0],c.game.templates)},d.origin,function(a){return R.isNil(a)?null:h.findStamp(a,c.game.models)},function(d){return c.event("Game.command.execute","onTemplates",[a,[c.factions,d,b],e])})()});R.forEach(function(a){var b=_slicedToArray(a,1),c=b[0];i[c]=k(c,!1),i[c+"Small"]=k(c,!0)},j);var l={setOriginModel:"ctrl+clickModel",setTargetModel:"shift+clickModel",spraySize6:"6",spraySize8:"8",spraySize10:"0"},m=R.extend(Object.create(c.bindings),l),n=R.concat([["Size","toggle","size"],["Spray6","spraySize6","size"],["Spray8","spraySize8","size"],["Spray10","spraySize10","size"]],c.buttons),o={onEnter:function(){},onLeave:function(){},name:"spray"+c.name,actions:i,buttons:n,bindings:m};return a.registerMode(o),b.register("Bindings",o.name,l,function(a){R.extend(o.bindings,a)}),o}]),angular.module("clickApp.services").factory("wallTemplateMode",["modes","settings","templateMode",function(a,b,c){var d=Object.create(c.actions),e={},f=R.extend(Object.create(c.bindings),e),g=R.concat([],c.buttons),h={onEnter:function(){},onLeave:function(){},name:"wall"+c.name,actions:d,buttons:g,bindings:f};return a.registerMode(h),h}]),angular.module("clickApp.services").factory("createTerrainMode",["modes","settings","commonMode","game",function(a,b,c){function d(a,b){b.create=R.over(R.lensPath(["terrain","base"]),R.pipe(R.assoc("x",a.x),R.assoc("y",a.y)),b.create)}var e=Object.create(c.actions);e.moveMap=function(a,b){return d(b,a),a.changeEvent("Game.create.update")},e.create=function(a,b){var c=R.path(["ui_state","flip_map"],a);return d(b["click#"],a),a.event("Game.command.execute","createTerrain",[a.create.terrain,c])};var f={create:"clickMap"},g=R.extend(Object.create(c.bindings),f),h=[],i={onEnter:function(a){a.changeEvent("Game.terrain.create.enable"),a.changeEvent("Game.moveMap.enable")},onLeave:function(a){a.create=R.assoc("terrain",null,a.create),a.changeEvent("Game.moveMap.disable"),a.changeEvent("Game.terrain.create.disable")},name:"CreateTerrain",actions:e,buttons:h,bindings:g};return a.registerMode(i),b.register("Bindings",i.name,f,function(a){R.extend(i.bindings,a)}),i}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.services").factory("terrainMode",["modes","settings","defaultMode","terrain","game","gameTerrains","gameTerrainSelection",function(a,b,c,d,e,f,g){function h(a){return a.event("Game.update",R.lensProp("terrain_selection"),g.clear$("local",a))}var i=Object.create(c.actions);i.modeBackToDefault=h,i.clickMap=h,i.rightClickMap=h,i.copySelection=function(a){var b=g.get("local",a.game.terrain_selection);return R.pipeP(f.copyStamps$(b),function(b){return a.create.terrain=b,a.event("Modes.switchTo","CreateTerrain")})(a.game.terrains)},i["delete"]=function(a){var b=g.get("local",a.game.terrain_selection);return a.event("Game.command.execute","deleteTerrain",[b])},i.toggleLock=function(a){var b=g.get("local",a.game.terrain_selection);return R.pipeP(function(){return f.findStamp(b[0],a.game.terrains)},function(c){var e=d.isLocked(c);return a.event("Game.command.execute","lockTerrains",[!e,b])})()};var j=[["moveFront","up"],["moveBack","down"],["rotateLeft","left"],["rotateRight","right"]];R.forEach(function(a){var b=_slicedToArray(a,1),c=b[0];i[c]=function(a){var b=g.get("local",a.game.terrain_selection);return a.event("Game.command.execute","onTerrains",[c,[!1],b])},i[c+"Small"]=function(a){var b=g.get("local",a.game.terrain_selection);return a.event("Game.command.execute","onTerrains",[c,[!0],b])}},j);var k=[["shiftUp","ctrl+up","shiftDown"],["shiftDown","ctrl+down","shiftUp"],["shiftLeft","ctrl+left","shiftRight"],["shiftRight","ctrl+right","shiftLeft"]];R.forEach(function(a){var b=_slicedToArray(a,3),c=b[0],d=b[1],e=b[2];d=d,i[c]=function(a){var b=g.get("local",a.game.terrain_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onTerrains",[d,[!1],b])},i[c+"Small"]=function(a){var b=g.get("local",a.game.terrain_selection),d=R.path(["ui_state","flip_map"],a)?e:c;return a.event("Game.command.execute","onTerrains",[d,[!0],b])}},k),function(){function a(a,c){var d=a.now.x-a.start.x,e=a.now.y-a.start.y;c.x=b.x+d,c.y=b.y+e}var b=void 0;i.dragStartTerrain=function(a,c){return d.isLocked(c.target)?self.Promise.reject("Terrain is locked"):(b=R.clone(c.target.state),i.dragTerrain(a,c),a.event("Game.update",R.lensProp("terrain_selection"),g.set$("local",[c.target.state.stamp],a)))},c.actions.dragStartTerrain=i.dragStartTerrain,i.dragTerrain=function(b,c){return d.isLocked(c.target)?self.Promise.reject("Terrain is locked"):(a(c,c.target.state),b.changeEvent("Game.terrain.change."+c.target.state.stamp),null)},i.dragEndTerrain=function(c,e){if(d.isLocked(e.target))return self.Promise.reject("Terrain is locked");e.target.state=R.clone(b);var f=R.clone(b);return a(e,f),c.event("Game.command.execute","onTerrains",["setPosition",[f],[e.target.state.stamp]])}}();var l={clickMap:"clickMap",rightClickMap:"rightClickMap",copySelection:"ctrl+c","delete":"del",toggleLock:"l"};R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];l[c]=d,l[c+"Small"]="shift+"+d},j),R.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];l[c]=d,l[c+"Small"]="shift+"+d},k);var m=R.extend(Object.create(c.bindings),l),n=[["Delete","delete"],["Lock/Unlock","toggleLock"]],o={onEnter:function(){},onLeave:function(){},name:"Terrain",actions:i,buttons:n,bindings:m};return a.registerMode(o),b.register("Bindings",o.name,l,function(a){R.extend(o.bindings,a)}),o}]),angular.module("clickApp.services").factory("pubSub",[function(){function a(a,b,c){return function(){c[a]=R.reject(R.equals(b),c[a])}}var b="#watch#",c={init:function(a){var b=arguments.length<=1||void 0===arguments[1]?"channel":arguments[1];return R.pipe(R.defaultTo({}),R.assoc("_pubSubName",b),R.assoc("_pubSubCache",{}))(a)},subscribe:function(b,c,d){return R.pipe(R.prop("_pubSubCache"),function(d){return R.pipe(R.propOr([],b),R.append(c),function(e){return d[b]=e,a(b,c,d)})(d)})(d)},publish:function(){for(var a=arguments.length,c=Array(a),e=0;a>e;e++)c[e]=arguments[e];var f=c[0];return R.pipePromise(R.last,d(f,R.init(c)),d(b,R.init(c)))(c)}},d=R.curry(function(a,c,d){return R.pipePromise(R.pathOr([],["_pubSubCache",a]),function(c){return R.isEmpty(c)&&a!==b,c},R.map(function(a){return new self.Promise(function(b){var d=void 0;try{d=a.apply(null,c)}catch(e){}b(d)})}),R.promiseAll,R.always(d))(d)});return R.curryService(c),c}]),angular.module("clickApp.services").factory("settings",["localStorage",function(a){var b="clickApp.settings",c={},d={},e={register:function(a,b,e,f){c[a]=R.defaultTo({},c[a]),d[a]=R.defaultTo({},d[a]),c[a][b]=e,d[a][b]=f},load:function(){return R.pipeP(function(){return a.load(b)["catch"](function(){})},R.defaultTo({}),R.spyWarn("Settings load"))()},init:function(){return R.pipeP(e.load,e.bind,e.update)(null)},bind:function(a){return a=R.defaultTo({},a),R.pipe(R.keys,R.reduce(function(b,d){var e=R.propOr({},d,a);return b[d]=R.pipe(R.keys,R.reduce(function(a,b){var f=Object.create(c[d][b]);return R.extend(f,R.propOr({},b,e)),a[b]=f,a},{}))(c[d]),b},{}),function(a){return{"default":c,current:a}})(c)},update:function(a){return R.pipe(R.keys,R.forEach(function(b){R.pipe(R.keys,R.filter(function(a){return R.exists(d[b][a])}),R.forEach(function(c){d[b][c](a.current[b][c])}))(a.current[b])}))(a.current),a},store:function(c){return R.pipePromise(R.spyWarn("Settings store"),a.save$(b))(c.current)}};return e}]),angular.module("clickApp.services").factory("state",["pubSub","fileImport","stateExports","stateData","stateUser","stateGame","stateGames","stateModes",function(a,b,c,d,e,f,g,h){var i={init:function(){var b=a.init({},"State");return b.processing=!1,b.change_queue=[],b.event=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return i.event.apply(null,[].concat(c,[b]))},b.onEvent=function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return a.subscribe.apply(null,[].concat(d,[b]))},b.change=a.init({},"State.Change"),b.changeEvent=function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return b.processing?(b.change_queue=R.append(d,b.change_queue),self.Promise.resolve()):a.publish.apply(null,[].concat(d,[b.change]))},b.changeEventUnbuffered=function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return a.publish.apply(null,[].concat(d,[b.change]))},b=d.init(b),b=e.init(b),b=f.init(b),b=g.init(b),b=h.init(b),j(b),b},event:function(){for(var b=arguments.length,c=Array(b),i=0;b>i;i++)c[i]=arguments[i];var k=R.last(c),l=k.processing;return k.processing=!0,R.pipeP(function(){return a.publish.apply(null,c)},function(){return l?self.Promise.reject():null},function(){return d.save(k)},function(){return e.save(k)},function(){return f.save(k)},function(){return g.save(k)},function(){return h.save(k)},function(){return j(k)},function(){k.processing=l},function(){return k.change_queue=R.uniq(k.change_queue),function b(c){if(R.isEmpty(c))return null;var d=R.head(c);return a.publish.apply(null,[].concat(_toConsumableArray(d),[k.change])).then(function(){return b(R.tail(c))})}(k.change_queue)},function(){k.change_queue=[]})()["catch"](R.always(null)).then(function(){k.processing=l})},onChangeEvent:function(b,c,d){return a.subscribe(b,c,d.change)},onLoadDumpFile:function(a,c,e){return R.pipeP(b.read$("json"),function(b){return R.pipeP(function(){return d.onSettingsReset(a,c,b.settings)},function(){return g.loadNewLocalGame(a,b.game)},function(){a.changeEvent("State.loadDumpFile","File loaded")})()})(e)["catch"](function(b){a.changeEvent("State.loadDumpFile",b)})}},j=c.export$("dump",function(a){return{settings:R.pathOr({},["settings","current"],a),game:R.propOr({},"game",a)}});return R.curryService(i),i}]),angular.module("clickApp.services").factory("stateData",["pubSub","stateExports","fileImport","settings","gameBoard","gameTerrainInfo","gameFactions","gameScenario",function(a,b,c,d,e,f,g,h){var i={init:function(a){var b=e.init().then(function(b){a.boards=b}),c=f.init().then(function(b){a.terrains=b}),j=g.init().then(function(b){a.factions=b}),k=h.init().then(function(b){a.scenarios=b}),m=d.init().then(function(b){a.settings=b,l(a)});return a.data_ready=self.Promise.all([b,c,j,k,m]).then(function(){}),a.onEvent("Settings.loadFile",i.onSettingsLoadFile$(a)),a.onEvent("Settings.reset",i.onSettingsReset$(a)),a.onEvent("Factions.loadDescFile",i.onFactionsLoadDescFile$(a)),a.onEvent("Factions.clearDesc",i.onFactionsClearDesc$(a)),a.onEvent("Factions.clearAllDesc",i.onFactionsClearAllDesc$(a)),a},save:function(a){return R.pipeP(R.always(l(a)),R.always(m(a)),R.always(n(a)))()},onSettingsLoadFile:function(a,b,e){return R.pipeP(c.read$("json"),d.bind,d.update,j(a),function(){a.changeEvent("Settings.loadFile","Settings loaded")})(e)["catch"](function(b){a.changeEvent("Settings.loadFile",b)})},onSettingsReset:function(a,b,c){return R.pipePromise(d.bind,d.update,j(a))(c)},onFactionsLoadDescFile:function(a,b,d,e){return R.pipeP(c.read$("json"),function(b){
return R.assocPath(["desc",d],b,a.factions)},g.updateDesc,k(a),function(){a.changeEvent("Factions.loadDescFile","File loaded")})(e)["catch"](function(b){a.changeEvent("Factions.loadDescFile",b)})},onFactionsClearDesc:function(a,b,c){return R.pipePromise(R.dissocPath(["desc",c]),g.updateDesc,k(a))(a.factions)},onFactionsClearAllDesc:function(a,b){return b=b,R.pipePromise(R.assoc("desc",{}),g.updateDesc,k(a))(a.factions)}},j=R.curry(function(a,b){a.settings=b,a.changeEvent("Settings.change")}),k=R.curry(function(a,b){a.factions=b,a.changeEvent("Factions.change")}),l=b.export$("settings",R.path(["settings","current"])),m=function(a){return a._settings===a.settings?null:(a._settings=a.settings,d.store(a.settings))},n=function(a){return a._factions===a.factions?null:(a._factions=a.factions,g.storeDesc(a.factions))};return R.curryService(i),i}]),angular.module("clickApp.services").factory("stateExports",["fileExport",function(a){var b=R.curry(function(b,c){return R.pipe(R.path([].concat(_toConsumableArray(b),["url"])),a.cleanup,R.always(c),R.assocPath([].concat(_toConsumableArray(b),["url"]),null))(c)}),c={init:function(a){return a.exports={},a},rejectIf:function(a,b){return a(b)?self.Promise.reject():b},"export":function(c,d,e){return R.pipePromise(d,R.rejectIf(R.equals(R.path(["exports","_"+c],e)),"unchanged"),function(a){return e.exports=R.assoc("_"+c,a,e.exports),a},R.rejectIf(R.isNil,"nil"),a.generate$("json"))(e)["catch"](function(a){switch(a){case"nil":return null;case"unchanged":return self.Promise.reject();default:return null}}).then(function(a){e.exports=R.pipe(R.defaultTo({}),b([c]),R.assocPath([c],{name:"clicknfeat_"+c+".json",url:a}))(e.exports),e.changeEvent("Exports."+c)})["catch"](R.always(null))}};return R.curryService(c),c}]),angular.module("clickApp.services").factory("stateGame",["$window","games","game","gameBoard","gameConnection","gameFactions","gameModels","gameModelSelection","gameScenario","gameTerrains","fileImport","stateExports","allCommands","allTemplates",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){return l["export"]("models",R.pipePromise(R.path(["game","model_selection"]),l.rejectIf$(R.isNil),h.get$("local"),l.rejectIf$(R.isEmpty),function(b){return g.copyStamps(b,R.path(["game","models"],a))},l.rejectIf$(R.isEmpty)),a)}var n={init:function(a){return a.game=null,a.onEvent("Game.load",n.onGameLoad$(a)),a.onEvent("Game.connection.close",n.onGameConnectionClose$(a)),a.onEvent("Game.command.execute",n.onGameCommandExecute$(a)),a.onEvent("Game.command.undo",n.onGameCommandUndo$(a)),a.onEvent("Game.command.replay",n.onGameCommandReplay$(a)),a.onEvent("Game.command.replayBatch",n.onGameCommandReplayBatch$(a)),a.onEvent("Game.command.undoLast",n.onGameCommandUndoLast$(a)),a.onEvent("Game.command.replayNext",n.onGameCommandReplayNext$(a)),a.onEvent("Game.setCmds",n.onGameSetCmds$(a)),a.onEvent("Game.setPlayers",n.onGameSetPlayers$(a)),a.onEvent("Game.newChatMsg",n.onGameNewChatMsg$(a)),a.onEvent("Game.update",n.onGameUpdate$(a)),a.onEvent("Game.invitePlayer",n.onGameInvitePlayer$(a)),a.onEvent("Game.model.create",n.onGameModelCreate$(a)),a.onEvent("Game.model.copy",n.onGameModelCopy$(a)),a.onEvent("Game.model.importList",n.onGameModelImportList$(a)),a.onEvent("Game.model.importFile",n.onGameModelImportFile$(a)),a.onEvent("Game.template.create",n.onGameTemplateCreate$(a)),a.onEvent("Game.terrain.create",n.onGameTerrainCreate$(a)),a.onEvent("Game.terrain.reset",n.onGameTerrainReset$(a)),a.onEvent("Game.board.set",n.onGameBoardSet$(a)),a.onEvent("Game.board.setRandom",n.onGameBoardSetRandom$(a)),a.onEvent("Game.board.importFile",n.onGameBoardImportFile$(a)),a.onEvent("Game.scenario.set",n.onGameScenarioSet$(a)),a.onEvent("Game.scenario.setRandom",n.onGameScenarioSetRandom$(a)),a.onEvent("Game.scenario.generateObjectives",n.onGameScenarioGenerateObjectives$(a)),a},save:function(a){return R.pipeP(function(){return q(a)},function(){return m(a)},function(){return r(a)})()},onGameLoad:function(a,d,f,g,h){return R.pipePromise(R.always(a.data_ready),R.always(a.user_ready),R.always(a.games_ready),function(){return f?b.loadOnlineGame(g,h):b.loadLocalGame(h,a.local_games)},function(b){return a.changeEventUnbuffered("Game.loading"),b},o(a),function(b){return R.pipeP(function(){return a.event("Modes.reset")},R.always(b))()},c.load$(a),function(b){return a.changeEvent("Game.loaded"),b},function(b){return f?e.open$(R.path(["user","state","name"],a),a,b):b},function(a){return f?a:R.assoc("local_id",h,a)},o(a),function(){a.changeEvent("Game.load.success")})()["catch"](function(b){a.changeEvent("Game.load.error",b)})},onGameConnectionClose:function(a,b){return b=b,R.pipe(e.cleanup,o(a))(a.game)},onGameCommandExecute:function(a,b,d,e){return R.pipeP(c.executeCommand$(d,e,a),o(a))(a.game)["catch"](p(a))},onGameCommandUndo:function(a,b,d){return R.pipeP(c.undoCommand$(d,a),o(a))(a.game)},onGameCommandUndoLast:function(a,b){return b=b,R.pipeP(c.undoLastCommand$(a),o(a))(a.game)["catch"](p(a))},onGameCommandReplay:function(a,b,d){return R.pipeP(c.replayCommand$(d,a),o(a))(a.game)},onGameCommandReplayBatch:function(a,b,d){return R.pipeP(c.replayCommandsBatch$(d,a),o(a))(a.game)},onGameCommandReplayNext:function(a,b){return b=b,R.pipeP(c.replayNextCommand$(a),o(a))(a.game)["catch"](p(a))},onGameSetCmds:function(a,b,c){return R.pipe(R.assoc(c.where,c.cmds),o(a))(a.game)},onGameSetPlayers:function(a,b,c){return R.pipe(R.assoc("players",c),o(a))(a.game)},onGameNewChatMsg:function(a,b,c){return R.pipe(R.over(R.lensProp("chat"),R.compose(R.append(c.chat),R.defaultTo([]))),o(a),function(){a.changeEvent("Game.chat")})(a.game)},onGameUpdate:function(a,b,c,d){return R.pipe(R.over(c,d),o(a))(a.game)},onGameInvitePlayer:function(b,c,d){var e=[s.capitalize(R.pathOr("Unknown",["user","state","name"],b)),"has invited you to join a game"].join(" "),f=a.location.hash;return b.event("User.sendChatMsg",{to:d,msg:e,link:f})},onGameModelCreate:function(a,b,c){var d=arguments.length<=3||void 0===arguments[3]?1:arguments[3];return a.create=R.assoc("model",{base:{x:240,y:240,r:0},models:R.times(function(a){return{info:c,x:20*a,y:0,r:0}},d)},R.defaultTo({},a.create)),a.event("Modes.switchTo","CreateModel")},onGameModelCopy:function(a,b,c){return a.create=R.assoc("model",c,a.create),a.event("Modes.switchTo","CreateModel")},onGameModelImportList:function(a,b,c){var d=R.pathOr("Unknown",["user","state","name"],a);return a.create=R.assoc("model",f.buildModelsList(c,d,a.factions.references),a.create),a.event("Modes.switchTo","CreateModel")},onGameModelImportFile:function(a,b,c){return R.pipeP(k.read$("json"),function(b){return a.create=R.assoc("model",b,a.create),a.event("Modes.switchTo","CreateModel")})(c)["catch"](p(a))},onGameTemplateCreate:function(a,b,c){return a.create=R.assoc("template",{base:{x:240,y:240,r:0},templates:[{type:c,x:0,y:0,r:0}]},R.defaultTo({},a.create)),a.event("Modes.switchTo","CreateTemplate")},onGameTerrainCreate:function(a,b,c){return a.create=R.assoc("terrain",{base:{x:240,y:240,r:0},terrains:[{info:c,x:0,y:0,r:0}]},R.defaultTo({},a.create)),a.event("Modes.switchTo","CreateTerrain")},onGameTerrainReset:function(a,b){return b=b,R.pipePromise(function(){return j.all(a.game.terrains)},R.pluck("state"),R.pluck("stamp"),function(b){return a.event("Game.command.execute","deleteTerrain",[b])})()["catch"](p(a))},onGameBoardSet:function(a,b,c){var e=d.forName(c,a.boards);return a.event("Game.command.execute","setBoard",[e])},onGameBoardSetRandom:function(a,b){b=b;for(var c=void 0,e=d.name(a.game.board);e===d.name(a.game.board);)c=a.boards[R.randomRange(0,a.boards.length-1)],e=d.name(c);return a.event("Game.command.execute","setBoard",[c])},onGameBoardImportFile:function(a,b,c){return R.pipeP(k.read$("json"),function(b){return R.pipePromise(function(){return b.board?a.event("Game.command.execute","setBoard",[b.board]):self.Promise.reject()},function(){return R.isEmpty(R.pathOr([],["terrain","terrains"],b))?self.Promise.reject():a.event("Game.terrain.reset")},function(){return a.event("Game.command.execute","createTerrain",[b.terrain,!1])})()})(c)["catch"](R.always(null))},onGameScenarioSet:function(a,b,c,d){var e=i.forName(c,d);return a.event("Game.command.execute","setScenario",[e])},onGameScenarioSetRandom:function(a,b){b=b;for(var c,d=i.group("SR15",a.scenarios),e=i.name(a.game.scenario);e===i.name(a.game.scenario);)c=d[1][R.randomRange(0,d[1].length-1)],e=i.name(c);return a.event("Game.command.execute","setScenario",[c])},onGameScenarioGenerateObjectives:function(a,b){return b=b,R.pipePromise(function(){return g.all(a.game.models)},R.filter(R.pipe(R.path(["state","info"]),R.head,R.equals("scenario"))),R.map(R.path(["state","stamp"])),function(b){return a.event("Game.command.execute","deleteModel",[b])},function(){return i.createObjectives(a.game.scenario)},function(b){var c=R.path(["ui_state","flip_map"],a);return a.event("Game.command.execute","createModel",[b,c])})()}},o=R.curry(function(a,b){return a.game=b,a.changeEvent("Game.change"),b}),p=R.curry(function(a,b){return a.changeEvent("Game.action.error",b),null}),q=l.export$("game",R.prop("game")),r=l.export$("board",R.pipePromise(R.prop("game"),l.rejectIf$(R.isNil),function(a){return{board:a.board,terrain:{base:{x:0,y:0,r:0},terrains:R.pipe(j.all,R.pluck("state"),R.map(R.pick(["x","y","r","info","lk"])))(a.terrains)}}}));return R.curryService(n),n}]),angular.module("clickApp.services").factory("stateGames",["game","games","fileImport",function(a,b,c){function d(a){return a._local_games===a.local_games?null:(a._local_games=a.local_games,b.storeLocalGames(a.local_games))}var e={init:function(a){return a.local_games={},a.games_ready=R.pipeP(b.loadLocalGames,f(a))(),a.onEvent("Games.local.create",e.onGamesLocalCreate$(a)),a.onEvent("Games.local.load",e.onGamesLocalLoad$(a)),a.onEvent("Games.local.loadFile",e.onGamesLocalLoadFile$(a)),a.onEvent("Games.local.delete",e.onGamesLocalDelete$(a)),a},save:function(a){return R.pipePromise(function(c){var d=parseInt(R.path(["game","local_id"],a));return R.isNil(d)||isNaN(d)||a._game===a.game?a:(a._game=a.game,R.pipe(b.updateLocalGame$(d,a.game),function(b){return a.local_games=b,a})(c))},d)(a.local_games)},onGamesLocalCreate:function(b,c){return c=c,R.pipePromise(function(){return a.create(b.user.state)},e.loadNewLocalGame$(b))()},onGamesLocalLoad:function(a,b,c){a.changeEvent("Games.local.load",c)},onGamesLocalLoadFile:function(a,b,d){return R.pipePromise(c.read$("json"),e.loadNewLocalGame$(a))(d)},onGamesLocalDelete:function(a,c,d){return R.pipePromise(b.removeLocalGame$(d),f(a))(a.local_games)},loadNewLocalGame:function(a,c){return R.pipe(b.newLocalGame$(c),f(a),function(){a.changeEvent("Games.local.load",R.length(a.local_games)-1)})(a.local_games)}},f=R.curry(function(a,b){a.local_games=b,a.changeEvent("Games.local.change")});return R.curryService(e),e}]),angular.module("clickApp.services").factory("stateModes",["modes","allModes",function(a){var b={init:function(a){return a.modes={},a.onEvent("Modes.switchTo",b.onModesSwitchTo$(a)),a.onEvent("Modes.current.action",b.onModesCurrentAction$(a)),a.onEvent("Modes.reset",b.onModesReset$(a)),a.onEvent("Modes.exit",b.onModesExit$(a)),a},save:function(a){return a},onModesSwitchTo:function(b,e,f){return R.pipePromise(a.switchToMode$(f,b),c(b))(b.modes)["catch"](d(b))},onModesCurrentAction:function(b,c,e,f){var g=a.currentModeAction(e,[b].concat(_toConsumableArray(f)),b.modes),h=R.last(f);return R.exists(R.prop("preventDefault",h))&&h.preventDefault(),self.Promise.resolve(g)["catch"](d(b))},onModesReset:function(b,d){return d=d,R.pipePromise(a.init,c(b))(b)},onModesExit:function(b,d){return d=d,R.pipePromise(a.exit$(b),c(b))(b.modes)}},c=R.curry(function(a,b){a.modes=b,a.changeEvent("Modes.change")}),d=R.curry(function(a,b){return a.changeEvent("Game.action.error",b),null});return R.curryService(b),b}]),angular.module("clickApp.services").factory("stateUser",["user","userConnection","prompt",function(a,b,c){function d(b){return b._user===b.user?null:(b._user=b.user,a.save(b.user))}var e={init:function(b){return b.user={},b.user_ready=R.pipeP(a.init,f(b))(b),b.onEvent("User.set",e.onUserSet$(b)),b.onEvent("User.toggleOnline",e.onUserToggleOnline$(b)),b.onEvent("User.sendChatMsg",e.onUserSendChatMsg$(b)),b.onEvent("User.connection.close",e.onUserConnectionClose$(b)),b.onEvent("User.setOnlineUsers",e.onUserSetOnlineUsers$(b)),b.onEvent("User.setOnlineGames",e.onUserSetOnlineGames$(b)),b.onEvent("User.newChatMsg",e.onUserNewChatMsg$(b)),b},save:function(a){return d(a)},onUserSet:function(b,c,d){return R.pipePromise(R.assoc("state",d),a.checkOnline$(b),f(b))(b.user)},onUserToggleOnline:function(b,c){return c=c,R.pipePromise(a.toggleOnline$(b),f(b))(b.user)},onUserSendChatMsg:function(a,c,d){return b.sendChat$(d,a.user)},onUserConnectionClose:function(b,d){return d=d,R.pipePromise(a.online,function(a){return a?c.prompt("alert","Server connection lost.")["catch"](R.always(null)):self.Promise.reject("User not online when connection close")},R.always(b.user),a.toggleOnline$(b),f(b))(b.user)},onUserSetOnlineUsers:function(a,b,c){return R.pipePromise(R.assocPath(["connection","users"],c),f(a))(a.user)},onUserSetOnlineGames:function(a,b,c){return R.pipePromise(R.assocPath(["connection","games"],c),f(a))(a.user)},onUserNewChatMsg:function(a,b,c){return a.changeEvent("User.chat",c),R.pipePromise(R.assocPath(["connection","chat"],R.pipe(R.pathOr([],["connection","chat"]),R.append(c))(a.user)),f(a))(a.user)}},f=R.curry(function(a,b){a.user=b,a.changeEvent("User.change")});return R.curryService(e),e}]),angular.module("clickApp.services").factory("aoeTemplate",["template","model","point",function(a,b,c){var d=Object.create(a);return d.create=function(a){return R.assocPath(["state","s"],15,a)},d.setSize=function(a,b){return R.isNil(R.find(R.equals(a),[3,4,5]))?self.Promise.reject("Invalid size for an AoE"):R.assocPath(["state","s"],5*a,b)},d.size=function(a){return R.path(["state","s"],a)},d.deviate=function(b,d,e){if(a.isLocked(e))return self.Promise.reject("Template is locked");b=e.state.r+60*(b-1);var f=R.defaultTo(d,R.path(["state","m"],e));return d=Math.min(d,f),R.pipe(R.over(R.lensProp("state"),c.translateInDirection$(10*d,b)),R.assocPath(["state","r"],b),a.checkState)(e)},d.maxDeviation=function(a){return R.pathOr(0,["state","m"],a)},d.setMaxDeviation=function(a,b){return R.assocPath(["state","m"],a,b)},d.setToRuler=function(b,c){if(a.isLocked(c))return self.Promise.reject("Template is locked");var d=R.pipe(R.assoc("x",b.x),R.assoc("y",b.y),R.assoc("r",b.r),R.assoc("m",b.m))(c.state);return R.pipe(R.assoc("state",d),a.checkState)(c)},d.setTarget=function(b,c,d,e){return a.setPosition(d.state,e)},a.registerTemplate("aoe",d),R.curryService(d),d}]).factory("wallTemplate",["template",self.wallTemplateServiceFactory=function(a){var b=Object.create(a);return b.create=function(a){return a},a.registerTemplate("wall",b),R.curryService(b),b}]).factory("sprayTemplate",["template","model","point",self.sprayTemplateServiceFactory=function(a,b,c){var d=Object.create(a);d.create=function(a){return R.assocPath(["state","s"],6,a)},d.setSize=function(a,b){return R.isNil(R.find(R.equals(a),[6,8,10]))?self.Promise.reject("Invalid size for a Spray"):R.assocPath(["state","s"],a,b)},d.size=function(a){return R.path(["state","s"],a)},d.origin=function(a){return R.path(["state","o"],a)},d.setOrigin=function(c,d,e){return a.isLocked(e)?self.Promise.reject("Template is locked"):R.pipeP(b.baseEdgeInDirection$(c,e.state.r),function(b){return R.pipe(R.assocPath(["state","o"],d.state.stamp),a.setPosition$(b))(e)})(d)},d.setTarget=function(d,e,f,g){if(a.isLocked(g))return self.Promise.reject("Template is locked");var h=c.directionTo(f.state,e.state);return R.pipeP(b.baseEdgeInDirection$(d,h),function(b){return R.pipe(R.assocPath(["state","r"],h),a.setPosition$(b))(g)})(e)};var e=["moveFront","moveBack","shiftLeft","shiftRight","shiftUp","shiftDown","setPosition"];return R.forEach(function(b){d[b]=function(c,d){return a.isLocked(d)?self.Promise.reject("Template is locked"):R.pipePromise(R.assocPath(["state","o"],null),function(d){return a[b](c,d)})(d)}},e),d.rotateLeft=function(d,e,f,g){if(a.isLocked(g))return self.Promise.reject("Template is locked");if(R.isNil(e))return a.rotateLeft(f,g);var h=a.moves()[f?"RotateSmall":"Rotate"];return g=R.over(R.lensProp("state"),c.rotateLeft$(h),g),R.pipeP(b.baseEdgeInDirection$(d,g.state.r),function(b){return a.setPosition(b,g)})(e)},d.rotateRight=function(d,e,f,g){if(a.isLocked(g))return self.Promise.reject("Template is locked");if(R.isNil(e))return a.rotateRight(f,g);var h=a.moves()[f?"RotateSmall":"Rotate"];return g=R.over(R.lensProp("state"),c.rotateRight$(h),g),R.pipeP(b.baseEdgeInDirection$(d,g.state.r),function(b){return a.setPosition(b,g)})(e)},a.registerTemplate("spray",d),R.curryService(d),d}]).factory("template",["settings","point",self.templateServiceFactory=function(a,b){var c={},d={Move:10,MoveSmall:1,Rotate:60,RotateSmall:6,Shift:10,ShiftSmall:1},e=R.clone(d);a.register("Moves","Template",d,function(a){R.extend(e,a)});var f={registerTemplate:function(a,b){c[a]=b},moves:function(){return e},create:function(a){return R.pipePromise(R.prop(a.type),R.rejectIf(R.isNil,"Create unknown template type "+a.type),function(b){var c={state:{type:a.type,x:0,y:0,r:0,l:[],stamp:R.guid()}};return b.create(c)},function(b){return b.state=R.deepExtend(b.state,a),b})(c)},state:function(a){return R.prop("state",a)},saveState:function(a){return R.clone(R.prop("state",a))},setState:function(a,b){return R.assoc("state",R.clone(a),b)},respondTo:function(a,b){return R.exists(c[b.state.type])&&R.exists(c[b.state.type][a])},call:function(a,b,d){return new self.Promise(function(e,g){return f.respondTo(a,d)?void e(c[d.state.type][a].apply(null,[].concat(_toConsumableArray(b),[d]))):void g("Unknown call "+a+" on "+d.state.type+" template")})},checkState:function(a){return R.pipe(R.over(R.lensPath(["state","x"]),R.compose(R.max(0),R.min(480))),R.over(R.lensPath(["state","y"]),R.compose(R.max(0),R.min(480))))(a)},isLocked:function(a){return R.path(["state","lk"],a)},setLock:function(a,b){return R.assocPath(["state","lk"],a,b)},setPosition:function(a,b){return f.isLocked(b)?self.Promise.reject("Template is locked"):R.pipe(R.assocPath(["state","x"],a.x),R.assocPath(["state","y"],a.y),f.checkState)(b)},moveFront:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"MoveSmall":"Move"];return R.pipe(R.over(R.lensProp("state"),b.moveFront$(d)),f.checkState)(c)},moveBack:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"MoveSmall":"Move"];return R.pipe(R.over(R.lensProp("state"),b.moveBack$(d)),f.checkState)(c)},rotateLeft:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"RotateSmall":"Rotate"];return R.pipe(R.over(R.lensProp("state"),b.rotateLeft$(d)),f.checkState)(c)},rotateRight:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"RotateSmall":"Rotate"];return R.pipe(R.over(R.lensProp("state"),b.rotateRight$(d)),f.checkState)(c)},shiftLeft:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftLeft$(d)),f.checkState)(c)},shiftRight:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftRight$(d)),f.checkState)(c)},shiftUp:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftUp$(d)),f.checkState)(c)},shiftDown:function(a,c){if(f.isLocked(c))return self.Promise.reject("Template is locked");var d=e[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftDown$(d)),f.checkState)(c)},eventName:function(a){return R.path(["state","stamp"],a)},addLabel:function(a,b){return R.over(R.lensPath(["state","l"]),R.compose(R.uniq,R.append(a)),b)},removeLabel:function(a,b){return R.over(R.lensPath(["state","l"]),R.reject(R.equals(a)),b)},fullLabel:function(a){return R.pathOr([],["state","l"],a).join(" ")}};return R.curryService(f),f}]).factory("allTemplates",["aoeTemplate","sprayTemplate","wallTemplate",function(){return{}}]),angular.module("clickApp.services").factory("terrain",["settings","point",function(a,b){var c={Move:10,MoveSmall:1,Rotate:15,RotateSmall:5,Shift:10,ShiftSmall:1},d=R.clone(c);a.register("Moves","Terrain",c,function(a){R.extend(d,a)});var e={create:function(a){var b={state:{x:0,y:0,r:0,lk:!1,stamp:R.guid()}};return b.state=R.deepExtend(b.state,a),e.checkState(b)},stamp:function(a){return R.path(["state","stamp"],a)},eventName:function(a){return R.path(["state","stamp"],a)},state:function(a){return R.prop("state",a)},saveState:function(a){return R.clone(R.prop("state",a))},setState:function(a,b){return R.assoc("state",R.clone(a),b)},checkState:function(a){return R.pipe(R.over(R.lensPath(["state","x"]),R.compose(R.max(0),R.min(480))),R.over(R.lensPath(["state","y"]),R.compose(R.max(0),R.min(480))))(a)},isLocked:function(a){return R.path(["state","lk"],a)},setLock:function(a,b){return R.assocPath(["state","lk"],a,b)},setPosition:function(a,b){return e.isLocked(b)?self.Promise.reject("Terrain is locked"):R.pipe(R.assocPath(["state","x"],a.x),R.assocPath(["state","y"],a.y),e.checkState)(b)},shiftPosition:function(a,b){return e.isLocked(b)?self.Promise.reject("Terrain is locked"):R.pipe(R.assocPath(["state","x"],b.state.x+a.x),R.assocPath(["state","y"],b.state.y+a.y),e.checkState)(b)},setOrientation:function(a,b){return e.isLocked(b)?self.Promise.reject("Terrain is locked"):R.pipe(R.assocPath(["state","r"],a,b),e.checkState)(b)},moveFront:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"MoveSmall":"Move"];return R.pipe(R.over(R.lensProp("state"),b.moveFront$(f)),e.checkState)(c)},moveBack:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"MoveSmall":"Move"];return R.pipe(R.over(R.lensProp("state"),b.moveBack$(f)),e.checkState)(c)},rotateLeft:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"RotateSmall":"Rotate"];return R.pipe(R.over(R.lensProp("state"),b.rotateLeft$(f)),e.checkState)(c)},rotateRight:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"RotateSmall":"Rotate"];return R.pipe(R.over(R.lensProp("state"),b.rotateRight$(f)),e.checkState)(c)},shiftLeft:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftLeft$(f)),e.checkState)(c)},shiftRight:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftRight$(f)),e.checkState)(c)},shiftUp:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftUp$(f)),e.checkState)(c)},shiftDown:function(a,c){if(e.isLocked(c))return self.Promise.reject("Terrain is locked");var f=d[a?"ShiftSmall":"Shift"];return R.pipe(R.over(R.lensProp("state"),b.shiftDown$(f)),e.checkState)(c)}};return R.curryService(e),e}]),angular.module("clickApp.services").factory("user",["http","localStorage","userConnection",function(a,b,c){function d(a,b){return R.pipePromise(R.assocPath(["state","online"],!0),j.checkOnline$(a))(b)}function e(a){return h(a)}function f(b){return R.pipePromise(R.prop("state"),a.post$("/api/users"),function(a){return R.assoc("state",a,b)})(b)}function g(b){return R.isNil(b.state.stamp)?self.Promise.reject("No valid stamp"):R.pipePromise(R.prop("state"),a.put$("/api/users/"+b.state.stamp),function(a){return R.assoc("state",a,b)})(b)}function h(a){return R.pipePromise(R.assocPath(["state","online"],!1),R.assocPath(["state","stamp"],null),c.close)(a)}var i="clickApp.user",j={isValid:function(a){return R.pipe(R.pathOr("",["state","name"]),s.trim,R.length,R.lt(0))(a)},save:function(a){return R.pipePromise(R.prop("state"),R.spyWarn("User save"),b.save$(i),R.always(a))(a)},load:function(){return R.pipeP(function(){return b.load(i)},R.spyWarn("User load"),function(a){return{state:a}},c.init)()},init:function(a){return R.pipeP(j.load,j.checkOnline$(a))()},description:function(a){return"Object"!==R.type(R.prop("state",a))?"":j.stateDescription(a.state)},stateDescription:function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=a.name,c=a.language,d=a.chat,e=a.faction,f=a.game_size,g=a.ck_position,h="";R.exists(b)&&(h+=s(b).trim().capitalize().value());var i=[];return R.exists(c)&&i.push(s(c).trim().value()),R.exists(d)&&i.push(s(d).trim().value()),R.isEmpty(i)||(h+="["+i.join(" ")+"]"),R.exists(e)&&!R.isEmpty(e)&&(h+=" - "+R.map(s.capitalize,e).join(",")),R.exists(f)&&(h+="["+s.trim(f)+"pts]"),R.exists(g)&&!R.isEmpty(g)&&(h+=" - likes "+g.join(",")),h},online:function(a){return R.path(["state","online"],a)},toggleOnline:function(a,b){return j.online(b)?e(b):d(a,b)},checkOnline:function(a,b){return R.pipePromise(function(a){return j.online(a)?a:self.Promise.reject("No online flag")},function(a){return g(a)["catch"](function(){return f(a)})},k(a))(b)["catch"](function(a){return h(b)})}},k=R.curry(function(a,b){return R.pipePromise(c.open$(a),R.assocPath(["state","online"],!0))(b)});return R.curryService(j),j}]),angular.module("clickApp.services").factory("userConnection",["http","pubSub","websocket",function(a,b,c){function d(a){return R.pipe(R.assocPath(["state","socket"],null),R.assoc("users",[]))(a)}function e(a){return function(){a.event("User.connection.close")}}var f={init:function(a){var b={state:{socket:null}};return R.assoc("connection",b,a)},open:function(a,b){if(R.exists(b.connection.state.socket))return self.Promise.resolve(b);var d={close:e(a),users:g(a),games:h(a),chat:i(a)};return b=R.assocPath(["connection","state","socket"],null,b),R.pipeP(function(){return c.create("/api/users/"+b.state.stamp,"user",d)},function(a){return R.assocPath(["connection","state","socket"],a,b)})()},close:function(a){return R.pipeP(function(){return R.isNil(a.connection.state.socket)?self.Promise.resolve():c.close(a.connection.state.socket)},function(){return R.assoc("connection",d(a.connection),a)})()},active:function(a){return R.pipe(R.path(["connection","state","socket"]),R.exists)(a)},sendChat:function(a,b){return f.active(b)?(a=R.pipe(R.assoc("type","chat"),R.assoc("from",b.state.stamp))(a),c.send(a,b.connection.state.socket)):self.Promise.reject("Not active")},userNameForStamp:function(a,b){return R.pipe(j(a),R.defaultTo({name:"Unknown"}),R.prop("name"),function(a){return s(a).trim().capitalize().value()})(b.connection)},usersNamesForStamps:function(a,b){return R.pipe(R.defaultTo({}),R.propOr({},"connection"),k(R.defaultTo([],a)),R.pluck("name"),function(a){return R.isEmpty(a)?["Unknown"]:a},R.map(function(a){return s(a).trim().capitalize().value()}))(b)}},g=R.curry(function(a,b){a.event("User.setOnlineUsers",R.pipe(R.propOr([],"users"),R.sortBy(R.compose(R.toLower,R.prop("name"))))(b))}),h=R.curry(function(a,b){a.event("User.setOnlineGames",R.pipe(R.propOr([],"games"))(b))}),i=R.curry(function(a,b){a.event("User.newChatMsg",b)}),j=R.curry(function(a,b){return R.pipe(R.prop("users"),R.find(R.propEq("stamp",a)))(b)}),k=R.curry(function(a,b){return R.pipe(R.map(R.flip(j)(b)),R.reject(R.isNil))(a)});return R.curryService(f),f}]),angular.module("clickApp.services").factory("websocket",["$document","jsonParser","jsonStringifier",function(a,b,c){return{create:function(a,c,d){return new self.Promise(function(e,f){function g(a,b){}function h(){}c=R.defaultTo(a,c),d=R.pipe(R.over(R.lensProp("error"),R.defaultTo(g)),R.over(R.lensProp("close"),R.defaultTo(h)))(d);var i="ws://",j=i+self.document.location.host+a,k=new self.WebSocket(j),l=!1;k.onopen=function(a){e(k),l=!0},k.onerror=function(a){d.error("socketError",a)},k.onclose=function(){return l?void d.close():(f("Connection error"),void(l=!0))},k.onmessage=function(a){R.pipeP(b.parse,function(a){return R.isNil(d[a.type])?void d.error("Unknown msg type",a):void d[a.type](a)})(a.data)}})},send:function(a,b){return R.pipeP(c.stringify,b.send)(a)},close:function(a){return new self.Promise(function(b){a.close(),b()})}}}]),angular.module("clickApp.filters").filter("capitalize",[function(){return function(a){return s.capitalize(a)}}]).filter("game",["game",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("gameConnection",["gameConnection",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("gameLayers",["gameLayers",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("gameRuler",["gameRuler",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("gameLos",["gameLos",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("modes",["modes",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("user",["user",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]).filter("userConnection",["userConnection",function(a){return function(b,c){if(!R.exists(a[c]))return null;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a[c].apply(null,R.append(b,e))}}]),angular.module("clickApp.directives").directive("clickBadDiceNotification",[function(){return{restrict:"E",template:['<audio src="/data/sound/naindows-hahaha02.wav">',"</audio>"].join(""),link:function(a,b){var c=b[0].querySelector("audio");a.onStateChangeEvent("Game.dice.roll",function(){var b=R.last(R.pathOr([],["state","game","dice"],a));if("rollDeviation"!==b.type){var d=R.propOr([],"d",b);if(!(R.length(d)<2)){var e=R.reduce(R.add,0,d)/R.length(d);e>=2||(c.currentTime=0,c.play())}}},a)}}}]),angular.module("clickApp.directives").factory("compatCheck",[function(){function a(a){return function(){return R.exists(self[a])?null:a}}var b={check:function(){return R.pipe(R.ap([a("requestAnimationFrame"),a("Promise"),a("FileReader"),function(){return R.exists(self.URL)||R.exists(self.webkitURL)?null:"URL"},a("Blob"),a("localStorage"),a("WebSocket"),a("XMLHttpRequest"),a("crypto")]),R.reject(R.isNil))([null])}};return R.curryService(b),b}]).directive("clickCompatCheck",["compatCheck",function(a){return{restrict:"E",templateUrl:"partials/directives/compat_check.html",link:function(b){var c=a.check();b.compat_error=R.isEmpty(c)?null:c}}}]),angular.module("clickApp.directives").directive("eaFile",function(){return{restrict:"A",scope:{eaFile:"&"},controller:["$scope",function(){}],link:function(a,b){b[0].onclick=function(){this.value=null},b[0].onchange=function(){var c=b[0].files;a.eaFile({file:c}),b[0].blur()}}}}),angular.module("clickApp.directives").controller("gameChatBoxCtrl",["$scope","game",function(a,b){a.chat={msg:""},a.doSendChatMessage=function(){var c=s.trim(a.chat.msg);R.isEmpty(c)||R.pipeP(b.sendChat$(R.path(["user","state","name"],a.state),c),function(){
a.chat.msg="",a.$digest()})(a.state.game)},a.digestOnStateChangeEvent("Game.chat",a)}]).directive("clickGameChatBox",[function(){return{restrict:"E",controller:"gameChatBoxCtrl",templateUrl:"partials/directives/game_chat_box.html",scope:!0,link:function(){}}}]),angular.module("clickApp.directives").directive("clickGameCreateModel",["gameFactions","gameMap",function(a,b){function c(a,b,c,d){var e=b.createElementNS(c,"circle");return e.classList.add("create-model"),e.setAttribute("cx","240"),e.setAttribute("cy","240"),e.setAttribute("r",a.base_radius),d.appendChild(e),e}function d(a,b,c,d){var e=b?-1:1;d.setAttribute("cx",a.x+e*c.x+""),d.setAttribute("cy",a.y+e*c.y+"")}return{restrict:"A",link:function(e,f){var g=document.getElementById("map"),h=g.namespaceURI,i=e.state,j=R.nth(e.index,i.create.model.models);R.pipeP(a.getModelInfo$(j.info),function(a){var k=c(a,document,h,f[0]),l=b.isFlipped(g);d(i.create.model.base,l,j,k),e.onStateChangeEvent("Game.create.update",function(){R.isNil(R.path(["create","model"],i))||(l=b.isFlipped(g),d(i.create.model.base,l,j,k))},e)})(i.factions)}}}]),angular.module("clickApp.directives").directive("clickGameCreateTemplate",["gameMap",function(a){function b(a,b,c){var d=a.createElementNS(b,"circle");return d.classList.add("create-template-aoe"),d.setAttribute("cx","240"),d.setAttribute("cy","240"),d.setAttribute("r","15"),c.appendChild(d),d}function c(a,b,c,d){var e=b?-1:1;d.setAttribute("cx",a.x+e*c.x+""),d.setAttribute("cy",a.y+e*c.y+"")}function d(a,b,c){var d=a.createElementNS(b,"polygon");return d.classList.add("create-template-spray"),d.setAttribute("points","8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0"),d.setAttribute("transform","translate(230,240)"),c.appendChild(d),d}function e(a,b,c,d){var e=b?-1:1;d.setAttribute("transform",["translate(",a.x+e*c.x-10,",",a.y+e*c.y,")"].join(""))}function f(a,b,c){var d=a.createElementNS(b,"rect");return d.classList.add("create-template-wall"),d.setAttribute("x","220"),d.setAttribute("y","236.25"),d.setAttribute("width","40"),d.setAttribute("height","7.5"),c.appendChild(d),d}function g(a,b,c,d){var e=b?-1:1;d.setAttribute("x",a.x+e*c.x-20+""),d.setAttribute("y",a.y+e*c.y-3.75+"")}var h={};return{restrict:"A",link:function(i,j){var k=document.getElementById("map"),l=k.namespaceURI;h.aoe={create:b,setPosition:c},h.spray={create:d,setPosition:e},h.wall={create:f,setPosition:g};var m=i.state,n=R.nth(i.index,m.create.template.templates),o=n.type,p=h[o].create(document,l,j[0]),q=a.isFlipped(k);h[o].setPosition(m.create.template.base,q,n,p),i.onStateChangeEvent("Game.create.update",function(){R.isNil(R.path(["create","template"],m))||(q=a.isFlipped(k),h[o].setPosition(m.create.template.base,q,n,p))},i)}}}]),angular.module("clickApp.directives").directive("clickGameCreateTerrain",["gameTerrainInfo","gameMap",function(a,b){function c(a,b,c,d){var e=b.createElementNS(c,"rect");return e.classList.add("create-terrain"),e.setAttribute("x","240"),e.setAttribute("y","240"),e.setAttribute("width",a.img.width),e.setAttribute("height",a.img.height),d.appendChild(e),e}function d(a,b,c,d,e){var f=c?-1:1;e.setAttribute("x",b.x+f*d.x-a.img.width/2+""),e.setAttribute("y",b.y+f*d.y-a.img.height/2+"")}return{restrict:"A",link:function(e,f){var g=document.getElementById("map"),h=g.namespaceURI,i=e.state,j=R.nth(e.index,i.create.terrain.terrains);R.pipeP(a.getInfo$(j.info),function(a){var k=c(a,document,h,f[0]),l=b.isFlipped(g);d(a,i.create.terrain.base,l,j,k),e.onStateChangeEvent("Game.create.update",function(){R.isNil(R.path(["create","terrain"],i))||(l=b.isFlipped(g),d(a,i.create.terrain.base,l,j,k))},e)})(i.terrains)}}}]),angular.module("clickApp.directives").directive("clickGameDragbox",[function(){return{restrict:"A",link:function(a,b){function c(a,b,c){var e=Math.min(b.x,c.x),f=Math.min(b.y,c.y),g=Math.abs(b.x-c.x),h=Math.abs(b.y-c.y);d.style.visibility="visible",d.setAttribute("x",e+""),d.setAttribute("y",f+""),d.setAttribute("width",g+""),d.setAttribute("height",h+"")}var d=b[0];d.style.visibility="hidden",a.onStateChangeEvent("Game.dragBox.enable",c,a),a.onStateChangeEvent("Game.dragBox.disable",function(){d.style.visibility="hidden"},a)}}}]),angular.module("clickApp.directives").controller("gameDiceBoxCtrl",["$scope",function(a){function b(){a.dice=R.clone(R.path(["state","game","dice"],a)),a.$digest()}a.onStateChangeEvent("Game.dice.roll",b,a),self.requestAnimationFrame(b),a.doRollDice=function(b,c){a.stateEvent("Game.command.execute","rollDice",[b,c])}}]).directive("clickGameDiceBox",[function(){return{restrict:"E",controller:"gameDiceBoxCtrl",templateUrl:"partials/directives/game_dice_box.html",scope:!0,link:function(){}}}]),angular.module("clickApp.controllers").controller("clickGameEditDamageCtrl",["$scope",function(){}]),angular.module("clickApp.directives").directive("clickGameEditDamage",["$window","game","gameFactions","gameMap",function(a,b,c,d){return{restrict:"A",template:['<click-game-model-damage info="info.damage"','  state="selection.state"',"  on-error=\"gameEvent('modeActionError', reason)\">","</click-game-model-damage>"].join(""),scope:!0,controller:"clickGameEditDamageCtrl",link:function(b,e){function f(a,b){o?g():h(a,b)}function g(){o=!1,b.selection={},e[0].style.display="none",e[0].style.visibility="hidden",e[0].style.left="0px",e[0].style.top="0px"}function h(d,e){o=!0,b.selection=e,c.getModelInfo(b.selection.state.info,n.factions).then(function(a){b.info=a,b.$digest()}),a.requestAnimationFrame(i)}function i(){e[0].style.display="initial",e[0].style.visibility="hidden",a.requestAnimationFrame(j)}function j(){k(),e[0].style.visibility="visible"}function k(){var a=e[0].getBoundingClientRect(),c=d.mapToScreenCoordinates(m,b.selection.state),f=l.getBoundingClientRect(),g=f.height-a.height,h=f.width-a.width,i=Math.max(0,Math.min(g,c.y-a.height/2)),j=Math.max(0,Math.min(h,c.x-a.width/2));e[0].style.top=i+"px",e[0].style.left=j+"px"}var l=document.getElementById("viewport"),m=document.getElementById("map"),n=b.state,o=!1;g(),b.onStateChangeEvent("Game.editDamage.toggle",f,b),b.onStateChangeEvent("Game.editDamage.open",h,b),b.onStateChangeEvent("Game.editDamage.close",g,b),b.doClose=g}}}]),angular.module("clickApp.controllers").controller("clickGameEditLabelCtrl",["$scope",function(a){a.edit={label:""},a.doAddLabel=function(){var b=s.trim(a.edit.label);0!==R.length(b)&&a.stateEvent("Game.command.execute","onModels",["addLabel",[b],[a.selection.state.stamp]]).then(function(){a.edit.label="",a.doClose(),a.$digest()})}}]),angular.module("clickApp.directives").directive("clickGameEditLabel",["$window","gameMap",function(a,b){return{restrict:"A",template:['<form ng-submit="doAddLabel()">','<input type="text" ng-model="edit.label" ng-change="doRefresh()" />',"</form>"].join(""),scope:!0,controller:"clickGameEditLabelCtrl",link:function(c,d){function e(){c.selection={},d[0].style.display="none",d[0].style.visibility="hidden",d[0].style.left="0px",d[0].style.top="0px"}function f(b,d){c.selection=d,c.edit={label:""},c.$digest(),a.requestAnimationFrame(g)}function g(){d[0].style.display="initial",d[0].style.visibility="hidden",k(),a.requestAnimationFrame(h)}function h(){j(),d[0].style.visibility="visible",a.requestAnimationFrame(function(){m.focus()})}function i(){k(),a.requestAnimationFrame(j)}function j(){var a=m.getBoundingClientRect(),e=b.mapToScreenCoordinates(l,c.selection.state);d[0].style.left=e.x-a.width/2+"px",d[0].style.top=e.y-a.height/2+"px"}function k(){m.style.width=R.length(c.edit.label)+"em"}var l=document.getElementById("map"),m=d[0].querySelector("input");e(),c.onStateChangeEvent("Game.editLabel.open",f,c),c.onStateChangeEvent("Game.editLabel.close",e,c),m.addEventListener("keydown",function(a){27===a.keyCode&&e()}),c.doRefresh=i,c.doClose=e}}}]),angular.module("clickApp.directives").directive("clickGameLoading",[function(){return{restrict:"A",link:function(a,b){a.onStateChangeEvent("Game.loading",function(){b[0].style.display="block"},a),a.onStateChangeEvent("Game.loaded",function(){b[0].style.display="none"},a)}}}]),angular.module("clickApp.directives").factory("labelElement",["$window","gameMap",function(a,b){function c(a,b,c,d){d.style.visibility=c,d.setAttribute("transform",a?"rotate(180,"+b.x+","+b.y+")":"")}function d(a,b,c){c.innerHTML=b,c.setAttribute("x",a.x+""),c.setAttribute("y",a.y+"")}function e(a,b,c,d){var e=c.getBoundingClientRect(),f=e.width/a-2,g=parseFloat(d.getAttribute("height"));d.setAttribute("x",b.x-f/2-1+""),d.setAttribute("y",b.y-(g-1)+""),d.setAttribute("width",f+2+"")}var f={create:function(a,b){var c=document.createElementNS(a,"g");c.classList.add("label"),b.appendChild(c);var d=document.createElementNS(a,"rect");d.setAttribute("height","6"),c.appendChild(d);var e=document.createElementNS(a,"text");return c.appendChild(e),{label:c,bckgnd:d,text:e}},updateOnFlipMap:function(a,c,d){var e=b.isFlipped(a);d.label.setAttribute("transform",e?"rotate(180,"+c.x+","+c.y+")":"")},update:function(b,f,g,h,i,j){i=R.defaultTo("",i)+"";var k=R.length(i)>0?"visible":"hidden";c(b,g,k,j.label),"visible"===k&&(d(h,i,j.text),a.requestAnimationFrame(function(){e(f,h,j.text,j.bckgnd)}))}};return f}]),angular.module("clickApp.directives").directive("clickGameLos",["modes","gameLos","gameModels","gameFactions",function(a,b,c,d){function e(a,b,c){var d=document.createElementNS(a,"g");c.appendChild(d);var e=document.createElementNS(a,"line");e.style["marker-start"]="url(#los-start)",e.style["marker-end"]="url(#los-end)",d.appendChild(e);var f=document.createElementNS(a,"circle");f.classList.add("los-origin"),f.setAttribute("cx","0"),f.setAttribute("cy","0"),f.setAttribute("r","0"),f.style.visibility="hidden",c.appendChild(f);var g=document.createElementNS(a,"circle");g.classList.add("los-target"),g.setAttribute("cx","0"),g.setAttribute("cy","0"),g.setAttribute("r","0"),g.style.visibility="hidden",c.appendChild(g);var h=document.createElementNS(a,"polygon");return h.classList.add("los-envelope"),h.setAttribute("points","0,0 0,0 0,0"),h.style.visibility="hidden",b.insertBefore(h,b.firstChild),{container:d,line:e,origin:f,target:g,envelope:h}}function f(a,b){b.style.visibility=a.display?"visible":"hidden",b.setAttribute("x1",a.start.x+""),b.setAttribute("y1",a.start.y+""),b.setAttribute("x2",a.end.x+""),b.setAttribute("y2",a.end.y+"")}function g(a,b,c){var d=R.pathOr({},["computed","envelope"],a),e=d.left;e=void 0===e?{}:e;var f=e.start;f=void 0===f?{}:f;var g=f.x,h=void 0===g?0:g,i=f.y,j=void 0===i?0:i,k=e.end;k=void 0===k?{}:k;var l=k.x,m=void 0===l?0:l,n=k.y,o=void 0===n?0:n,p=d.right;p=void 0===p?{}:p;var q=p.start;q=void 0===q?{}:q;var r=q.x,s=void 0===r?0:r,t=q.y,u=void 0===t?0:t,v=p.end;v=void 0===v?{}:v;var w=v.x,x=void 0===w?0:w,y=v.y,z=void 0===y?0:y,A=[[h,j].join(","),[m,o].join(","),[x,z].join(","),[s,u].join(",")].join(" ");c.setAttribute("points",A),c.style.visibility=b?"visible":"hidden"}function h(a,b,e,f,g){R.pipeP(function(a){return R.exists(a)?c.findStamp(a,b):self.Promise.reject()},function(b){return!f||R.isNil(b)?(g.style.visibility="hidden",self.Promise.reject()):R.pipeP(d.getModelInfo$(b.state.info),function(a){g.setAttribute("cx",b.state.x+""),g.setAttribute("cy",b.state.y+""),g.setAttribute("r",a.base_radius+""),g.style.visibility="visible"})(a)})(e)["catch"](R.always(null))}return{restrict:"A",link:function(c,d){var i=document.getElementById("map"),j=document.getElementById("game-under-models"),k=i.namespaceURI,l=c.state,m=e(k,j,d[0]),n=e(k,j,d[0]);c.onStateChangeEvent("Game.los.local.change",function(){f(l.game.los.local,m.line)},c),c.onStateChangeEvent("Game.los.remote.change",function(){f(l.game.los.remote,n.line);var c=b.isDisplayed(l.game.los)||"LoS"===a.currentModeName(l.modes);g(l.game.los,c,n.envelope),h(l.factions,l.game.models,b.origin(l.game.los),c,n.origin),h(l.factions,l.game.models,b.target(l.game.los),c,n.target)},c)}}}]).directive("clickGameLosClip",[function(){function a(a,b){var c=R.pathOr({},["computed","envelope"],a),d=c.left;d=void 0===d?{}:d;var e=d.start;e=void 0===e?{}:e;var f=e.x,g=void 0===f?0:f,h=e.y,i=void 0===h?0:h,j=d.end;j=void 0===j?{}:j;var k=j.x,l=void 0===k?0:k,m=j.y,n=void 0===m?0:m,o=c.right;o=void 0===o?{}:o;var p=o.start;p=void 0===p?{}:p;var q=p.x,r=void 0===q?0:q,s=p.y,t=void 0===s?0:s,u=o.end;u=void 0===u?{}:u;var v=u.x,w=void 0===v?0:v,x=u.y,y=void 0===x?0:x,z=[[g,i].join(","),[l,n].join(","),[w,y].join(","),[r,t].join(",")].join(" ");b.setAttribute("points",z)}return{restrict:"A",link:function(b,c){var d=b.state;b.onStateChangeEvent("Game.loaded",function(){a(d.game.los,c[0])},b),b.onStateChangeEvent("Game.los.remote.change",function(){a(d.game.los,c[0])},b)}}}]).directive("clickGameLosDarkness",["gameLos","modes",function(a,b){function c(c,d,e){var f=R.propOr({},"envelope",c),g=f.left;g=void 0===g?{}:g;var h=g.start;h=void 0===h?{}:h;var i=h.x,j=void 0===i?0:i,k=h.y,l=void 0===k?0:k,m=g.end;m=void 0===m?{}:m;var n=m.x,o=void 0===n?0:n,p=m.y,q=void 0===p?0:p,r=f.right;r=void 0===r?{}:r;var s=r.start;s=void 0===s?{}:s;var t=s.x,u=void 0===t?0:t,v=s.y,w=void 0===v?0:v,x=r.end;x=void 0===x?{}:x;var y=x.x,z=void 0===y?0:y,A=x.y,B=void 0===A?0:A,C=[[j,l].join(","),[o,q].join(","),[z,B].join(","),[u,w].join(",")].join(" ");e.setAttribute("points",C);var D=a.isDisplayed(d.game.los)||"LoS"===b.currentModeName(d.modes);e.style.visibility=D?"visible":"hidden"}return{restrict:"A",link:function(a,b){var d=a.state;c(a,d,b[0]),a.onStateChangeEvent("Game.remote.los.change",function(){c(a,d,d.game.los,b[0])},a)}}}]).directive("clickGameLosRefresh",[function(){return{restrict:"A",scope:!0,link:function(a){a.digestOnStateChangeEvent("Game.los.remote.change",a)}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").directive("clickGameMap",["$window","gameMap","terrain","defaultMode",function(a,b,c,d){function e(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b.sort()}return{restrict:"A",link:function(f,g){function h(a){m.style.width=a+"px",m.style.height=a+"px"}function i(){var a=l.getBoundingClientRect(),b=a.width,c=a.height,d=l.scrollLeft+b/2,e=l.scrollTop+c/2;return[[d,e],[b,c]]}function j(a,b,c,d){l.scrollLeft=a-c/2,l.scrollTop=b-d/2}var k=R.bind(console.log,console),l=document.querySelector("#viewport"),m=g[0],n=f.state,o=function(){function a(){var a=[].concat(_toConsumableArray(document.querySelectorAll("input")),_toConsumableArray(document.querySelectorAll("select")),_toConsumableArray(document.querySelectorAll("textarea")));R.forEach(function(a){a.blur()},a)}function g(c){if(k("mouseDownMap",c,m.getBoundingClientRect()),a(),c.preventDefault(),1===c.which){m.addEventListener("mousemove",h);var d=b.eventToMapCoordinates(m,c);b.findEventTarget(n.game,c).then(function(a){p={active:!1,start:d,target:a,now:null}})}}function h(a){if(k("dragMap",a),a.preventDefault(),1===a.which&&(p.now=b.eventToMapCoordinates(m,a),!(!p.active&&Math.abs(p.now.x-p.start.x)<d.moves().DragEpsilon&&Math.abs(p.now.y-p.start.y)<d.moves().DragEpsilon))){var e=p.active?"drag":"dragStart";p.active=!0,"Terrain"===p.target.type&&c.isLocked(p.target.target)&&(p.target={type:"Map",target:null}),f.stateEvent("Modes.current.action",e+p.target.type,[{target:p.target.target,start:p.start,now:p.now},a])}}function i(a){k("mouseLeaveMap",a),a.preventDefault(),m.removeEventListener("mousemove",h),p.active&&(p.active=!1,f.stateEvent("Modes.current.action","dragEnd"+p.target.type,[{target:p.target.target,start:p.start,now:p.now},a]))}function j(a){if(k("clickMap",a),a.preventDefault(),1===a.which){m.removeEventListener("mousemove",h);var c=b.eventToMapCoordinates(m,a);p.active?(p.active=!1,f.stateEvent("Modes.current.action","dragEnd"+p.target.type,[{target:p.target.target,start:p.start,now:c},a])):b.findEventTarget(n.game,a).then(function(b){var d=R.pipe(R.append("click"+b.type),R.join("+"))(e(a));a["click#"]={target:b.target,x:c.x,y:c.y},n.changeEvent("Game.selectionDetail.close"),n.changeEvent("Game.editLabel.close"),n.changeEvent("Game.editDamage.close"),Mousetrap.trigger(d,void 0,a)})}}function l(a){k("rightClickMap",a),a.preventDefault();var c=b.eventToMapCoordinates(m,a);b.findEventTarget(n.game,a).then(function(b){var d=R.pipe(R.append("rightClick"+b.type),R.join("+"))(e(a));a["click#"]={target:b.target,x:c.x,y:c.y},n.changeEvent("Game.selectionDetail.close"),n.changeEvent("Game.editLabel.close"),n.changeEvent("Game.editDamage.close"),Mousetrap.trigger(d,void 0,a)})}function o(a){k("moveMap",a),a.preventDefault();var c=b.eventToMapCoordinates(m,a);f.stateEvent("Modes.current.action","moveMap",[c,a])}var p={active:!1,start:null,target:null,now:null};return{down:g,drag:h,leave:i,click:j,rightClick:l,move:o}}(),p=function(){function a(){c||(m.addEventListener("mousemove",o.move),c=!0)}function b(){c&&(m.removeEventListener("mousemove",o.move),c=!1)}var c=!1;return{enable:a,disable:b}}(),q=function(){var a=void 0;return n.ui_state=R.assoc("flip_map",!1,R.propOr({},"ui_state",n)),m.classList.remove("flipped"),function(){a=document.querySelector("#deploiement-labels"),n.ui_state.flip_map=!m.classList.contains("flipped"),m.classList.toggle("flipped"),n.ui_state.flip_map?a.setAttribute("transform","rotate(180,240,240)"):a.setAttribute("transform",""),n.changeEvent("Game.map.flipped")}}(),r=function(){function a(){var a=l.getBoundingClientRect(),b=Math.min(a.width,a.height);h(b-15)}function b(){var a=i(),b=_slicedToArray(a,2),c=_slicedToArray(b[0],2),d=c[0],e=c[1],f=_slicedToArray(b[1],2),g=f[0],k=f[1],l=m.getBoundingClientRect();d=g>l.width?l.width/2:d,e=k>l.height?l.height/2:e,h(2*l.width),j(2*d,2*e,g,k)}function c(){var a=i(),b=_slicedToArray(a,2),c=_slicedToArray(b[0],2),d=c[0],e=c[1],f=_slicedToArray(b[1],2),g=f[0],k=f[1],l=Math.min(g,k),n=m.getBoundingClientRect();h(Math.max(l-15,n.width/2)),j(d/2,e/2,g,k)}return{"in":b,out:c,reset:a}}(),s=function(){function b(){var b=l.scrollLeft;a.requestAnimationFrame(function(){l.scrollLeft=b-f})}function c(){var b=l.scrollLeft;a.requestAnimationFrame(function(){l.scrollLeft=b+f})}function d(){var b=l.scrollTop;a.requestAnimationFrame(function(){l.scrollTop=b-f})}function e(){var b=l.scrollTop;a.requestAnimationFrame(function(){l.scrollTop=b+f})}var f=30;return{left:b,right:c,up:d,down:e}}();m.addEventListener("mouseup",o.click),m.addEventListener("mousedown",o.down),m.addEventListener("mouseleave",o.leave),m.addEventListener("dragstart",function(a){a.preventDefault()}),m.addEventListener("contextmenu",o.rightClick),f.onStateChangeEvent("Game.view.flipMap",q,f),f.onStateChangeEvent("Game.moveMap.enable",p.enable,f),f.onStateChangeEvent("Game.moveMap.disable",p.disable,f),f.onStateChangeEvent("Game.view.zoomIn",r["in"],f),f.onStateChangeEvent("Game.view.zoomOut",r.out,f),f.onStateChangeEvent("Game.view.zoomReset",r.reset,f),f.onStateChangeEvent("Game.view.scrollLeft",s.left,f),f.onStateChangeEvent("Game.view.scrollRight",s.right,f),f.onStateChangeEvent("Game.view.scrollUp",s.up,f),f.onStateChangeEvent("Game.view.scrollDown",s.down,f),a.requestAnimationFrame(r.reset)}}}]),angular.module("clickApp.directives").directive("clickGameModel",["gameMap","gameFactions","gameModels","gameModelSelection","gameScenario","model","labelElement","clickGameModelArea","clickGameModelAura","clickGameModelBase","clickGameModelCharge","clickGameModelCounter","clickGameModelDamage","clickGameModelIcon","clickGameModelLoS","clickGameModelMelee",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b,c,d,e){var f=r(b,c,d);e.$on("$destroy",s(f)),e.onStateChangeEvent("Game.map.flipped",u(b,e,f),e);var g=x(a,b,e,f);e.onStateChangeEvent("Game.model.change."+c.state.stamp,g,e),g(),e.onStateChangeEvent("Game.model.selection.local.updateSingle",v(a.factions,c,f),e),e.onStateChangeEvent("Game.template.selection.local.updateSingle",w(a.factions,c,f),e);var h=t(e,function(c){A(a,b,c,e,f)});e.onStateChangeEvent("Game.scenario.refresh",h,e),e.onStateChangeEvent("Game.scenario.change",h,e)}function r(a,b,c){var d=document.getElementById("map"),e=document.getElementById("game-under-models"),f=document.getElementById("game-over-models"),q=d.namespaceURI,r=i.create(q,c),s=p.create(q,c),t=j.create(q,a,b,c),u=m.create(q,a,c),v=o.create(q,a,c),w=g.create(q,f),x=l.create(q,f,c),y=g.create(q,c),z=n.create(q,c),A=h.create(q,c),B=k.create(q,e,f,c);return{container:c,aura:r,base:t,damage:u,los:v,label:w,counter:x,unit:y,icon:z,area:A,melee:s,charge:B}}function s(a){return function(){var b=document.getElementById("game-under-models"),c=document.getElementById("game-over-models");c.removeChild(a.label.label),l.cleanup(b,c,a.counter),k.cleanup(b,c,a.charge)}}function t(a,b){return function(){R.pipeP(function(){return c.findStamp(a.model.state.stamp,a.state.game.models)},b)()}}function u(a,b,c){return t(b,function(b){var d=document.getElementById("map"),e=C(a,b);g.updateOnFlipMap(d,e.flip,c.label),g.updateOnFlipMap(d,b.state,c.counter[0]),(f.isCharging(b)||f.isPlacing(b))&&g.updateOnFlipMap(d,b.state.cha.s,c.charge[2])})}function v(a,b,c){return function(d,e,g){return R.isNil(g)||e===b.state.stamp?(c.container.classList.remove("overlap"),void c.container.classList.remove("b2b")):void R.pipeP(f.distanceTo$(a,g),function(a){return-.1>a?(c.container.classList.add("overlap"),void c.container.classList.remove("b2b")):.1>a?(c.container.classList.remove("overlap"),void c.container.classList.add("b2b")):(c.container.classList.remove("overlap"),void c.container.classList.remove("b2b"))})(b)}}function w(a,b,c){return function(d,e,g){return R.isNil(g)?void c.container.classList.remove("under-aoe"):void R.pipeP(f.distanceToAoE$(a,g),function(a){0>=a?c.container.classList.add("under-aoe"):c.container.classList.remove("under-aoe")})(b)}}function x(b,c,d,e){return t(d,function(o){var q=document.getElementById("map"),r=a.isFlipped(q),s=a.zoomFactor(q),t=f.isWreckDisplayed(o);(t?f.getWreckImage(b.factions,o):f.getImage(b.factions,o)).then(function(a){var q=f.fullLabel(o),t=C(c,o);y(a,o,e),z(b.game.model_selection,o,e),A(b,c,o,d,e),i.update(c,o,a,e.aura),j.update(c,o,a,e.base),m.update(c,o,a,e.damage),g.update(r,s,t.flip,t.text,q,e.label),l.update(r,s,c,o,a,e.counter),B(r,s,a,c,o,e),n.update(c,o,a,e.icon),h.update(b.factions,c,o,a,e.area),p.update(c,o,a,e.melee),k.update(r,s,b,c,o,a,e.charge)})})}function y(a,b,c){c.container.setAttribute("transform",["translate(",b.state.x-a.width/2,",",b.state.y-a.height/2,") rotate(",b.state.r,",",a.width/2,",",a.height/2,")"].join(""))}function z(a,b,c){var e=c.container,f=b.state.stamp;d["in"]("local",f,a)?e.classList.add("local-selection"):e.classList.remove("local-selection"),d["in"]("remote",f,a)?e.classList.add("remote-selection"):e.classList.remove("remote-selection"),d.inSingle("local",f,a)?(e.classList.add("single-local"),e.classList.remove("single-remote")):d.inSingle("remote",f,a)?(e.classList.remove("single-local"),e.classList.add("single-remote")):(e.classList.remove("single-local"),e.classList.remove("single-remote"))}function A(a,b,c,d,f){var g=R.pipe(R.pick(["x","y"]),R.assoc("radius",b.base_radius))(c.state);d.stateIs("game.setup")&&R.exists(a.game.scenario)&&e.isContesting(g,a.game.scenario)?f.container.classList.add("contesting"):f.container.classList.remove("contesting"),d.stateIs("game.setup")&&R.exists(a.game.scenario)&&"wardude"===b.type&&e.isKillboxing(g,a.game.scenario)?f.container.classList.add("killboxing"):f.container.classList.remove("killboxing")}function B(a,b,c,d,e,h){var i=f.unit(e);i=R.exists(i)?i:"";var j=f.isUnitDisplayed(e)?i+"":"";j=R.length(j)>0?"U"+j:j;var k=D(c,d,e);g.update(a,b,k.flip,k.text,j,h.unit)}function C(a,b){var c=b.state.y+a.base_radius+6,d=b.state.y-a.base_radius-2,e=(b.state.r%360+360)%360,f=e>90&&270>e,g={x:b.state.x,y:f?c:d},h={x:g.x,y:g.y-2};return{text:g,flip:h}}function D(a,b){var c={x:a.width/2,y:a.height/2},d={x:c.x-.7*b.base_radius-5,y:c.y-.7*b.base_radius-5};return{text:d,flip:c}}var E={restrict:"A",link:function(a,c){var d=a.state;b.getModelInfo(a.model.state.info,d.factions)["catch"](function(a){return self.Promise.reject(a)}).then(function(b){return q(d,b,a.model,c[0],a)})}};return E}]).directive("clickGameModelsList",[function(){return{restrict:"A",templateUrl:"partials/game/models_list.html",scope:!0,link:function(a,b){a.type=b[0].getAttribute("click-game-models-list"),a.digestOnStateChangeEvent("Game.model.create",a)}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelArea",["model",function(a){return{create:function(a,b){var c=document.createElementNS(a,"circle");c.classList.add("model-ctrl-area"),c.setAttribute("cx","0"),c.setAttribute("cy","0"),c.setAttribute("r","0"),c.style.visibility="hidden",b.appendChild(c);var d=document.createElementNS(a,"circle");return d.classList.add("model-area"),d.setAttribute("cx","0"),d.setAttribute("cy","0"),d.setAttribute("r","0"),d.style.visibility="hidden",b.appendChild(d),[d,c]},update:function(b,c,d,e,f){var g=_slicedToArray(f,2),h=g[0],i=g[1];i.setAttribute("cx",e.width/2+""),i.setAttribute("cy",e.height/2+""),a.isCtrlAreaDisplayed(b,d).then(function(a){if(a){var b=20*(c.focus||c.fury)+c.base_radius;i.setAttribute("r",b+""),i.style.visibility="visible"}else i.style.visibility="hidden"}),h.setAttribute("cx",e.width/2+""),h.setAttribute("cy",e.height/2+""),a.isAreaDisplayed(d)?(h.setAttribute("r",10*d.state.are+c.base_radius+""),h.style.visibility="visible"):h.style.visibility="hidden"}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelAura",["model",function(a){return{create:function(a,b){var c=document.createElementNS(a,"circle");c.classList.add("color-aura"),c.style.filter="url(#aura-filter)",c.style.visibility="hidden",b.appendChild(c);var d=document.createElementNS(a,"circle");return d.classList.add("state-aura"),d.style.filter="url(#state-aura-filter)",b.appendChild(d),[c,d]},update:function(b,c,d,e){var f=_slicedToArray(e,2),g=f[0],h=f[1];h.setAttribute("cx",d.width/2+""),h.setAttribute("cy",d.height/2+""),h.setAttribute("r",1.2*b.base_radius+""),g.setAttribute("cx",d.width/2+""),g.setAttribute("cy",d.height/2+""),g.setAttribute("r",1.2*b.base_radius+""),a.isAuraDisplayed(c)?(g.style.fill=c.state.aur,g.style.visibility="visible"):g.style.visibility="hidden"}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelBase",["model",function(a){return{create:function(b,c,d,e){var f=document.createElementNS(b,"circle");f.classList.add("model-base"),f.setAttribute("cx",c.img[0].width/2+""),f.setAttribute("cy",c.img[0].height/2+""),f.setAttribute("r",c.base_radius),f.setAttribute("style",["fill:",c.base_color,";"].join("")),f.setAttribute("data-stamp",d.state.stamp),e.appendChild(f);var g=document.createElementNS(b,"title");f.appendChild(g),g.innerHTML=a.descriptionFromInfo(c,d);var h=document.createElementNS(b,"line");h.classList.add("model-los"),h.setAttribute("x1",c.img[0].width/2+""),h.setAttribute("y1",c.img[0].height/2+""),h.setAttribute("x2",c.img[0].width/2+""),h.setAttribute("y2",c.img[0].height/2-c.base_radius+""),e.appendChild(h);var i=document.createElementNS(b,"line");i.classList.add("model-los"),i.setAttribute("x1",c.img[0].width/2-c.base_radius+""),i.setAttribute("y1",c.img[0].height/2+""),i.setAttribute("x2",c.img[0].width/2+c.base_radius+""),i.setAttribute("y2",c.img[0].height/2+""),e.appendChild(i);var j=document.createElementNS(b,"image");j.classList.add("model-image"),j.setAttribute("x","0"),j.setAttribute("y","0"),e.appendChild(j);var k=document.createElementNS(b,"circle");return k.classList.add("model-edge"),k.setAttribute("cx",c.img[0].width/2+""),k.setAttribute("cy",c.img[0].height/2+""),k.setAttribute("r",c.base_radius),e.appendChild(k),[f,h,i,j,k]},update:function(a,b,c,d){var e=_slicedToArray(d,5),f=(e[0],e[1],e[2],e[3]);e[4];f.setAttribute("width",c.width+""),f.setAttribute("height",c.height+""),R.exists(c.link)?(f.setAttributeNS("http://www.w3.org/1999/xlink","href",c.link),f.style.visibility="visible"):f.style.visibility="hidden"}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelCharge",["labelElement","model","point","gameFactions","gameModels","gameModelSelection",function(a,b,c,d,e,f){return{create:function(b,c,d){var e=document.createElementNS(b,"rect");e.style.visibility="hidden",e.classList.add("model-charge-path"),c.appendChild(e);var f=document.createElementNS(b,"circle");f.style.visibility="hidden",f.classList.add("model-charge-target"),d.appendChild(f);var g=a.create(b,d);return[e,f,g]},cleanup:function(a,b,c){var d=_slicedToArray(c,3),e=d[0],f=d[1],g=d[2];b.removeChild(g.label),b.removeChild(f),a.removeChild(e)},update:function(g,h,i,j,k,l,m){var n=_slicedToArray(m,3),o=n[0],p=n[1],q=n[2];if(!b.isCharging(k)&&!b.isPlacing(k))return o.style.visibility="hidden",p.style.visibility="hidden",void a.update(g,h,k.state,k.state,"",q);var r=void 0;if(b.isCharging(k)){var s=c.distanceTo(k.state,k.state.cha.s),t=k.state.cha.s.r,u=c.translateInDirection(400,t,k.state.cha.s);o.setAttribute("width",2*j.base_radius+""),o.setAttribute("height","800"),o.setAttribute("x",u.x-j.base_radius+""),o.setAttribute("y",u.y-400+""),o.setAttribute("transform",["rotate(",t,",",u.x,",",u.y,")"].join("")),o.style.visibility="visible";var v=Math.round(10*s)/100+'"';r=b.chargeMaxLength(k),R.exists(r)&&(v+="/"+r+'"'),a.update(g,h,k.state.cha.s,k.state.cha.s,v,q),f["in"]("local",k.state.stamp,i.game.model_selection)&&R.exists(k.state.cha.t)&&R.pipeP(e.findStamp$(k.state.cha.t),function(a){p.setAttribute("cx",a.state.x+""),p.setAttribute("cy",a.state.y+"");var e=0;b.isMeleeDisplayed("mm",k)&&(e=5),b.isMeleeDisplayed("mr",k)&&(e=20),b.isMeleeDisplayed("ms",k)&&(e=40);var f=c.distanceTo(a.state,k.state);return R.pipeP(d.getModelInfo$(a.state.info),function(a){p.setAttribute("r",a.base_radius+""),f<=e+j.base_radius+a.base_radius?p.classList.add("reached"):p.classList.remove("reached"),
p.style.visibility="visible"})(i.factions)})(i.game.models)}if(b.isPlacing(k)){var w=c.distanceTo(k.state,k.state.pla.s),x=k.state.pla.s.r,y=c.translateInDirection(400,x,k.state.pla.s);o.setAttribute("width",2*j.base_radius+""),o.setAttribute("height","800"),o.setAttribute("x",y.x-j.base_radius+""),o.setAttribute("y",y.y-400+""),o.setAttribute("transform",["rotate(",x,",",y.x,",",y.y,")"].join("")),o.style.visibility="visible";var z=Math.round(10*w)/100+'"',A=b.placeWithin(k);r=b.placeMaxLength(k),R.exists(r)&&(z+="/"+(A?"w.":"")+r+'"'),a.update(g,h,k.state.pla.s,k.state.pla.s,z,q)}p.style.visibility="hidden"}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelCounter",["labelElement","model",function(a,b){function c(a){var b={x:a.state.x,y:a.state.y},c={x:b.x,y:b.y+4};return{text:c,flip:b}}function d(a,b){var c={x:a.width/2,y:a.height/2},d={x:c.x+.8*b.base_radius+5,y:c.y-b.base_radius-5};return{text:d,flip:c}}return{create:function(b,c,d){var e=a.create(b,c);e.label.classList.add("counter"),e.bckgnd.setAttribute("height","9");var f=document.createElementNS(b,"image");f.classList.add("model-image"),f.setAttribute("x","0"),f.setAttribute("y","0"),f.setAttribute("width","20"),f.setAttribute("height","20"),f.setAttributeNS("http://www.w3.org/1999/xlink","href","/data/icons/Soul.png"),d.appendChild(f);var g=a.create(b,d);return[e,f,g]},cleanup:function(a,b,c){var d=_slicedToArray(c,3),e=d[0];d[1],d[2];b.removeChild(e.label)},update:function(e,f,g,h,i,j){var k=_slicedToArray(j,3),l=k[0],m=k[1],n=k[2],o=b.isCounterDisplayed("c",h)?h.state.c:"",p=c(h);a.update(e,f,p.flip,p.text,o,l);var q=b.isCounterDisplayed("s",h)?h.state.s+"":"",r=R.length(q)>0?"visible":"hidden",s=d(i,g,h);m.setAttribute("x",s.text.x-10+""),m.setAttribute("y",s.text.y-10+""),m.style.visibility=r,a.update(e,f,s.flip,s.text,q,n)}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelDamage",["model",function(a){return{create:function(a,b,c){var d=void 0,e=void 0;("warrior"!==b.damage.type||1!==b.damage.n)&&(d=document.createElementNS(a,"line"),d.classList.add("model-damage-bar"),d.setAttribute("x1",b.img[0].width/2-b.base_radius+""),d.setAttribute("y1",b.img[0].height/2+b.base_radius+2+""),d.setAttribute("x2",b.img[0].width/2+b.base_radius+""),d.setAttribute("y2",b.img[0].height/2+b.base_radius+2+""),d.style.stroke="#F00",c.appendChild(d),e=document.createElementNS(a,"line"),e.classList.add("model-damage-bar"),e.setAttribute("x1",b.img[0].width/2-b.base_radius+""),e.setAttribute("y1",b.img[0].height/2+b.base_radius+2+""),e.setAttribute("x2",b.img[0].width/2+b.base_radius+""),e.setAttribute("y2",b.img[0].height/2+b.base_radius+2+""),e.style.stroke="#0F0",c.appendChild(e));var f=void 0,g=void 0;return R.exists(b.damage.field)&&(f=document.createElementNS(a,"line"),f.classList.add("model-damage-bar"),f.setAttribute("x1",b.img[0].width/2-b.base_radius+""),f.setAttribute("y1",b.img[0].height/2+b.base_radius+2+""),f.setAttribute("x2",b.img[0].width/2+b.base_radius+""),f.setAttribute("y2",b.img[0].height/2+b.base_radius+2+""),f.style.stroke="#066",c.appendChild(f),g=document.createElementNS(a,"line"),g.classList.add("model-damage-bar"),g.setAttribute("x1",b.img[0].width/2-b.base_radius+""),g.setAttribute("y1",b.img[0].height/2+b.base_radius+2+""),g.setAttribute("x2",b.img[0].width/2+b.base_radius+""),g.setAttribute("y2",b.img[0].height/2+b.base_radius+2+""),g.style.stroke="#0FF",c.appendChild(g)),[d,e,f,g]},update:function(b,c,d,e){var f=_slicedToArray(e,4),g=f[0],h=f[1],i=f[2],j=f[3];if(!R.isNil(g)){if("none"===b.damage.type||a.isWreckDisplayed(c)){if(g.style.visibility="hidden",h.style.visibility="hidden",R.isNil(i))return;return i.style.visibility="hidden",void(j.style.visibility="hidden")}var k=d.width/2+b.base_radius,l=d.width/2-b.base_radius,m=d.height/2+b.base_radius+1,n=c.state.dmg.t/b.damage.total,o=(l-k)*(1-n)+k;if(g.setAttribute("x1",l+""),g.setAttribute("y1",m+""),g.setAttribute("x2",k+""),g.setAttribute("y2",m+""),g.style.visibility="visible",h.setAttribute("x1",o+""),h.setAttribute("y1",m+""),h.setAttribute("x2",k+""),h.setAttribute("y2",m+""),h.style.visibility="visible",!R.isNil(i)){var p=c.state.dmg.f/b.damage.field,q=(l-k)*(1-p)+k;i.setAttribute("x1",l+""),i.setAttribute("y1",m+1+""),i.setAttribute("x2",k+""),i.setAttribute("y2",m+1+""),i.style.visibility="visible",j.setAttribute("x1",q+""),j.setAttribute("y1",m+1+""),j.setAttribute("x2",k+""),j.setAttribute("y2",m+1+""),j.style.visibility="visible"}}}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelIcon",["model",function(a){var b=[["b","/data/icons/Blind.png"],["c","/data/icons/Corrosion.png"],["d","/data/icons/BoltBlue.png"],["f","/data/icons/Fire.png"],["e","/data/icons/BoltYellow.png"],["k","/data/icons/KD.png"],["t","/data/icons/Stationary.png"]];return{create:function(a,c){var d=R.reduce(function(b,d){var e=document.createElementNS(a,"image");return e.classList.add("model-image"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","10"),e.setAttribute("height","10"),e.setAttributeNS("http://www.w3.org/1999/xlink","href",d[1]),e.style.visibility="hidden",c.appendChild(e),R.assoc(d[0],e,b)},{},b),e=document.createElementNS(a,"image");e.classList.add("model-image"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","10"),e.setAttribute("height","10"),e.setAttributeNS("http://www.w3.org/1999/xlink","href","/data/icons/Leader.png"),c.appendChild(e);var f=document.createElementNS(a,"image");return f.classList.add("model-image"),f.setAttribute("x","0"),f.setAttribute("y","0"),f.setAttribute("width","10"),f.setAttribute("height","10"),f.setAttributeNS("http://www.w3.org/1999/xlink","href","/data/icons/Lock.png"),f.style.visibility="visible",c.appendChild(f),[d,e,f]},update:function(b,c,d,e){var f=_slicedToArray(e,3),g=f[0],h=f[1],i=f[2];return R.pipe(R.keys,R.filter(function(b){return a.isEffectDisplayed(b,c)}),function(a){var c=d.width/2-10*R.length(a)/2,e=d.height/2+b.base_radius+1;R.addIndex(R.forEach)(function(a,b){g[a].setAttribute("x",c+10*b+""),g[a].setAttribute("y",e+""),g[a].style.visibility="visible"},a)})(g),R.pipe(R.keys,R.reject(function(b){return a.isEffectDisplayed(b,c)}),R.forEach(function(a){g[a].style.visibility="hidden"}))(g),h.setAttribute("x",d.width/2-.7*b.base_radius-5+""),h.setAttribute("y",d.height/2-.7*b.base_radius-5+""),a.isLeaderDisplayed(c)?h.style.visibility="visible":h.style.visibility="hidden",a.isLocked(c)?(i.setAttribute("x",d.width/2+b.base_radius-5+""),i.setAttribute("y",d.height/2-5+""),void(i.style.visibility="visible")):void(i.style.visibility="hidden")}}}]),angular.module("clickApp.directives").factory("clickGameModelLoS",[function(){return{create:function(a,b,c){var d=document.createElementNS(a,"line");d.classList.add("model-los-selection"),d.setAttribute("x1",b.img[0].width/2+""),d.setAttribute("y1",b.img[0].height/2+""),d.setAttribute("x2",b.img[0].width/2+""),d.setAttribute("y2",b.img[0].height/2-700+""),c.appendChild(d);var e=document.createElementNS(a,"line");return e.classList.add("model-los-selection"),e.setAttribute("x1",b.img[0].width/2-700+""),e.setAttribute("y1",b.img[0].height/2+""),e.setAttribute("x2",b.img[0].width/2+700+""),e.setAttribute("y2",b.img[0].height/2+""),c.appendChild(e),[d,e]},update:function(){}}}]);var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();angular.module("clickApp.directives").factory("clickGameModelMelee",["model",function(a){function b(a,b,c){return["M",b.width/2-c.base_radius-a,",",b.height/2," ","L",b.width/2+c.base_radius+a,",",b.height/2," ","A",c.base_radius+a,",",c.base_radius+a," 0 0,0 ",b.width/2-c.base_radius-a,",",b.height/2," ","M",b.width/2,",",b.height/2," ","L",b.width/2,",",b.height/2-c.base_radius-a," "].join("")}return{create:function(a,b){var c=document.createElementNS(a,"path");c.classList.add("model-melee"),c.setAttribute("d",""),b.appendChild(c);var d=document.createElementNS(a,"path");d.classList.add("model-melee"),d.setAttribute("d",""),b.appendChild(d);var e=document.createElementNS(a,"path");return e.classList.add("model-melee"),e.setAttribute("d",""),b.appendChild(e),[c,d,e]},update:function(c,d,e,f){var g=_slicedToArray(f,3),h=g[0],i=g[1],j=g[2],k=void 0;a.isMeleeDisplayed("mm",d)?(k=b(5,e,c),h.setAttribute("d",k),h.style.visibility="visible"):h.style.visibility="hidden",a.isMeleeDisplayed("mr",d)?(k=b(20,e,c),i.setAttribute("d",k),i.style.visibility="visible"):i.style.visibility="hidden",a.isMeleeDisplayed("ms",d)?(k=b(40,e,c),j.setAttribute("d",k),j.style.visibility="visible"):j.style.visibility="hidden"}}}]),angular.module("clickApp.directives").controller("clickGameModelDamageCtrl",["$scope",function(a){var b=a.$parent.state;a.range=function(a){return R.range(0,a)},a.warriorBoxClass=function(b){return a.state&&a.state.dmg.n>b?"mark":""},a.fieldBoxClass=function(b,c){return a.state&&a.state.dmg.f>c*a.info.field/2+b?"mark":""},a.gridBoxClass=function(b,c){return a.info[b][c]?a.state&&1===a.state.dmg[b][c]?"mark":"":"none"},a.doResetDamage=function(){R.isNil(a.state)||a.stateEvent("Game.command.execute","onModels",["resetDamage",[][a.state.stamp]]).then(function(){a.$digest()})},a.doWarriorDamage=function(c){R.isNil(a.state)||a.stateEvent("Game.command.execute","onModels",["setWarriorDamage",[b.factions,c],[a.state.stamp]]).then(function(){a.$digest()})},a.doFieldDamage=function(c){R.isNil(a.state)||a.stateEvent("Game.command.execute","onModels",["setFieldDamage",[b.factions,c],[a.state.stamp]]).then(function(){a.$digest()})},a.doGridDamage=function(c,d){R.isNil(a.state)||R.isNil(a.info[d][c])||a.stateEvent("Game.command.execute","onModels",["setGridDamage",[b.factions,c,d],[a.state.stamp]]).then(function(){a.$digest()})},a.doGridColDamage=function(c){R.isNil(a.state)||a.stateEvent("Game.command.execute","onModels",["setGridColDamage",[b.factions,c],[a.state.stamp]]).then(function(){a.$digest()})}}]).directive("clickGameModelDamage",[function(){return{restrict:"E",scope:{info:"=",state:"=",onError:"&"},controller:"clickGameModelDamageCtrl",templateUrl:"partials/game/model_damage.html",link:function(a){}}}]),angular.module("clickApp.directives").directive("clickGameRuler",["gameMap","labelElement","gameRuler","gameModels","gameFactions","modes",function(a,b,c,d,e,f){function g(a,c){var d=document.createElementNS(a,"g");c.appendChild(d);var e=document.createElementNS(a,"line");e.style["marker-start"]="url(#ruler-start)",e.style["marker-end"]="url(#ruler-end)",d.appendChild(e);var f=b.create(a,d),g=document.createElementNS(a,"circle");g.classList.add("ruler-origin"),g.setAttribute("cx","0"),g.setAttribute("cy","0"),g.setAttribute("r","0"),g.style.visibility="hidden",c.appendChild(g);var h=document.createElementNS(a,"circle");return h.classList.add("ruler-target"),h.setAttribute("cx","0"),h.setAttribute("cy","0"),h.setAttribute("r","0"),h.style.visibility="hidden",c.appendChild(h),{container:d,line:e,label:f,origin:g,target:h}}function h(c,d,e){var f=a.isFlipped(c),g=a.zoomFactor(c),h={x:(d.end.x-d.start.x)/2+d.start.x,y:(d.end.y-d.start.y)/2+d.start.y},i=d.display?d.length:"";j(d.display,d,e.line),b.update(f,g,h,h,i,e.label)}function i(a,c,d){var e={x:(c.end.x-c.start.x)/2+c.start.x,y:(c.end.y-c.start.y)/2+c.start.y};b.updateOnFlipMap(a,e,d.label)}function j(a,b,c){c.style.visibility=a?"visible":"hidden",c.setAttribute("x1",b.start.x+""),c.setAttribute("y1",b.start.y+""),c.setAttribute("x2",b.end.x+""),c.setAttribute("y2",b.end.y+"")}function k(a,b,f,g,h){var i=c.origin(f);R.pipeP(function(a){return R.isNil(a)?self.Promise.reject():d.findStamp(a,b)},function(b){return!g||R.isNil(b)?(h.style.visibility="hidden",self.Promise.reject()):R.pipeP(e.getModelInfo$(b.state.info),function(a){h.setAttribute("cx",b.state.x+""),h.setAttribute("cy",b.state.y+""),h.setAttribute("r",a.base_radius+""),h.style.visibility="visible"})(a)})(i)["catch"](R.always(null))}function l(a,b,f,g,h){var i=c.target(f);R.pipeP(function(a){return R.isNil(a)?self.Promise.reject():d.findStamp(a,b)},function(b){return!g||R.isNil(b)?(h.style.visibility="hidden",self.Promise.reject()):(c.targetReached(f)?h.classList.add("reached"):h.classList.remove("reached"),R.pipeP(e.getModelInfo$(b.state.info),function(a){h.setAttribute("cx",b.state.x+""),h.setAttribute("cy",b.state.y+""),h.setAttribute("r",a.base_radius+""),h.style.visibility="visible"})(a))})(i)["catch"](R.always(null))}return{restrict:"A",link:function(a,b){var d=document.getElementById("map"),e=d.namespaceURI,j=a.state,m=g(e,b[0]),n=g(e,b[0]);a.onStateChangeEvent("Game.ruler.local.change",function(){h(d,j.game.ruler.local,m)},a),a.onStateChangeEvent("Game.ruler.remote.change",function(){h(d,j.game.ruler.remote,n);var a=c.isDisplayed(j.game.ruler)||"Ruler"===f.currentModeName(j.modes);k(j.factions,j.game.models,j.game.ruler,a,n.origin),l(j.factions,j.game.models,j.game.ruler,a,n.target)},a),a.onStateChangeEvent("Game.map.flipped",function(){i(d,j.game.ruler.local,m),i(d,j.game.ruler.remote,n)},a)}}}]),angular.module("clickApp.directives").directive("clickGamePage",["$window",function(a){return{restrict:"A",link:function(b,c){var d=function(){var b=void 0;return function(){var d=c[0].querySelector("#gameview"),e=c[0].querySelector("#menu"),f=c[0].querySelector("#dice-osd"),g=c[0].querySelector("#chat-osd"),h=e.classList.contains("hidden");if(h)d.style.width=b+"px";else{var i=d.getBoundingClientRect();b=i.width,d.style.width=a.innerWidth+"px"}d.classList.toggle("resizable"),e.classList.toggle("hidden"),f.classList.toggle("show"),g.classList.toggle("show")}}();c[0].querySelector("#menu-toggle").addEventListener("click",d),b.onStateChangeEvent("Game.toggleMenu",d,b);var e=c[0].querySelector("#gameview"),f=e.getBoundingClientRect();e.style.width=f.height+"px"}}}]),angular.module("clickApp.directives").controller("clickGameSelectionDetailCtrl",["$scope","game","gameFactions",function(a,b,c){var d=a.state;a.edit={label:"",max_deviation:0};var e={template:function(){a.edit.max_deviation=R.pathOr(0,["state","m"],a.selection)},model:function(){c.getModelInfo(a.selection.state.info,d.factions).then(function(b){a.info=b,a.$digest()})}};a.show={info:!1},a.updateOnOpen=function(){a.show.info=!1,e[a.type]()},a.labelDisplay=function(a){return s.truncate(a,12)},a.doSetMaxDeviation=function(){var b=a.edit.max_deviation>0?a.edit.max_deviation:null;a.stateEvent("Game.command.execute","onTemplates",["setMaxDeviation",[b],[a.selection.state.stamp]])},a.doAddLabel=function(){var b="template"===a.type?"onTemplates":"onModels",c=s.trim(a.edit.label);0!==R.length(c)&&(a.stateEvent("Game.command.execute",b,["addLabel",[c],[a.selection.state.stamp]]).then(function(){a.$digest()}),a.edit.label="")},a.doRemoveLabel=function(b){var c="template"===a.type?"onTemplates":"onModels";a.stateEvent("Game.command.execute",c,["removeLabel",[b],[a.selection.state.stamp]]).then(function(){a.$digest()})}}]).directive("clickGameSelectionDetail",["$window","game","gameMap",function(a,b,c){return{restrict:"A",scope:!0,controller:"clickGameSelectionDetailCtrl",link:function(b,d){function e(c,d,e){b.type=d,b.selection=e,b.edit={label:"",max_deviation:0},b.updateOnOpen(),a.requestAnimationFrame(g)}function f(){b.selection={},d[0].style.display="none",d[0].style.visibility="hidden",d[0].style.left="0px",d[0].style.top="0px"}function g(){b.$digest(),d[0].style.display="initial",d[0].style.visibility="hidden",a.requestAnimationFrame(h)}function h(){i(),d[0].style.visibility="visible"}function i(){var a=d[0].getBoundingClientRect(),e=c.mapToScreenCoordinates(q,b.selection.state),f=p.getBoundingClientRect();j(f,a,e)?d[0].style.left=k(a,e):d[0].style.left=l(a,e),m(f,a,e)?d[0].style.top=n(a,e):d[0].style.top=o(a,e)}function j(a,b,c){return c.x+b.width<=a.right}function k(a,b){return b.x+"px"}function l(a,b){return Math.max(0,b.x-a.width)+"px"}function m(a,b,c){return c.y+b.height<=a.bottom}function n(a,b){return b.y+"px"}function o(a,b){return Math.max(0,b.y-a.height)+"px"}var p=document.getElementById("viewport"),q=document.getElementById("map");b.type="model",f(),b.onStateChangeEvent("Game.selectionDetail.open",e,b),b.onStateChangeEvent("Game.selectionDetail.close",f,b),b.doClose=f}}}]),angular.module("clickApp.directives").directive("clickGameTemplate",["labelElement","aoeTemplateElement","sprayTemplateElement","wallTemplateElement","gameTemplates",function(a,b,c,d,e){var f={aoe:b,spray:c,wall:d};return{restrict:"A",link:function(b,c){function d(){R.pipePromise(function(){return e.findStamp(i.state.stamp,b.state.game.templates)},function(a){f[a.state.type].update(g,b.state,a,j)})()}var g=document.getElementById("map"),h=g.namespaceURI,i=b.template;if(!R.isNil(i)){var j=f[i.state.type].create(h,c[0],i);j.container=c[0],b.onStateChangeEvent("Game.map.flipped",function(){a.updateOnFlipMap(g,i.state,j.label)},b),d(),b.onStateChangeEvent("Game.template.change."+i.state.stamp,d,b)}}}}]).directive("clickGameTemplatesList",[function(){return{restrict:"A",templateUrl:"partials/game/templates_list.html",scope:!0,link:function(a,b){a.type=b[0].getAttribute("click-game-templates-list"),a.digestOnStateChangeEvent("Game.template.create",a)}}}]),angular.module("clickApp.directives").factory("aoeTemplateElement",["template","gameTemplateSelection","gameMap","labelElement",function(a,b,c,d){function e(a,b){b.setAttribute("cx",a.state.x+""),b.setAttribute("cy",a.state.y+""),b.setAttribute("r",a.state.s+"")}function f(a,b){b.setAttribute("x1",a.state.x+""),b.setAttribute("y1",a.state.y+""),b.setAttribute("x2",a.state.x+""),b.setAttribute("y2",a.state.y-a.state.s+""),b.setAttribute("transform","rotate("+a.state.r+","+a.state.x+","+a.state.y+")")}var g={create:function(a,b,c){var e=document.createElementNS(a,"circle");e.classList.add("template"),e.classList.add("aoe"),e.setAttribute("data-stamp",c.state.stamp),b.appendChild(e);var f=document.createElementNS(a,"line");f.classList.add("template-aoe-direction"),f.style["marker-end"]="url(#aoe-direction-end)",b.appendChild(f);var g=d.create(a,b);return{aoe:e,dir:f,label:g}},update:function(g,h,i,j){var k=h.game.template_selection,l=b["in"]("local",i.state.stamp,k),m=b["in"]("remote",i.state.stamp,k),n=l||m,o=c.isFlipped(g),p=c.zoomFactor(g),q=i.state,r={x:i.state.x,y:i.state.y+i.state.s+5},s=a.fullLabel(i);n?j.container.classList.add("selection"):j.container.classList.remove("selection"),l?j.container.classList.add("local"):j.container.classList.remove("local"),m?j.container.classList.add("remote"):j.container.classList.remove("remote"),e(i,j.aoe),f(i,j.dir),d.update(o,p,q,r,s,j.label)}};return g}]),angular.module("clickApp.directives").factory("sprayTemplateElement",["template","sprayTemplate","gameTemplateSelection","gameModels","gameFactions","gameMap","labelElement",function(a,b,c,d,e,f,g){function h(a,b){b.setAttribute("transform",["rotate(",a.state.r,",",a.state.x,",",a.state.y,")"].join(""))}function i(a,b,c){c.setAttribute("transform",["translate(",b.state.x-10,",",b.state.y,")"].join("")),c.setAttribute("points",k[b.state.s+""]),c.style.stroke=a}function j(a,b,c,d){return!b||R.isNil(c)?void(d.style.visibility="hidden"):void R.pipeP(e.getModelInfo$(c.state.info),function(a){d.setAttribute("cx",c.state.x+""),d.setAttribute("cy",c.state.y+""),d.setAttribute("r",a.base_radius+""),d.style.visibility="visible"})(a)}var k={6:"8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0",8:"8.75,0 3.5,-78.672 10,-80 16.5,-78.672 11.25,0",10:"8.75,0 1.875,-98.34 10,-100 18.125,-98.34 11.25,0"},l={create:function(a,b,c){var d=document.getElementById("game-over-models"),e=document.createElementNS(a,"g");b.appendChild(e);var f=document.createElementNS(a,"polygon");f.classList.add("template"),f.classList.add("spray"),f.setAttribute("data-stamp",c.state.stamp),e.appendChild(f);var h=g.create(a,e),i=document.createElementNS(a,"circle");return i.classList.add("spray-origin"),i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","0"),i.style.visibility="hidden",d.appendChild(i),{container:e,spray:f,label:h,origin:i}},update:function(e,k,l,m){var n=k.game.template_selection,o=c["in"]("local",l.state.stamp,n),p=c["in"]("remote",l.state.stamp,n),q=o||p,r=q?o?"#0F0":"#FFF":"#C60",s=f.isFlipped(e),t=f.zoomFactor(e),u=l.state,v={x:l.state.x,y:l.state.y+5},w=a.fullLabel(l);h(l,m.container),i(r,l,m.spray),g.update(s,t,u,v,w,m.label),R.pipePromise(b.origin,function(a){return R.isNil(a)?null:d.findStamp(a,k.game.models)},function(a){j(k.factions,o,a,m.origin)})(l)}};return l}]),angular.module("clickApp.directives").factory("wallTemplateElement",["template","gameTemplateSelection","gameMap","labelElement",function(a,b,c,d){function e(a,b){b.setAttribute("x",a.state.x-20+""),b.setAttribute("y",a.state.y-3.75+"")}function f(a,b,c,d,e){a?e.classList.add("selection"):e.classList.remove("selection"),b?e.classList.add("local"):e.classList.remove("local"),c?e.classList.add("remote"):e.classList.remove("remote"),e.setAttribute("transform","rotate("+d.state.r+","+d.state.x+","+d.state.y+")")}var g={create:function(a,b,c){var e=document.createElementNS(a,"g");b.appendChild(e);var f=document.createElementNS(a,"rect");f.classList.add("template"),f.classList.add("wall"),f.setAttribute("width","40"),f.setAttribute("height","7.5"),f.setAttribute("data-stamp",c.state.stamp),e.appendChild(f);var g=d.create(a,e);return{container:e,wall:f,label:g}},update:function(g,h,i,j){var k=h.game.template_selection,l=b["in"]("local",i.state.stamp,k),m=b["in"]("remote",i.state.stamp,k),n=l||m,o=c.isFlipped(g),p=c.zoomFactor(g),q=i.state,r={x:i.state.x,y:i.state.y+2},s=a.fullLabel(i);e(i,j.wall),f(n,l,m,i,j.container),d.update(o,p,q,r,s,j.label)}};return g}]),angular.module("clickApp.directives").directive("clickGameTerrain",["gameMap","gameTerrains","gameTerrainInfo","gameTerrainSelection",function(a,b,c,d){function e(a,b,c,d,e){var h=f(b,c,d),i=g(a,b,e,h);e.onStateChangeEvent("Game.terrain.change."+c.state.stamp,i,e),i()}function f(a,b,c){var d=document.getElementById("map"),e=d.namespaceURI,f=document.createElementNS(e,"image");f.classList.add("terrain-image"),f.setAttribute("data-stamp",b.state.stamp),f.setAttribute("x","0"),f.setAttribute("y","0"),f.setAttribute("width",a.img.width+""),f.setAttribute("height",a.img.height+""),f.setAttributeNS("http://www.w3.org/1999/xlink","href",a.img.link),c.appendChild(f);var g=document.createElementNS(e,"line");g.classList.add("terrain-los"),g.setAttribute("x1",a.img.width/2+""),g.setAttribute("y1",a.img.height/2+""),g.setAttribute("x2",a.img.width/2+""),g.setAttribute("y2","0"),c.appendChild(g);var h=document.createElementNS(e,"rect");return h.classList.add("terrain-edge"),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("width",a.img.width+""),h.setAttribute("height",a.img.height+""),c.appendChild(h),{container:c,image:f,direction:g,edge:h}}function g(a,c,d,e){return function(){R.pipeP(function(){return b.findStamp(d.terrain.state.stamp,d.state.game.terrains)},function(b){h(c.img,b,e),i(a.game.terrain_selection,b,e)})()}}function h(a,b,c){c.container.setAttribute("transform",["translate(",b.state.x-a.width/2,",",b.state.y-a.height/2,") rotate(",b.state.r,",",a.width/2,",",a.height/2,")"].join(""))}function i(a,b,c){var e=c.container,f=b.state.stamp;d["in"]("local",f,a)?e.classList.add("local-selection"):e.classList.remove("local-selection"),d["in"]("remote",f,a)?e.classList.add("remote-selection"):e.classList.remove("remote-selection")}var j={restrict:"A",link:function(a,b){var d=a.state;R.pipeP(function(){return c.getInfo(a.terrain.state.info,d.terrains)["catch"](function(a){return self.Promise.reject(a)})},function(c){return e(d,c,a.terrain,b[0],a)})()}};return j}]).directive("clickGameTerrainsList",[function(){return{restrict:"A",templateUrl:"partials/game/terrains_list.html",scope:!0,link:function(a,b){a.type=b[0].getAttribute("click-game-terrains-list"),a.digestOnStateChangeEvent("Game.terrain.create",a)}}}]),angular.module("clickApp.directives").directive("clickGameWarnMode",["$timeout",function(a){return{restrict:"A",link:function(b,c){c[0].style.display="none";var d,e=c[0].querySelector(".warn-mode-name"),f=c[0].querySelector(".warn-reason");b.onStateChangeEvent("Game.action.error",function(g,h){R.exists(d)&&a.cancel(d),e.innerHTML=b.currentModeName(),f.innerHTML=h,c[0].style.display="initial",d=a(function(){c[0].style.display="none",d=null},1e3)},b)}}}]),angular.module("clickApp.directives").controller("gamesListCtrl",["$scope",function(a){function b(b){R.pipe(R.defaultTo(R.head(a.selection.list)),R.defaultTo(0),R.min(R.length(a.games)-1),R.max(0),function(b){a.selection.list=[b]})(b)}a.selection.list=[],a.isInSelection=function(b){return R.exists(R.find(R.equals(b),a.selection.list))},a.selectionIsEmpty=function(){return R.isEmpty(a.selection.list)},a.doSetSelection=function(c){R.exists(a.current)&&a.games[c].public_stamp===a.current||b(c)},a.$watch("games",function(){b()})}]).directive("clickGamesList",[function(){return{restrict:"E",controller:"gamesListCtrl",templateUrl:"partials/directives/games_list.html",scope:{games:"=",selection:"=",current:"="},link:function(){}}}]),angular.module("clickApp.directives").directive("clickLogReplayList",[function(){return{restrict:"A",link:function(a,b){var c=b[0].getAttribute("click-log-replay-list");a.$watch(c,function(){self.requestAnimationFrame(function(){b[0].scrollTop=1e6})})}}}]),angular.module("clickApp.directives").directive("clickUserMailNotification",[function(){return{restrict:"E",template:['<audio src="/data/sound/you_got_mail.wav">',"</audio>"].join(""),link:function(a,b){var c=b[0].querySelector("audio");a.onStateChangeEvent("User.chat",function(b,d){d.from!==a.state.user.state.stamp&&(c.currentTime=0,c.play())},a)}}}]).directive("clickGameMailNotification",[function(){return{restrict:"E",template:['<audio src="/data/sound/you_got_mail.wav">',"</audio>"].join(""),link:function(a,b){var c=b[0].querySelector("audio");a.onStateChangeEvent("Game.chat",function(b,d){d.from!==a.state.user.state.name&&(c.currentTime=0,c.play())},a)}}}]),angular.module("clickApp.directives").factory("prompt",[function(){function a(){return R.exists(b)?b:new self.Promise(function(a){d.push(a)})}var b,c,d=[];return{register:function(a){return b=a,b.doValidate=function(){var a=b.close();c.resolve(a),c=null},b.doCancel=function(){b.close(),c.reject("canceled"),c=null},R.forEach(function(a){a(b)},d),d=[],b},prompt:function(b,d,e){return R.pipePromise(a,function(a){return a.open({prompt_type:b,message:"String"===R.type(d)?[d]:d,input_type:"Number"===R.type(e)?"number":"text",input_value:e}),new self.Promise(function(a,b){c={resolve:a,reject:b}})})()}}}]).directive("prompt",["$window","prompt",function(a,b){return{restrict:"E",templateUrl:"partials/directives/prompt.html",scope:!0,link:function(c,d){var e=d[0].querySelector("form"),f=d[0].querySelector("p"),g=d[0].querySelector("input"),h=d[0].querySelector("button.btn-default");d[0].style.display="none";var i=b.register({open:function(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=b.message,e=b.input_type,i=b.prompt_type,j=b.input_value;a.requestAnimationFrame(function(){f.innerHTML=R.defaultTo([],c).join("<br />"),g.setAttribute("type",R.defaultTo("text",e)),g.style.display="prompt"===i?"initial":"none",h.style.display="alert"!==i?"initial":"none",d[0].style.display="initial",g.focus(),g.value=R.defaultTo(null,j)})},close:function(){var a=g.value;return"number"===g.getAttribute("type")&&(a=0===R.length(a)?null:parseFloat(a)),d[0].style.display="none",a}});e.addEventListener("submit",i.doValidate),h.addEventListener("click",i.doCancel)}}}]),angular.module("clickApp.directives").controller("userChatCtrl",["$scope",function(a){function b(b){a.chat.to=R.reject(R.equals(d.user.state.stamp),b)}function c(){return R.length(s.strip(a.chat.msg))>0}var d=a.state;a.chat={msg:"",to:[]},a.userIsInTo=function(b){return R.find(R.equals(b),a.chat.to)},a.doToggleUserTo=function(c){b(a.userIsInTo(c)?R.reject(R.equals(c),a.chat.to):R.append(c,a.chat.to))},a.doSetAllUsersTo=function(){b(R.pluck("stamp",d.user.connection.users))},a.doSetToChat=function(a){b(R.pipe(R.prop("to"),R.append(R.prop("from",a)),R.uniq)(a))},a.canSendChatMsg=function(){return!R.isEmpty(a.chat.to)&&c()},a.doSendChatMessage=function(){return a.canSendChatMsg()?R.pipePromise(function(){return a.stateEvent("User.sendChatMsg",a.chat)},function(){a.chat.msg="",a.$digest()})(a.user):null},a.doSendChatMessageToAll=function(){b(R.pluck("stamp",d.user.connection.users)),a.doSendChatMessage()}}]).directive("clickUserConnection",[function(){return{restrict:"E",controller:"userChatCtrl",templateUrl:"partials/directives/user_chat.html",scope:!0,link:function(){}}}]);
//# sourceMappingURL=app.min.js.map
angular.module('clickApp.services').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('partials/debug.html',
    "<div class=container><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>Import dump file</h4></div><div class=panel-body><p class=text-warning>{{result}}</p><form><input class=form-control id=import-file type=file multiple ea-file=\"doLoadDumpFile(file)\"></form></div></div></div>"
  );


  $templateCache.put('partials/directives/compat_check.html',
    "<p class=compat-warning ng-show=compat_error>Your browser is missing crucial features ({{compat_error.join(', ')}}). You should update it.</p>"
  );


  $templateCache.put('partials/directives/game_chat_box.html',
    "<div><form ng-submit=doSendChatMessage()><div class=input-group><span class=input-group-btn><button type=submit class=\"btn btn-default\">Send</button></span> <input class=form-control placeholder=Msg... ng-model=\"chat.msg\"></div></form><div class=chat-list><div class=chat ng-repeat=\"c in game.chat.slice(-10).reverse() track by c.stamp\">{{ c.from }} ➝ {{c.msg}}</div></div></div>"
  );


  $templateCache.put('partials/directives/game_dice_box.html',
    "<div><div class=btn-group><button class=\"btn btn-default\" title=\"{{action_bindings['roll1D6'] || ''}}\" ng-click=\"doRollDice(6, 1)\">1D6</button> <button class=\"btn btn-default\" title=\"{{action_bindings['roll2D6'] || ''}}\" ng-click=\"doRollDice(6, 2)\">2D6</button> <button class=\"btn btn-default\" title=\"{{action_bindings['roll3D6'] || ''}}\" ng-click=\"doRollDice(6, 3)\">3D6</button> <button class=\"btn btn-default\" title=\"{{action_bindings['roll4D6'] || ''}}\" ng-click=\"doRollDice(6, 4)\">4D6</button> <button class=\"btn btn-default\" title=\"{{action_bindings['roll5D6'] || ''}}\" ng-click=\"doRollDice(6, 5)\">5D6</button> <button class=\"btn btn-default\" title=\"{{action_bindings['roll1D3'] || ''}}\" ng-click=\"doRollDice(3, 1)\">1D3</button></div><div class=dice-list><div ng-repeat=\"(i,die) in dice.slice(-10).reverse() track by die.stamp\"><span class=text-primary>[{{::die.user}}]</span> {{::die.desc}}</div></div></div>"
  );


  $templateCache.put('partials/directives/games_list.html',
    "<div ng-repeat=\"(i,g) in games\" class=\"clickable {{current && g.public_stamp === current ? 'bg-primary':''}} {{isInSelection(i) ? 'bg-info':''}}\" ng-click=doSetSelection(i)>{{::g | game:'description'}}</div>"
  );


  $templateCache.put('partials/directives/prompt.html',
    "<div><div class=prompt-mask></div><div class=\"prompt-container text-center\"><div class=\"prompt-panel panel panel-default\"><form name=prompt><div class=panel-body><p></p><input step=any min=0 class=\"form-control\"></div><div class=panel-footer><button class=\"btn btn-default\" type=button style=width:45%>Cancel</button> <button class=\"btn btn-primary\" type=submit style=width:45%>Ok</button></div></form></div></div></div>"
  );


  $templateCache.put('partials/directives/user_chat.html',
    "<div ng-repeat=\"u in state.user.connection.users track by u.stamp\" class=\"user clickable {{ userIsInTo(u.stamp) ? 'bg-info' : '' }} {{ (state.user.state.stamp === u.stamp) ? 'bg-primary' : '' }}\" ng-click=doToggleUserTo(u.stamp)>{{ u | user:'stateDescription' }} ( {{:: u.stamp }} )</div><h4>Chat</h4><form ng-submit=doSendChatMessage()><div class=form-group><label>To :</label><em>{{ (state.user | userConnection:'usersNamesForStamps':chat.to).join(',') }}</em><div class=input-group><span class=input-group-btn><button type=button class=\"btn btn-default\" ng-click=doSendChatMessageToAll()>ToAll</button></span> <input class=form-control placeholder=Msg... ng-model=\"chat.msg\"></div></div></form><div class=chat-list><div class=chat ng-repeat=\"c in state.user.connection.chat.slice().reverse() track by c.stamp\"><em ng-click=doSetToChat(c) class=clickable>{{ state.user | userConnection:'userNameForStamp':c.from }} ➝ {{ (state.user | userConnection:'usersNamesForStamps':c.to).join(',') }}</em> : <a ng-href={{c.link}}>{{c.msg}}</a></div></div>"
  );


  $templateCache.put('partials/game.html',
    "<div id=game click-game-page><div id=gameview class=resizable><div id=zoom-osd class=btn-group-vertical ng-include=\"'partials/game/zoomOsd.html'\"></div><div id=cmd-osd ng-include=\"'partials/game/cmdOsd.html'\"></div><div id=game-loading class=\"text-center bg-primary\" click-game-loading><strong>Loading...</strong></div><div id=game-warn-mode class=text-center click-game-warn-mode><div class=warn-mode-name>Mode</div><div class=warn-reason>Reason</div></div><div id=selection-osd ng-include=\"'partials/game/selectionOsd.html'\" click-game-selection-detail></div><div id=dice-osd><click-game-dice-box></click-game-dice-box></div><div id=chat-osd><click-game-chat-box></click-game-chat-box></div><div class=edit-label click-game-edit-label></div><div class=edit-damage click-game-edit-damage></div><div id=viewport><svg id=map click-game-map click-game-layers viewbox=\"0 0 480 480\"><defs><filter id=aura-filter x=-50% y=-50% width=200% height=200%><fegaussianblur in=SourceGraphic stddeviation=\"2\"></filter><filter id=state-aura-filter x=-75% y=-75% width=250% height=250%><fegaussianblur in=SourceGraphic stddeviation=\"4\"></filter><marker id=aoe-direction-end markerwidth=6 markerheight=8 refx=6 refy=4 orient=auto><polygon points=\"0,8 6,4 0,0\" style=\"fill:#0F0\"></marker><marker id=ruler-start markerwidth=6 markerheight=8 refx=0 refy=4 orient=auto><polygon points=\"6,8 0,4 6,0\" style=\"fill:#0EE\"><line x1=0 y1=1 x2=0 y2=7 style=\"stroke:#0CC;\n" +
    "                         stroke-width:2px\"></marker><marker id=ruler-end markerwidth=6 markerheight=8 refx=6 refy=4 orient=auto><polygon points=\"0,8 6,4 0,0\" style=\"fill:#0EE\"><line x1=6 y1=1 x2=6 y2=7 style=\"stroke:#0CC;\n" +
    "                         stroke-width:2px\"></marker><clippath id=los-clip><polygon click-game-los-clip></polygon></clippath></defs><g id=game-board ng-show=\"state.game.layers | gameLayers:'isDisplayed':'b'\"><image id=board-preview x=0 y=0 width=480 height=480 xlink:href=\"{{state.game.board.preview || ''}}\"></image><image id=board-view x=0 y=0 width=480 height=480 xlink:href=\"{{state.game.board.img || ''}}\"></image></g><g id=game-terrains-locked ng-show=\"state.game.layers | gameLayers:'isDisplayed':'b'\" click-game-terrains-list=locked></g><g id=game-terrains ng-show=\"state.game.layers | gameLayers:'isDisplayed':'b'\" click-game-terrains-list=active></g><g id=game-deploiement ng-show=\"state.game.layers | gameLayers:'isDisplayed':'d'\" ng-include=\"'partials/game/deploiement.html'\"></g><g id=game-scenario ng-show=\"state.game.layers | gameLayers:'isDisplayed':'s'\" ng-include=\"'partials/game/scenario.html'\"></g><g id=game-templates-locked ng-show=\"state.game.layers | gameLayers:'isDisplayed':'t'\" click-game-templates-list=locked></g><g id=game-under-models ng-show=\"state.game.layers | gameLayers:'isDisplayed':'m'\"><g click-game-los-refresh style=\"clip-path: url(#los-clip)\"><polygon ng-repeat=\"envelope in state.game.los.computed.shadow\" click-game-los-darkness class=los-shadow></polygon><polygon ng-repeat=\"envelope in state.game.los.computed.darkness\" click-game-los-darkness class=los-darkness></polygon></g></g><g id=game-models-locked ng-show=\"state.game.layers | gameLayers:'isDisplayed':'m'\" click-game-models-list=locked></g><g id=game-models ng-show=\"state.game.layers | gameLayers:'isDisplayed':'m'\" click-game-models-list=active></g><g id=game-over-models ng-show=\"state.game.layers | gameLayers:'isDisplayed':'m'\"></g><g id=game-templates ng-show=\"state.game.layers | gameLayers:'isDisplayed':'t'\" click-game-templates-list=active></g><g id=game-ruler click-game-ruler></g><g id=game-los click-game-los></g><g id=game-create-terrains><g ng-repeat=\"(index, terrain) in state.create.terrain.terrains\" click-game-create-terrain></g></g><g id=game-create-models><g ng-repeat=\"(index, model) in state.create.model.models\" click-game-create-model></g></g><g id=game-create-templates><g ng-repeat=\"(index, terrain) in state.create.template.templates\" click-game-create-template></g></g><rect id=game-dragbox click-game-dragbox></rect></svg></div></div><div id=menu><button id=menu-toggle class=\"btn btn-default\" title=\"Toggle menu\"><span class=\"glyphicon glyphicon-chevron-left\"></span> <span class=\"glyphicon glyphicon-chevron-right\"></span></button><div id=menu-content><p><strong>Player 1:</strong> {{game | game:'playerName':'p1'}} <strong>VS</strong> <strong>Player 2:</strong> {{game | game:'playerName':'p2'}}<form class=form-inline ng-show=\"state.game | gameConnection:'active'\" ng-submit=doInvitePlayer()><div class=form-group><div class=input-group><span class=input-group-btn><button type=submit class=\"btn btn-default\">Invite Player</button></span><select class=form-control ng-options=\"u.stamp as (u.name | capitalize) for u in user.connection.users\" ng-model=invite.player required></select></div></div></form></p><ul class=\"nav nav-tabs\"><li class=\"{{stateIs('game.main') ? 'active' : ''}}\" ng-click=\"goToState('^.main')\"><a class=\"{{ hints.go_to_main ? 'go-to-hint' : ''}}\">Main</a></li><li class=\"{{stateIs('game.model') ? 'active' : ''}}\" ng-click=\"goToState('^.model')\"><a>Model</a></li><li class=\"{{stateIs('game.setup') ? 'active' : ''}}\" ng-click=\"goToState('^.setup')\"><a>Setup</a></li><li class=\"{{stateIs('game.log') ? 'active' : ''}}\" ng-click=\"goToState('^.log')\"><a>Log</a></li><li class=\"{{stateIs('game.save') ? 'active' : ''}}\" ng-click=\"goToState('^.save')\"><a>Save</a></li><li class=\"{{stateIs('game.help') ? 'active' : ''}}\" ng-click=\"goToState('^.help')\"><a>Help</a></li><li ng-show=\"user | user:'online'\" class=\"{{stateIs('game.online') ? 'active' : ''}}\" ng-click=\"goToState('^.online')\"><a class=\"{{ hints.go_to_online ? 'go-to-hint' : ''}}\">Online</a></li><li ng-click=\"goToState('lounge')\"><a>Lounge</a></li></ul><div ui-view id=menu-view class=\"{{currentModeIs('CreateTemplate') ? 'disabled' : ''}}\"></div></div></div><click-game-mail-notification></click-game-mail-notification><click-bad-dice-notification></click-bad-dice-notification></div>"
  );


  $templateCache.put('partials/game/cmdOsd.html',
    "<div class=scroll-container><div class=mode-title><strong>{{currentModeName()}}</strong></div><div class=btn-group-vertical><button class=\"btn btn-default\" title=\"{{action_bindings['modeBackToDefault'] || ''}}\" ng-click=\"doModeAction('modeBackToDefault')\">Back To Default</button> <button class=\"btn btn-default\" title=\"{{action_bindings['flipMap'] || ''}}\" ng-click=\"doModeAction('flipMap')\">Flip Map</button> <button ng-repeat=\"action in action_buttons\" class=\"btn {{::(action.length === 3 && action[1] !== 'toggle') ? 'btn-info' : 'btn-default'}}\" title=\"{{::action_bindings[action[1]] || ''}}\" ng-click=doActionButton(action) ng-show=\"\n" +
    "            action[1] === 'toggle' ||\n" +
    "            action.length === 2 ||\n" +
    "            show_action_group === action[2]\n" +
    "            \">{{action[0]}} <span class=\"glyphicon {{action[1] === 'toggle' ? (show_action_group === action[2] ? 'glyphicon-chevron-up' : 'glyphicon-chevron-down') : '' }}\"></span></button></div></div>"
  );


  $templateCache.put('partials/game/deploiement.html',
    "<g><line x1=0 y1=70 x2=480 y2=70 class=deploiement-line></line><line x1=0 y1=90 x2=480 y2=90 class=extended-deploiement-line></line><line x1=0 y1=130 x2=480 y2=130 class=advance-deploiement-line></line><line x1=0 y1=150 x2=480 y2=150 class=extended-advance-deploiement-line></line><line x1=0 y1=100 x2=480 y2=100 class=deploiement-line></line><line x1=0 y1=120 x2=480 y2=120 class=extended-deploiement-line></line><line x1=0 y1=160 x2=480 y2=160 class=advance-deploiement-line></line><line x1=0 y1=180 x2=480 y2=180 class=extended-advance-deploiement-line></line><line x1=0 y1=380 x2=480 y2=380 class=deploiement-line></line><line x1=0 y1=360 x2=480 y2=360 class=extended-deploiement-line></line><line x1=0 y1=320 x2=480 y2=320 class=advance-deploiement-line></line><line x1=0 y1=300 x2=480 y2=300 class=extended-advance-deploiement-line></line><line x1=0 y1=410 x2=480 y2=410 class=deploiement-line></line><line x1=0 y1=390 x2=480 y2=390 class=extended-deploiement-line></line><line x1=0 y1=350 x2=480 y2=350 class=advance-deploiement-line></line><line x1=0 y1=330 x2=480 y2=330 class=extended-advance-deploiement-line></line><line x1=0 y1=30 x2=480 y2=30 class=ambush-line></line><line x1=30 y1=0 x2=30 y2=480 class=ambush-line></line><line x1=0 y1=450 x2=480 y2=450 class=ambush-line></line><line x1=450 y1=0 x2=450 y2=480 class=ambush-line></line><g id=deploiement-labels><rect x=0 y=58 width=1.2em height=1em class=dep-label></rect><text x=0 y=69 class=dep-label>7\"</text><rect x=0 y=122 width=1.8em height=1em class=dep-label-sm></rect><text x=0 y=129 class=dep-label-sm>13\"</text><rect x=0 y=88 width=1.8em height=1em class=dep-label></rect><text x=0 y=99 class=dep-label>10\"</text><rect x=0 y=152 width=1.8em height=1em class=dep-label-sm></rect><text x=0 y=159 class=dep-label-sm>16\"</text><rect x=0 y=368 width=1.8em height=1em class=dep-label></rect><text x=0 y=379 class=dep-label>10\"</text><rect x=0 y=312 width=1.8em height=1em class=dep-label-sm></rect><text x=0 y=319 class=dep-label-sm>16\"</text><rect x=0 y=398 width=1.2em height=1em class=dep-label></rect><text x=0 y=409 class=dep-label>7\"</text><rect x=0 y=342 width=1.8em height=1em class=dep-label-sm></rect><text x=0 y=349 class=dep-label-sm>13\"</text></g></g>"
  );


  $templateCache.put('partials/game/help.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading>Debug dump file</div><div class=panel-body><a class=\"btn btn-default\" ng-disabled=!dump.url ng-href={{dump.url}} download={{dump.name}}>Download Dump File</a></div></div><div class=\"panel panel-info\"><div class=panel-heading>Current Mode Bindings</div><table class=table><tr ng-repeat=\"bind in bindings track by bind[0]\"><td><button class=\"btn btn-default\" ng-click=doModeAction(bind[0])>{{::bind[0]}}</button></td><td>{{::bind[1]}}</td><td></td></tr></table></div></div>"
  );


  $templateCache.put('partials/game/log.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading><strong>Command Log</strong></div><div class=panel-content><button class=\"btn btn-default\" title=\"{{action_bindings['commandUndoLast'] || ''}}\" ng-disabled=\"commands.length === 0\" ng-click=\"doModeAction('commandUndoLast')\">Undo Last</button> <button class=\"btn btn-default\" title=\"{{action_bindings['commandReplayNext'] || ''}}\" ng-disabled=\"undo.length === 0\" ng-click=\"doModeAction('commandReplayNext')\">Replay Next</button><div class=log-replay-list click-log-replay-list=undo><div ng-repeat=\"(i,cmd) in undo.slice(-20) track by cmd.stamp\"><span class=text-primary>[{{::cmd.user}}]</span> {{::cmd.type}} {{::cmd.desc}}</div></div><div class=\"log-replay-list log\" click-log-replay-list=undo_log><div ng-repeat=\"(i,cmd) in undo_log.slice(-20) track by cmd.stamp\"><span class=text-primary>[{{::cmd.user}}]</span> <span class=text-info>{{::cmd.type}} {{::cmd.desc}}</span></div></div><div class=\"log-command-list log\"><div ng-repeat=\"(i,cmd) in commands_log.slice(-20).reverse() track by cmd.stamp\"><span class=text-primary>[{{::cmd.user}}]</span> <span class=text-info>{{::cmd.type}} {{::cmd.desc}}</span></div></div><div class=log-command-list><div ng-repeat=\"(i,cmd) in commands.slice(-20).reverse() track by cmd.stamp\"><span class=text-primary>[{{::cmd.user}}]</span> {{::cmd.type}} {{::cmd.desc}}</div></div></div></div></div>"
  );


  $templateCache.put('partials/game/main.html',
    "<div><div ng-show=\"game | gameConnection:'active'\" class=\"panel panel-info\"><div class=panel-heading>Chat</div><div class=panel-content><click-game-chat-box></click-game-chat-box></div></div><div class=\"panel panel-info\"><div class=panel-heading>Tools</div><div class=panel-content><div class=btn-group><button class=\"btn {{ currentModeIs('Ruler') ? 'btn-primary' : 'btn-default' }}\" title=\"{{action_bindings['enterRulerMode'] || ''}}\" ng-click=doUseRuler()>Use<br>Ruler</button> <button class=\"btn {{ (state.game.ruler | gameRuler:'isDisplayed') ? 'btn-primary' : 'btn-default' }}\" ng-click=doToggleShowRuler()>Show<br>Ruler</button></div><div class=btn-group><button class=\"btn {{ currentModeIs('LoS') ? 'btn-primary' : 'btn-default' }}\" title=\"{{action_bindings['enterLosMode'] || ''}}\" ng-click=doUseLos()>Use<br>LoS</button> <button class=\"btn {{ (state.game.los | gameLos:'isDisplayed') ? 'btn-primary' : 'btn-default' }}\" ng-click=doToggleShowLos()>Show<br>LoS</button></div><div class=btn-group><button class=\"btn btn-default\" ng-click=\"doCreateTemplate('aoe')\">New<br>AoE</button> <button class=\"btn btn-default\" ng-click=\"doCreateTemplate('spray')\">New<br>Spray</button> <button class=\"btn btn-default\" ng-click=\"doCreateTemplate('wall')\">New<br>Wall</button></div></div></div><div class=\"panel panel-info\"><div class=panel-heading>Dice</div><div class=panel-content><click-game-dice-box></click-game-dice-box></div></div></div>"
  );


  $templateCache.put('partials/game/model.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading><strong>Create Model</strong></div><div class=panel-content><form class=form-inline name=create-model><table><tr><th>Faction</th><td><select class=form-control ng-options=\"k as f.name for (k,f) in factions\" ng-model=faction ng-change=onFactionChange()></select></td></tr><tr><th>Section</th><td><select class=form-control ng-options=\"k as k for (k,s) in factions[faction].models\" ng-model=section ng-change=onSectionChange()></select></td></tr><tr><th>Entry</th><td><select class=form-control ng-options=\"k as e.name for (k,e) in factions[faction].models[section]\" ng-model=entry ng-change=onEntryChange()></select></td></tr><tr ng-show=factions[faction].models[section][entry].entries><th>Type</th><td><select class=form-control ng-options=\"\n" +
    "                      k as k for (k,t) in\n" +
    "                      factions[faction].models[section][entry].entries\n" +
    "                      \" ng-model=type ng-change=onTypeChange()></select></td></tr><tr ng-show=factions[faction].models[section][entry].entries><th>Model</th><td><select class=form-control ng-options=\"\n" +
    "                      k as m.name for (k,m) in\n" +
    "                      factions[faction].models[section][entry].entries[type]\n" +
    "                      \" ng-model=model ng-change=onModelChange()></select></td></tr><tr ng-show=getModel().ranges><th>Size</th><td><select class=form-control ng-options=\"\n" +
    "                      s as s for (k,s) in\n" +
    "                      getModel().ranges\n" +
    "                      \" ng-model=repeat></select></td></tr></table></form><br><table ng-show=getModel()><tr ng-show=\"getModel() !== factions[faction].models[section][entry]\"><th>Unit</th><td>{{factions[faction].models[section][entry].name}}</td></tr><tr><th>Name</th><td>{{getModel().name}}</td></tr><tr><th>Type</th><td>{{getModel().type}}</td></tr><tr ng-show=getModel().fury><th>Fury</th><td>{{getModel().fury}}</td></tr><tr><th>Base</th><td>{{getModel().base}}</td></tr><tr><th>Damage</th><td><click-game-model-damage info=getModel().damage></click-game-model-damage></td></tr><tr ng-show=getModel().img[0].link><th>Image</th><td><img width=150 height=150 ng-src=\"{{getModel().img[0].link}}\"></td></tr></table></div><div class=panel-footer><button class=\"btn btn-default\" ng-disabled=\"\n" +
    "              !getModel() ||\n" +
    "              currentModeIs('CreateModel')\n" +
    "              \" ng-click=doCreateModel()>Create Model</button></div></div><div class=\"panel panel-info\"><form name=import-list ng-submit=doImportList()><div class=panel-heading><strong>Import List</strong></div><div class=panel-content><textarea class=form-control style=\"width:100%;\n" +
    "                         height: 8em\" ng-model=import.list placeholder=\"Forward Kommander list...\">\n" +
    "        </textarea></div><div class=panel-footer><button class=\"btn btn-default\" type=submit>Import List</button></div></form></div><div class=\"panel panel-info\"><div class=panel-heading><strong>Import Models File</strong></div><div class=panel-content><form class=form-inline><div class=form-group><input type=file multiple class=form-control ea-file=\"doImportModelsFile(file)\"></div></form></div></div></div>"
  );


  $templateCache.put('partials/game/model_damage.html',
    "<div><strong>Total :</strong> <span ng-show=state>{{state.dmg.t}} /</span>{{info.total}} <span ng-if=info.field>+ <span ng-show=state>{{state.dmg.f}} /</span>{{info.field}}</span> <button class=\"btn btn-default\" ng-show=state ng-click=doResetDamage()>Reset</button><div ng-if=\"info.type == 'warrior'\" class=damage-warrior><div ng-repeat=\"i in range(info.n)\" class=\"damage-box {{ warriorBoxClass(i) }}\" ng-click=doWarriorDamage(i+1)></div></div><table class=damage-grid ng-if=info.field><tr ng-repeat=\"line in [0, 1]\"><td ng-repeat=\"col in range(info.field/2)\" class=\"damage-box {{ fieldBoxClass(col, line) }}\" ng-click=\"doFieldDamage(line * info.field/2 + col + 1)\">F</td></tr></table><table ng-if=\"\n" +
    "         info.type === 'jack' ||\n" +
    "         info.type === 'gargantuan' ||\n" +
    "         info.type === 'beast'\n" +
    "         \" class=damage-grid><tr><td ng-repeat=\"col in ['1','2','3','4','5','6']\" class=damage-col-header ng-click=doGridColDamage(col)>{{::col}}</td></tr><tr ng-repeat=\"line in range(info.depth)\"><td ng-repeat=\"col in ['1','2','3','4','5','6']\" class=\"damage-box {{ gridBoxClass(col, line) }}\" ng-click=\"doGridDamage(line, col)\">{{ (!info[col][line] || info[col][line] === 'b') ? ' ' : info[col][line].toUpperCase() }}</td></tr></table><table ng-if=\"info.type === 'colossal'\" class=damage-grid><tr><td ng-repeat=\"col in ['L1','L2','L3','L4','L5','L6','R1','R2','R3','R4','R5','R6']\" class=damage-col-header ng-click=doGridColDamage(col)>{{::col}}</td></tr><tr ng-repeat=\"line in [0,1,2,3,4,5]\"><td ng-repeat=\"col in ['L1','L2','L3','L4','L5','L6','R1','R2','R3','R4','R5','R6']\" class=\"damage-box {{ gridBoxClass(col, line) }}\" ng-click=\"doGridDamage(line, col)\">{{ (!info[col][line] || info[col][line] === 'b') ? ' ' : info[col][line].toUpperCase() }}</td></tr></table></div>"
  );


  $templateCache.put('partials/game/models_list.html',
    "<g ng-repeat=\"(i,model) in state.game.models[type] track by model.state.stamp\" click-game-model></g>"
  );


  $templateCache.put('partials/game/online.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>{{ user | user:'description' }} / {{ (user | user:'online') ? 'Online' : 'Offline' }} ( {{ user.state.stamp }} )</h4></div><div class=panel-body ng-show=\"user | userConnection:'active'\"><click-user-connection></click-user-connection></div></div><div class=\"panel panel-info\" ng-show=\"user | userConnection:'active'\"><div class=panel-heading><h4 class=panel-title>Online Games</h4></div><div class=\"game-list panel-body\"><click-games-list games=user.connection.games selection=online_games_selection current=game.public_stamp></click-games-list></div><div class=panel-footer><form><div class=btn-group><button type=button class=\"btn btn-default\" ng-click=doLoadOnlineGame() ng-disabled=\"online_games_selection.list.length <= 0\">Watch Game</button></div></form></div></div></div>"
  );


  $templateCache.put('partials/game/save.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading>Save current game</div><div class=panel-body><a class=\"btn btn-default\" ng-disabled=!exports.game.url ng-href={{exports.game.url}} download={{exports.game.name}}>Download Game File</a></div></div><div class=\"panel panel-info\"><div class=panel-heading>Save current models selection</div><div class=panel-body><a class=\"btn btn-default\" ng-disabled=!exports.models.url ng-href={{exports.models.url}} download={{exports.models.name}}>Download Models File</a></div></div><div class=\"panel panel-info\"><div class=panel-heading>Save current board and terrain</div><div class=panel-body><a class=\"btn btn-default\" ng-disabled=!exports.board.url ng-href={{exports.board.url}} download={{exports.board.name}}>Download Board File</a></div></div></div>"
  );


  $templateCache.put('partials/game/scenario.html',
    "<g><circle ng-repeat=\"(i,c) in state.game.scenario.circle\" ng-attr-cx={{::c.x}} ng-attr-cy={{::c.y}} ng-attr-r={{::c.r}} class=zone></circle><rect ng-repeat=\"(i,r) in state.game.scenario.rect\" ng-attr-x={{::r.x-r.width/2}} ng-attr-y={{::r.y-r.height/2}} ng-attr-width={{::r.width}} ng-attr-height={{::r.height}} class=zone></rect><circle ng-repeat=\"(i,o) in state.game.scenario.objectives\" ng-attr-cx={{::o.x}} ng-attr-cy={{::o.y}} r=9.842 class=objective></circle><circle ng-repeat=\"(i,f) in state.game.scenario.flags\" ng-attr-cx={{::f.x}} ng-attr-cy={{::f.y}} r=7.874 class=objective></circle><g ng-show=\"stateIs('game.setup')\"><rect ng-show=state.game.scenario.killbox x=140 y=140 width=200 height=200 class=area></rect><circle ng-repeat=\"(i,o) in state.game.scenario.objectives\" ng-attr-cx={{::o.x}} ng-attr-cy={{::o.y}} r=49.842 class=area></circle><circle ng-repeat=\"(i,f) in state.game.scenario.flags\" ng-attr-cx={{::f.x}} ng-attr-cy={{::f.y}} r=47.874 class=area></circle></g></g>"
  );


  $templateCache.put('partials/game/selectionOsd.html',
    "<div ng-include=\"'partials/game/selectionOsd_'+type+'.html'\"></div>"
  );


  $templateCache.put('partials/game/selectionOsd_model.html',
    "<div class=\"panel panel-info\"><div class=panel-heading ng-click=doClose()><button class=close><span>&times;</span></button><h4 class=panel-title>{{info.name}}</h4></div><div class=panel-content><div ng-if=info.unit_name><strong>Unit :</strong> {{info.unit_name}}</div><div><strong>Name :</strong> {{info.name}}</div><div><strong>Created By :</strong> {{selection.state.user}}</div><div><strong>Class :</strong> {{info.type}} - {{info.base}}</div><div ng-show=info.fury><strong>Fury :</strong> {{info.fury}}</div><div ng-show=info.focus><strong>Focus :</strong> {{info.focus}}</div><div class=\"hint clickable\" ng-hide=show.info ng-click=\"show.info = true\">Show Info...</div><div class=bg-info ng-show=show.info><div ng-repeat=\"d in info.desc\"><strong>{{d[0]}}</strong> {{d[1]}}</div></div><form ng-submit=doAddLabel()><div class=form-group><label for=new-label>Label</label><input id=new-label class=form-control ng-model=edit.label placeholder=\"New Label\"></div><button type=button class=\"btn btn-default\" ng-repeat=\"l in selection.state.l\" ng-click=doRemoveLabel(l)>{{::labelDisplay(l)}} <span>&times;</span></button></form><div><strong>Damage :</strong><click-game-model-damage info=info.damage state=selection.state on-error=\"gameEvent('modeActionError', reason)\"></click-game-model-damage></div></div></div>"
  );


  $templateCache.put('partials/game/selectionOsd_template.html',
    "<div class=\"panel panel-info\"><div class=panel-heading ng-click=doClose()><button class=close><span>&times;</span></button><h4 class=panel-title>{{selection.state.type}} Template</h4></div><div class=panel-content><form name=selection-label ng-submit=doSetMaxDeviation() ng-show=\"selection.state.type === 'aoe'\"><div class=form-group><label for=new-deviation>Max Deviation</label><input id=new-deviation class=form-control type=number step=any min=0 ng-model=edit.max_deviation placeholder=\"0\"></div></form><form ng-submit=doAddLabel()><div class=form-group><label for=new-label>Label</label><input id=new-label class=form-control ng-model=edit.label placeholder=\"New Label\"></div><button type=button class=\"btn btn-default\" ng-repeat=\"l in selection.state.l\" ng-click=doRemoveLabel(l)>{{::labelDisplay(l)}} <span>&times;</span></button></form></div></div>"
  );


  $templateCache.put('partials/game/setup.html',
    "<div><div class=\"panel panel-info\"><div class=panel-heading><strong>Layers</strong></div><div class=panel-content><form class=form-inline name=layers><div class=checkbox><label><input type=checkbox ng-checked=\"layers | gameLayers:'isDisplayed':'b'\" ng-click=\"doToggleLayer('b')\"> Board</label></div><div class=checkbox><label><input type=checkbox ng-checked=\"layers | gameLayers:'isDisplayed':'d'\" ng-click=\"doToggleLayer('d')\"> Deploiement</label></div><div class=checkbox><label><input type=checkbox ng-checked=\"layers | gameLayers:'isDisplayed':'s'\" ng-click=\"doToggleLayer('s')\"> Scenario</label></div><div class=checkbox><label><input type=checkbox ng-checked=\"layers | gameLayers:'isDisplayed':'m'\" ng-click=\"doToggleLayer('m')\"> Models</label></div><div class=checkbox><label><input type=checkbox ng-checked=\"layers | gameLayers:'isDisplayed':'t'\" ng-click=\"doToggleLayer('t')\"> Templates</label></div></form></div></div><div class=\"panel panel-info\"><div class=panel-heading><strong>Scenario</strong></div><div class=panel-content><form class=form-inline name=scenario><select class=form-control ng-options=\"s as s[0] for s in scenarios\" ng-model=scenario_group></select><select class=form-control ng-options=\"s.name as s.name for s in scenario_group[1]\" ng-model=scenario_name ng-change=doSetScenario()></select><button class=\"btn btn-default\" ng-click=doSetRandomScenario()>Random</button> <button class=\"btn btn-default\" ng-click=doGenerateObjectives()>Generate Objective</button></form></div></div><div class=\"panel panel-info\"><div class=panel-heading><strong>Import Board File</strong></div><div class=panel-content><form class=form-inline><div class=form-group><input type=file multiple class=form-control ea-file=\"doImportBoardFile(file)\"></div></form></div></div><div class=\"panel panel-info\"><div class=panel-heading><strong>Board Map</strong></div><div class=panel-content><form class=form-inline name=board-map><select class=form-control ng-options=\"b.name as b.name for b in boards\" ng-model=board_name ng-change=doSetBoard()></select><button class=\"btn btn-default\" ng-click=doSetRandomBoard()>Random</button> <button class=\"btn btn-default\" ng-click=doResetTerrain()>Reset Terrain</button></form></div></div><div class=\"panel panel-info\"><div class=panel-heading><strong>Create Terrain</strong></div><div class=panel-content><form class=form-inline name=create-terrain><table><tr><th>Ambiance</th><td><select class=form-control ng-options=\"k as k for (k,f) in terrains\" ng-model=ambiance ng-change=onAmbianceChange()></select></td></tr><tr><th>Category</th><td><select class=form-control ng-options=\"k as k for (k,s) in terrains[ambiance]\" ng-model=category ng-change=onCategoryChange()></select></td></tr><tr><th>Entry</th><td><select class=form-control ng-options=\"k as e.name for (k,e) in terrains[ambiance][category]\" ng-model=entry ng-change=onEntryChange()></select></td></tr></table></form><br><table><tr><th>Image</th><td><img ng-width={{getTerrain().img.width/2}} ng-height={{getTerrain().img.height/2}} ng-src=\"{{getTerrain().img.link}}\"></td></tr></table></div><div class=panel-footer><button class=\"btn btn-default\" ng-disabled=\"!getTerrain() ||\n" +
    "                           currentModeIs('CreateTerrain')\n" +
    "                           \" ng-click=doCreateTerrain()>Create Terrain</button></div></div></div>"
  );


  $templateCache.put('partials/game/templates_list.html',
    "<g ng-repeat=\"template in state.game.templates[type] track by template.state.stamp\" click-game-template></g>"
  );


  $templateCache.put('partials/game/terrains_list.html',
    "<g ng-repeat=\"(i,terrain) in state.game.terrains[type] track by terrain.state.stamp\" click-game-terrain></g>"
  );


  $templateCache.put('partials/game/zoomOsd.html',
    "<button type=button class=\"btn btn-default\" ng-click=\"doModeAction('viewZoomIn')\" title=\"{{action_bindings['viewZoomIn'] || ''}}\"><span class=\"glyphicon glyphicon-zoom-in\"></span></button> <button type=button class=\"btn btn-default\" ng-click=\"doModeAction('viewZoomReset')\" title=\"{{action_bindings['viewZoomReset'] || ''}}\"><span class=\"glyphicon glyphicon-fullscreen\"></span></button> <button type=button class=\"btn btn-default\" ng-click=\"doModeAction('viewZoomOut')\" title=\"{{action_bindings['viewZoomOut'] || ''}}\"><span class=\"glyphicon glyphicon-zoom-out\"></span></button>"
  );


  $templateCache.put('partials/info.html',
    "<div class=container><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>Legal Info</h4></div><div class=panel-body><p>Privateer Press, WARMACHINE®, Cryx, Cygnar, Khador, Protectorate of Menoth, Retribution of Scyrah, HORDES, Circle Orboros, Legion of Everblight, Skorne, Trollbloods, and their logos and slogans; warjack, warbeast, and warcaster are trademark property of Privateer Press. ©2001-2014 Privateer Press, Inc. All Rights Reserved. Used without Permission.</p><p>This application is not official and not endorsed by Privateer Press.</p><p>Art assets are from the <a href=\"http://z7.invisionfree.com/vassalwmh/\">Vassal Warmachine module</a>, by Jeffery Brady and Ben Boyd.</p></div></div><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>License and Source code</h4></div><div class=panel-body><p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.</p><p><a href=https://github.com/eauc/clicknfeat>The source code for this program is available here.</a></p></div></div></div>"
  );


  $templateCache.put('partials/lounge.html',
    "<div id=lounge class=container><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>{{ state.user | user:'description' }} / {{ (state.user | user:'online') ? 'Online' : 'Offline' }}</h4></div><div class=panel-body ng-show=\"state.user | user:'online'\"><click-user-connection></click-user-connection></div><div class=panel-footer><button type=button class=\"btn btn-default\" ng-click=doUserToggleOnline()>Go {{ (state.user | user:'online') ? 'Offline' : 'Online' }}</button></div></div><div class=\"panel panel-info\" ng-show=\"state.user | userConnection:'active'\"><div class=panel-heading><h4 class=panel-title>Online Games</h4></div><div class=\"game-list panel-body\"></div><div class=panel-footer><form><div class=btn-group><button type=button class=\"btn btn-default\" ng-click=doCreateOnlineGame()>New Game</button> <button type=button class=\"btn btn-default\" ng-click=doLoadOnlineGame() ng-disabled=\"online_games_selection.list.length <= 0\">Watch Game</button></div><div class=form-group><label for=import-file>Upload game file :</label><input class=form-control id=import-file type=file multiple ea-file=\"doOpenOnlineGameFile(file)\"></div></form></div></div><div class=\"panel panel-info\"><div class=panel-heading><h4 class=panel-title>Local games</h4></div><div class=\"game-list panel-body\"><click-games-list games=state.local_games selection=local_games_selection></click-games-list></div><div class=panel-footer><form><div class=btn-group><button type=button class=\"btn btn-default\" ng-click=doCreateLocalGame()>New Game</button> <button type=button class=\"btn btn-default\" ng-click=doLoadLocalGame() ng-disabled=\"local_games_selection.list.length <= 0\">Load Game</button> <button type=button class=\"btn btn-default\" ng-click=doDeleteLocalGame(index) ng-disabled=\"local_games_selection.list.length <= 0\">Delete Game</button></div><div class=form-group><label for=import-file>Import game file :</label><input class=form-control id=import-file type=file multiple ea-file=\"doOpenLocalGameFile(file)\"></div></form></div></div></div>"
  );


  $templateCache.put('partials/settings.html',
    "<div id=settings class=container><ul class=\"nav nav-tabs\"><li ng-repeat=\"m in menu\" class=\"{{stateIs('settings.'+m) ? 'active' : ''}}\" ng-click=\"goToState('^.'+m)\"><a>{{::m}}</a></li></ul><div ui-view></div></div>"
  );


  $templateCache.put('partials/settings/bindings.html',
    "<div id=settings-bindings><form><div class=form-group><label>For mode :</label><select class=form-control ng-options=\"m as m for m in modes\" ng-model=mode></select></div></form><table class=table><tr><th>Action</th><th>Default</th><th>Current</th></tr><tr ng-repeat=\"a in getBindingsKeys(mode)\" class=\"{{ edit_settings.Bindings[mode][a] && edit_settings.Bindings[mode][a] !== state.settings.default.Bindings[mode][a] ? 'modified' : '' }}\"><td class=vertical-center>{{::a}}</td><td class=vertical-center>{{::state.settings.default.Bindings[mode][a]}}</td><td><div class=input-group><input class=form-control placeholder={{::state.settings.default.Bindings[mode][a]}} ng-model=\"edit_settings.Bindings[mode][a]\"> <span class=input-group-btn><button class=\"btn btn-default\" type=button ng-click=doRecordBinding(a) ng-disabled=recording><span class=\"glyphicon glyphicon-record\"></span></button></span></div><span class=hint ng-show=\"recording === a\">Recording...</span></td></tr></table></div>"
  );


  $templateCache.put('partials/settings/main.html',
    "<div id=settings-main><div class=\"panel panel-info\"><div class=panel-heading><span class=\"glyphicon glyphicon-import\"></span> Import</div><div class=panel-content><form><input class=form-control id=import-file type=file multiple ea-file=\"doLoadSettingsFile(file)\"></form><div class=error-list><strong class=text-warning>{{load_settings_result}}</strong></div></div></div><div class=\"panel panel-info\"><div class=panel-heading><span class=\"glyphicon glyphicon-export\"></span> Export</div><div class=panel-content><a class=\"btn btn-default\" ng-disabled=!state.exports.settings.url ng-href={{state.exports.settings.url}} download={{::state.exports.settings.name}}>Download Settings File</a></div></div><button type=button class=\"btn btn-default\" ng-click=doResetSettings({})>Reset Settings</button></div>"
  );


  $templateCache.put('partials/settings/models.html',
    "<div id=settings-main><p class=text-warning><strong>{{result}}</strong></p><div class=\"panel panel-info\"><div class=panel-heading><span class=\"glyphicon glyphicon-import\"></span> Models Descriptions</div><div class=\"panel-body row\"><form><div class=\"form-group {{ hasDesc(f) ? 'bg-info' : '' }}\" ng-repeat=\"(f, faction) in state.factions.base\"><label class=\"control-label col-xs-3 text-right\"><span class=\"clickable glyphicon glyphicon-trash\" ng-click=doClearFactionDesc(f)></span> {{::faction.name}}</label><input id=file-{{::f}} type=file multiple ea-file=\"doOpenFactionFile(f, file)\"></div></form></div><div class=panel-footer><button type=button class=\"btn btn-default\" ng-click=doClearAllDesc(f)>Clear All <span class=\"glyphicon glyphicon-trash\"></span></button></div></div></div>"
  );


  $templateCache.put('partials/settings/moves.html',
    "<div id=settings-bindings><form><div class=form-group><label>For mode :</label><select class=form-control ng-options=\"m as m for m in modes\" ng-model=mode></select></div></form><table class=table><tr><th>Action</th><th>Default</th><th>Current</th></tr><tr ng-repeat=\"(a,b) in state.settings.default.Moves[mode]\" class=\"{{ edit_settings.Moves[mode][a] && edit_settings.Moves[mode][a] !== b ? 'modified' : '' }}\"><td class=vertical-center>{{::a}}</td><td class=vertical-center>{{::b}}</td><td><div class=input-group><input type=number class=form-control placeholder={{::b}} ng-model=\"edit_settings.Moves[mode][a]\"></div></td></tr></table></div>"
  );


  $templateCache.put('partials/user.html',
    "<div class=container><form name=user_form><div class=form-group><label for=name>Name</label><input id=name name=name class=form-control ng-model=edit_user.name required></div><div class=form-group><label for=language>Language</label><input id=language name=language class=form-control ng-model=edit_user.language placeholder=\"FR, EN, ...\"></div><div class=form-group><label for=chat>Chat</label><select id=chat name=chat class=form-control type=text ng-model=edit_user.chat multiple><option value=text>Text</option><option value=skype>Skype</option></select></div><div class=form-group><label for=faction>Faction</label><select id=faction name=faction class=form-control ng-model=edit_user.faction multiple><option value=circle>Circle Orboros</option><option value=cryx>Cryx</option><option value=cygnar>Cygnar</option><option value=cyriss>Convergence of Cyriss</option><option value=khador>Khador</option><option value=legion>Legion of Everblight</option><option value=menoth>Protectorate of Menoth</option><option value=mercs>Mercernaries</option><option value=minions>Minions</option><option value=scyrah>Retribution of Scyrah</option><option value=skorne>Skorne Empire</option><option value=troll>Trollbloods</option></select></div><div class=form-group><label for=game_size>Games sizes</label><input id=game_size name=game_size class=form-control ng-model=edit_user.game_size placeholder=\"50, 35, ...\"></div><div class=form-group><label for=ck_position>Favorite Caster Kill Positions</label><select id=ck_position name=ck_position class=form-control type=text ng-model=edit_user.ck_position multiple><option value=Missionary>Missionary</option><option value=69>69</option><option value=71>71</option><option value=47>47</option><option value=ln(2Pi)>ln(2Pi)</option><option value=WTF?>WTF?</option></select></div><div class=form-group><button class=\"btn btn-default\" ng-click=doSaveUser() ng-disabled=!user_form.$valid>Save User</button></div></form></div>"
  );

}]);
