{"version":3,"sources":["../../es6/directives/gameCreateModel.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAClC,SAAS,CAAC,sBAAsB,EAAE,CACjC,SAAS,EACT,cAAc,EACd,SAAS,EACT,UAAS,OAAO,EACP,mBAAmB,EACnB,cAAc,EAAE;AACvB,SAAO;AACL,YAAQ,EAAE,GAAG;AACb,QAAI,EAAE,cAAS,KAAK,EAAE,cAAE,EAAa;AACnC,UAAI,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;AACzC,UAAI,KAAK,GAAG,GAAG,CAAC,YAAY,CAAC;;AAE7B,aAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;AAC7C,UAAI,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;;AAE1D,OAAC,CAAC,KAAK,CACL,mBAAmB,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,EAC7C,UAAS,IAAI,EAAE;AACb,YAAI,OAAO,GAAG,kBAAkB,CAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AAC/D,YAAI,UAAU,GAAG,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC/C,wBAAgB,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;;AAEtE,aAAK,CAAC,WAAW,CAAC,iBAAiB,EAAE,SAAS,iBAAiB,GAAG;AAChE,oBAAU,GAAG,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC3C,0BAAgB,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;SACvE,EAAE,KAAK,CAAC,CAAC;OACX,CACF,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;KACnB;GACF,CAAC;AACF,WAAS,kBAAkB,CAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE;AACzD,QAAI,OAAO,GAAG,QAAQ,CAAC,eAAe,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AACxD,WAAO,CAAC,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;AACtC,WAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AAClC,WAAO,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AAClC,WAAO,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AAC5C,UAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;AAC5B,WAAO,OAAO,CAAC;GAChB;AACD,WAAS,gBAAgB,CAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,EAAE;AAC1D,QAAI,KAAK,GAAG,UAAU,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAChC,WAAO,CAAC,YAAY,CAAC,IAAI,EAAE,AAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC,CAAC,GAAE,EAAE,CAAC,CAAC;AAC1D,WAAO,CAAC,YAAY,CAAC,IAAI,EAAE,AAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC,CAAC,GAAE,EAAE,CAAC,CAAC;GAC3D;CACF,CACF,CAAC,CAAC","file":"gameCreateModel.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.directives')\n  .directive('clickGameCreateModel', [\n    '$window',\n    'gameFactions',\n    'gameMap',\n    function($window,\n             gameFactionsService,\n             gameMapService) {\n      return {\n        restrict: 'A',\n        link: function(scope, el/*, attrs*/) {\n          var map = document.getElementById('map');\n          var svgNS = map.namespaceURI;\n\n          console.log('clickCreateModel', scope.index);\n          var model = R.nth(scope.index, scope.create.model.models);\n\n          R.pipeP(\n            gameFactionsService.getModelInfo$(model.info),\n            function(info) {\n              var element = createModelElement(info, document, svgNS, el[0]);\n              var is_flipped = gameMapService.isFlipped(map);\n              setModelPosition(scope.create.model.base, is_flipped, model, element);\n          \n              scope.onGameEvent('moveCreateModel', function onMoveCreateModel() {\n                is_flipped = gameMapService.isFlipped(map);\n                setModelPosition(scope.create.model.base, is_flipped, model, element);\n              }, scope);\n            }\n          )(scope.factions);\n        }\n      };\n      function createModelElement(info, document, svgNS, parent) {\n        var element = document.createElementNS(svgNS, 'circle');\n        element.classList.add('create-model');\n        element.setAttribute('cx', '240');\n        element.setAttribute('cy', '240');\n        element.setAttribute('r', info.base_radius);\n        parent.appendChild(element);\n        return element;\n      }\n      function setModelPosition(base, is_flipped, model, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('cx', (base.x + coeff * model.x)+'');\n        element.setAttribute('cy', (base.y + coeff * model.y)+'');\n      }\n    }\n  ]);\n"]}