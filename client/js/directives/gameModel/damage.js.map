{"version":3,"sources":["../../../es6/directives/gameModel/damage.js"],"names":[],"mappings":"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","file":"damage.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.directives')\n  .factory('clickGameModelDamage', [\n    'model',\n    function(modelService) {\n      return {\n        create: function clickGameModelDamageCreate(svgNS, info, parent) {\n          var damage_bar_red;\n          var damage_bar_green;\n          if(!(info.damage.type === 'warrior' &&\n               info.damage.n === 1)) {\n            damage_bar_red = document.createElementNS(svgNS, 'line');\n            damage_bar_red.classList.add('model-damage-bar');\n            damage_bar_red.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            damage_bar_red.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_red.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            damage_bar_red.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_red.style.stroke = '#F00';\n            parent.appendChild(damage_bar_red);\n          \n            damage_bar_green = document.createElementNS(svgNS, 'line');\n            damage_bar_green.classList.add('model-damage-bar');\n            damage_bar_green.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            damage_bar_green.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_green.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            damage_bar_green.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_green.style.stroke = '#0F0';\n            parent.appendChild(damage_bar_green);\n          }\n\n          var field_bar_red;\n          var field_bar_green;\n          if(R.exists(info.damage.field)) {\n            field_bar_red = document.createElementNS(svgNS, 'line');\n            field_bar_red.classList.add('model-damage-bar');\n            field_bar_red.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            field_bar_red.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_red.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            field_bar_red.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_red.style.stroke = '#066';\n            parent.appendChild(field_bar_red);\n          \n            field_bar_green = document.createElementNS(svgNS, 'line');\n            field_bar_green.classList.add('model-damage-bar');\n            field_bar_green.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            field_bar_green.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_green.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            field_bar_green.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_green.style.stroke = '#0FF';\n            parent.appendChild(field_bar_green);\n          }\n\n          return [ damage_bar_red, damage_bar_green,\n                   field_bar_red, field_bar_green\n                 ];\n        },\n        update: function clickGameModelDamageUpdate(info, model, img, el) {\n          var damage_bar_red = el[0];\n          var damage_bar_green = el[1];\n          var field_bar_red = el[2];\n          var field_bar_green = el[3];\n          \n          if(R.isNil(damage_bar_red)) return;\n\n          if(info.damage.type === 'none' ||\n             modelService.isWreckDisplayed(model)) {\n            damage_bar_red.style.visibility = 'hidden';\n            damage_bar_green.style.visibility = 'hidden';\n\n            if(R.isNil(field_bar_red)) return;\n\n            field_bar_red.style.visibility = 'hidden';\n            field_bar_green.style.visibility = 'hidden';\n            return;\n          }\n        \n          var min_x = img.width / 2 + info.base_radius;\n          var max_x = img.width / 2 - info.base_radius;\n          var y = img.height / 2 + info.base_radius + 1;\n\n          var percent_damage = model.state.dmg.t / info.damage.total;\n          var damage_x = (max_x-min_x) * (1-percent_damage) + min_x;\n\n          damage_bar_red.setAttribute('x1', max_x + '');\n          damage_bar_red.setAttribute('y1', y + '');\n          damage_bar_red.setAttribute('x2', min_x + '');\n          damage_bar_red.setAttribute('y2', y + '');\n          damage_bar_red.style.visibility = 'visible';\n\n          damage_bar_green.setAttribute('x1', damage_x + '');\n          damage_bar_green.setAttribute('y1', y + '');\n          damage_bar_green.setAttribute('x2', min_x + '');\n          damage_bar_green.setAttribute('y2', y + '');\n          damage_bar_green.style.visibility = 'visible';\n\n          if(R.isNil(field_bar_red)) return;\n\n          var percent_field = model.state.dmg.f / info.damage.field;\n          var field_x = (max_x-min_x) * (1-percent_field) + min_x;\n\n          field_bar_red.setAttribute('x1', max_x + '');\n          field_bar_red.setAttribute('y1', (y+1) + '');\n          field_bar_red.setAttribute('x2', min_x + '');\n          field_bar_red.setAttribute('y2', (y+1) + '');\n          field_bar_red.style.visibility = 'visible';\n          \n          field_bar_green.setAttribute('x1', field_x + '');\n          field_bar_green.setAttribute('y1', (y+1) + '');\n          field_bar_green.setAttribute('x2', min_x + '');\n          field_bar_green.setAttribute('y2', (y+1) + '');\n          field_bar_green.style.visibility = 'visible';\n        },\n      };\n    }\n  ]);\n"]}