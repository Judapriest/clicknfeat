{"version":3,"sources":["terrain.es6"],"names":[],"mappings":";;;;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,qBAAf,EACG,SADH,CACa,kBADb,EACiC,gCADjC,EAEG,SAFH,CAEa,uBAFb,EAEsC,qCAFtC,EADU;;AAKV,mCAAiC,OAAjC,GAA2C,CACzC,SADyC,EAEzC,SAFyC,EAGzC,cAHyC,EAIzC,sBAJyC,CAA3C,CALU;AAWV,WAAS,gCAAT,CAA0C,cAA1C,EAC0C,YAD1C,EAE0C,iBAF1C,EAG0C,yBAH1C,EAGqE;AACnE,WAAO;AACL,gBAAU,GAAV;AACA,YAAM,IAAN;KAFF,CADmE;;AAMnE,aAAS,IAAT,CAAc,KAAd,EAAqB;AACnB,cAAQ,IAAR,CAAa,aAAb,EAA4B,MAAM,OAAN,CAA5B,CADmB;;AAGnB,UAAM,QAAQ,MAAM,OAAN,CAAc,KAAd,CAAoB,KAApB,CAHK;AAInB,YAAM,YAAN,CAAmB,gBAAnB,EACmB,eAAe,QAAf,CAAwB,iBAAxB,EACA,KAFnB,EAJmB;AAOnB,YAAM,YAAN,CAAmB,iBAAnB,EACmB,eAAe,QAAf,CAAwB,OAAxB,EACA,KAFnB,EAPmB;AAUnB,cAVmB;;AAYnB,eAAS,iBAAT,OAA+C;;;YAAnB,oBAAmB;YAAT,kBAAS;;AAC7C,YAAG,CAAC,EAAE,IAAF,CAAO,EAAE,MAAF,CAAS,KAAT,CAAP,EAAwB,MAAxB,CAAD,EAAkC,OAArC;;AAEA,sBAAc,QAAd,EAH6C;OAA/C;AAKA,eAAS,KAAT,GAAiB;AACf,YAAM,WAAW,eAAe,QAAf,CAAwB,QAAxB,CAAiC,MAAjC,EAAX,CADS;AAEf,sBAAc,QAAd,EAFe;;AAIf,YAAM,YAAY,eAAe,QAAf,CAAwB,SAAxB,CAAkC,MAAlC,EAAZ,CAJS;AAKf,yBAAiB,SAAjB,EALe;OAAjB;AAOA,eAAS,aAAT,CAAuB,QAAvB,EAAiC;AAC/B,YAAM,UAAU,kBACP,SADO,CACG,KADH,EACU,QADV,CAAV,CADyB;AAG/B,YAAG,EAAE,KAAF,CAAQ,OAAR,CAAH,EAAqB,OAArB;AACA,cAAM,OAAN,GAAgB,OAAhB,CAJ+B;;AAM/B,gBAAQ,MAAR,GAAiB,aAAa,MAAb,CAAoB,OAApB,CAAjB,CAN+B;;AAQ/B,gBAAQ,IAAR,CAAa,gBAAb,EACa,KADb,EACoB,QAAQ,KAAR,EAAe,QAAQ,MAAR,CADnC,CAR+B;OAAjC;AAWA,eAAS,gBAAT,CAA0B,SAA1B,EAAqC;AACnC,YAAM,QAAQ,0BACL,EADK,CACF,OADE,EACO,KADP,EACc,SADd,CAAR,CAD6B;AAGnC,YAAM,SAAS,0BACN,EADM,CACH,QADG,EACO,KADP,EACc,SADd,CAAT,CAH6B;AAKnC,YAAM,WAAY,SAAS,MAAT,CALiB;AAMnC,cAAM,SAAN,GAAkB;AAChB,iBAAO,KAAP;AACA,kBAAQ,MAAR;AACA,oBAAU,QAAV;SAHF,CANmC;AAWnC,gBAAQ,IAAR,CAAa,mBAAb,EACa,KADb,EACoB,SADpB,EAC+B,MAAM,SAAN,CAD/B,CAXmC;OAArC;KAnCF;GATF;;AA6DA,wCAAsC,OAAtC,GAAgD,EAAhD,CAxEU;AAyEV,WAAS,qCAAT,GAAiD;AAC/C,WAAO;AACL,gBAAU,GAAV;AACA,mBAAa,gDAAb;AACA,aAAO,IAAP;AACA,YAAM,IAAN;KAJF,CAD+C;;AAQ/C,aAAS,IAAT,CAAc,KAAd,EAAqB,SAArB,EAAgC,KAAhC,EAAuC;AACrC,YAAM,IAAN,GAAa,MAAM,qBAAN,CADwB;AAErC,cAAQ,GAAR,CAAY,uBAAZ,EAAqC,MAAM,IAAN,CAArC,CAFqC;KAAvC;GARF;CAzED,CAAD","file":"terrain.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .directive('clickGameTerrain', clickGameTerrainDirectiveFactory)\n    .directive('clickGameTerrainsList', clickGameTerrainsListDirectiveFactory);\n\n  clickGameTerrainDirectiveFactory.$inject = [\n    'appGame',\n    'terrain',\n    'gameTerrains',\n    'gameTerrainSelection',\n  ];\n  function clickGameTerrainDirectiveFactory(appGameService,\n                                            terrainModel,\n                                            gameTerrainsModel,\n                                            gameTerrainSelectionModel) {\n    return {\n      restrict: 'A',\n      link: link\n    };\n\n    function link(scope) {\n      console.warn('gameTerrain', scope.terrain);\n\n      const stamp = scope.terrain.state.stamp;\n      scope.listenSignal(refreshSelection,\n                         appGameService.terrains.selection_changes,\n                         scope);\n      scope.listenSignal(onTerrainsChanges,\n                         appGameService.terrains.changes,\n                         scope);\n      mount();\n\n      function onTerrainsChanges([terrains, stamps]) {\n        if(!R.find(R.equals(stamp), stamps)) return;\n\n        refreshRender(terrains);\n      }\n      function mount() {\n        const terrains = appGameService.terrains.terrains.sample();\n        refreshRender(terrains);\n\n        const selection = appGameService.terrains.selection.sample();\n        refreshSelection(selection);\n      }\n      function refreshRender(terrains) {\n        const terrain = gameTerrainsModel\n                .findStamp(stamp, terrains);\n        if(R.isNil(terrain)) return;\n        scope.terrain = terrain;\n\n        terrain.render = terrainModel.render(terrain);\n\n        console.warn('RENDER TERRAIN',\n                     stamp, terrain.state, terrain.render);\n      }\n      function refreshSelection(selection) {\n        const local = gameTerrainSelectionModel\n                .in('local', stamp, selection);\n        const remote = gameTerrainSelectionModel\n                .in('remote', stamp, selection);\n        const selected = (local || remote);\n        scope.selection = {\n          local: local,\n          remote: remote,\n          selected: selected\n        };\n        console.warn('SELECTION TERRAIN',\n                     stamp, selection, scope.selection);\n      }\n    }\n  }\n\n  clickGameTerrainsListDirectiveFactory.$inject = [];\n  function clickGameTerrainsListDirectiveFactory() {\n    return {\n      restrict: 'A',\n      templateUrl: 'app/components/game/terrain/terrains_list.html',\n      scope: true,\n      link: link\n    };\n\n    function link(scope, _element_, attrs) {\n      scope.type = attrs.clickGameTerrainsList;\n      console.log('clickGameTerrainsList', scope.type);\n    }\n  }\n})();\n"]}