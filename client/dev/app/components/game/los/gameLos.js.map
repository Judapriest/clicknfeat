{"version":3,"sources":["gameLos.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,qBAAf,EACG,SADH,CACa,cADb,EAC6B,uBAD7B,EAEG,SAFH,CAEa,uBAFb,EAEsC,gCAFtC,EADU;;AAKV,0BAAwB,OAAxB,GAAkC,CAChC,OADgC,EAEhC,SAFgC,EAGhC,YAHgC,EAIhC,cAJgC,CAAlC,CALU;AAWV,WAAS,uBAAT,CAAiC,UAAjC,EACiC,YADjC,EAC+C;AAC7C,WAAO;AACL,gBAAU,GAAV;AACA,aAAO,IAAP;AACA,YAAM,IAAN;KAHF,CAD6C;;AAO7C,aAAS,IAAT,CAAc,KAAd,EAAqB;;AAEnB,YAAM,kBAAN,CAAyB,uBAAzB,EAAkD,SAAlD,EAA6D,KAA7D,EAFmB;AAGnB,YAAM,kBAAN,CAAyB,wBAAzB,EAAmD,SAAnD,EAA8D,KAA9D,EAHmB;;AAKnB,eAAS,SAAT,GAAqB;AACnB,YAAM,QAAQ,MAAM,KAAN,CADK;AAEnB,YAAM,MAAM,MAAM,IAAN,CAAW,GAAX,CAFO;AAGnB,YAAM,cAAc,WACX,eADW,CACK,MAAM,KAAN,CADL,KACsB,KADtB,CAHD;AAKnB,cAAM,MAAN,GAAe,aACZ,MADY,CACL,EAAE,wBAAF;AACE,oBAAU,MAAM,QAAN;AACV,kBAAQ,MAAM,IAAN,CAAW,MAAX,EAHL,EAG0B,GAH1B,CAAf,CALmB;AASnB,cAAM,OAAN,GATmB;OAArB;KALF;GARF;;AA2BA,mCAAiC,OAAjC,GAA2C,CACzC,SADyC,CAA3C,CAtCU;AAyCV,WAAS,gCAAT,CAA0C,YAA1C,EAAwD;AACtD,WAAO;AACL,gBAAU,GAAV;AACA,aAAO,IAAP;AACA,YAAM,IAAN;KAHF,CADsD;AAMtD,aAAS,IAAT,CAAc,KAAd,EAAqB;AACnB,YAAM,kBAAN,CAAyB,wBAAzB,EAAmD,cAAnD,EAAmE,KAAnE,EADmB;AAEnB,eAAS,cAAT,GAA0B;AACxB,YAAM,QAAQ,MAAM,KAAN,CADU;AAExB,YAAM,MAAM,MAAM,IAAN,CAAW,GAAX,CAFY;AAGxB,cAAM,MAAN,GAAe,aAAa,eAAb,CAA6B,KAA7B,EAAoC,GAApC,CAAf,CAHwB;AAIxB,YAAM,YAAY,SAAS,aAAT,CAAuB,mBAAvB,CAAZ,CAJkB;AAKxB,kBAAU,YAAV,CAAuB,QAAvB,EAAiC,MAAM,MAAN,CAAa,SAAb,CAAjC,CALwB;AAMxB,cAAM,OAAN,GANwB;OAA1B;KAFF;GANF;CAzCD,CAAD","file":"gameLos.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .directive('clickGameLos', gameLosDirectiveFactory)\n    .directive('clickGameLosEnveloppe', gameLosEnveloppeDirectiveFactory);\n\n  gameLosDirectiveFactory.$inject = [\n    'modes',\n    'gameLos',\n    'gameModels',\n    'gameFactions',\n  ];\n  function gameLosDirectiveFactory(modesModel,\n                                   gameLosModel) {\n    return {\n      restrict: 'A',\n      scope: true,\n      link: link\n    };\n\n    function link(scope) {\n      // const map = document.getElementById('map');\n      scope.onStateChangeEvent('Game.los.local.change', updateLos, scope);\n      scope.onStateChangeEvent('Game.los.remote.change', updateLos, scope);\n\n      function updateLos() {\n        const state = scope.state;\n        const los = state.game.los;\n        const in_los_mode = modesModel\n                .currentModeName(state.modes) === 'Los';\n        scope.render = gameLosModel\n          .render({ in_los_mode,\n                    factions: state.factions,\n                    models: state.game.models }, los);\n        scope.$digest();\n      }\n    }\n  }\n\n  gameLosEnveloppeDirectiveFactory.$inject = [\n    'gameLos'\n  ];\n  function gameLosEnveloppeDirectiveFactory(gameLosModel) {\n    return {\n      restrict: 'A',\n      scope: true,\n      link: link\n    };\n    function link(scope) {\n      scope.onStateChangeEvent('Game.los.remote.change', updateEnvelope, scope);\n      function updateEnvelope() {\n        const state = scope.state;\n        const los = state.game.los;\n        scope.render = gameLosModel.renderEnveloppe(state, los);\n        const clip_path = document.querySelector('#los-clip polygon');\n        clip_path.setAttribute('points', scope.render.enveloppe);\n        scope.$digest();\n      }\n    }\n  }\n})();\n"]}