{"version":3,"sources":["createModel.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,qBAAf,EACG,SADH,CACa,sBADb,EACqC,+BADrC,EADU;;AAIV,kCAAgC,OAAhC,GAA0C,CACxC,YADwC,EAExC,SAFwC,EAGxC,OAHwC,CAA1C,CAJU;AASV,WAAS,+BAAT,CAAyC,UAAzC,EACyC,cADzC,EAEyC,UAFzC,EAEqD;AACnD,WAAO;AACL,gBAAU,GAAV;AACA,YAAM,IAAN;KAFF,CADmD;;AAMnD,aAAS,IAAT,CAAc,KAAd,EAAqB;AACnB,cAAQ,GAAR,CAAY,kBAAZ,EADmB;;AAGnB,wBAAkB,KAAlB,EAHmB;AAInB,iBAAW,kBAAX,CAA8B,oBAA9B,EAAoD,mBAApD,EAAyE,KAAzE,EAJmB;;AAMnB,eAAS,mBAAT,GAA+B;AAC7B,0BAAkB,KAAlB,EAD6B;AAE7B,cAAM,OAAN,GAF6B;OAA/B;KANF;;AAYA,aAAS,iBAAT,CAA2B,KAA3B,EAAkC;AAChC,UAAM,QAAQ,WAAW,KAAX,CADkB;AAEhC,UAAM,SAAS,MAAM,MAAN,CAFiB;AAGhC,UAAG,EAAE,KAAF,CAAQ,OAAO,IAAP,CAAX,EAAyB,OAAzB;AACA,UAAM,QAAQ,MAAM,KAAN,CAJkB;;AAMhC,UAAM,MAAM,SAAS,cAAT,CAAwB,KAAxB,CAAN,CAN0B;AAOhC,UAAM,aAAa,eAAe,SAAf,CAAyB,GAAzB,CAAb,CAP0B;AAQhC,UAAM,QAAQ,aAAa,CAAC,CAAD,GAAK,CAAlB,CARkB;;AAUhC,YAAM,GAAN,GAAY,WAAW,MAAX,CAAkB,EAAC,sBAAD,EAAlB,EAAgC,MAAM,QAAN,EAAgB,EAAE,MAAF,CAAS,KAAT,EAC1D,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,MAAN,CAAa,IAAb,CAAkB,CAAlB,GAAsB,QAAQ,MAAM,CAAN,CADe,EAE1D,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,MAAN,CAAa,IAAb,CAAkB,CAAlB,GAAsB,QAAQ,MAAM,CAAN,CAFe,CAAhD,CAAZ,CAVgC;AAchC,cAAQ,IAAR,CAAa,oBAAb,EAAmC,MAAM,GAAN,CAAnC,CAdgC;KAAlC;GApBF;CATD,CAAD","file":"createModel.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .directive('clickGameCreateModel', gameCreateModelDirectiveFactory);\n\n  gameCreateModelDirectiveFactory.$inject = [\n    '$rootScope',\n    'gameMap',\n    'model',\n  ];\n  function gameCreateModelDirectiveFactory($rootScope,\n                                           gameMapService,\n                                           modelModel) {\n    return {\n      restrict: 'A',\n      link: link\n    };\n\n    function link(scope) {\n      console.log('clickCreateModel');\n\n      updateCreateModel(scope);\n      $rootScope.onStateChangeEvent('Create.base.change', onUpdateCreateModel, scope);\n\n      function onUpdateCreateModel() {\n        updateCreateModel(scope);\n        scope.$digest();\n      }\n    }\n\n    function updateCreateModel(scope) {\n      const state = $rootScope.state;\n      const create = state.create;\n      if(R.isNil(create.base)) return;\n      const model = scope.model;\n\n      const map = document.getElementById('map');\n      const is_flipped = gameMapService.isFlipped(map);\n      const coeff = is_flipped ? -1 : 1;\n\n      scope.pos = modelModel.render({is_flipped}, state.factions, R.thread(model)(\n        R.assoc('x', state.create.base.x + coeff * model.x),\n        R.assoc('y', state.create.base.y + coeff * model.y)\n      ));\n      console.warn('createModel.update', scope.pos);\n    }\n  }\n})();\n"]}