{"version":3,"sources":["gameChatBox.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,qBAAf,EACG,UADH,CACc,iBADd,EACiC,eADjC,EAEG,SAFH,CAEa,kBAFb,EAEiC,2BAFjC,EADU;;AAKV,kBAAgB,OAAhB,GAA0B,CACxB,QADwB,EAExB,MAFwB,CAA1B,CALU;AASV,WAAS,eAAT,CAAyB,MAAzB,EACyB,SADzB,EACoC;AAClC,QAAM,KAAK,IAAL,CAD4B;AAElC,YAAQ,GAAR,CAAY,iBAAZ,EAFkC;;AAIlC,OAAG,iBAAH,GAAuB,iBAAvB,CAJkC;;AAMlC,eANkC;;AAQlC,aAAS,QAAT,GAAoB;AAClB,SAAG,GAAH,GAAS,EAAT,CADkB;AAElB,aAAO,kBAAP,CAA0B,WAA1B,EAAuC,UAAvC,EAAmD,MAAnD,EAFkB;AAGlB,aAAO,kBAAP,CAA0B,aAA1B,EAAyC,UAAzC,EAAqD,MAArD,EAHkB;AAIlB,WAAK,MAAL,CAAY,qBAAZ,CAAkC,UAAlC,EAJkB;KAApB;AAMA,aAAS,UAAT,GAAsB;AACpB,SAAG,IAAH,GAAU,EAAE,KAAF,CAAQ,EAAE,IAAF,CAAO,CAAC,MAAD,EAAQ,MAAR,CAAP,EAAwB,OAAO,KAAP,CAAhC,CAAV,CADoB;AAEpB,aAAO,OAAP,GAFoB;KAAtB;AAIA,aAAS,iBAAT,GAA6B;AAC3B,UAAM,MAAM,EAAE,IAAF,CAAO,GAAG,GAAH,CAAb,CADqB;AAE3B,UAAG,EAAE,OAAF,CAAU,GAAV,CAAH,EAAmB,OAAnB;;AAEA,QAAE,OAAF,CAAU,OAAO,KAAP,CAAa,IAAb,CAAV,CACE,UAAU,UAAV,CAAqB,EAAE,IAAF,CAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,MAAlB,CAAP,EAAkC,OAAO,KAAP,CAAvD,EACqB,GADrB,CADF,EAGE,YAAM;AACJ,WAAG,GAAH,GAAS,EAAT,CADI;AAEJ,eAAO,OAAP,GAFI;OAAN,CAHF,CAJ2B;KAA7B;GAnBF;;AAkCA,8BAA4B,OAA5B,GAAsC,EAAtC,CA3CU;AA4CV,WAAS,2BAAT,GAAuC;AACrC,WAAO;AACL,gBAAU,GAAV;AACA,mBAAa,iDAAb;AACA,aAAO,IAAP;AACA,kBAAY,iBAAZ;AACA,oBAAc,WAAd;AACA,YAAM,gBAAM,EAAN;KANR,CADqC;GAAvC;CA5CD,CAAD","file":"gameChatBox.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .controller('gameChatBoxCtrl', gameChatBoxCtrl)\n    .directive('clickGameChatBox', gameChatBoxDirectiveFactory);\n\n  gameChatBoxCtrl.$inject = [\n    '$scope',\n    'game',\n  ];\n  function gameChatBoxCtrl($scope,\n                           gameModel) {\n    const vm = this;\n    console.log('gameChatBoxCtrl');\n\n    vm.doSendChatMessage = doSendChatMessage;\n\n    activate();\n\n    function activate() {\n      vm.msg = '';\n      $scope.onStateChangeEvent('Game.chat', updateChat, $scope);\n      $scope.onStateChangeEvent('Game.loaded', updateChat, $scope);\n      self.window.requestAnimationFrame(updateChat);\n    }\n    function updateChat() {\n      vm.chat = R.clone(R.path(['game','chat'], $scope.state));\n      $scope.$digest();\n    }\n    function doSendChatMessage() {\n      const msg = s.trim(vm.msg);\n      if(R.isEmpty(msg)) return;\n\n      R.threadP($scope.state.game)(\n        gameModel.sendChatP$(R.path(['user', 'state', 'name'], $scope.state),\n                             msg),\n        () => {\n          vm.msg = '';\n          $scope.$digest();\n        }\n      );\n    }\n  }\n\n  gameChatBoxDirectiveFactory.$inject = [];\n  function gameChatBoxDirectiveFactory() {\n    return {\n      restrict: 'E',\n      templateUrl: 'app/components/game/chat_box/game_chat_box.html',\n      scope: true,\n      controller: 'gameChatBoxCtrl',\n      controllerAs: 'game_chat',\n      link: () => { }\n    };\n  }\n})();\n"]}