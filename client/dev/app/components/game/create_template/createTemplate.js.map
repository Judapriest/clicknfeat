{"version":3,"sources":["createTemplate.es6"],"names":[],"mappings":"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","file":"createTemplate.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .directive('clickGameCreateTemplate', gameCreateTemplateDirectiveFactory);\n\n  gameCreateTemplateDirectiveFactory.$inject = [\n    'gameMap',\n  ];\n  function gameCreateTemplateDirectiveFactory(gameMapService) {\n    const templates = {\n      aoe: {\n        create: createAoE,\n        setPosition: setAoEPosition\n      },\n      spray: {\n        create: createSpray,\n        setPosition: setSprayPosition\n      },\n      wall: {\n        create: createWall,\n        setPosition: setWallPosition\n      }\n    };\n    const gameCreateTemplateDirective = {\n      restrict: 'A',\n      link: link\n    };\n    return gameCreateTemplateDirective;\n\n    function link(scope, parent) {\n      const map = document.getElementById('map');\n      const svgNS = map.namespaceURI;\n\n      console.log('clickCreateTemplate', scope.index);\n      const state = scope.state;\n      const template = R.nth(scope.index, state.create.templates);\n      const type = template.type;\n\n      const element = templates[type].create(document, svgNS, parent[0]);\n      const is_flipped = gameMapService.isFlipped(map);\n      templates[type].setPosition(state.create.base,\n                                  is_flipped, template, element);\n\n      scope.onStateChangeEvent('Game.create.update', onUpdate, scope);\n\n      function onUpdate() {\n        if(R.isNil(R.path(['create','templates'], state))) return;\n\n        const is_flipped = gameMapService.isFlipped(map);\n        templates[type].setPosition(state.create.base,\n                                    is_flipped, template, element);\n      }\n    }\n    function createAoE(document, svgNS, parent) {\n      const aoe = document.createElementNS(svgNS, 'circle');\n      aoe.classList.add('create-template-aoe');\n      aoe.setAttribute('cx', '240');\n      aoe.setAttribute('cy', '240');\n      aoe.setAttribute('r', '15');\n      parent.appendChild(aoe);\n      return aoe;\n    }\n    function setAoEPosition(base, is_flipped, template, element) {\n      const coeff = is_flipped ? -1 : 1;\n      element.setAttribute('cx', (base.x + coeff * template.x)+'');\n      element.setAttribute('cy', (base.y + coeff * template.y)+'');\n    }\n    function createSpray(document, svgNS, parent) {\n      const sp = document.createElementNS(svgNS, 'polygon');\n      sp.classList.add('create-template-spray');\n      sp.setAttribute('points', '8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0');\n      sp.setAttribute('transform', 'translate(230,240)');\n      parent.appendChild(sp);\n      return sp;\n    }\n    function setSprayPosition(base, is_flipped, template, element) {\n      const coeff = is_flipped ? -1 : 1;\n      element.setAttribute('transform', [\n        'translate(',\n        (base.x + coeff * template.x)-10,\n        ',',\n        (base.y + coeff * template.y),\n        ')',\n      ].join(''));\n    }\n    function createWall(document, svgNS, parent) {\n      const wall = document.createElementNS(svgNS, 'rect');\n      wall.classList.add('create-template-wall');\n      wall.setAttribute('x', '220');\n      wall.setAttribute('y', '236.25');\n      wall.setAttribute('width', '40');\n      wall.setAttribute('height', '7.5');\n      parent.appendChild(wall);\n      return wall;\n    }\n    function setWallPosition(base, is_flipped, template, element) {\n      var coeff = is_flipped ? -1 : 1;\n      element.setAttribute('x', ((base.x + coeff * template.x)-20)+'');\n      element.setAttribute('y', ((base.y + coeff * template.y)-3.75)+'');\n    }\n  }\n})();\n"]}