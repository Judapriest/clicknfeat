{"version":3,"sources":["createTemplate.es6"],"names":[],"mappings":"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","file":"createTemplate.js","sourcesContent":["angular.module('clickApp.directives')\n  .directive('clickGameCreateTemplate', [\n    'gameMap',\n    function(gameMapService) {\n      var templates = {};\n      return {\n        restrict: 'A',\n        link: function(scope, parent) {\n          var map = document.getElementById('map');\n          var svgNS = map.namespaceURI;\n\n          templates['aoe'] = {\n            create: createAoE,\n            setPosition: setAoEPosition\n          };\n          templates['spray'] = {\n            create: createSpray,\n            setPosition: setSprayPosition\n          };\n          templates['wall'] = {\n            create: createWall,\n            setPosition: setWallPosition\n          };\n\n          console.log('clickCreateTemplate', scope.index);\n          let state = scope.state;\n          let template = R.nth(scope.index, state.create.template.templates);\n          let type = template.type;\n\n          let element = templates[type].create(document, svgNS, parent[0]);\n          let is_flipped = gameMapService.isFlipped(map);\n          templates[type].setPosition(state.create.template.base, is_flipped, template, element);\n\n          scope.onStateChangeEvent('Game.create.update', () => {\n            if(R.isNil(R.path(['create','template'], state))) return;\n\n            is_flipped = gameMapService.isFlipped(map);\n            templates[type].setPosition(state.create.template.base, is_flipped, template, element);\n          }, scope);\n        }\n      };\n      function createAoE(document, svgNS, parent) {\n        var aoe = document.createElementNS(svgNS, 'circle');\n        aoe.classList.add('create-template-aoe');\n        aoe.setAttribute('cx', '240');\n        aoe.setAttribute('cy', '240');\n        aoe.setAttribute('r', '15');\n        parent.appendChild(aoe);\n        return aoe;\n      }\n      function setAoEPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('cx', (base.x + coeff * template.x)+'');\n        element.setAttribute('cy', (base.y + coeff * template.y)+'');\n      }\n      function createSpray(document, svgNS, parent) {\n        var sp = document.createElementNS(svgNS, 'polygon');\n        sp.classList.add('create-template-spray');\n        sp.setAttribute('points', '8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0');\n        sp.setAttribute('transform', 'translate(230,240)');\n        parent.appendChild(sp);\n        return sp;\n      }\n      function setSprayPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('transform', [\n          'translate(',\n          (base.x + coeff * template.x)-10,\n          ',',\n          (base.y + coeff * template.y),\n          ')',\n        ].join(''));\n      }\n      function createWall(document, svgNS, parent) {\n        var wall = document.createElementNS(svgNS, 'rect');\n        wall.classList.add('create-template-wall');\n        wall.setAttribute('x', '220');\n        wall.setAttribute('y', '236.25');\n        wall.setAttribute('width', '40');\n        wall.setAttribute('height', '7.5');\n        parent.appendChild(wall);\n        return wall;\n      }\n      function setWallPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('x', ((base.x + coeff * template.x)-20)+'');\n        element.setAttribute('y', ((base.y + coeff * template.y)-3.75)+'');\n      }\n    }\n  ]);\n"]}