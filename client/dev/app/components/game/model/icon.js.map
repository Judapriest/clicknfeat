{"version":3,"sources":["icon.es6"],"names":[],"mappings":"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","file":"icon.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .factory('clickGameModelIcon', gameModelIconModelFactory);\n\n  gameModelIconModelFactory.$inject = [\n    'model',\n  ];\n  function gameModelIconModelFactory(modelService) {\n    const EFFECTS = [\n      [ 'b' , '/data/icons/Blind.png'      ],\n      [ 'c' , '/data/icons/Corrosion.png'  ],\n      [ 'd' , '/data/icons/BoltBlue.png'   ],\n      [ 'f' , '/data/icons/Fire.png'       ],\n      [ 'e' , '/data/icons/BoltYellow.png' ],\n      [ 'k' , '/data/icons/KD.png'         ],\n      [ 't' , '/data/icons/Stationary.png' ],\n    ];\n\n    return {\n      create: gameModelIconsCreate,\n      update: gameModelIconsUpdate\n    };\n\n    function gameModelIconsCreate(svgNS, parent) {\n      const effects = R.reduce((mem, effect) => {\n        const image = document.createElementNS(svgNS, 'image');\n        image.classList.add('model-image');\n        image.setAttribute('x', '0');\n        image.setAttribute('y', '0');\n        image.setAttribute('width', '10');\n        image.setAttribute('height', '10');\n        image.setAttributeNS('http://www.w3.org/1999/xlink', 'href', effect[1]);\n        image.style.visibility = 'hidden';\n        parent.appendChild(image);\n        return R.assoc(effect[0], image, mem);\n      }, {}, EFFECTS);\n\n      const leader = document.createElementNS(svgNS, 'image');\n      leader.classList.add('model-image');\n      leader.setAttribute('x', '0');\n      leader.setAttribute('y', '0');\n      leader.setAttribute('width', '10');\n      leader.setAttribute('height', '10');\n      leader.setAttributeNS('http://www.w3.org/1999/xlink', 'href', '/data/icons/Leader.png');\n      parent.appendChild(leader);\n\n      const lock = document.createElementNS(svgNS, 'image');\n      lock.classList.add('model-image');\n      lock.setAttribute('x', '0');\n      lock.setAttribute('y', '0');\n      lock.setAttribute('width', '10');\n      lock.setAttribute('height', '10');\n      lock.setAttributeNS('http://www.w3.org/1999/xlink',\n                          'href', '/data/icons/Lock.png');\n      lock.style.visibility = 'visible';\n      parent.appendChild(lock);\n\n      return [ effects, leader, lock ];\n    }\n    function gameModelIconsUpdate(info, model, img, element) {\n      const [ effects, leader, lock ] = element;\n\n      R.thread(effects)(\n        R.keys,\n        R.filter((effect) => modelService.isEffectDisplayed(effect, model)),\n        (actives) => {\n          const base_x = img.width / 2 - (R.length(actives) * 10 / 2);\n          const base_y = img.height / 2 + info.base_radius + 1;\n          R.addIndex(R.forEach)((effect, i) => {\n            effects[effect].setAttribute('x', (base_x + i * 10)+'');\n            effects[effect].setAttribute('y', (base_y)+'');\n            effects[effect].style.visibility = 'visible';\n          }, actives);\n        }\n      );\n      R.thread(effects)(\n        R.keys,\n        R.reject((effect) => modelService.isEffectDisplayed(effect, model)),\n        R.forEach((effect) => {\n          effects[effect].style.visibility = 'hidden';\n        })\n      );\n\n      leader.setAttribute('x', (img.width / 2 - 0.7 * info.base_radius - 5)+'');\n      leader.setAttribute('y', (img.height / 2 - 0.7 * info.base_radius - 5)+'');\n      if(modelService.isLeaderDisplayed(model)) {\n        leader.style.visibility = 'visible';\n      }\n      else {\n        leader.style.visibility = 'hidden';\n      }\n\n      if(!modelService.isLocked(model)) {\n        lock.style.visibility = 'hidden';\n        return;\n      }\n      lock.setAttribute('x', (img.width/2+info.base_radius-5)+'');\n      lock.setAttribute('y', (img.height/2-5)+'');\n      lock.style.visibility = 'visible';\n    }\n  }\n})();\n"]}