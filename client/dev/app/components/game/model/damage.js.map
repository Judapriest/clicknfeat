{"version":3,"sources":["damage.es6"],"names":[],"mappings":"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","file":"damage.js","sourcesContent":["angular.module('clickApp.directives')\n  .factory('clickGameModelDamage', [\n    'model',\n    function(modelService) {\n      return {\n        create: function clickGameModelDamageCreate(svgNS, info, parent) {\n          let damage_bar_red;\n          let damage_bar_green;\n          if(!(info.damage.type === 'warrior' &&\n               info.damage.n === 1)) {\n            damage_bar_red = document.createElementNS(svgNS, 'line');\n            damage_bar_red.classList.add('model-damage-bar');\n            damage_bar_red.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            damage_bar_red.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_red.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            damage_bar_red.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_red.style.stroke = '#F00';\n            parent.appendChild(damage_bar_red);\n\n            damage_bar_green = document.createElementNS(svgNS, 'line');\n            damage_bar_green.classList.add('model-damage-bar');\n            damage_bar_green.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            damage_bar_green.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_green.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            damage_bar_green.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            damage_bar_green.style.stroke = '#0F0';\n            parent.appendChild(damage_bar_green);\n          }\n\n          let field_bar_red;\n          let field_bar_green;\n          if(R.exists(info.damage.field)) {\n            field_bar_red = document.createElementNS(svgNS, 'line');\n            field_bar_red.classList.add('model-damage-bar');\n            field_bar_red.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            field_bar_red.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_red.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            field_bar_red.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_red.style.stroke = '#066';\n            parent.appendChild(field_bar_red);\n\n            field_bar_green = document.createElementNS(svgNS, 'line');\n            field_bar_green.classList.add('model-damage-bar');\n            field_bar_green.setAttribute('x1', (info.img[0].width/2-info.base_radius)+'');\n            field_bar_green.setAttribute('y1', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_green.setAttribute('x2', (info.img[0].width/2+info.base_radius)+'');\n            field_bar_green.setAttribute('y2', (info.img[0].height/2+info.base_radius+2)+'');\n            field_bar_green.style.stroke = '#0FF';\n            parent.appendChild(field_bar_green);\n          }\n\n          return [ damage_bar_red, damage_bar_green,\n                   field_bar_red, field_bar_green\n                 ];\n        },\n        update: function clickGameModelDamageUpdate(info, model, img, element) {\n          let [ damage_bar_red, damage_bar_green,\n                field_bar_red, field_bar_green\n              ] = element;\n\n          if(R.isNil(damage_bar_red)) return;\n\n          if(info.damage.type === 'none' ||\n             modelService.isWreckDisplayed(model)) {\n            damage_bar_red.style.visibility = 'hidden';\n            damage_bar_green.style.visibility = 'hidden';\n\n            if(R.isNil(field_bar_red)) return;\n\n            field_bar_red.style.visibility = 'hidden';\n            field_bar_green.style.visibility = 'hidden';\n            return;\n          }\n\n          let min_x = img.width / 2 + info.base_radius;\n          let max_x = img.width / 2 - info.base_radius;\n          let y = img.height / 2 + info.base_radius + 1;\n\n          let percent_damage = model.state.dmg.t / info.damage.total;\n          let damage_x = (max_x-min_x) * (1-percent_damage) + min_x;\n\n          damage_bar_red.setAttribute('x1', max_x + '');\n          damage_bar_red.setAttribute('y1', y + '');\n          damage_bar_red.setAttribute('x2', min_x + '');\n          damage_bar_red.setAttribute('y2', y + '');\n          damage_bar_red.style.visibility = 'visible';\n\n          damage_bar_green.setAttribute('x1', damage_x + '');\n          damage_bar_green.setAttribute('y1', y + '');\n          damage_bar_green.setAttribute('x2', min_x + '');\n          damage_bar_green.setAttribute('y2', y + '');\n          damage_bar_green.style.visibility = 'visible';\n\n          if(R.isNil(field_bar_red)) return;\n\n          let percent_field = model.state.dmg.f / info.damage.field;\n          let field_x = (max_x-min_x) * (1-percent_field) + min_x;\n\n          field_bar_red.setAttribute('x1', max_x + '');\n          field_bar_red.setAttribute('y1', (y+1) + '');\n          field_bar_red.setAttribute('x2', min_x + '');\n          field_bar_red.setAttribute('y2', (y+1) + '');\n          field_bar_red.style.visibility = 'visible';\n\n          field_bar_green.setAttribute('x1', field_x + '');\n          field_bar_green.setAttribute('y1', (y+1) + '');\n          field_bar_green.setAttribute('x2', min_x + '');\n          field_bar_green.setAttribute('y2', (y+1) + '');\n          field_bar_green.style.visibility = 'visible';\n        }\n      };\n    }\n  ]);\n"]}