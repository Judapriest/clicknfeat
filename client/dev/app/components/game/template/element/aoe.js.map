{"version":3,"sources":["aoe.es6"],"names":[],"mappings":"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","file":"aoe.js","sourcesContent":["(function() {\n  angular.module('clickApp.directives')\n    .factory('aoeTemplateElement', aoeTemplateElementModelFactory);\n\n  aoeTemplateElementModelFactory.$inject = [\n    'template',\n    'gameTemplateSelection',\n    'gameMap',\n    'labelElement',\n  ];\n  function aoeTemplateElementModelFactory(templateModel,\n                                          gameTemplateSelectionModel,\n                                          gameMapService,\n                                          labelElementModel) {\n    const aoeTemplateElementModel = {\n      create: aoeTemplateElementModelCreate,\n      cleanup: () => {},\n      update: aoeTemplateElementModelUpdate\n    };\n    R.curryService(aoeTemplateElementModel);\n    return aoeTemplateElementModel;\n\n    function aoeTemplateElementModelCreate(svgNS, parent, aoe) {\n      const circle = document.createElementNS(svgNS, 'circle');\n      circle.classList.add('template');\n      circle.classList.add('aoe');\n      circle.setAttribute('data-stamp', aoe.state.stamp);\n      parent.appendChild(circle);\n\n      const line = document.createElementNS(svgNS, 'line');\n      line.classList.add('template-aoe-direction');\n      line.style['marker-end'] = 'url(#aoe-direction-end)';\n      parent.appendChild(line);\n\n      const label = labelElementModel.create(svgNS, parent);\n\n      return { aoe: circle,\n               dir: line,\n               label: label\n             };\n    }\n    function aoeTemplateElementModelUpdate(map, state, template, aoe) {\n      const selection = state.game.template_selection;\n      const local = gameTemplateSelectionModel\n              .in('local', template.state.stamp, selection);\n      const remote = gameTemplateSelectionModel\n              .in('remote', template.state.stamp, selection);\n      const selected = (local || remote);\n\n      const map_flipped = gameMapService.isFlipped(map);\n      const zoom_factor = gameMapService.zoomFactor(map);\n      const label_flip_center = template.state;\n      const label_text_center = { x: template.state.x,\n                                  y: template.state.y + template.state.s + 5\n                                };\n      const label_text = templateModel.fullLabel(template);\n\n      if(selected) aoe.container.classList.add('selection');\n      else aoe.container.classList.remove('selection');\n      if(local) aoe.container.classList.add('local');\n      else aoe.container.classList.remove('local');\n      if(remote) aoe.container.classList.add('remote');\n      else aoe.container.classList.remove('remote');\n\n      updateAoe(template, aoe.aoe);\n      updateDir(template, aoe.dir);\n      labelElementModel.update(map_flipped,\n                               zoom_factor,\n                               label_flip_center,\n                               label_text_center,\n                               label_text,\n                               aoe.label);\n    }\n    function updateAoe(template, aoe) {\n      aoe.setAttribute('cx', template.state.x+'');\n      aoe.setAttribute('cy', template.state.y+'');\n      aoe.setAttribute('r', template.state.s+'');\n    }\n    function updateDir(template, dir) {\n      dir.setAttribute('x1', template.state.x+'');\n      dir.setAttribute('y1', template.state.y+'');\n      dir.setAttribute('x2', template.state.x+'');\n      dir.setAttribute('y2', (template.state.y-template.state.s)+'');\n      dir.setAttribute('transform', ('rotate('+\n                                     template.state.r+','+\n                                     template.state.x+','+\n                                     template.state.y+\n                                     ')'\n                                    ));\n    }\n  }\n})();\n"]}