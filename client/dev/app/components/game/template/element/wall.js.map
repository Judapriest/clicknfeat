{"version":3,"sources":["wall.es6"],"names":[],"mappings":"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","file":"wall.js","sourcesContent":["(function() {\n\n  angular.module('clickApp.directives')\n    .factory('wallTemplateElement', wallTemplateElementModelFactory);\n\n  wallTemplateElementModelFactory.$inject = [\n    'template',\n    'gameTemplateSelection',\n    'gameMap',\n    'labelElement',\n  ];\n  function wallTemplateElementModelFactory(templateModel,\n                                           gameTemplateSelectionModel,\n                                           gameMapService,\n                                           labelElementModel) {\n    const wallTemplateElementModel = {\n      create: wallTemplateElementModelCreate,\n      cleanup: () => {},\n      update: wallTemplateElementModelUpdate\n    };\n    return wallTemplateElementModel;\n\n    function wallTemplateElementModelCreate(svgNS, parent, template) {\n      const group = document.createElementNS(svgNS, 'g');\n      parent.appendChild(group);\n\n      const rect = document.createElementNS(svgNS, 'rect');\n      rect.classList.add('template');\n      rect.classList.add('wall');\n      rect.setAttribute('width', '40');\n      rect.setAttribute('height', '7.5');\n      rect.setAttribute('data-stamp', template.state.stamp);\n      group.appendChild(rect);\n\n      const label = labelElementModel.create(svgNS, group);\n\n      return { container: group,\n               wall: rect,\n               label: label\n             };\n    }\n    function wallTemplateElementModelUpdate(map, state, template, wall) {\n      const selection = state.game.template_selection;\n      const local = gameTemplateSelectionModel\n              .in('local', template.state.stamp, selection);\n      const remote = gameTemplateSelectionModel\n              .in('remote', template.state.stamp, selection);\n      const selected = (local || remote);\n\n      const map_flipped = gameMapService.isFlipped(map);\n      const zoom_factor = gameMapService.zoomFactor(map);\n      const label_flip_center = template.state;\n      const label_text_center = { x: template.state.x,\n                                  y: template.state.y+2\n                                };\n      const label_text = templateModel.fullLabel(template);\n\n      updateWall(template, wall.wall);\n      updateContainer(selected, local, remote, template, wall.container);\n      labelElementModel.update(map_flipped,\n                               zoom_factor,\n                               label_flip_center,\n                               label_text_center,\n                               label_text,\n                               wall.label);\n    }\n    function updateWall(template, wall) {\n      wall.setAttribute('x', (template.state.x-20)+'');\n      wall.setAttribute('y', (template.state.y-3.75)+'');\n    }\n    function updateContainer(selected, local, remote, template, container) {\n      if(selected) container.classList.add('selection');\n      else container.classList.remove('selection');\n      if(local) container.classList.add('local');\n      else container.classList.remove('local');\n      if(remote) container.classList.add('remote');\n      else container.classList.remove('remote');\n\n      container.setAttribute('transform', ('rotate('+\n                                           template.state.r+','+\n                                           template.state.x+','+\n                                           template.state.y+\n                                           ')'\n                                          ));\n    }\n  }\n})();\n"]}