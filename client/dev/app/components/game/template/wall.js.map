{"version":3,"sources":["wall.es6"],"names":[],"mappings":"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","file":"wall.js","sourcesContent":["angular.module('clickApp.directives')\n  .factory('wallTemplateElement', [\n    'template',\n    'gameTemplateSelection',\n    'gameMap',\n    'labelElement',\n    function(templateService,\n             gameTemplateSelectionService,\n             gameMapService,\n             labelElementService) {\n      var wallTemplateElementService = {\n        create: function wallTemplateElementServiceCreate(svgNS, parent, template) {\n          var group = document.createElementNS(svgNS, 'g');\n          parent.appendChild(group);\n\n          var rect = document.createElementNS(svgNS, 'rect');\n          rect.classList.add('template');\n          rect.classList.add('wall');\n          rect.setAttribute('width', '40');\n          rect.setAttribute('height', '7.5');\n          rect.setAttribute('data-stamp', template.state.stamp);\n          group.appendChild(rect);\n\n          var label = labelElementService.create(svgNS, group);\n\n          return { container: group,\n                   wall: rect,\n                   label: label\n                 };\n        },\n        update: function wallTemplateElementUpdate(map, state, template, wall) {\n          var selection = state.game.template_selection;\n          var local = gameTemplateSelectionService\n                .in('local', template.state.stamp, selection);\n          var remote = gameTemplateSelectionService\n                .in('remote', template.state.stamp, selection);\n          var selected = (local || remote);\n\n          var map_flipped = gameMapService.isFlipped(map);\n          var zoom_factor = gameMapService.zoomFactor(map);\n          var label_flip_center = template.state;\n          var label_text_center = { x: template.state.x,\n                                    y: template.state.y+2\n                                  };\n          var label_text = templateService.fullLabel(template);\n\n          updateWall(template, wall.wall);\n          updateContainer(selected, local, remote, template, wall.container);\n          labelElementService.update(map_flipped,\n                                     zoom_factor,\n                                     label_flip_center,\n                                     label_text_center,\n                                     label_text,\n                                     wall.label);\n        }\n      };\n      function updateWall(template, wall) {\n        wall.setAttribute('x', (template.state.x-20)+'');\n        wall.setAttribute('y', (template.state.y-3.75)+'');\n      }\n      function updateContainer(selected, local, remote, template, container) {\n        if(selected) container.classList.add('selection');\n        else container.classList.remove('selection');\n        if(local) container.classList.add('local');\n        else container.classList.remove('local');\n        if(remote) container.classList.add('remote');\n        else container.classList.remove('remote');\n\n        container.setAttribute('transform', ('rotate('+\n                                             template.state.r+','+\n                                             template.state.x+','+\n                                             template.state.y+\n                                             ')'\n                                            ));\n      }\n      return wallTemplateElementService;\n    }\n  ]);\n"]}