{"version":3,"sources":["template.es6"],"names":[],"mappings":";;AAAA,QAAQ,MAAR,CAAe,qBAAf,EACG,SADH,CACa,mBADb,EACkC,CAC9B,cAD8B,EAE9B,oBAF8B,EAG9B,sBAH8B,EAI9B,qBAJ8B,EAK9B,eAL8B,EAM9B,UAAS,mBAAT,EACS,yBADT,EAES,2BAFT,EAGS,0BAHT,EAIS,oBAJT,EAI+B;AAC7B,MAAI,YAAY;AACd,SAAK,yBAAL;AACA,WAAO,2BAAP;AACA,UAAM,0BAAN;GAHE,CADyB;AAM7B,SAAO;AACL,cAAU,GAAV;AACA,UAAM,cAAS,KAAT,EAAgB,MAAhB,EAAwB;AAC5B,UAAI,MAAM,SAAS,cAAT,CAAwB,KAAxB,CAAN,CADwB;AAE5B,UAAI,QAAQ,IAAI,YAAJ,CAFgB;;AAI5B,UAAI,WAAW,MAAM,QAAN,CAJa;AAK5B,cAAQ,GAAR,CAAY,cAAZ,EAA4B,QAA5B,EAL4B;AAM5B,UAAG,EAAE,KAAF,CAAQ,QAAR,CAAH,EAAsB,OAAtB;;AAEA,UAAI,UAAU,UAAU,SAAS,KAAT,CAAe,IAAf,CAAV,CAA+B,MAA/B,CAAsC,KAAtC,EAA6C,OAAO,CAAP,CAA7C,EAAwD,QAAxD,CAAV,CARwB;AAS5B,cAAQ,SAAR,GAAoB,OAAO,CAAP,CAApB,CAT4B;;AAW5B,YAAM,kBAAN,CAAyB,kBAAzB,EAA6C,YAAM;AACjD,4BACG,eADH,CACmB,GADnB,EACwB,SAAS,KAAT,EAAgB,QAAQ,KAAR,CADxC,CADiD;OAAN,EAG1C,KAHH,EAX4B;AAe5B,eAAS,cAAT,GAA0B;AACxB,UAAE,WAAF,CACE,YAAM;AACJ,iBAAO,qBACJ,SADI,CACM,SAAS,KAAT,CAAe,KAAf,EAAsB,MAAM,KAAN,CAAY,IAAZ,CAAiB,SAAjB,CADnC,CADI;SAAN,EAIA,UAAC,QAAD,EAAc;AACZ,oBAAU,SAAS,KAAT,CAAe,IAAf,CAAV,CAA+B,MAA/B,CAAsC,GAAtC,EAA2C,MAAM,KAAN,EAAa,QAAxD,EAAkE,OAAlE,EADY;SAAd,CALF,GADwB;OAA1B;AAWA,uBA1B4B;AA2B5B,YAAM,kBAAN,2BAAiD,SAAS,KAAT,CAAe,KAAf,EACxB,cADzB,EACyC,KADzC,EA3B4B;KAAxB;GAFR,CAN6B;CAJ/B,CAPJ,EAoDG,SApDH,CAoDa,wBApDb,EAoDuC,CACnC,YAAW;AACT,SAAO;AACL,cAAU,GAAV;AACA,iBAAa,mCAAb;AACA,WAAO,IAAP;AACA,UAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB;AAC7B,YAAM,IAAN,GAAa,QAAQ,CAAR,EAAW,YAAX,CAAwB,2BAAxB,CAAb,CAD6B;AAE7B,YAAM,wBAAN,CAA+B,sBAA/B,EAAuD,KAAvD,EAF6B;AAG7B,cAAQ,GAAR,CAAY,wBAAZ,EAAsC,MAAM,IAAN,CAAtC,CAH6B;KAAzB;GAJR,CADS;CAAX,CArDJ","file":"template.js","sourcesContent":["angular.module('clickApp.directives')\n  .directive('clickGameTemplate', [\n    'labelElement',\n    'aoeTemplateElement',\n    'sprayTemplateElement',\n    'wallTemplateElement',\n    'gameTemplates',\n    function(labelElementService,\n             aoeTemplateElementService,\n             sprayTemplateElementService,\n             wallTemplateElementService,\n             gameTemplatesService) {\n      var templates = {\n        aoe: aoeTemplateElementService,\n        spray: sprayTemplateElementService,\n        wall: wallTemplateElementService\n      };\n      return {\n        restrict: 'A',\n        link: function(scope, parent) {\n          var map = document.getElementById('map');\n          var svgNS = map.namespaceURI;\n\n          var template = scope.template;\n          console.log('gameTemplate', template);\n          if(R.isNil(template)) return;\n\n          var element = templates[template.state.type].create(svgNS, parent[0], template);\n          element.container = parent[0];\n\n          scope.onStateChangeEvent('Game.map.flipped', () => {\n            labelElementService\n              .updateOnFlipMap(map, template.state, element.label);\n          }, scope);\n          function updateTemplate() {\n            R.pipePromise(\n              () => {\n                return gameTemplatesService\n                  .findStamp(template.state.stamp, scope.state.game.templates);\n              },\n              (template) => {\n                templates[template.state.type].update(map, scope.state, template, element);\n              }\n            )();\n          }\n          updateTemplate();\n          scope.onStateChangeEvent(`Game.template.change.${template.state.stamp}`,\n                                   updateTemplate, scope);\n        }\n      };\n    }\n  ])\n  .directive('clickGameTemplatesList', [\n    function() {\n      return {\n        restrict: 'A',\n        templateUrl: 'partials/game/templates_list.html',\n        scope: true,\n        link: function(scope, element) {\n          scope.type = element[0].getAttribute('click-game-templates-list');\n          scope.digestOnStateChangeEvent('Game.template.create', scope);\n          console.log('clickGameTemplatesList', scope.type);\n        }\n      };\n    }\n  ]);\n"]}