{"version":3,"sources":["aoe.es6"],"names":[],"mappings":"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","file":"aoe.js","sourcesContent":["angular.module('clickApp.directives')\n  .factory('aoeTemplateElement', [\n    'template',\n    'gameTemplateSelection',\n    'gameMap',\n    'labelElement',\n    function(templateService,\n             gameTemplateSelectionService,\n             gameMapService,\n             labelElementService) {\n      var aoeTemplateElementService = {\n        create: function aoeTemplateElementServiceCreate(svgNS, parent, aoe) {\n          var circle = document.createElementNS(svgNS, 'circle');\n          circle.classList.add('template');\n          circle.classList.add('aoe');\n          circle.setAttribute('data-stamp', aoe.state.stamp);\n          parent.appendChild(circle);\n\n          var line = document.createElementNS(svgNS, 'line');\n          line.classList.add('template-aoe-direction');\n          line.style['marker-end'] = 'url(#aoe-direction-end)';\n          parent.appendChild(line);\n\n          var label = labelElementService.create(svgNS, parent);\n\n          return { aoe: circle,\n                   dir: line,\n                   label: label\n                 };\n        },\n        update: function aoeTemplateElementUpdate(map, state, template, aoe) {\n          var selection = state.game.template_selection;\n          var local = gameTemplateSelectionService\n                .in('local', template.state.stamp, selection);\n          var remote = gameTemplateSelectionService\n                .in('remote', template.state.stamp, selection);\n          var selected = (local || remote);\n\n          var map_flipped = gameMapService.isFlipped(map);\n          var zoom_factor = gameMapService.zoomFactor(map);\n          var label_flip_center = template.state;\n          var label_text_center = { x: template.state.x,\n                                    y: template.state.y + template.state.s + 5\n                                  };\n          var label_text = templateService.fullLabel(template);\n\n          if(selected) aoe.container.classList.add('selection');\n          else aoe.container.classList.remove('selection');\n          if(local) aoe.container.classList.add('local');\n          else aoe.container.classList.remove('local');\n          if(remote) aoe.container.classList.add('remote');\n          else aoe.container.classList.remove('remote');\n\n          updateAoe(template, aoe.aoe);\n          updateDir(template, aoe.dir);\n          labelElementService.update(map_flipped,\n                                     zoom_factor,\n                                     label_flip_center,\n                                     label_text_center,\n                                     label_text,\n                                     aoe.label);\n        }\n      };\n      function updateAoe(template, aoe) {\n        aoe.setAttribute('cx', template.state.x+'');\n        aoe.setAttribute('cy', template.state.y+'');\n        aoe.setAttribute('r', template.state.s+'');\n      }\n      function updateDir(template, dir) {\n        dir.setAttribute('x1', template.state.x+'');\n        dir.setAttribute('y1', template.state.y+'');\n        dir.setAttribute('x2', template.state.x+'');\n        dir.setAttribute('y2', (template.state.y-template.state.s)+'');\n        dir.setAttribute('transform', ('rotate('+\n                                       template.state.r+','+\n                                       template.state.x+','+\n                                       template.state.y+\n                                       ')'\n                                      ));\n      }\n      return aoeTemplateElementService;\n    }\n  ]);\n"]}