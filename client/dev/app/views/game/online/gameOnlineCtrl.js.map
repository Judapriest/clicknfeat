{"version":3,"sources":["gameOnlineCtrl.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,sBAAf,EACG,UADH,CACc,gBADd,EACgC,cADhC,EADU;;AAIV,iBAAe,OAAf,GAAyB,CACvB,QADuB,EAEvB,MAFuB,CAAzB,CAJU;AAQV,WAAS,cAAT,CAAwB,MAAxB,EACwB,SADxB,EACmC;AACjC,QAAM,KAAK,IAAL,CAD2B;AAEjC,YAAQ,GAAR,CAAY,qBAAZ,EAFiC;;AAIjC,OAAG,gBAAH,GAAsB,gBAAtB,CAJiC;;AAMjC,eANiC;;AAQjC,aAAS,QAAT,GAAoB;AAClB,SAAG,eAAH,GAAqB,EAArB,CADkB;;AAGlB,aAAO,kBAAP,CAA0B,mBAA1B,EAA+C,iBAA/C,EAAkE,MAAlE,EAHkB;AAIlB,aAAO,KAAP,CAAa,UAAb,CACG,IADH,CACQ,eADR,EAJkB;KAApB;;AAQA,aAAS,eAAT,GAA2B;AACzB,UAAG,CAAC,UAAU,MAAV,CAAiB,OAAO,KAAP,CAAa,IAAb,CAAlB,EAAsC;AACvC,eAAO,GAAP,CAAW,SAAX,CAAqB,QAArB,EADuC;OAAzC;KADF;;AAMA,aAAS,gBAAT,GAA4B;AAC1B,QAAE,MAAF,CAAS,OAAO,KAAP,CAAT,CACE,EAAE,MAAF,CAAS,EAAT,EAAa,CAAC,MAAD,EAAQ,YAAR,EAAqB,OAArB,CAAb,CADF,EAEE,EAAE,GAAF,CAAM,GAAG,eAAH,CAAmB,IAAnB,CAAwB,CAAxB,CAAN,CAFF,EAGE,EAAE,SAAF,CAAY,EAAZ,CAHF,EAIE,EAAE,MAAF,CAAS,MAAT,EAAiB,cAAjB,CAJF,EAKE,UAAC,EAAD,EAAQ;AACN,eAAO,UAAP,CAAkB,mBAAlB,EAAuC,EAAvC,EADM;OAAR,CALF,CAD0B;KAA5B;AAWA,aAAS,iBAAT,CAA2B,OAA3B,EAAoC,SAApC,EAA+C,EAA/C,EAAmD;AACjD,aAAO,GAAP,CAAW,SAAX,CAAqB,WAArB,EAAkC;AAChC,gBAAQ,QAAR;AACA,iBAAS,SAAT;AACA,YAAI,EAAJ;OAHF,EADiD;AAMjD,aAAO,OAAP,GANiD;KAAnD;GAlCF;CARD,CAAD","file":"gameOnlineCtrl.js","sourcesContent":["(function() {\n  angular.module('clickApp.controllers')\n    .controller('gameOnlineCtrl', gameOnlineCtrl);\n\n  gameOnlineCtrl.$inject = [\n    '$scope',\n    'user',\n  ];\n  function gameOnlineCtrl($scope,\n                          userModel) {\n    const vm = this;\n    console.log('init gameOnlineCtrl');\n\n    vm.doLoadOnlineGame = doLoadOnlineGame;\n\n    activate();\n\n    function activate() {\n      vm.games_selection = {};\n\n      $scope.onStateChangeEvent('Games.online.load', onGamesOnlineLoad, $scope);\n      $scope.state.user_ready\n        .then(checkUserOnline);\n    }\n\n    function checkUserOnline() {\n      if(!userModel.online($scope.state.user)) {\n        $scope.app.goToState('^.main');\n      }\n    }\n\n    function doLoadOnlineGame() {\n      R.thread($scope.state)(\n        R.pathOr([], ['user','connection','games']),\n        R.nth(vm.games_selection.list[0]),\n        R.defaultTo({}),\n        R.propOr('null', 'public_stamp'),\n        (id) => {\n          $scope.stateEvent('Games.online.load', id);\n        }\n      );\n    }\n    function onGamesOnlineLoad(_event_, isPrivate, id) {\n      $scope.app.goToState('game.main', {\n        online: 'online',\n        private: isPrivate,\n        id: id\n      });\n      $scope.$digest();\n    }\n  }\n})();\n"]}