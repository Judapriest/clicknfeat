{"version":3,"sources":["appCtrl.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,sBAAf,EACG,UADH,CACc,SADd,EACyB,OADzB,EADU;;AAIV,UAAQ,OAAR,GAAkB,CAChB,YADgB,EAEhB,QAFgB,EAGhB,WAHgB,EAIhB,UAJgB,EAKhB,SALgB,EAMhB,SANgB,EAOhB,SAPgB,EAQhB,SARgB,EAShB,UATgB,EAUhB,UAVgB,EAWhB,aAXgB,EAYhB,UAZgB,CAAlB,CAJU;AAkBV,WAAS,OAAT,CAAiB,UAAjB,EACiB,MADjB,EAEiB,gBAFjB,EAGiB,eAHjB,EAIiB,cAJjB,EAKiB,cALjB,EAKiC;AAC/B,YAAQ,GAAR,CAAY,cAAZ,EAD+B;;AAG/B,QAAM,KAAK,IAAL,CAHyB;AAI/B,OAAG,WAAH,GAAiB,WAAjB,CAJ+B;AAK/B,OAAG,OAAH,GAAa,OAAb,CAL+B;AAM/B,OAAG,YAAH,GAAkB,YAAlB,CAN+B;AAO/B,OAAG,SAAH,GAAe,SAAf,CAP+B;;AAS/B,eAAW,UAAX,GAAwB,UAAxB,CAT+B;AAU/B,eAAW,QAAX,GAAsB,QAAtB,CAV+B;AAW/B,eAAW,YAAX,GAA0B,YAA1B,CAX+B;;AAa/B,eAb+B;;AAe/B,aAAS,QAAT,GAAoB;AAClB,eAAS,UAAC,KAAD,EAAW;AAAE,mBAAW,KAAX,GAAmB,KAAnB,CAAF;OAAX,EACA,gBAAgB,KAAhB,EAAuB,UADhC,EADkB;AAGlB,eAAS,WAAT,EAAsB,eAAe,KAAf,EAAsB,UAA5C,EAHkB;AAIlB,iBAAW,UAAX,CAAsB,aAAtB,EAJkB;KAApB;;AAOA,aAAS,WAAT,CAAqB,QAArB,EAA+B;AAC7B,UAAG,CAAC,QAAD,EAAW,OAAO,EAAP,CAAU,MAAV,EAAd;KADF;;AAIA,aAAS,UAAT,GAA6B;wCAAN;;OAAM;;AAC3B,uBAAiB,MAAjB,CAAwB,IAAxB,CAA6B,IAA7B,EAD2B;KAA7B;AAGA,aAAS,QAAT,CAAkB,IAAlB,EAAwB,IAAxB,EAA8B,KAA9B,EAAqC;AACnC,UAAM,WAAW,SAAX,QAAW,GAAM;AACrB,aAAK,KAAK,MAAL,EAAL,EADqB;OAAN,CADkB;AAInC,qBAAe,eAAf,CAA+B,QAA/B,EAJmC;AAKnC,YAAM,GAAN,CAAU,UAAV,EAAsB,YAAM;AAC1B,uBAAe,kBAAf,CAAkC,QAAlC,EAD0B;OAAN,CAAtB,CALmC;AAQnC,iBARmC;KAArC;AAUA,aAAS,YAAT,CAAsB,QAAtB,EAAgC,MAAhC,EAAwC,KAAxC,EAA+C;AAC7C,UAAM,cAAc,OAAO,MAAP,CAAc,QAAd,CAAd,CADuC;AAE7C,YAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EAF6C;KAA/C;;AAKA,aAAS,WAAT,GAAuB;AACrB,aAAO,EAAE,IAAF,CAAO,CAAC,SAAD,EAAY,MAAZ,EAAoB,UAApB,CAAP,EAAyC,MAAzC,CAAP,CADqB;KAAvB;AAGA,aAAS,OAAT,CAAiB,IAAjB,EAAuB;AACrB,aAAO,OAAO,EAAP,CAAU,IAAV,CAAP,CADqB;KAAvB;AAGA,aAAS,YAAT,CAAsB,KAAtB,EAA6B;AAC3B,aAAO,KAAK,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,KAA5B,CAAL,CADoB;KAA7B;AAGA,aAAS,SAAT,GAA4B;yCAAN;;OAAM;;AAC1B,WAAK,UAAL,CAAgB,YAAM;AACpB,eAAO,EAAP,CAAU,KAAV,CAAgB,MAAhB,EAAwB,IAAxB,EADoB;OAAN,EAEb,GAFH,EAD0B;KAA5B;GA1DF;CAlBD,CAAD","file":"appCtrl.js","sourcesContent":["(function() {\n  angular.module('clickApp.controllers')\n    .controller('appCtrl', appCtrl);\n\n  appCtrl.$inject = [\n    '$rootScope',\n    '$state',\n    'appAction',\n    'appState',\n    'appTick',\n    'appUser',\n    'appData',\n    'appGame',\n    'appGames',\n    'appModes',\n    'allCommands',\n    'allModes',\n  ];\n  function appCtrl($rootScope,\n                   $state,\n                   appActionService,\n                   appStateService,\n                   appTickService,\n                   appUserService) {\n    console.log('init appCtrl');\n\n    const vm = this;\n    vm.isNavHidden = isNavHidden;\n    vm.stateIs = stateIs;\n    vm.stateMatches = stateMatches;\n    vm.goToState = goToState;\n\n    $rootScope.sendAction = sendAction;\n    $rootScope.bindCell = bindCell;\n    $rootScope.listenSignal = listenSignal;\n\n    activate();\n\n    function activate() {\n      bindCell((state) => { $rootScope.state = state; },\n               appStateService.state, $rootScope);\n      bindCell(onUserValid, appUserService.valid, $rootScope);\n      $rootScope.sendAction('Modes.reset');\n    }\n\n    function onUserValid(is_valid) {\n      if(!is_valid) $state.go('user');\n    }\n\n    function sendAction(...args) {\n      appActionService.action.send(args);\n    }\n    function bindCell(bind, cell, scope) {\n      const listener = () => {\n        bind(cell.sample());\n      };\n      appTickService.addTickListener(listener);\n      scope.$on('$destroy', () => {\n        appTickService.removeTickListener(listener);\n      });\n      listener();\n    }\n    function listenSignal(listener, signal, scope) {\n      const unsubscribe = signal.listen(listener);\n      scope.$on('$destroy', unsubscribe);\n    }\n\n    function isNavHidden() {\n      return R.path(['current', 'data', 'hide_nav' ], $state);\n    }\n    function stateIs(name) {\n      return $state.is(name);\n    }\n    function stateMatches(match) {\n      return 0 <= $state.current.name.indexOf(match);\n    }\n    function goToState(...args) {\n      self.setTimeout(() => {\n        $state.go.apply($state, args);\n      }, 100);\n    }\n  }\n})();\n"]}