{"version":3,"sources":["appCtrl.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,sBAAf,EACG,UADH,CACc,SADd,EACyB,OADzB,EADU;;AAIV,UAAQ,OAAR,GAAkB,CAChB,YADgB,EAEhB,QAFgB,EAGhB,WAHgB,EAIhB,UAJgB,EAKhB,SALgB,EAMhB,UANgB,EAOhB,SAPgB,CAAlB,CAJU;;;;;AAgBV,WAAS,OAAT,CAAiB,UAAjB,EACiB,MADjB,EAEiB,gBAFjB,EAGiB,eAHjB,EAIiB,cAJjB,EAIiC;AAC/B,YAAQ,GAAR,CAAY,cAAZ,EAD+B;;AAG/B,QAAM,KAAK,IAAL;;AAHyB,MAK/B,CAAG,OAAH,GAAa,OAAb,CAL+B;AAM/B,OAAG,YAAH,GAAkB,YAAlB;;;;AAN+B,cAU/B,CAAW,SAAX,GAAuB,SAAvB,CAV+B;;AAY/B,eAAW,UAAX,GAAwB,UAAxB;;;AAZ+B,cAe/B,CAAW,QAAX,GAAsB,QAAtB,CAf+B;AAgB/B,eAAW,YAAX,GAA0B,YAA1B,CAhB+B;;AAkB/B,eAlB+B;;AAoB/B,aAAS,QAAT,GAAoB;AAClB,eAAS,UAAC,KAAD,EAAW;AAAE,mBAAW,KAAX,GAAmB,KAAnB,CAAF;OAAX,EACA,gBAAgB,KAAhB,EAAuB,UADhC;;;AADkB,KAApB;;;;;;;AApB+B,aAgCtB,UAAT,GAA6B;wCAAN;;OAAM;;AAC3B,uBAAiB,MAAjB,CAAwB,IAAxB,CAA6B,IAA7B,EAD2B;KAA7B;;;;;;;;;;;;AAhC+B,aA8CtB,QAAT,CAAkB,IAAlB,EAAwB,IAAxB,EAA8B,KAA9B,EAAqC;AACnC,UAAM,WAAW,SAAX,QAAW,GAAM;AACrB,aAAK,KAAK,MAAL,EAAL,EADqB;OAAN,CADkB;AAInC,qBAAe,eAAf,CAA+B,QAA/B,EAJmC;AAKnC,YAAM,GAAN,CAAU,UAAV,EAAsB,YAAM;AAC1B,uBAAe,kBAAf,CAAkC,QAAlC,EAD0B;OAAN,CAAtB,CALmC;AAQnC,iBARmC;KAArC;AAUA,aAAS,YAAT,CAAsB,QAAtB,EAAgC,MAAhC,EAAwC,KAAxC,EAA+C;AAC7C,UAAM,cAAc,OAAO,MAAP,CAAc,QAAd,CAAd,CADuC;AAE7C,YAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EAF6C;KAA/C;;;;;AAxD+B,aAgEtB,OAAT,CAAiB,IAAjB,EAAuB;AACrB,aAAO,OAAO,EAAP,CAAU,IAAV,CAAP,CADqB;KAAvB;AAGA,aAAS,YAAT,CAAsB,KAAtB,EAA6B;AAC3B,aAAO,KAAK,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,KAA5B,CAAL,CADoB;KAA7B;AAGA,aAAS,SAAT,GAA4B;yCAAN;;OAAM;;AAC1B,WAAK,UAAL,CAAgB,YAAM;AACpB,eAAO,EAAP,CAAU,KAAV,CAAgB,MAAhB,EAAwB,IAAxB,EADoB;OAAN,EAEb,GAFH,EAD0B;KAA5B;GA1EF;CAhBD,CAAD","file":"appCtrl.js","sourcesContent":["(function() {\n  angular.module('clickApp.controllers')\n    .controller('appCtrl', appCtrl);\n\n  appCtrl.$inject = [\n    '$rootScope',\n    '$state',\n    'appAction',\n    'appState',\n    'appTick',\n    'appGames',\n    'appUser',\n    // 'stateData',\n    // 'stateGame',\n    // 'stateModes',\n  ];\n  function appCtrl($rootScope,\n                   $state,\n                   appActionService,\n                   appStateService,\n                   appTickService) {\n    console.log('init appCtrl');\n\n    const vm = this;\n    // vm.isNavHidden = isNavHidden;\n    vm.stateIs = stateIs;\n    vm.stateMatches = stateMatches;\n    // vm.goToState = goToState;\n\n    // $rootScope.stateIs = stateIs;\n    $rootScope.goToState = goToState;\n\n    $rootScope.sendAction = sendAction;\n    // $rootScope.onStateChangeEvent = onStateChangeEvent;\n    // $rootScope.digestOnStateChangeEvent = digestOnStateChangeEvent;\n    $rootScope.bindCell = bindCell;\n    $rootScope.listenSignal = listenSignal;\n\n    activate();\n\n    function activate() {\n      bindCell((state) => { $rootScope.state = state; },\n               appStateService.state, $rootScope);\n      // $rootScope.onStateChangeEvent('User.becomesInvalid', onUserInvalid, $rootScope);\n      // $rootScope.state = appStateService.init();\n    }\n\n    // function onUserInvalid() {\n    //   $state.go('user');\n    //   $rootScope.$digest();\n    // }\n\n    function sendAction(...args) {\n      appActionService.action.send(args);\n    }\n    // function onStateChangeEvent(event, listener, scope) {\n    //   appStateService.addListener(event, listener);\n    //   scope.$on('$destroy', () => {\n    //     appStateService.removeListener(event, listener);\n    //   });\n    // }\n    // function digestOnStateChangeEvent(event, scope) {\n    //   onStateChangeEvent(event, () => {\n    //     scope.$digest();\n    //   }, scope);\n    // }\n    function bindCell(bind, cell, scope) {\n      const listener = () => {\n        bind(cell.sample());\n      };\n      appTickService.addTickListener(listener);\n      scope.$on('$destroy', () => {\n        appTickService.removeTickListener(listener);\n      });\n      listener();\n    }\n    function listenSignal(listener, signal, scope) {\n      const unsubscribe = signal.listen(listener);\n      scope.$on('$destroy', unsubscribe);\n    }\n\n    // function isNavHidden() {\n    //   return R.path(['current', 'data', 'hide_nav' ], $state);\n    // }\n    function stateIs(name) {\n      return $state.is(name);\n    }\n    function stateMatches(match) {\n      return 0 <= $state.current.name.indexOf(match);\n    }\n    function goToState(...args) {\n      self.setTimeout(() => {\n        $state.go.apply($state, args);\n      }, 100);\n    }\n  }\n})();\n"]}