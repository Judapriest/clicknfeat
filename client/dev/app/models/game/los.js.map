{"version":3,"sources":["los.es6"],"names":[],"mappings":"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","file":"los.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('gameLos', gameLosModelFactory);\n\n  gameLosModelFactory.$inject = [\n    'gameSegment',\n    'point',\n    'circle',\n    'gameFactions',\n    'gameModels',\n  ];\n  function gameLosModelFactory(gameSegmentModel,\n                               pointModel,\n                               circleModel,\n                               gameFactionsModel,\n                               gameModelsModel) {\n    const base = gameSegmentModel('los');\n    const gameLosModel = Object.create(base);\n    R.deepExtend(gameLosModel, {\n      toggleDisplay: gameLosToggleDisplay,\n      setRemote: gameLosSetRemote,\n      resetRemote: gameLosResetRemote,\n      origin: gameLosOrigin,\n      clearOrigin: gameLosClearOrigin,\n      setOrigin: gameLosSetOrigin,\n      target: gameLosTarget,\n      setOriginResetTarget: gameLosSetOriginResetTarget,\n      clearTarget: gameLosClearTarget,\n      setTarget: gameLosSetTarget,\n      toggleIgnoreModel: gameLosToggleIgnoreModel,\n      updateOriginTarget: gameLosUpdateOriginTarget\n    });\n\n    const setOriginTarget$ = R.curry(setOriginTarget);\n\n    R.curryService(gameLosModel);\n    return gameLosModel;\n\n    function gameLosToggleDisplay(state, game, los) {\n      return R.thread(los)(\n        base.toggleDisplay$(state, game),\n        setOriginTarget$({}, state, game)\n      );\n    }\n    function gameLosSetRemote(start, end, state, game, los) {\n      return R.thread(los)(\n        base.setRemote$(start, end, state, game),\n        setOriginTarget$({}, state, game)\n      );\n    }\n    function gameLosResetRemote(remote, state, game, los) {\n      return R.thread(los)(\n        base.resetRemote$(remote, state, game),\n        setOriginTarget$({}, state, game)\n      );\n    }\n    function gameLosOrigin(los) {\n      return R.path(['remote', 'origin'], los);\n    }\n    function gameLosClearOrigin(state, game, los) {\n      return setOriginTarget({ origin: null,\n                               ignore: null,\n                               display: false\n                             }, state, game, los);\n    }\n    function gameLosSetOrigin(origin_model, state, game, los) {\n      const origin = origin_model.state.stamp;\n      let target = gameLosModel.target(los);\n      target = (target === origin) ? null : target;\n      const display = (target && origin);\n      return setOriginTarget({ origin: origin,\n                               target: target,\n                               ignore: null,\n                               display: display\n                             }, state, game, los);\n    }\n    function gameLosSetOriginResetTarget(origin_model, state, game, los) {\n      const origin = origin_model.state.stamp;\n      return setOriginTarget({ origin: origin,\n                               target: null,\n                               ignore: null,\n                               display: true\n                             }, state, game, los);\n    }\n    function gameLosTarget(los) {\n      return R.path(['remote', 'target'], los);\n    }\n    function gameLosClearTarget(state, game, los) {\n      return setOriginTarget({ target: null,\n                               ignore: null,\n                               display: false\n                             }, state, game, los);\n    }\n    function gameLosSetTarget(target_model, state, game, los) {\n      let origin = gameLosModel.origin(los);\n      const target = target_model.state.stamp;\n      origin = (origin === target) ? null : origin;\n      const display = (target && origin);\n      return setOriginTarget({ origin: origin,\n                               target: target,\n                               ignore: null,\n                               display: display\n                             }, state, game, los);\n    }\n    function gameLosToggleIgnoreModel(model, state, game, los) {\n      let ignore = R.pathOr([], ['remote','ignore'], los);\n      const is_ignored = R.find(R.equals(model.state.stamp),\n                                ignore);\n      ignore = ( is_ignored\n                 ? R.reject(R.equals(model.state.stamp), ignore)\n                 : R.append(model.state.stamp, ignore)\n               );\n      console.log('toggleIgnoreModel', ignore);\n\n      return setOriginTarget({ ignore: ignore },\n                             state, game, los);\n    }\n    function gameLosUpdateOriginTarget(state, game, los) {\n      return setOriginTarget({}, state, game, los);\n    }\n\n    function setOriginTarget(update, state, game, los) {\n      const {\n        origin = R.path(['remote','origin'], los),\n        target = R.path(['remote','target'], los),\n        ignore = R.pathOr([], ['remote','ignore'], los),\n        display = R.path(['remote','display'], los),\n      } = update;\n\n      los = R.thread(los)(\n        R.assocPath(['remote','origin'], origin),\n        R.assocPath(['remote','target'], target),\n        R.assocPath(['remote','display'], display),\n        R.assocPath(['remote','ignore'], R.defaultTo([], ignore)),\n        R.assoc('computed', { envelope: null,\n                              darkness: [],\n                              shadow: [] })\n      );\n\n      if(los.remote.origin && los.remote.target) {\n        updateEnveloppes();\n      }\n      state.queueChangeEventP('Game.los.remote.change');\n      return los;\n\n      function updateEnveloppes() {\n        R.threadP()(\n          () => getOriginTargetInfo(state, game,\n                                    los.remote.origin,\n                                    los.remote.target),\n          ([origin_state, origin_info, target_state, target_info]) => {\n            const origin_circle = {\n              x: origin_state.x,\n              y: origin_state.y,\n              radius: origin_info.base_radius\n            };\n            const target_circle = {\n              x: target_state.x,\n              y: target_state.y,\n              radius: target_info.base_radius\n            };\n            const envelope = circleModel.envelopeTo(target_circle, origin_circle);\n            los.computed.envelope = envelope;\n\n            return R.threadP()(\n              () => computeIntervenings(state, game, los.remote.ignore,\n                                        target, target_circle,\n                                        origin, envelope),\n              (intervenings) => [ origin_circle, intervenings ]\n            );\n          },\n          ([ origin_circle, intervenings ]) => {\n            const darkness = computeDarkness(origin_circle, intervenings);\n            los.computed.darkness = darkness;\n\n            const shadow = computeShadow(origin_circle, intervenings);\n            los.computed.shadow = shadow;\n\n            state.queueChangeEventP('Game.los.remote.change');\n          }\n        );\n      }\n    }\n    function getOriginTargetInfo(state, game, origin, target) {\n      return R.threadP()(\n        () => [\n          gameModelsModel.findStampP(origin, game.models),\n          gameModelsModel.findStampP(target, game.models),\n        ],\n        R.promiseAll,\n        ([{ state: origin_state }, { state: target_state }]) => {\n          return R.threadP()(\n            () => [\n              gameFactionsModel.getModelInfoP(origin_state.info, state.factions),\n              gameFactionsModel.getModelInfoP(target_state.info, state.factions),\n            ],\n            R.promiseAll,\n            ([origin_info, target_info]) => [\n              origin_state, origin_info,\n              target_state, target_info,\n            ]\n          );\n        }\n      );\n    }\n    function computeIntervenings(state, game, ignore,\n                                 target, target_circle,\n                                 origin, envelope) {\n      return R.threadP(game.models)(\n        gameModelsModel.all,\n        R.map(getModelCircle),\n        R.promiseAll,\n        R.reject(circleIsNotIntervening),\n        R.filter(circleModel.isInEnvelope$(envelope))\n      );\n\n      function getModelCircle(model) {\n        return R.threadP()(\n          () => gameFactionsModel\n            .getModelInfoP(model.state.info, state.factions),\n          (info) => R.assoc('radius', info.base_radius, model.state)\n        );\n      }\n      function circleIsNotIntervening(circle) {\n        return (target === circle.stamp ||\n                origin === circle.stamp ||\n                target_circle.radius > circle.radius ||\n                R.find(R.equals(circle.stamp), ignore)\n               );\n      }\n    }\n    function computeDarkness(origin_circle,\n                             intervenings) {\n      return R.map((circle) => circleModel\n                   .outsideEnvelopeTo(circle, [], origin_circle),\n                   intervenings);\n    }\n    function computeShadow(origin_circle,\n                           intervenings) {\n      return R.map((circle) => circleModel\n                   .outsideEnvelopeTo(circle, intervenings, origin_circle),\n                   intervenings);\n    }\n  }\n})();\n"]}