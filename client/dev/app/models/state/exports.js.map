{"version":3,"sources":["exports.es6"],"names":[],"mappings":";;;;AAAA,QAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,cADX,EAC2B,CACvB,YADuB,EAEvB,SAAS,0BAAT,CAAoC,iBAApC,EAAuD;AACrD,MAAI,iBAAiB,EAAE,KAAF,CAAQ,UAAC,IAAD,EAAO,OAAP,EAAmB;AAC9C,WAAO,EAAE,IAAF,CACL,EAAE,IAAF,8BAAW,QAAK,OAAhB,CADK,EAEL,kBAAkB,OAAlB,EACA,EAAE,MAAF,CAAS,OAAT,CAHK,EAIL,EAAE,SAAF,8BAAgB,QAAK,OAArB,EAA6B,IAA7B,CAJK,EAKL,OALK,CAAP,CAD8C;GAAnB,CAAzB,CADiD;AASrD,MAAI,sBAAsB;AACxB,UAAM,SAAS,gBAAT,CAA0B,KAA1B,EAAiC;AACrC,YAAM,OAAN,GAAgB,EAAhB,CADqC;AAErC,aAAO,KAAP,CAFqC;KAAjC;AAIN,cAAU,SAAS,oBAAT,CAA8B,IAA9B,EAAoC,GAApC,EAAyC;AACjD,UAAG,KAAK,GAAL,CAAH,EAAc,OAAO,KAAK,OAAL,CAAa,MAAb,EAAP,CAAd;AACA,aAAO,GAAP,CAFiD;KAAzC;AAIV,YAAQ,SAAS,sBAAT,CAAgC,IAAhC,EAAsC,SAAtC,EAAiD,KAAjD,EAAwD;AAC9D,aAAO,EAAE,WAAF,CACL,SADK,EAEL,EAAE,QAAF,CAAW,EAAE,MAAF,CAAS,EAAE,IAAF,CAAO,CAAC,SAAD,QAAe,IAAf,CAAP,EAA+B,KAA/B,CAAT,CAAX,EACW,WADX,CAFK,EAIL,UAAC,IAAD,EAAU;AACR,cAAM,OAAN,GAAgB,EAAE,KAAF,OAAY,IAAZ,EAAoB,IAApB,EAA0B,MAAM,OAAN,CAA1C,CADQ;AAER,eAAO,IAAP,CAFQ;OAAV,EAIA,EAAE,QAAF,CAAW,EAAE,KAAF,EAAS,KAApB,CARK,EASL,kBAAkB,SAAlB,CAA4B,MAA5B,CATK,EAUL,KAVK,EAWJ,KAXI,CAWE,UAAC,KAAD,EAAW;AAChB,gBAAO,KAAP;AACA,eAAK,KAAL;AAAY,mBAAO,IAAP,CAAZ;AADA,eAEK,WAAL;AAAkB,mBAAO,KAAK,OAAL,CAAa,MAAb,EAAP,CAAlB;AAFA;AAGS;AACP,sBAAQ,IAAR,CAAa,gBAAb,EAA+B,IAA/B,EAAqC,KAArC,EADO;AAEP,qBAAO,IAAP,CAFO;aAAT;AAHA,SADgB;OAAX,CAXF,CAqBJ,IArBI,CAqBC,UAAC,GAAD,EAAS;AACb,cAAM,OAAN,GAAgB,EAAE,IAAF,CACd,EAAE,SAAF,CAAY,EAAZ,CADc,EAEd,eAAe,CAAC,IAAD,CAAf,CAFc,EAGd,EAAE,SAAF,CAAY,CAAC,IAAD,CAAZ,EAAoB;AAClB,gCAAoB,cAApB;AACA,eAAK,GAAL;SAFF,CAHc,EAOd,MAAM,OAAN,CAPF,CADa;AASb,gBAAQ,IAAR,CAAa,SAAb,EAAwB,MAAM,OAAN,CAAxB,CATa;AAUb,cAAM,WAAN,cAA6B,IAA7B,EAVa;OAAT,CArBD,CAiCJ,KAjCI,CAiCE,EAAE,MAAF,CAAS,IAAT,CAjCF,CAAP,CAD8D;KAAxD;GATN,CATiD;AAuDrD,IAAE,YAAF,CAAe,mBAAf,EAvDqD;AAwDrD,SAAO,mBAAP,CAxDqD;CAAvD,CAHJ","file":"exports.js","sourcesContent":["angular.module('clickApp.services')\n  .factory('stateExports', [\n    'fileExport',\n    function stateExportsServiceFactory(fileExportService) {\n      let cleanupExport$ = R.curry((path, exports) => {\n        return R.pipe(\n          R.path([...path,'url']),\n          fileExportService.cleanup,\n          R.always(exports),\n          R.assocPath([...path,'url'], null)\n        )(exports);\n      });\n      let stateExportsService = {\n        init: function stateExportsInit(state) {\n          state.exports = {};\n          return state;\n        },\n        rejectIf: function stateExportsRejectIf(test, obj) {\n          if(test(obj)) return self.Promise.reject();\n          return obj;\n        },\n        export: function stateExportsExportData(name, buildData, state) {\n          return R.pipePromise(\n            buildData,\n            R.rejectIf(R.equals(R.path(['exports',`_${name}`], state)),\n                       'unchanged'),\n            (data) => {\n              state.exports = R.assoc(`_${name}`, data, state.exports);\n              return data;\n            },\n            R.rejectIf(R.isNil, 'nil'),\n            fileExportService.generate$('json')\n          )(state)\n            .catch((error) => {\n              switch(error) {\n              case 'nil': return null;\n              case 'unchanged': return self.Promise.reject();\n              default: {\n                console.warn('Exports: error', name, error);\n                return null;\n              }\n              }\n            })\n            .then((url) => {\n              state.exports = R.pipe(\n                R.defaultTo({}),\n                cleanupExport$([name]),\n                R.assocPath([name], {\n                  name: `clicknfeat_${name}.json`,\n                  url: url\n                })\n              )(state.exports);\n              console.warn('Exports', state.exports);\n              state.changeEvent(`Exports.${name}`);\n            })\n            .catch(R.always(null));\n        }\n      };\n      R.curryService(stateExportsService);\n      return stateExportsService;\n    }\n  ]);\n"]}