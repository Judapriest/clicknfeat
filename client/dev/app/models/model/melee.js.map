{"version":3,"sources":["melee.es6"],"names":[],"mappings":"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","file":"melee.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelMelee', modelMeleeServiceFactory);\n\n  modelMeleeServiceFactory.$inject = [];\n  function modelMeleeServiceFactory() {\n    const DSP_LENS = R.lensPath(['state','dsp']);\n    return function(modelService) {\n      const modelMeleeModel = {\n        isMeleeDisplayed: modelIsMeleeDisplayed,\n        setMeleeDisplay: modelSetMeleeDisplay,\n        toggleMeleeDisplay: modelToggleMeleeDisplay,\n        renderMelee: modelRenderMelee\n      };\n      return modelMeleeModel;\n\n      function modelIsMeleeDisplayed(melee, model) {\n        return !!R.find(R.equals(melee), model.state.dsp);\n      }\n      function modelSetMeleeDisplay(melee, set, model) {\n        const update = ( set\n                         ? R.compose(R.uniq, R.append(melee))\n                         : R.reject(R.equals(melee))\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelToggleMeleeDisplay(melee, model) {\n        const update = ( modelService.isMeleeDisplayed(melee, model)\n                         ? R.reject(R.equals(melee))\n                         : R.append(melee)\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelRenderMelee({ img,\n                                  info }, state) {\n        const melee = {\n          melee: {\n            show: modelMeleeModel.isMeleeDisplayed('mm', {state}),\n            path: computeMeleePath(5, img, info)\n          },\n          reach: {\n            show: modelMeleeModel.isMeleeDisplayed('mr', {state}),\n            path: computeMeleePath(20, img, info)\n          },\n          strike: {\n            show: modelMeleeModel.isMeleeDisplayed('ms', {state}),\n            path: computeMeleePath(40, img, info)\n          }\n        };\n        return { melee };\n      }\n      function computeMeleePath(size, img, info) {\n        return [\n          `M${img.width/2-info.base_radius-size},${img.height/2}`,\n          `L${img.width/2+info.base_radius+size},${img.height/2}`,\n          `A${info.base_radius+size},${info.base_radius+size} 0 0,0`,\n          `${img.width/2-info.base_radius-size},${img.height/2}`,\n          `M${img.width/2},${img.height/2}`,\n          `L${img.width/2},${img.height/2-info.base_radius-size}`,\n        ].join(' ');\n      }\n    };\n  }\n})();\n"]}