{"version":3,"sources":["counter.es6"],"names":[],"mappings":"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","file":"counter.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelCounter', modelCounterModelFactory);\n\n  modelCounterModelFactory.$inject = [];\n  function modelCounterModelFactory() {\n    const DSP_LENS = R.lensPath(['state','dsp']);\n    return (modelModel) => {\n      const modelCounterModel = {\n        isCounterDisplayed: modelIsCounterDisplayed,\n        incrementCounter: modelIncrementCounter,\n        decrementCounter: modelDecrementCounter,\n        setCounterDisplay: modelSetCounterDisplay,\n        toggleCounterDisplay: modelToggleCounterDisplay,\n        renderCounter: modelRenderCounter\n      };\n      return modelCounterModel;\n\n      function modelIsCounterDisplayed(counter, model) {\n        return !!R.find(R.equals(counter), R.viewOr([], DSP_LENS, model));\n      }\n      function modelIncrementCounter(counter, model) {\n        const value = R.defaultTo(0, model.state[counter]) + 1;\n        return R.assocPath(['state', counter], value, model);\n      }\n      function modelDecrementCounter(counter, model) {\n        const value = Math.max(0, R.defaultTo(0, model.state[counter]) - 1);\n        return R.assocPath(['state', counter], value, model);\n      }\n      function modelSetCounterDisplay(counter, set, model) {\n        const update = ( set\n                         ? R.compose(R.uniq, R.append(counter))\n                         : R.reject(R.equals(counter))\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelToggleCounterDisplay(counter, model) {\n        const update = ( modelModel.isCounterDisplayed(counter, model)\n                         ? R.reject(R.equals(counter))\n                         : R.append(counter)\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelRenderCounter({ base,\n                                    cx, cy,\n                                    is_flipped }, model) {\n        const state = model.state;\n        const radius= model.info.base_radius;\n        const counter_options = {\n          rotate: -state.r,\n          flipped: is_flipped,\n          flip_center: { x: cx, y: cy },\n          text_center: { x: cx, y: cy + 2 }\n        };\n        const counter = base\n                .renderText(counter_options, state.c);\n        counter.show = modelModel\n          .isCounterDisplayed('c', model);\n        const souls_options = {\n          rotate: -state.r,\n          flip_center: { x: cx, y: cy },\n          text_center: { x: cx + radius * 0.8 + 5,\n                         y: cy - radius - 5 }\n        };\n        const souls = base\n                .renderText(souls_options, state.s);\n        souls.show = modelModel\n          .isCounterDisplayed('s', model);\n        souls.cx = souls.x - 10;\n        souls.cy = souls.y - 10;\n        return {\n          counter,\n          souls\n        };\n      }\n    };\n  }\n})();\n"]}