{"version":3,"sources":["move.es6"],"names":[],"mappings":"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","file":"move.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelMove', modelMoveModelFactory);\n\n  modelMoveModelFactory.$inject = [\n    'point',\n  ];\n  function modelMoveModelFactory(pointModel) {\n    const STATE_LENS = R.lensProp('state');\n    const X_LENS = R.lensPath(['state','x']);\n    const Y_LENS = R.lensPath(['state','y']);\n    return (MOVES, modelModel) => {\n      const modelMoveModel = {\n        setPositionP: moveModel(modelSetPosition, true),\n        setPositionP_: modelSetPositionP_,\n        shiftPositionP: moveModel(modelShiftPosition, true),\n        setOrientationP: moveModel(modelSetOrientation, false),\n        orientToP: moveModel(modelOrientTo, false),\n        moveFrontP: moveModel(modelMoveFront, false),\n        moveBackP: moveModel(modelMoveBack, false),\n        rotateLeftP: moveModel(modelRotateLeft, false),\n        rotateRightP: moveModel(modelRotateRight, false),\n        shiftLeftP: moveModel(modelShiftLeft, false),\n        shiftRightP: moveModel(modelShiftRight, false),\n        shiftUpP: moveModel(modelShiftUp, false),\n        shiftDownP: moveModel(modelShiftDown, false)\n      };\n      return modelMoveModel;\n\n      function moveModel(move, withTarget) {\n        return function(...args) {\n          const model = R.last(args);\n          const factions = R.head(args);\n          const target = (withTarget ? R.nth(1, args) : null);\n          return R.threadP(model)(\n            R.rejectIfP(modelModel.isLocked,\n                       'Model is locked'),\n            () => move.apply(this, args),\n            modelModel.checkState$(factions, target)\n          );\n        };\n      }\n      function modelSetPosition(_factions_, _target_, pos, model) {\n        return R.pipe(\n          R.set(X_LENS, pos.x),\n          R.set(Y_LENS, pos.y)\n        )(model);\n      }\n      function modelSetPositionP_(factions, target, pos, model) {\n        return R.threadP(model)(\n          R.rejectIfP(modelModel.isLocked,\n                     'Model is locked'),\n          R.set(X_LENS, pos.x),\n          R.set(Y_LENS, pos.y),\n          modelModel.checkState$(factions, target),\n          (check) => {\n            model.state = check.state;\n            return model;\n          }\n        );\n      }\n      function modelShiftPosition(_factions_, _target_, shift, model) {\n        return R.pipe(\n          R.over(X_LENS, R.add(shift.x)),\n          R.over(Y_LENS, R.add(shift.y))\n        )(model);\n      }\n      function modelSetOrientation(_factions_, orientation, model) {\n        return R.assocPath(['state','r'], orientation, model);\n      }\n      function modelOrientTo(_factions_, other, model) {\n        return R.assocPath(['state','r'],\n                           pointModel.directionTo(other.state, model.state),\n                           model);\n      }\n      function modelMoveFront(_factions_, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(\n          STATE_LENS,\n          pointModel.moveFront$(dist),\n          model\n        );\n      }\n      function modelMoveBack(_factions_, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(\n          STATE_LENS,\n          pointModel.moveBack$(dist),\n          model\n        );\n      }\n      function modelRotateLeft(_factions_, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(\n          STATE_LENS,\n          pointModel.rotateLeft$(angle),\n          model\n        );\n      }\n      function modelRotateRight(_factions_, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(\n          STATE_LENS,\n          pointModel.rotateRight$(angle),\n          model\n        );\n      }\n      function modelShiftLeft(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(\n          STATE_LENS,\n          pointModel.shiftLeft$(dist),\n          model\n        );\n      }\n      function modelShiftRight(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(\n          STATE_LENS,\n          pointModel.shiftRight$(dist),\n          model\n        );\n      }\n      function modelShiftUp(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(\n          STATE_LENS,\n          pointModel.shiftUp$(dist),\n          model\n        );\n      }\n      function modelShiftDown(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(\n          STATE_LENS,\n          pointModel.shiftDown$(dist),\n          model\n        );\n      }\n    };\n  }\n})();\n"]}