{"version":3,"sources":["move.es6"],"names":[],"mappings":"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","file":"move.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelMove', modelMoveModelFactory);\n\n  modelMoveModelFactory.$inject = [\n    'point',\n  ];\n  function modelMoveModelFactory(pointModel) {\n    return (MOVES, modelModel) => {\n      const modelMoveModel = {\n        setPositionP: moveModel(modelSetPositionP, true),\n        setPosition_: modelSetPosition_,\n        shiftPositionP: moveModel(modelShiftPositionP, true),\n        setOrientationP: moveModel(modelSetOrientationP, false),\n        orientToP: moveModel(modelOrientToP, false),\n        moveFrontP: moveModel(modelMoveFrontP, false),\n        moveBackP: moveModel(modelMoveBackP, false),\n        rotateLeftP: moveModel(modelRotateLeftP, false),\n        rotateRightP: moveModel(modelRotateRightP, false),\n        shiftLeftP: moveModel(modelShiftLeftP, false),\n        shiftRightP: moveModel(modelShiftRightP, false),\n        shiftUpP: moveModel(modelShiftUpP, false),\n        shiftDownP: moveModel(modelShiftDownP, false)\n      };\n      return modelMoveModel;\n\n      function moveModel(move, withTarget) {\n        return function(...args) {\n          const model = R.last(args);\n          const factions = R.head(args);\n          const target = (withTarget ? R.nth(1, args) : null);\n          return R.threadP(model)(\n            R.rejectIfP(modelModel.isLocked,\n                       'Model is locked'),\n            () => move.apply(this, args),\n            modelModel.checkStateP$(factions, target)\n          );\n        };\n      }\n      function modelSetPositionP(_factions_, _target_, pos, model) {\n        return R.pipe(\n          R.assocPath(['state','x'], pos.x),\n          R.assocPath(['state','y'], pos.y)\n        )(model);\n      }\n      function modelSetPosition_(factions, target, pos, model) {\n        return R.threadP(model)(\n          R.rejectIfP(modelModel.isLocked,\n                     'Model is locked'),\n          R.assocPath(['state','x'], pos.x),\n          R.assocPath(['state','y'], pos.y),\n          modelModel.checkStateP$(factions, target),\n          (check) => {\n            model.state = check.state;\n            return model;\n          }\n        );\n      }\n      function modelShiftPositionP(_factions_, _target_, shift, model) {\n        return R.pipe(\n          R.over(R.lensPath(['state','x']), R.add(shift.x)),\n          R.over(R.lensPath(['state','y']), R.add(shift.y))\n        )(model);\n      }\n      function modelSetOrientationP(_factions_, orientation, model) {\n        return R.assocPath(['state','r'], orientation, model);\n      }\n      function modelOrientToP(_factions_, other, model) {\n        return R.assocPath(['state','r'],\n                           pointModel.directionTo(other.state, model.state),\n                           model);\n      }\n      function modelMoveFrontP(_factions_, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(R.lensProp('state'),\n                      pointModel.moveFront$(dist),\n                      model);\n      }\n      function modelMoveBackP(_factions_, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(R.lensProp('state'),\n                      pointModel.moveBack$(dist),\n                      model);\n      }\n      function modelRotateLeftP(_factions_, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(R.lensProp('state'),\n                      pointModel.rotateLeft$(angle),\n                      model);\n      }\n      function modelRotateRightP(_factions_, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(R.lensProp('state'),\n                      pointModel.rotateRight$(angle),\n                      model);\n      }\n      function modelShiftLeftP(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftLeft$(dist),\n                      model);\n      }\n      function modelShiftRightP(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftRight$(dist),\n                      model);\n      }\n      function modelShiftUpP(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftUp$(dist),\n                      model);\n      }\n      function modelShiftDownP(_factions_, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftDown$(dist),\n                      model);\n      }\n    };\n  }\n})();\n"]}