{"version":3,"sources":["move.es6"],"names":[],"mappings":"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","file":"move.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelMove', modelMoveModelFactory);\n\n  modelMoveModelFactory.$inject = [\n    'settings',\n    'point',\n  ];\n  function modelMoveModelFactory(settingsModel,\n                                 pointModel) {\n    return (MOVES, modelModel) => {\n      const modelMoveModel = {\n        setPositionP: moveModel(modelSetPositionP, true),\n        setPosition_: modelSetPosition_,\n        shiftPositionP: moveModel(modelShiftPositionP, true),\n        setOrientationP: moveModel(modelSetOrientationP, false),\n        orientToP: moveModel(modelOrientToP, false),\n        moveFrontP: moveModel(modelMoveFrontP, false),\n        moveBackP: moveModel(modelMoveBackP, false),\n        rotateLeftP: moveModel(modelRotateLeftP, false),\n        rotateRightP: moveModel(modelRotateRightP, false),\n        shiftLeftP: moveModel(modelShiftLeftP, false),\n        shiftRightP: moveModel(modelShiftRightP, false),\n        shiftUpP: moveModel(modelShiftUpP, false),\n        shiftDownP: moveModel(modelShiftDownP, false)\n      };\n      return modelMoveModel;\n\n      function moveModel(move, withTarget) {\n        return function(...args) {\n          const model = R.last(args);\n          const factions = R.head(args);\n          const target = (withTarget ? R.nth(1, args) : null);\n          return R.threadP(model)(\n            R.rejectIf(modelModel.isLocked,\n                       'Model is locked'),\n            () => move.apply(this, args),\n            modelModel.checkStateP$(factions, target)\n          );\n        };\n      }\n      function modelSetPositionP(factions, target, pos, model) {\n        return R.pipe(\n          R.assocPath(['state','x'], pos.x),\n          R.assocPath(['state','y'], pos.y)\n        )(model);\n      }\n      function modelSetPosition_(factions, target, pos, model) {\n        return R.threadP(model)(\n          R.rejectIf(modelModel.isLocked,\n                     'Model is locked'),\n          R.assocPath(['state','x'], pos.x),\n          R.assocPath(['state','y'], pos.y),\n          modelModel.checkStateP$(factions, target),\n          (check) => {\n            model.state = check.state;\n            return model;\n          }\n        );\n      }\n      function modelShiftPositionP(factions, target, shift, model) {\n        return R.pipe(\n          R.over(R.lensPath(['state','x']), R.add(shift.x)),\n          R.over(R.lensPath(['state','y']), R.add(shift.y))\n        )(model);\n      }\n      function modelSetOrientationP(factions, orientation, model) {\n        return R.assocPath(['state','r'], orientation, model);\n      }\n      function modelOrientToP(factions, other, model) {\n        return R.assocPath(['state','r'],\n                           pointModel.directionTo(other.state, model.state),\n                           model);\n      }\n      function modelMoveFrontP(factions, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(R.lensProp('state'),\n                      pointModel.moveFront$(dist),\n                      model);\n      }\n      function modelMoveBackP(factions, small, model) {\n        const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n        return R.over(R.lensProp('state'),\n                      pointModel.moveBack$(dist),\n                      model);\n      }\n      function modelRotateLeftP(factions, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(R.lensProp('state'),\n                      pointModel.rotateLeft$(angle),\n                      model);\n      }\n      function modelRotateRightP(factions, small, model) {\n        const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n        return R.over(R.lensProp('state'),\n                      pointModel.rotateRight$(angle),\n                      model);\n      }\n      function modelShiftLeftP(factions, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftLeft$(dist),\n                      model);\n      }\n      function modelShiftRightP(factions, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftRight$(dist),\n                      model);\n      }\n      function modelShiftUpP(factions, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftUp$(dist),\n                      model);\n      }\n      function modelShiftDownP(factions, small, model) {\n        const dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n        return R.over(R.lensProp('state'),\n                      pointModel.shiftDown$(dist),\n                      model);\n      }\n    };\n  }\n})();\n"]}