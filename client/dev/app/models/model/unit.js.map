{"version":3,"sources":["unit.es6"],"names":[],"mappings":"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","file":"unit.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelUnit', modelModelFactory);\n\n  modelModelFactory.$inject = [];\n  function modelModelFactory() {\n    const DSP_LENS = R.lensPath(['state','dsp']);\n    const UNIT_LENS = R.lensPath(['state','u']);\n    return (modelModel) => {\n      const modelUnitModel = {\n        isUnitDisplayed: modelIsUnitDisplayed,\n        unit: modelUnit,\n        unitIs: modelUnitIs,\n        setUnit: modelSetUnit,\n        setUnitDisplay: modelSetUnitDisplay,\n        toggleUnitDisplay: modelToggleUnitDisplay,\n        renderUnit: modelRenderUnit\n      };\n      return modelUnitModel;\n\n      function modelIsUnitDisplayed(model) {\n        return !!R.find(R.equals('u'), R.viewOr([], DSP_LENS, model));\n      }\n      function modelUnit(model) {\n        return R.viewOr(0, UNIT_LENS, model);\n      }\n      function modelUnitIs(unit, model) {\n        return unit === R.view(UNIT_LENS, model);\n      }\n      function modelSetUnit(unit, model) {\n        return R.set(UNIT_LENS, unit, model);\n      }\n      function modelSetUnitDisplay(set, model) {\n        const update = ( set\n                         ? R.compose(R.uniq, R.append('u'))\n                         : R.reject(R.equals('u'))\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelToggleUnitDisplay(model) {\n        const update = ( modelModel.isUnitDisplayed(model)\n                         ? R.reject(R.equals('u'))\n                         : R.append('u')\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelRenderUnit({ base, cx, cy }, model) {\n        const radius = model.info.base_radius;\n        const unit_options = {\n          rotate: -model.state.r,\n          flip_center: { x: cx, y: cy },\n          text_center: { x: cx - radius * 0.7 - 5,\n                         y: cy - radius * 0.7 - 5 }\n        };\n        const unit = base\n                .renderText(unit_options, `U${modelModel.unit(model)}`);\n        unit.show = modelModel\n          .isUnitDisplayed(model);\n        unit.cx = unit.x - 10;\n        unit.cy = unit.y - 10;\n        return { unit };\n      }\n    };\n  }\n})();\n"]}