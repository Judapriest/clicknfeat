{"version":3,"sources":["image.es6"],"names":[],"mappings":"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","file":"image.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelImage', modelImageModelFactory);\n\n  modelImageModelFactory.$inject = [\n    'gameFactions',\n  ];\n  function modelImageModelFactory(gameFactionsModel) {\n    const DSP_LENS = R.lensPath(['state','dsp']);\n    return (modelModel) => {\n      const modelImageModel = {\n        isImageDisplayed: modelIsImageDisplayed,\n        getImage: modelGetImage,\n        setNextImage: modelSetNextImage,\n        setImageDisplay: modelSetImageDisplay,\n        toggleImageDisplay: modelToggleImageDisplay\n      };\n      return modelImageModel;\n\n      function modelIsImageDisplayed(model) {\n        return !!R.find(R.equals('i'), R.viewOr([], DSP_LENS, model));\n      }\n      function modelGetImage(factions, model) {\n        return R.thread(factions)(\n          gameFactionsModel.getModelInfo$(model.state.info),\n          R.prop('img'),\n          (info_img) => {\n            let img = R.thread(info_img)(\n              R.filter(R.propEq('type','default')),\n              R.prop(model.state.img)\n            );\n            if(modelModel.isLeaderDisplayed(model)) {\n              img = R.thread(info_img)(\n                R.filter(R.propEq('type','leader')),\n                R.head,\n                R.defaultTo(img)\n              );\n            }\n            if(modelModel.isIncorporealDisplayed(model)) {\n              img = R.thread(info_img)(\n                R.filter(R.propEq('type','incorporeal')),\n                R.head,\n                R.defaultTo(img)\n              );\n            }\n            const link = modelModel.isImageDisplayed(model) ? img.link : null;\n            return R.assoc('link', link, img);\n          }\n        );\n      }\n      function modelSetNextImage(factions, model) {\n        return R.thread(factions)(\n          gameFactionsModel.getModelInfo$(model.state.info),\n          R.prop('img'),\n          R.filter(R.propEq('type','default')),\n          (imgs) => (model.state.img >= imgs.length-1) ? 0 : model.state.img + 1,\n          (next_img) => R.assocPath(['state','img'], next_img, model)\n        );\n      }\n      function modelSetImageDisplay(set, model) {\n        const update = ( set\n                         ? R.compose(R.uniq, R.append('i'))\n                         : R.reject(R.equals('i'))\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n      function modelToggleImageDisplay(model) {\n        const update = ( modelModel.isImageDisplayed(model)\n                         ? R.reject(R.equals('i'))\n                         : R.append('i')\n                       );\n        return R.over(DSP_LENS, update, model);\n      }\n    };\n  }\n})();\n"]}