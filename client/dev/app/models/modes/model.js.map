{"version":3,"sources":["model.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,WADX,EACwB,qBADxB,EADU;;AAIV,wBAAsB,OAAtB,GAAgC,CAC9B,OAD8B,EAE9B,UAF8B,EAG9B,YAH8B,EAI9B,eAJ8B,EAK9B,oBAL8B,CAAhC,CAJU;AAWV,WAAS,qBAAT,CAA+B,UAA/B,EAC+B,aAD/B,EAE+B,eAF/B,EAG+B,kBAH/B,EAI+B,uBAJ/B,EAIwD;AACtD,QAAM,gBAAgB,OAAO,MAAP,CAAc,mBAAmB,OAAnB,CAA9B,CADgD;AAEtD,kBAAc,WAAd,GAA4B,gBAA5B,CAFsD;AAGtD,kBAAc,UAAd,GAA2B,eAA3B,CAHsD;;AAKtD,QAAM,yBAAyB;AAC7B,qBAAe,GAAf;AACA,oBAAc,GAAd;KAFI,CALgD;AAStD,QAAM,iBAAiB,EAAE,MAAF,CAAS,OAAO,MAAP,CAAc,mBAAmB,QAAnB,CAAvB,EACO,sBADP,CAAjB,CATgD;AAWtD,QAAM,gBAAgB,gBACf,YADe,CACF,EAAE,QAAQ,IAAR;AACA,oBAAc,IAAd;AACA,mBAAa,IAAb;KAHA,CAAhB,CAXgD;AAgBtD,QAAM,aAAa;AACjB,eAAS,mBAAM,EAAN;AACT,eAAS,mBAAM,EAAN;AACT,YAAM,OAAN;AACA,eAAS,aAAT;AACA,eAAS,aAAT;AACA,gBAAU,cAAV;KANI,CAhBgD;AAwBtD,eAAW,YAAX,CAAwB,UAAxB,EAxBsD;AAyBtD,kBAAc,QAAd,CAAuB,UAAvB,EACuB,WAAW,IAAX,EACA,sBAFvB,EAGuB,UAAC,EAAD,EAAQ;AACN,QAAE,MAAF,CAAS,WAAW,QAAX,EAAqB,EAA9B,EADM;KAAR,CAHvB,CAzBsD;AA+BtD,WAAO,UAAP,CA/BsD;;AAiCtD,aAAS,gBAAT,CAA0B,KAA1B,EAAiC;AAC/B,UAAM,SAAS,wBACN,GADM,CACF,OADE,EACO,MAAM,IAAN,CAAW,eAAX,CADhB,CADyB;AAG/B,aAAO,EAAE,OAAF,GACL;eAAM,MAAM,MAAN,CAAa,sBAAb,EACa,UADb,EAEa,CAAC,cAAD,EAAiB,EAAjB,EAAqB,MAArB,CAFb;OAAN,EAGA;eAAM,MAAM,MAAN,CAAa,gBAAb,EAA+B,aAA/B;OAAN,CAJF,CAH+B;KAAjC;AAUA,aAAS,eAAT,CAAyB,KAAzB,EAAgC;AAC9B,UAAM,SAAS,wBACN,GADM,CACF,OADE,EACO,MAAM,IAAN,CAAW,eAAX,CADhB,CADwB;AAG9B,aAAO,EAAE,OAAF,GACL;eAAM,MAAM,MAAN,CAAa,sBAAb,EACa,UADb,EAEa,CAAE,aAAF,EAAiB,EAAjB,EAAqB,MAArB,CAFb;OAAN,EAGA;eAAM,MAAM,MAAN,CAAa,gBAAb,EAA+B,YAA/B;OAAN,CAJF,CAH8B;KAAhC;GA/CF;CAXD,CAAD","file":"model.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('modelMode', modelModeModelFactory);\n\n  modelModeModelFactory.$inject = [\n    'modes',\n    'settings',\n    'modelsMode',\n    'modelBaseMode',\n    'gameModelSelection',\n  ];\n  function modelModeModelFactory(modesModel,\n                                 settingsModel,\n                                 modelsModeModel,\n                                 modelBaseModeModel,\n                                 gameModelSelectionModel) {\n    const model_actions = Object.create(modelBaseModeModel.actions);\n    model_actions.startCharge = modelStartCharge;\n    model_actions.startPlace = modelStartPlace;\n\n    const model_default_bindings = {\n      'startCharge': 'c',\n      'startPlace': 'p'\n    };\n    const model_bindings = R.extend(Object.create(modelBaseModeModel.bindings),\n                                  model_default_bindings);\n    const model_buttons = modelsModeModel\n          .buildButtons({ single: true,\n                          start_charge: true,\n                          start_place: true\n                        });\n    const model_mode = {\n      onEnter: () => { },\n      onLeave: () => { },\n      name: 'Model',\n      actions: model_actions,\n      buttons: model_buttons,\n      bindings: model_bindings\n    };\n    modesModel.registerMode(model_mode);\n    settingsModel.register('Bindings',\n                           model_mode.name,\n                           model_default_bindings,\n                           (bs) => {\n                             R.extend(model_mode.bindings, bs);\n                           });\n    return model_mode;\n\n    function modelStartCharge(state) {\n      const stamps = gameModelSelectionModel\n              .get('local', state.game.model_selection);\n      return R.threadP()(\n        () => state.eventP('Game.command.execute',\n                           'onModels',\n                           ['startChargeP', [], stamps]),\n        () => state.eventP('Modes.switchTo', 'ModelCharge')\n      );\n    }\n    function modelStartPlace(state) {\n      const stamps = gameModelSelectionModel\n              .get('local', state.game.model_selection);\n      return R.threadP()(\n        () => state.eventP('Game.command.execute',\n                           'onModels',\n                           [ 'startPlaceP', [], stamps]),\n        () => state.eventP('Modes.switchTo', 'ModelPlace')\n      );\n    }\n  }\n})();\n"]}