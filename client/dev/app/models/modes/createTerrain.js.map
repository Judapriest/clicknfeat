{"version":3,"sources":["createTerrain.es6"],"names":[],"mappings":";;AAAA,QAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,mBADX,EACgC,CAC5B,OAD4B,EAE5B,UAF4B,EAG5B,YAH4B,EAI5B,MAJ4B,EAK5B,SAAS,+BAAT,CAAyC,YAAzC,EACyC,eADzC,EAEyC,iBAFzC,EAE4D;AAC1D,MAAI,wBAAwB,OAAO,MAAP,CAAc,kBAAkB,OAAlB,CAAtC,CADsD;AAE1D,WAAS,gBAAT,CAA0B,KAA1B,EAAiC,KAAjC,EAAwC;AACtC,UAAM,MAAN,GAAe,EAAE,IAAF,CACb,EAAE,QAAF,CAAW,CAAC,SAAD,EAAW,MAAX,CAAX,CADa,EAEb,EAAE,IAAF,CACE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CADf,EAEE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CAFf,CAFa,EAMb,MAAM,MAAN,CANF,CADsC;GAAxC;AAUA,wBAAsB,OAAtB,GAAgC,UAAC,KAAD,EAAQ,KAAR,EAAkB;AAChD,qBAAiB,KAAjB,EAAwB,KAAxB,EADgD;AAEhD,WAAO,MAAM,WAAN,CAAkB,oBAAlB,CAAP,CAFgD;GAAlB,CAZ0B;AAgB1D,wBAAsB,MAAtB,GAA+B,UAAC,KAAD,EAAQ,KAAR,EAAkB;AAC/C,QAAI,aAAa,EAAE,IAAF,CAAO,CAAC,UAAD,EAAY,UAAZ,CAAP,EAAgC,KAAhC,CAAb,CAD2C;AAE/C,qBAAiB,MAAM,QAAN,CAAjB,EAAkC,KAAlC,EAF+C;AAG/C,WAAO,MAAM,KAAN,CAAY,sBAAZ,EACY,eADZ,EAC6B,CAAE,MAAM,MAAN,CAAa,OAAb,EAAsB,UAAxB,CAD7B,CAAP,CAH+C;GAAlB,CAhB2B;AAsB1D,MAAI,iCAAiC;AACnC,cAAU,UAAV;GADE,CAtBsD;AAyB1D,MAAI,yBAAyB,EAAE,MAAF,CAAS,OAAO,MAAP,CAAc,kBAAkB,QAAlB,CAAvB,EACS,8BADT,CAAzB,CAzBsD;AA2B1D,MAAI,wBAAwB,EAAxB,CA3BsD;AA4B1D,MAAI,qBAAqB;AACvB,aAAS,iBAAC,KAAD,EAAW;AAClB,YAAM,WAAN,CAAkB,4BAAlB,EADkB;AAElB,YAAM,WAAN,CAAkB,qBAAlB,EAFkB;KAAX;AAIT,aAAS,iBAAC,KAAD,EAAW;AAClB,YAAM,MAAN,GAAe,EAAE,KAAF,CAAQ,SAAR,EAAmB,IAAnB,EAAyB,MAAM,MAAN,CAAxC,CADkB;AAElB,YAAM,WAAN,CAAkB,sBAAlB,EAFkB;AAGlB,YAAM,WAAN,CAAkB,6BAAlB,EAHkB;KAAX;AAKT,UAAM,eAAN;AACA,aAAS,qBAAT;AACA,aAAS,qBAAT;AACA,cAAU,sBAAV;GAbE,CA5BsD;AA2C1D,eAAa,YAAb,CAA0B,kBAA1B,EA3C0D;AA4C1D,kBAAgB,QAAhB,CAAyB,UAAzB,EACyB,mBAAmB,IAAnB,EACA,8BAFzB,EAGyB,UAAC,EAAD,EAAQ;AACN,MAAE,MAAF,CAAS,mBAAmB,QAAnB,EAA6B,EAAtC,EADM;GAAR,CAHzB,CA5C0D;AAkD1D,SAAO,kBAAP,CAlD0D;CAF5D,CANJ","file":"createTerrain.js","sourcesContent":["angular.module('clickApp.services')\n  .factory('createTerrainMode', [\n    'modes',\n    'settings',\n    'commonMode',\n    'game',\n    function createTerrainModeServiceFactory(modesService,\n                                             settingsService,\n                                             commonModeService) {\n      var createTerrain_actions = Object.create(commonModeService.actions);\n      function updateCreateBase(coord, state) {\n        state.create = R.over(\n          R.lensPath(['terrain','base']),\n          R.pipe(\n            R.assoc('x', coord.x),\n            R.assoc('y', coord.y)\n          ),\n          state.create\n        );\n      }\n      createTerrain_actions.moveMap = (state, coord) => {\n        updateCreateBase(coord, state);\n        return state.changeEvent('Game.create.update');\n      };\n      createTerrain_actions.create = (state, event) => {\n        let is_flipped = R.path(['ui_state','flip_map'], state);\n        updateCreateBase(event['click#'], state);\n        return state.event('Game.command.execute',\n                           'createTerrain', [ state.create.terrain, is_flipped ]);\n      };\n      var createTerrain_default_bindings = {\n        'create': 'clickMap'\n      };\n      var createTerrain_bindings = R.extend(Object.create(commonModeService.bindings),\n                                            createTerrain_default_bindings);\n      var createTerrain_buttons = [];\n      var createTerrain_mode = {\n        onEnter: (state) => {\n          state.changeEvent('Game.terrain.create.enable');\n          state.changeEvent('Game.moveMap.enable');\n        },\n        onLeave: (state) => {\n          state.create = R.assoc('terrain', null, state.create);\n          state.changeEvent('Game.moveMap.disable');\n          state.changeEvent('Game.terrain.create.disable');\n        },\n        name: 'CreateTerrain',\n        actions: createTerrain_actions,\n        buttons: createTerrain_buttons,\n        bindings: createTerrain_bindings\n      };\n      modesService.registerMode(createTerrain_mode);\n      settingsService.register('Bindings',\n                               createTerrain_mode.name,\n                               createTerrain_default_bindings,\n                               (bs) => {\n                                 R.extend(createTerrain_mode.bindings, bs);\n                               });\n      return createTerrain_mode;\n    }\n  ]);\n"]}