{"version":3,"sources":["element.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,mBADX,EACgC,6BADhC,EADU;;AAIV,gCAA8B,OAA9B,GAAwC,CACtC,YADsC,CAAxC,CAJU;AAOV,WAAS,6BAAT,CAAuC,eAAvC,EAAwD;AACtD,WAAO,SAAS,sBAAT,CAAgC,IAAhC,EAAsC;AAC3C,UAAM,wBAAwB,OAAO,MAAP,CAAc,gBAAgB,OAAhB,CAAtC,CADqC;AAE3C,4BAAsB,OAAtB,GAAgC,OAAhC,CAF2C;AAG3C,4BAAsB,MAAtB,GAA+B,MAA/B,CAH2C;;AAK3C,UAAM,iCAAiC;AACrC,kBAAU,UAAV;OADI,CALqC;AAQ3C,UAAM,yBAAyB,EAAE,MAAF,CAAS,OAAO,MAAP,CAAc,gBAAgB,QAAhB,CAAvB,EACS,8BADT,CAAzB,CARqC;AAU3C,UAAM,wBAAwB,EAAxB,CAVqC;;AAY3C,UAAM,qBAAqB;AACzB,iBAAS,OAAT;AACA,iBAAS,OAAT;AACA,yBAAe,EAAE,UAAF,CAAa,IAAb,CAAf;AACA,iBAAS,qBAAT;AACA,iBAAS,qBAAT;AACA,kBAAU,sBAAV;OANI,CAZqC;;AAqB3C,aAAO,kBAAP,CArB2C;;AAuB3C,eAAS,OAAT,CAAiB,KAAjB,EAAwB;AACtB,cAAM,iBAAN,WAAgC,uBAAhC,EADsB;AAEtB,cAAM,iBAAN,CAAwB,qBAAxB,EAFsB;OAAxB;AAIA,eAAS,OAAT,CAAiB,KAAjB,EAAwB;AACtB,cAAM,MAAN,GAAe,EAAE,KAAF,CAAW,UAAX,EAAoB,IAApB,EAA0B,MAAM,MAAN,CAAzC,CADsB;AAEtB,cAAM,iBAAN,CAAwB,sBAAxB,EAFsB;AAGtB,cAAM,iBAAN,WAAgC,wBAAhC,EAHsB;OAAxB;AAKA,eAAS,OAAT,CAAiB,KAAjB,EAAwB,KAAxB,EAA+B;AAC7B,yBAAiB,KAAjB,EAAwB,KAAxB,EAD6B;AAE7B,cAAM,iBAAN,CAAwB,oBAAxB,EAF6B;OAA/B;AAIA,eAAS,MAAT,CAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AAC5B,YAAI,aAAa,EAAE,IAAF,CAAO,CAAC,UAAD,EAAY,UAAZ,CAAP,EAAgC,KAAhC,CAAb,CADwB;AAE5B,yBAAiB,MAAM,QAAN,CAAjB,EAAkC,KAAlC,EAF4B;AAG5B,eAAO,MAAM,MAAN,CAAa,sBAAb,aACsB,EAAE,UAAF,CAAa,IAAb,CADtB,EAEa,CAAE,MAAM,MAAN,EAAc,UAAhB,CAFb,CAAP,CAH4B;OAA9B;AAOA,eAAS,gBAAT,CAA0B,KAA1B,EAAiC,KAAjC,EAAwC;AACtC,cAAM,MAAN,GAAe,EAAE,IAAF,CACb,EAAE,QAAF,CAAW,MAAX,CADa,EAEb,EAAE,IAAF,CACE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CADf,EAEE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CAFf,CAFa,EAMb,MAAM,MAAN,CANF,CADsC;OAAxC;KA3CK,CAD+C;GAAxD;CAPD,CAAD","file":"element.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('createElementMode', createElementModeModelFactory);\n\n  createElementModeModelFactory.$inject = [\n    'commonMode',\n  ];\n  function createElementModeModelFactory(commonModeModel) {\n    return function createElementModeModel(type) {\n      const createElement_actions = Object.create(commonModeModel.actions);\n      createElement_actions.moveMap = moveMap;\n      createElement_actions.create = create;\n\n      const createElement_default_bindings = {\n        'create': 'clickMap'\n      };\n      const createElement_bindings = R.extend(Object.create(commonModeModel.bindings),\n                                              createElement_default_bindings);\n      const createElement_buttons = [];\n\n      const createElement_mode = {\n        onEnter: onEnter,\n        onLeave: onLeave,\n        name: `Create${s.capitalize(type)}`,\n        actions: createElement_actions,\n        buttons: createElement_buttons,\n        bindings: createElement_bindings\n      };\n\n      return createElement_mode;\n\n      function onEnter(state) {\n        state.queueChangeEventP(`Game.${type}.create.enable`);\n        state.queueChangeEventP('Game.moveMap.enable');\n      }\n      function onLeave(state) {\n        state.create = R.assoc(`${type}s`, null, state.create);\n        state.queueChangeEventP('Game.moveMap.disable');\n        state.queueChangeEventP(`Game.${type}.create.disable`);\n      }\n      function moveMap(state, coord) {\n        updateCreateBase(coord, state);\n        state.queueChangeEventP('Game.create.update');\n      }\n      function create(state, event) {\n        let is_flipped = R.path(['ui_state','flip_map'], state);\n        updateCreateBase(event['click#'], state);\n        return state.eventP('Game.command.execute',\n                            `create${s.capitalize(type)}`,\n                            [ state.create, is_flipped ]);\n      }\n      function updateCreateBase(coord, state) {\n        state.create = R.over(\n          R.lensProp('base'),\n          R.pipe(\n            R.assoc('x', coord.x),\n            R.assoc('y', coord.y)\n          ),\n          state.create\n        );\n      }\n    };\n  }\n})();\n"]}