{"version":3,"sources":["element.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,mBADX,EACgC,6BADhC,EADU;;AAIV,gCAA8B,OAA9B,GAAwC,CACtC,UADsC,EAEtC,YAFsC,CAAxC,CAJU;AAQV,WAAS,6BAAT,CAAuC,eAAvC,EACuC,eADvC,EACwD;AACtD,QAAM,cAAc,EAAE,QAAF,CAAW,QAAX,CAAd,CADgD;AAEtD,WAAO,SAAS,sBAAT,CAAgC,IAAhC,EAAsC;AAC3C,UAAM,wBAAwB,OAAO,MAAP,CAAc,gBAAgB,OAAhB,CAAtC,CADqC;AAE3C,4BAAsB,OAAtB,GAAgC,OAAhC,CAF2C;AAG3C,4BAAsB,MAAtB,GAA+B,MAA/B,CAH2C;;AAK3C,UAAM,iCAAiC;AACrC,kBAAU,UAAV;OADI,CALqC;AAQ3C,UAAM,yBAAyB,EAAE,MAAF,CAAS,OAAO,MAAP,CAAc,gBAAgB,QAAhB,CAAvB,EACS,8BADT,CAAzB,CARqC;AAU3C,UAAM,wBAAwB,EAAxB,CAVqC;;AAY3C,UAAM,qBAAqB;AACzB,iBAAS,OAAT;AACA,iBAAS,OAAT;AACA,yBAAe,EAAE,UAAF,CAAa,IAAb,CAAf;AACA,iBAAS,qBAAT;AACA,iBAAS,qBAAT;AACA,kBAAU,sBAAV;OANI,CAZqC;AAoB3C,UAAM,oBAAoB,EAAE,KAAF,CAAQ,gBAAR,CAApB,CApBqC;AAqB3C,aAAO,kBAAP,CArB2C;;AAuB3C,eAAS,OAAT,GAAmB;AACjB,wBAAgB,IAAhB,CAAqB,qBAArB,EADiB;OAAnB;AAGA,eAAS,OAAT,GAAmB;AACjB,wBAAgB,IAAhB,CAAqB,sBAArB,EADiB;OAAnB;AAGA,eAAS,OAAT,CAAiB,KAAjB,EAAwB,KAAxB,EAA+B;AAC7B,eAAO,EAAE,IAAF,CACL,WADK,EAEL,kBAAkB,KAAlB,CAFK,EAGL,KAHK,CAAP,CAD6B;OAA/B;AAOA,eAAS,MAAT,CAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AAC5B,YAAM,aAAa,EAAE,IAAF,CAAO,CAAC,UAAD,EAAY,UAAZ,CAAP,EAAgC,KAAhC,CAAb,CADsB;AAE5B,YAAM,SAAS,EAAE,MAAF,CAAS,KAAT,EACb,EAAE,IAAF,CAAO,WAAP,CADa,EAEb,kBAAkB,MAAM,QAAN,CAAlB,CAFa,CAAT,CAFsB;AAM5B,wBAAgB,WAAhB,CAA4B,sBAA5B,aACqC,EAAE,UAAF,CAAa,IAAb,CADrC,EAE4B,CAAE,MAAF,EAAU,UAAV,CAF5B,EAN4B;AAS5B,eAAO,EAAE,GAAF,CAAM,WAAN,EAAmB,EAAnB,EAAuB,KAAvB,CAAP,CAT4B;OAA9B;AAWA,eAAS,gBAAT,CAA0B,KAA1B,EAAiC,MAAjC,EAAyC;AACvC,eAAO,EAAE,IAAF,CACL,EAAE,QAAF,CAAW,MAAX,CADK,EAEL,EAAE,IAAF,CACE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CADf,EAEE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CAFf,CAFK,EAML,MANK,CAAP,CADuC;OAAzC;KA/CK,CAF+C;GADxD;CARD,CAAD","file":"element.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('createElementMode', createElementModeModelFactory);\n\n  createElementModeModelFactory.$inject = [\n    'appState',\n    'commonMode',\n  ];\n  function createElementModeModelFactory(appStateService,\n                                         commonModeModel) {\n    const CREATE_LENS = R.lensProp('create');\n    return function createElementModeModel(type) {\n      const createElement_actions = Object.create(commonModeModel.actions);\n      createElement_actions.moveMap = moveMap;\n      createElement_actions.create = create;\n\n      const createElement_default_bindings = {\n        'create': 'clickMap'\n      };\n      const createElement_bindings = R.extend(Object.create(commonModeModel.bindings),\n                                              createElement_default_bindings);\n      const createElement_buttons = [];\n\n      const createElement_mode = {\n        onEnter: onEnter,\n        onLeave: onLeave,\n        name: `Create${s.capitalize(type)}`,\n        actions: createElement_actions,\n        buttons: createElement_buttons,\n        bindings: createElement_bindings\n      };\n      const updateCreateBase$ = R.curry(updateCreateBase);\n      return createElement_mode;\n\n      function onEnter() {\n        appStateService.emit('Game.moveMap.enable');\n      }\n      function onLeave() {\n        appStateService.emit('Game.moveMap.disable');\n      }\n      function moveMap(state, coord) {\n        return R.over(\n          CREATE_LENS,\n          updateCreateBase$(coord),\n          state\n        );\n      }\n      function create(state, event) {\n        const is_flipped = R.path(['ui_state','flip_map'], state);\n        const create = R.thread(state)(\n          R.view(CREATE_LENS),\n          updateCreateBase$(event['click#'])\n        );\n        appStateService.chainReduce('Game.command.execute',\n                                    `create${s.capitalize(type)}`,\n                                    [ create, is_flipped ]);\n        return R.set(CREATE_LENS, {}, state);\n      }\n      function updateCreateBase(coord, create) {\n        return R.over(\n          R.lensProp('base'),\n          R.pipe(\n            R.assoc('x', coord.x),\n            R.assoc('y', coord.y)\n          ),\n          create\n        );\n      }\n    };\n  }\n})();\n"]}