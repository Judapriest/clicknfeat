{"version":3,"sources":["createModel.es6"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,iBADX,EAC8B,CAC1B,OAD0B,EAE1B,UAF0B,EAG1B,YAH0B,EAI1B,MAJ0B,EAK1B,SAAS,6BAAT,CAAuC,YAAvC,EACuC,eADvC,EAEuC,iBAFvC,EAE0D;AACxD,MAAI,sBAAsB,OAAO,MAAP,CAAc,kBAAkB,OAAlB,CAApC,CADoD;AAExD,WAAS,gBAAT,CAA0B,KAA1B,EAAiC,KAAjC,EAAwC;AACtC,UAAM,MAAN,GAAe,EAAE,IAAF,CACb,EAAE,QAAF,CAAW,CAAC,OAAD,EAAS,MAAT,CAAX,CADa,EAEb,EAAE,IAAF,CACE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CADf,EAEE,EAAE,KAAF,CAAQ,GAAR,EAAa,MAAM,CAAN,CAFf,CAFa,EAMb,MAAM,MAAN,CANF,CADsC;GAAxC;AAUA,sBAAoB,OAApB,GAA8B,UAAC,KAAD,EAAQ,KAAR,EAAkB;AAC9C,qBAAiB,KAAjB,EAAwB,KAAxB,EAD8C;AAE9C,WAAO,MAAM,WAAN,CAAkB,oBAAlB,CAAP,CAF8C;GAAlB,CAZ0B;AAgBxD,sBAAoB,MAApB,GAA6B,UAAC,KAAD,EAAQ,KAAR,EAAkB;AAC7C,QAAI,aAAa,EAAE,IAAF,CAAO,CAAC,UAAD,EAAY,UAAZ,CAAP,EAAgC,KAAhC,CAAb,CADyC;AAE7C,qBAAiB,MAAM,QAAN,CAAjB,EAAkC,KAAlC,EAF6C;AAG7C,WAAO,MAAM,KAAN,CAAY,sBAAZ,EACY,aADZ,EAC2B,CAAE,MAAM,MAAN,CAAa,KAAb,EAAoB,UAAtB,CAD3B,CAAP,CAH6C;GAAlB,CAhB2B;AAuBxD,MAAI,+BAA+B;AACjC,cAAU,UAAV;GADE,CAvBoD;AA0BxD,MAAI,uBAAuB,EAAE,MAAF,CAAS,OAAO,MAAP,CAAc,kBAAkB,QAAlB,CAAvB,EACS,4BADT,CAAvB,CA1BoD;AA4BxD,MAAI,sBAAsB,EAAtB,CA5BoD;AA6BxD,MAAI,mBAAmB;AACrB,aAAS,iBAAC,KAAD,EAAW;AAClB,YAAM,WAAN,CAAkB,0BAAlB,EADkB;AAElB,YAAM,WAAN,CAAkB,qBAAlB,EAFkB;KAAX;AAIT,aAAS,iBAAC,KAAD,EAAW;AAClB,YAAM,MAAN,CAAa,KAAb,GAAqB,IAArB,CADkB;AAElB,YAAM,WAAN,CAAkB,sBAAlB,EAFkB;AAGlB,YAAM,WAAN,CAAkB,2BAAlB,EAHkB;KAAX;AAKT,UAAM,aAAN;AACA,aAAS,mBAAT;AACA,aAAS,mBAAT;AACA,cAAU,oBAAV;GAbE,CA7BoD;AA4CxD,eAAa,YAAb,CAA0B,gBAA1B,EA5CwD;AA6CxD,kBAAgB,QAAhB,CAAyB,UAAzB,EACyB,iBAAiB,IAAjB,EACA,4BAFzB,EAGyB,UAAC,EAAD,EAAQ;AACN,MAAE,MAAF,CAAS,iBAAiB,QAAjB,EAA2B,EAApC,EADM;GAAR,CAHzB,CA7CwD;AAmDxD,SAAO,gBAAP,CAnDwD;CAF1D,CANJ","file":"createModel.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('createModelMode', [\n    'modes',\n    'settings',\n    'commonMode',\n    'game',\n    function createModelModeServiceFactory(modesService,\n                                           settingsService,\n                                           commonModeService) {\n      var createModel_actions = Object.create(commonModeService.actions);\n      function updateCreateBase(coord, state) {\n        state.create = R.over(\n          R.lensPath(['model','base']),\n          R.pipe(\n            R.assoc('x', coord.x),\n            R.assoc('y', coord.y)\n          ),\n          state.create\n        );\n      }\n      createModel_actions.moveMap = (state, coord) => {\n        updateCreateBase(coord, state);\n        return state.changeEvent('Game.create.update');\n      };\n      createModel_actions.create = (state, event) => {\n        let is_flipped = R.path(['ui_state','flip_map'], state);\n        updateCreateBase(event['click#'], state);\n        return state.event('Game.command.execute',\n                           'createModel', [ state.create.model, is_flipped ]);\n                           \n      };\n      var createModel_default_bindings = {\n        'create': 'clickMap'\n      };\n      var createModel_bindings = R.extend(Object.create(commonModeService.bindings),\n                                          createModel_default_bindings);\n      var createModel_buttons = [];\n      var createModel_mode = {\n        onEnter: (state) => {\n          state.changeEvent('Game.model.create.enable');\n          state.changeEvent('Game.moveMap.enable');\n        },\n        onLeave: (state) => {\n          state.create.model = null;\n          state.changeEvent('Game.moveMap.disable');\n          state.changeEvent('Game.model.create.disable');\n        },\n        name: 'CreateModel',\n        actions: createModel_actions,\n        buttons: createModel_buttons,\n        bindings: createModel_bindings\n      };\n      modesService.registerMode(createModel_mode);\n      settingsService.register('Bindings',\n                               createModel_mode.name,\n                               createModel_default_bindings,\n                               (bs) => {\n                                 R.extend(createModel_mode.bindings, bs);\n                               });\n      return createModel_mode;\n    }\n  ]);\n"]}