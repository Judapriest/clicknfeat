{"version":3,"sources":["aoe.es6"],"names":[],"mappings":"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","file":"aoe.js","sourcesContent":["(function() {\n  angular.module('clickApp.models')\n    .factory('aoeTemplate', aoeTemplateModelFactory);\n\n  aoeTemplateModelFactory.$inject = [\n    'template',\n    'point',\n  ];\n  function aoeTemplateModelFactory(templateModel,\n                                   pointModel) {\n    const aoeTemplateModel = Object.create(templateModel);\n    R.deepExtend(aoeTemplateModel, {\n      _create: aoeTemplateCreate,\n      setSizeP: aoeTemplateSetSizeP,\n      size: aoeTemplateSize,\n      deviate: aoeTemplateDeviateP,\n      maxDeviation: aoeTemplateMaxDeviation,\n      setMaxDeviation: aoeTemplateSetMaxDeviation,\n      setToRulerP: aoeTemplateSetToRulerP,\n      setTargetP: aoeTemplateSetTargetP\n    });\n\n    templateModel.registerTemplate('aoe', aoeTemplateModel);\n    R.curryService(aoeTemplateModel);\n    return aoeTemplateModel;\n\n    function aoeTemplateCreate(temp) {\n      return R.assocPath(['state','s'], 15, temp);\n    }\n    function aoeTemplateSetSizeP(size, temp) {\n      return R.threadP(size)(\n        (size) => R.find(R.equals(size), [3,4,5]),\n        R.rejectIf(R.isNil, 'Invalid size for an AoE'),\n        () => R.assocPath(['state','s'], size * 5, temp)\n      );\n    }\n    function aoeTemplateSize(temp) {\n      return R.path(['state','s'], temp);\n    }\n    function aoeTemplateDeviateP(dir, len, temp) {\n      return R.threadP(temp)(\n        R.rejectIf(templateModel.isLocked, 'Template is locked'),\n        (temp) => {\n          dir = temp.state.r + 60 * (dir-1);\n          const max_len = R.defaultTo(len, R.path(['state','m'], temp));\n          len = Math.min(len, max_len);\n          return R.thread(temp)(\n            R.over(R.lensProp('state'),\n                   pointModel.translateInDirection$(len * 10, dir)),\n            R.assocPath(['state','r'], dir),\n            templateModel.checkState\n          );\n        }\n      );\n    }\n    function aoeTemplateMaxDeviation(temp) {\n      return R.pathOr(0, ['state','m'], temp);\n    }\n    function aoeTemplateSetMaxDeviation(max, temp) {\n      return R.assocPath(['state','m'], max, temp);\n    }\n    function aoeTemplateSetToRulerP(pos, temp) {\n      return R.threadP(temp)(\n        R.rejectIf(templateModel.isLocked, 'Template is locked'),\n        (temp) => {\n          const state = R.thread(temp.state)(\n            R.assoc('x', pos.x),\n            R.assoc('y', pos.y),\n            R.assoc('r', pos.r),\n            R.assoc('m', pos.m)\n          );\n          return R.thread(temp)(\n            R.assoc('state', state),\n            templateModel.checkState\n          );\n        }\n      );\n    }\n    function aoeTemplateSetTargetP(factions, origin, target, temp) {\n      return templateModel.setPositionP(target.state, temp);\n    }\n  }\n})();\n"]}