{"version":3,"sources":["spray.es6"],"names":[],"mappings":"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","file":"spray.js","sourcesContent":["(function() {\n  angular.module('clickApp.models')\n    .factory('sprayTemplate', sprayTemplateModelFactory);\n\n  sprayTemplateModelFactory.$inject = [\n    'template',\n    'model',\n    'point',\n  ];\n  const POINTS = {\n    6: '8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0',\n    8: '8.75,0 3.5,-78.672 10,-80 16.5,-78.672 11.25,0',\n    10: '8.75,0 1.875,-98.34 10,-100 18.125,-98.34 11.25,0'\n  };\n  function sprayTemplateModelFactory(templateModel,\n                                     modelModel,\n                                     pointModel) {\n    const SIZE_LENS = R.lensPath(['state','s']);\n    const ORIGIN_LENS = R.lensPath(['state','o']);\n    const R_LENS = R.lensPath(['state','r']);\n    const sprayTemplateModel = Object.create(templateModel);\n    R.deepExtend(sprayTemplateModel, {\n      _create: sprayTemplateCreate,\n      setSizeP: sprayTemplateSetSizeP,\n      size: sprayTemplateSize,\n      origin: sprayTemplateOrigin,\n      setOriginP: sprayTemplateSetOriginP,\n      setTargetP: sprayTemplateSetTargetP,\n      rotateLeftP: sprayTemplateRotateLeft,\n      rotateRightP: sprayTemplateRotateRight,\n      render: sprayTemplateRender\n    });\n    const FORWARD_MOVES = [\n      'moveFrontP',\n      'moveBackP',\n      'shiftLeftP',\n      'shiftRightP',\n      'shiftUpP',\n      'shiftDownP',\n      'setPositionP',\n    ];\n    R.forEach(buildSprayMove, FORWARD_MOVES);\n\n    templateModel.registerTemplate('spray', sprayTemplateModel);\n    R.curryService(sprayTemplateModel);\n    return sprayTemplateModel;\n\n    function sprayTemplateCreate(temp) {\n      return R.set(SIZE_LENS, 6, temp);\n    }\n    function sprayTemplateSetSizeP(size, temp) {\n      return R.threadP(size)(\n        (size) => R.find(R.equals(size), [6,8,10]),\n        R.rejectIfP(R.isNil, 'Invalid size for a Spray'),\n        () => R.set(SIZE_LENS, size, temp)\n      );\n    }\n    function sprayTemplateSize(temp) {\n      return R.view(SIZE_LENS, temp);\n    }\n    function sprayTemplateOrigin(temp) {\n      return R.view(ORIGIN_LENS, temp);\n    }\n    function sprayTemplateSetOriginP(origin, temp) {\n      return R.threadP(temp)(\n        R.rejectIfP(templateModel.isLocked, 'Template is locked'),\n        R.view(R_LENS),\n        modelModel.baseEdgeInDirection$(R.__, origin),\n        (position) => R.thread(temp)(\n          R.set(ORIGIN_LENS, origin.state.stamp),\n          (temp) => templateModel.setPositionP(position, temp)\n        )\n      );\n    }\n    function sprayTemplateSetTargetP(origin, target, temp) {\n      return R.threadP(temp)(\n        R.rejectIfP(templateModel.isLocked, 'Template is locked'),\n        () => pointModel.directionTo(target.state, origin.state),\n        (direction) => R.threadP(origin)(\n          modelModel.baseEdgeInDirection$(direction),\n          (position) => R.thread(temp)(\n            R.set(R_LENS, direction),\n            (temp) => templateModel.setPositionP(position, temp)\n          )\n        )\n      );\n    }\n    function buildSprayMove(move) {\n      sprayTemplateModel[move] = sprayTemplateForwardMove;\n\n      function sprayTemplateForwardMove(small, template) {\n        return R.threadP(template)(\n          R.rejectIfP(templateModel.isLocked,\n                     'Template is locked'),\n          R.set(ORIGIN_LENS, null),\n          (template) => templateModel[move](small, template)\n        );\n      }\n    }\n    function sprayTemplateRotateLeft(origin, small, template) {\n      return R.threadP(template)(\n        (temp) => templateModel.rotateLeftP(small, temp),\n        handleOrigin\n      );\n\n      function handleOrigin(template) {\n        if(R.isNil(origin)) return template;\n\n        return R.threadP(origin)(\n          modelModel.baseEdgeInDirection$(template.state.r),\n          (base_edge) => templateModel.setPositionP(base_edge, template)\n        );\n      }\n    }\n    function sprayTemplateRotateRight(origin, small, template) {\n      return R.threadP(template)(\n        (temp) => templateModel.rotateRightP(small, temp),\n        handleOrigin\n      );\n\n      function handleOrigin(template) {\n        if(R.isNil(origin)) return template;\n\n        return R.threadP(origin)(\n          modelModel.baseEdgeInDirection$(template.state.r),\n          (base_edge) => templateModel.setPositionP(base_edge, template)\n        );\n      }\n    }\n    function sprayTemplateRender(temp_state, base_render) {\n      R.deepExtend(base_render, {\n        points: POINTS[temp_state.s || 6],\n        transform: [\n          `rotate(${temp_state.r},${temp_state.x},${temp_state.y})`,\n          `translate(${temp_state.x-10},${temp_state.y})`,\n        ].join(' ')\n      });\n      return {\n        text_center: { x: temp_state.x,\n                       y: temp_state.y + 5\n                     },\n        flip_center: temp_state,\n        rotate_with_model: false\n      };\n    }\n  }\n})();\n"]}