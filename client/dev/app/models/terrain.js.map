{"version":3,"sources":["terrain.es6"],"names":[],"mappings":"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","file":"terrain.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('terrain', terrainModelFactory);\n\n  terrainModelFactory.$inject = [\n    'settings',\n    'point',\n  ];\n  function terrainModelFactory(settingsModel,\n                               pointModel) {\n    const terrainModel = {\n      create: terrainCreate,\n      stamp: terrainStamp,\n      eventName: terrainEventName,\n      state: terrainState,\n      saveState: terrainSaveState,\n      setState: terrainSetState,\n      checkState: terrainCheckState,\n      isLocked: terrainIsLocked,\n      setLock: terrainSetLock,\n      setPositionP: terrainSetPositionP,\n      shiftPositionP: terrainShiftPositionP,\n      setOrientationP: terrainSetOrientationP,\n      moveFrontP: terrainMoveFrontP,\n      moveBackP: terrainMoveBackP,\n      rotateLeftP: terrainRotateLeftP,\n      rotateRightP: terrainRotateRightP,\n      shiftLeftP: terrainShiftLeftP,\n      shiftRightP: terrainShiftRightP,\n      shiftUpP: terrainShiftUpP,\n      shiftDownP: terrainShiftDownP\n    };\n\n    const DEFAULT_MOVES = {\n      Move: 10,\n      MoveSmall: 1,\n      Rotate: 15,\n      RotateSmall: 5,\n      Shift: 10,\n      ShiftSmall: 1\n    };\n    const MOVES = R.clone(DEFAULT_MOVES);\n    settingsModel.register('Misc',\n                           'Terrain',\n                           DEFAULT_MOVES,\n                           (moves) => {\n                             R.extend(MOVES, moves);\n                           });\n    R.curryService(terrainModel);\n    return terrainModel;\n\n    function terrainCreate(temp) {\n      var terrain = {\n        state: {\n          x: 0, y: 0, r: 0,\n          lk: false,\n          stamp: R.guid()\n        }\n      };\n      terrain.state = R.deepExtend(terrain.state, temp);\n      return terrainModel.checkState(terrain);\n    }\n    function terrainStamp(terrain) {\n      return R.path(['state','stamp'], terrain);\n    }\n    function terrainEventName(terrain) {\n      return R.path(['state','stamp'], terrain);\n    }\n    function terrainState(terrain) {\n      return R.prop('state', terrain);\n    }\n    function terrainSaveState(terrain) {\n      return R.clone(R.prop('state', terrain));\n    }\n    function terrainSetState(state, terrain) {\n      return R.assoc('state', R.clone(state), terrain);\n    }\n    function terrainCheckState(terrain) {\n      return R.thread(terrain)(\n        R.over(R.lensPath(['state','x']),\n               R.compose(R.max(0), R.min(480))),\n        R.over(R.lensPath(['state','y']),\n               R.compose(R.max(0), R.min(480)))\n      );\n    }\n    function terrainIsLocked(terrain) {\n      return R.path(['state', 'lk'], terrain);\n    }\n    function terrainSetLock(set, terrain) {\n      return R.assocPath(['state','lk'], set, terrain);\n    }\n    function terrainSetPositionP(pos, terrain) {\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.assocPath(['state','x'], pos.x),\n        R.assocPath(['state','y'], pos.y),\n        terrainModel.checkState\n      );\n    }\n    function terrainShiftPositionP(shift, terrain) {\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.assocPath(['state','x'], terrain.state.x + shift.x),\n        R.assocPath(['state','y'], terrain.state.y + shift.y),\n        terrainModel.checkState\n      );\n    }\n    function terrainSetOrientationP(orientation, terrain) {\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.assocPath(['state','r'], orientation, terrain),\n        terrainModel.checkState\n      );\n    }\n    function terrainMoveFrontP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.moveFront$(dist)),\n        terrainModel.checkState\n      );\n    }\n    function terrainMoveBackP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.moveBack$(dist)),\n        terrainModel.checkState\n      );\n    }\n    function terrainRotateLeftP(small, terrain) {\n      const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.rotateLeft$(angle)),\n        terrainModel.checkState\n      );\n    }\n    function terrainRotateRightP(small, terrain) {\n      const angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.rotateRight$(angle)),\n        terrainModel.checkState\n      );\n    }\n    function terrainShiftLeftP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.shiftLeft$(dist)),\n        terrainModel.checkState\n      );\n    }\n    function terrainShiftRightP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.shiftRight$(dist)),\n        terrainModel.checkState\n      );\n    }\n    function terrainShiftUpP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.shiftUp$(dist)),\n        terrainModel.checkState\n      );\n    }\n    function terrainShiftDownP(small, terrain) {\n      const dist = MOVES[small ? 'MoveSmall' : 'Move'];\n      return R.threadP(terrain)(\n        R.rejectIf(terrainModel.isLocked,\n                   'Terrain is locked'),\n        R.over(R.lensProp('state'),\n               pointModel.shiftDown$(dist)),\n        terrainModel.checkState\n      );\n    }\n  }\n})();\n"]}