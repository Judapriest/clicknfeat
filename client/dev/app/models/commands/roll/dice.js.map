{"version":3,"sources":["dice.es6"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,iBADX,EAC8B,CAC1B,UAD0B,EAE1B,SAAS,6BAAT,CAAuC,eAAvC,EAAwD;AACtD,MAAI,yBAAyB;AAC3B,aAAS,SAAS,eAAT,CAAyB,KAAzB,EAAgC,OAAhC,EAAyC,KAAzC,EAAgD,IAAhD,EAAsD;AAC7D,UAAI,QAAQ,EAAE,KAAF,CAAQ,YAAW;AAC7B,eAAO,EAAE,WAAF,CAAc,CAAd,EAAiB,KAAjB,CAAP,CAD6B;OAAX,EAEjB,OAFS,CAAR,CADyD;AAI7D,UAAI,QAAQ,EAAE,MAAF,CAAS,EAAE,GAAF,EAAO,CAAhB,EAAmB,KAAnB,CAAR,CAJyD;AAM7D,UAAI,OAAO;AACT,oBAAU,cAAS,MAAM,IAAN,CAAW,GAAX,aAAsB,KAAzC;AACA,WAAG,KAAH;AACA,WAAG,OAAH;AACA,WAAG,KAAH;OAJE,CANyD;;AAa7D,YAAM,WAAN,CAAkB,gBAAlB,EAb6D;;AAe7D,aAAO,CAAC,IAAD,EAAO,IAAP,CAAP,CAf6D;KAAtD;AAiBT,YAAQ,SAAS,YAAT,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,IAAnC,EAAyC;AAC/C,UAAI,OAAO,EAAE,MAAF,CAAS,EAAT,EAAa,MAAb,EAAqB,IAArB,CAAP,CAD2C;AAE/C,aAAO,EAAE,KAAF,CAAQ,MAAR,EAAgB,EAAE,MAAF,CAAS,IAAT,EAAe,IAAf,CAAhB,EAAsC,IAAtC,CAAP,CAF+C;;AAI/C,YAAM,WAAN,CAAkB,gBAAlB,EAJ+C;;AAM/C,aAAO,IAAP,CAN+C;KAAzC;AAQR,UAAM,SAAS,YAAT,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,IAAnC,EAAyC;AAC7C,UAAI,OAAO,EAAE,MAAF,CAAS,EAAT,EAAa,MAAb,EAAqB,IAArB,CAAP,CADyC;AAE7C,aAAO,EAAE,KAAF,CAAQ,MAAR,EAAgB,EAAE,MAAF,CAAS,EAAE,MAAF,CAAS,OAAT,EAAkB,KAAK,KAAL,CAA3B,EAAwC,IAAxC,CAAhB,EAA+D,IAA/D,CAAP,CAF6C;;AAI7C,YAAM,WAAN,CAAkB,gBAAlB,EAJ6C;;AAM7C,aAAO,IAAP,CAN6C;KAAzC;GA1BJ,CADkD;AAoCtD,kBAAgB,eAAhB,CAAgC,UAAhC,EAA4C,sBAA5C,EApCsD;AAqCtD,SAAO,sBAAP,CArCsD;CAAxD,CAHJ","file":"dice.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('rollDiceCommand', [\n    'commands',\n    function rollDiceCommandServiceFactory(commandsService) {\n      var rollDiceCommandService = {\n        execute: function rollDiceExecute(sides, nb_dice, state, game) {\n          var dices = R.times(function() {\n            return R.randomRange(1, sides);\n          }, nb_dice);\n          var total = R.reduce(R.add, 0, dices)\n          ;\n          var ctxt = {\n            desc: `d${sides}[${dices.join(',')}] = ${total}`,\n            s: sides,\n            n: nb_dice,\n            d: dices\n          };\n          \n          state.changeEvent('Game.dice.roll');\n          \n          return [ctxt, game];\n        },\n        replay: function rollDiceRedo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.append(ctxt, dice), game);\n\n          state.changeEvent('Game.dice.roll');\n          \n          return game;\n        },\n        undo: function rollDiceUndo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.reject(R.propEq('stamp', ctxt.stamp), dice), game);\n\n          state.changeEvent('Game.dice.roll');\n          \n          return game;\n        }\n      };\n      commandsService.registerCommand('rollDice', rollDiceCommandService);\n      return rollDiceCommandService;\n    }\n  ]);\n"]}