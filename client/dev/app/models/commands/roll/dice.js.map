{"version":3,"sources":["dice.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,iBADX,EAC8B,2BAD9B,EADU;;AAIV,8BAA4B,OAA5B,GAAsC,CACpC,UADoC,CAAtC,CAJU;AAOV,WAAS,2BAAT,CAAqC,aAArC,EAAoD;AAClD,QAAM,uBAAuB;AAC3B,gBAAU,gBAAV;AACA,eAAS,eAAT;AACA,aAAO,aAAP;KAHI,CAD4C;AAMlD,kBAAc,eAAd,CAA8B,UAA9B,EAA0C,oBAA1C,EANkD;AAOlD,WAAO,oBAAP,CAPkD;;AASlD,aAAS,gBAAT,CAA0B,KAA1B,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,IAAjD,EAAuD;AACrD,UAAM,OAAO,EAAE,KAAF,CAAQ,YAAM;AACzB,eAAO,EAAE,WAAF,CAAc,CAAd,EAAiB,KAAjB,CAAP,CADyB;OAAN,EAElB,OAFU,CAAP,CAD+C;AAIrD,UAAM,QAAQ,EAAE,MAAF,CAAS,EAAE,GAAF,EAAO,CAAhB,EAAmB,IAAnB,CAAR,CAJ+C;AAKrD,UAAM,OAAO;AACX,oBAAU,cAAS,KAAK,IAAL,CAAU,GAAV,aAAqB,KAAxC;AACA,WAAG,KAAH;AACA,WAAG,OAAH;AACA,WAAG,IAAH;OAJI,CAL+C;;AAYrD,YAAM,iBAAN,CAAwB,gBAAxB,EAZqD;AAarD,aAAO,CAAC,IAAD,EAAO,IAAP,CAAP,CAbqD;KAAvD;AAeA,aAAS,eAAT,CAAyB,IAAzB,EAA+B,KAA/B,EAAsC,IAAtC,EAA4C;AAC1C,aAAO,EAAE,IAAF,CAAO,EAAE,QAAF,CAAW,MAAX,CAAP,EAA2B,EAAE,MAAF,CAAS,IAAT,CAA3B,EAA2C,IAA3C,CAAP,CAD0C;;AAG1C,YAAM,iBAAN,CAAwB,gBAAxB,EAH0C;AAI1C,aAAO,IAAP,CAJ0C;KAA5C;AAMA,aAAS,aAAT,CAAuB,IAAvB,EAA6B,KAA7B,EAAoC,IAApC,EAA0C;AACxC,aAAO,EAAE,IAAF,CAAO,EAAE,QAAF,CAAW,MAAX,CAAP,EACO,EAAE,MAAF,CAAS,EAAE,MAAF,CAAS,OAAT,EAAkB,KAAK,KAAL,CAA3B,CADP,EAEO,IAFP,CAAP,CADwC;;AAKxC,YAAM,iBAAN,CAAwB,gBAAxB,EALwC;AAMxC,aAAO,IAAP,CANwC;KAA1C;GA9BF;CAPD,CAAD","file":"dice.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('rollDiceCommand', rollDiceCommandModelFactory);\n\n  rollDiceCommandModelFactory.$inject = [\n    'commands',\n  ];\n  function rollDiceCommandModelFactory(commandsModel) {\n    const rollDiceCommandModel = {\n      executeP: rollDiceExecuteP,\n      replayP: rollDiceReplayP,\n      undoP: rollDiceUndoP\n    };\n    commandsModel.registerCommand('rollDice', rollDiceCommandModel);\n    return rollDiceCommandModel;\n\n    function rollDiceExecuteP(sides, nb_dice, state, game) {\n      const dice = R.times(() => {\n        return R.randomRange(1, sides);\n      }, nb_dice);\n      const total = R.reduce(R.add, 0, dice);\n      const ctxt = {\n        desc: `d${sides}[${dice.join(',')}] = ${total}`,\n        s: sides,\n        n: nb_dice,\n        d: dice\n      };\n\n      state.queueChangeEventP('Game.dice.roll');\n      return [ctxt, game];\n    }\n    function rollDiceReplayP(ctxt, state, game) {\n      game = R.over(R.lensProp('dice'), R.append(ctxt), game);\n\n      state.queueChangeEventP('Game.dice.roll');\n      return game;\n    }\n    function rollDiceUndoP(ctxt, state, game) {\n      game = R.over(R.lensProp('dice'),\n                    R.reject(R.propEq('stamp', ctxt.stamp)),\n                    game);\n\n      state.queueChangeEventP('Game.dice.roll');\n      return game;\n    }\n  }\n})();\n"]}