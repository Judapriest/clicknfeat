{"version":3,"sources":["deviation.es6"],"names":[],"mappings":";;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,sBADX,EACmC,gCADnC,EADU;;AAIV,mCAAiC,OAAjC,GAA2C,CACzC,UADyC,CAA3C,CAJU;AAOV,WAAS,gCAAT,CAA0C,aAA1C,EAAyD;AACvD,QAAM,4BAA4B;AAChC,gBAAU,qBAAV;AACA,eAAS,aAAT;AACA,aAAO,aAAP;KAHI,CADiD;;AAOvD,kBAAc,eAAd,CAA8B,eAA9B,EAA+C,yBAA/C,EAPuD;AAQvD,WAAO,yBAAP,CARuD;;AAUvD,aAAS,qBAAT,CAA+B,KAA/B,EAAsC,IAAtC,EAA4C;AAC1C,UAAM,YAAY,EAAE,WAAF,CAAc,CAAd,EAAiB,CAAjB,CAAZ,CADoC;AAE1C,UAAM,WAAW,EAAE,WAAF,CAAc,CAAd,EAAiB,CAAjB,CAAX,CAFoC;;AAI1C,UAAM,OAAO;AACX,6CAAmC,4BAAuB,cAA1D;AACA,WAAG,SAAH;AACA,WAAG,QAAH;OAHI,CAJoC;;AAU1C,YAAM,iBAAN,CAAwB,gBAAxB,EAV0C;;AAY1C,aAAO,CAAC,IAAD,EAAO,IAAP,CAAP,CAZ0C;KAA5C;AAcA,aAAS,aAAT,CAAuB,IAAvB,EAA6B,KAA7B,EAAoC,IAApC,EAA0C;AACxC,UAAM,OAAO,EAAE,MAAF,CAAS,EAAT,EAAa,MAAb,EAAqB,IAArB,CAAP,CADkC;AAExC,aAAO,EAAE,KAAF,CAAQ,MAAR,EAAgB,EAAE,MAAF,CAAS,IAAT,EAAe,IAAf,CAAhB,EAAsC,IAAtC,CAAP,CAFwC;;AAIxC,YAAM,iBAAN,CAAwB,gBAAxB,EAJwC;;AAMxC,aAAO,IAAP,CANwC;KAA1C;AAQA,aAAS,aAAT,CAAuB,IAAvB,EAA6B,KAA7B,EAAoC,IAApC,EAA0C;AACxC,UAAM,OAAO,EAAE,MAAF,CAAS,EAAT,EAAa,MAAb,EAAqB,IAArB,CAAP,CADkC;AAExC,aAAO,EAAE,KAAF,CAAQ,MAAR,EAAgB,EAAE,MAAF,CAAS,EAAE,MAAF,CAAS,OAAT,EAAkB,KAAK,KAAL,CAA3B,EAAwC,IAAxC,CAAhB,EAA+D,IAA/D,CAAP,CAFwC;;AAIxC,YAAM,iBAAN,CAAwB,gBAAxB,EAJwC;;AAMxC,aAAO,IAAP,CANwC;KAA1C;GAhCF;CAPD,CAAD","file":"deviation.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('rollDeviationCommand', rollDeviationCommandModelFactory);\n\n  rollDeviationCommandModelFactory.$inject = [\n    'commands',\n  ];\n  function rollDeviationCommandModelFactory(commandsModel) {\n    const rollDeviationCommandModel = {\n      executeP: rollDeviationExecuteP,\n      replayP: rollDiceRedoP,\n      undoP: rollDiceUndoP\n    };\n\n    commandsModel.registerCommand('rollDeviation', rollDeviationCommandModel);\n    return rollDeviationCommandModel;\n\n    function rollDeviationExecuteP(state, game) {\n      const direction = R.randomRange(1, 6);\n      const distance = R.randomRange(1, 6);\n\n      const ctxt = {\n        desc: `AoE deviation : direction ${direction}, distance ${distance}\"`,\n        r: direction,\n        d: distance\n      };\n\n      state.queueChangeEventP('Game.dice.roll');\n\n      return [ctxt, game];\n    }\n    function rollDiceRedoP(ctxt, state, game) {\n      const dice = R.propOr([], 'dice', game);\n      game = R.assoc('dice', R.append(ctxt, dice), game);\n\n      state.queueChangeEventP('Game.dice.roll');\n\n      return game;\n    }\n    function rollDiceUndoP(ctxt, state, game) {\n      const dice = R.propOr([], 'dice', game);\n      game = R.assoc('dice', R.reject(R.propEq('stamp', ctxt.stamp), dice), game);\n\n      state.queueChangeEventP('Game.dice.roll');\n\n      return game;\n    }\n  }\n})();\n"]}