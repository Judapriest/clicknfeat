{"version":3,"sources":["objectives.es6"],"names":[],"mappings":";;;;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,yBADX,EACsC,mCADtC,EADU;;AAIV,sCAAoC,OAApC,GAA8C,CAC5C,UAD4C,EAE5C,UAF4C,EAG5C,oBAH4C,EAI5C,oBAJ4C,EAK5C,YAL4C,EAM5C,cAN4C,CAA9C,CAJU;AAYV,WAAS,mCAAT,CAA6C,eAA7C,EAC6C,aAD7C,EAE6C,uBAF7C,EAG6C,uBAH7C,EAI6C,eAJ7C,EAK6C,iBAL7C,EAKgE;AAC9D,QAAM,cAAc,EAAE,QAAF,CAAW,QAAX,CAAd,CADwD;AAE9D,QAAM,+BAA+B;AACnC,gBAAU,wBAAV;AACA,eAAS,uBAAT;AACA,aAAO,qBAAP;KAHI,CAFwD;AAO9D,kBAAc,eAAd,CAA8B,kBAA9B,EAAkD,4BAAlD,EAP8D;AAQ9D,WAAO,4BAAP,CAR8D;;AAU9D,aAAS,wBAAT,CAAkC,IAAlC,EAAwC;AACtC,UAAM,OAAO;AACX,cAAM,EAAN;OADI,CADgC;AAItC,aAAO,EAAE,OAAF,CAAU,IAAV,EACL,EAAE,IAAF,CAAO,WAAP,CADK,EAEL,gBAAgB,GAAhB,EACA,EAAE,MAAF,CAAS,EAAE,IAAF,CACP,EAAE,IAAF,CAAO,CAAC,OAAD,EAAS,MAAT,CAAP,CADO,EAEP,EAAE,IAAF,EACA,EAAE,MAAF,CAAS,UAAT,CAHO,CAAT,CAHK,EAQL,EAAE,GAAF,CAAM,EAAE,IAAF,CAAO,CAAC,OAAD,EAAS,OAAT,CAAP,CAAN,CARK,EASL,UAAC,MAAD;eAAY,wBACT,QADS,CACA,MADA,EACQ,IADR;OAAZ,EAEA,gBAAyB;;;YAAvB,uBAAuB;YAAV,gBAAU;;AACvB,aAAK,GAAL,GAAW,WAAX,CADuB;AAEvB,eAAO,IAAP,CAFuB;OAAzB,EAIA,UAAC,IAAD,EAAU;AACR,eAAO,EAAE,MAAF,CAAS,IAAT,EACL,EAAE,IAAF,CAAO,UAAP,CADK,EAEL,kBAAkB,gBAAlB,EACA,UAAC,UAAD;iBAAgB,wBACb,QADa,CACJ,UADI,EACQ,KADR,EACe,IADf;SAAhB,CAHF,CADQ;OAAV,EAQA,iBAAyB;;;YAAvB,uBAAuB;YAAV,gBAAU;;AACvB,aAAK,MAAL,GAAc,WAAd,CADuB;AAEvB,eAAO,CAAC,IAAD,EAAO,IAAP,CAAP,CAFuB;OAAzB,CAvBF,CAJsC;KAAxC;AAiCA,aAAS,uBAAT,CAAiC,IAAjC,EAAuC,IAAvC,EAA6C;AAC3C,aAAO,EAAE,OAAF,CAAU,IAAV,EACL,UAAC,IAAD;eAAU,wBAAwB,OAAxB,CAAgC,KAAK,GAAL,EAAU,IAA1C;OAAV,EACA,UAAC,IAAD;eAAU,wBAAwB,OAAxB,CAAgC,KAAK,MAAL,EAAa,IAA7C;OAAV,CAFF,CAD2C;KAA7C;AAMA,aAAS,qBAAT,CAA+B,IAA/B,EAAqC,IAArC,EAA2C;AACzC,aAAO,EAAE,OAAF,CAAU,IAAV,EACL,UAAC,IAAD;eAAU,wBAAwB,KAAxB,CAA8B,KAAK,MAAL,EAAa,IAA3C;OAAV,EACA,UAAC,IAAD;eAAU,wBAAwB,KAAxB,CAA8B,KAAK,GAAL,EAAU,IAAxC,EACP,KADO,CACD,EAAE,IAAF,CAAO,gBAAgB,IAAhB,EAAsB;iBAAM;SAAN,CAD5B;OAAV,CAFF,CADyC;KAA3C;GAtDF;CAZD,CAAD","file":"objectives.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('createObjectivesCommand', createObjectivesCommandModelFactory);\n\n  createObjectivesCommandModelFactory.$inject = [\n    'appError',\n    'commands',\n    'createModelCommand',\n    'deleteModelCommand',\n    'gameModels',\n    'gameScenario',\n  ];\n  function createObjectivesCommandModelFactory(appErrorService,\n                                               commandsModel,\n                                               createModelCommandModel,\n                                               deleteModelCommandModel,\n                                               gameModelsModel,\n                                               gameScenarioModel) {\n    const MODELS_LENS = R.lensProp('models');\n    const createObjectivesCommandModel = {\n      executeP: createObjectivesExecuteP,\n      replayP: createObjectivesReplayP,\n      undoP: createObjectivesUndoP\n    };\n    commandsModel.registerCommand('createObjectives', createObjectivesCommandModel);\n    return createObjectivesCommandModel;\n\n    function createObjectivesExecuteP(game) {\n      const ctxt = {\n        desc: ''\n      };\n      return R.threadP(game)(\n        R.view(MODELS_LENS),\n        gameModelsModel.all,\n        R.filter(R.pipe(\n          R.path(['state','info']),\n          R.head,\n          R.equals('scenario')\n        )),\n        R.map(R.path(['state','stamp'])),\n        (stamps) => deleteModelCommandModel\n          .executeP(stamps, game),\n        ([delete_ctxt, game]) => {\n          ctxt.del = delete_ctxt;\n          return game;\n        },\n        (game) => {\n          return R.thread(game)(\n            R.prop('scenario'),\n            gameScenarioModel.createObjectives,\n            (objectives) => createModelCommandModel\n              .executeP(objectives, false, game)\n          );\n        },\n        ([create_ctxt, game]) => {\n          ctxt.create = create_ctxt;\n          return [ctxt, game];\n        }\n      );\n    }\n    function createObjectivesReplayP(ctxt, game) {\n      return R.threadP(game)(\n        (game) => deleteModelCommandModel.replayP(ctxt.del, game),\n        (game) => createModelCommandModel.replayP(ctxt.create, game)\n      );\n    }\n    function createObjectivesUndoP(ctxt, game) {\n      return R.threadP(game)(\n        (game) => createModelCommandModel.undoP(ctxt.create, game),\n        (game) => deleteModelCommandModel.undoP(ctxt.del, game)\n          .catch(R.pipe(appErrorService.emit, () => game))\n      );\n    }\n  }\n})();\n"]}