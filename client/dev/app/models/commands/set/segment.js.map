{"version":3,"sources":["segment.es6"],"names":[],"mappings":";;;;AAAA,CAAC,YAAW;AACV,UAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,mBADX,EACgC,6BADhC,EADU;;AAIV,gCAA8B,OAA9B,GAAuC,EAAvC,CAJU;AAKV,WAAS,6BAAT,GAAyC;AACvC,WAAO,SAAS,2BAAT,CAAqC,IAArC,EACqC,gBADrC,EACuD;AAC5D,UAAM,YAAY,EAAE,QAAF,CAAW,IAAX,CAAZ,CADsD;AAE5D,UAAM,yBAAyB;AAC7B,kBAAU,kBAAV;AACA,iBAAS,iBAAT;AACA,eAAO,eAAP;OAHI,CAFsD;AAO5D,aAAO,sBAAP,CAP4D;;AAS5D,eAAS,kBAAT,CAA4B,MAA5B,EAAoC,IAApC,EAA0C,IAA1C,EAAgD;AAC9C,YAAM,OAAO;AACX,kBAAQ,EAAR;AACA,iBAAO,EAAP;AACA,gBAAM,MAAN;SAHI,CADwC;AAM9C,eAAO,EAAE,OAAF,CAAU,gBAAV,EACL,WADK,EAEL;iBAAM,UAAU,QAAV,EAAoB,IAApB;SAAN,EACA;iBAAM,iBAAiB,OAAjB,4CAA4B,cAAM,EAAE,IAAF,CAAO,SAAP,EAAkB,IAAlB,GAAlC;SAAN,EACA,UAAC,OAAD;iBAAa,EAAE,GAAF,CAAM,SAAN,EAAiB,OAAjB,EAA0B,IAA1B;SAAb,EACA,UAAC,IAAD;iBAAU,UAAU,OAAV,EAAmB,IAAnB;SAAV,EACA,UAAC,IAAD;iBAAU,CAAC,IAAD,EAAO,IAAP;SAAV,CANF,CAN8C;;AAe9C,iBAAS,WAAT,CAAqB,gBAArB,EAAuC;AACrC,iBAAO,EAAE,OAAF,CAAU,gBAAV,EACL,EAAE,IAAF,CAAO,MAAP,CADK,EAEL,EAAE,IAAF,EACA,EAAE,SAAF,CAAY,EAAE,UAAF,CAAa,EAAE,MAAF,CAAS,UAAT,CAAb,CAAZ,EACc,EAAE,UAAF,CAAa,IAAb,0BAAsC,YADpD,CAHK,CAAP,CADqC;SAAvC;AAQA,iBAAS,SAAT,CAAmB,IAAnB,EAAyB,IAAzB,EAA+B;AAC7B,eAAK,IAAL,IAAa,iBAAiB,eAAjB,CAAiC,EAAE,IAAF,CAAO,SAAP,EAAkB,IAAlB,CAAjC,CAAb,CAD6B;AAE7B,iBAAO,IAAP,CAF6B;SAA/B;OAvBF;AA4BA,eAAS,iBAAT,CAA2B,IAA3B,EAAiC,IAAjC,EAAuC;AACrC,eAAO,EAAE,IAAF,CACL,SADK,EAEL,iBAAiB,YAAjB,CAA8B,KAAK,KAAL,CAFzB,EAGL,IAHK,CAAP,CADqC;OAAvC;AAOA,eAAS,eAAT,CAAyB,IAAzB,EAA+B,IAA/B,EAAqC;AACnC,eAAO,EAAE,IAAF,CACL,SADK,EAEL,iBAAiB,YAAjB,CAA8B,KAAK,MAAL,CAFzB,EAGL,IAHK,CAAP,CADmC;OAArC;KA7CK,CADgC;GAAzC;CALD,CAAD","file":"segment.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('setSegmentCommand', setSegmentCommandModelFactory);\n\n  setSegmentCommandModelFactory.$inject =[];\n  function setSegmentCommandModelFactory() {\n    return function buildSetSegmentCommandModel(type,\n                                                gameSegmentModel) {\n      const TYPE_LENS = R.lensProp(type);\n      const setSegmentCommandModel = {\n        executeP: setSegmentExecuteP,\n        replayP: setSegmentReplayP,\n        undoP: setSegmentUndoP\n      };\n      return setSegmentCommandModel;\n\n      function setSegmentExecuteP(method, args, game) {\n        const ctxt = {\n          before: [],\n          after: [],\n          desc: method\n        };\n        return R.threadP(gameSegmentModel)(\n          checkMethod,\n          () => saveState('before', game),\n          () => gameSegmentModel[method](...args, R.view(TYPE_LENS, game)),\n          (segment) => R.set(TYPE_LENS, segment, game),\n          (game) => saveState('after', game),\n          (game) => [ctxt, game]\n        );\n\n        function checkMethod(gameSegmentModel) {\n          return R.threadP(gameSegmentModel)(\n            R.prop(method),\n            R.type,\n            R.rejectIfP(R.complement(R.equals('Function')),\n                       `${s.capitalize(type)} unknown method \"${method}\"`)\n          );\n        }\n        function saveState(when, game) {\n          ctxt[when] = gameSegmentModel.saveRemoteState(R.view(TYPE_LENS, game));\n          return game;\n        }\n      }\n      function setSegmentReplayP(ctxt, game) {\n        return R.over(\n          TYPE_LENS,\n          gameSegmentModel.resetRemote$(ctxt.after),\n          game\n        );\n      }\n      function setSegmentUndoP(ctxt, game) {\n        return R.over(\n          TYPE_LENS,\n          gameSegmentModel.resetRemote$(ctxt.before),\n          game\n        );\n      }\n    };\n  }\n})();\n"]}