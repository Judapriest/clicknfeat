{"version":3,"sources":["model.es6"],"names":[],"mappings":"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","file":"model.js","sourcesContent":["(function() {\n  angular.module('clickApp.services')\n    .factory('model', modelModelFactory);\n\n  modelModelFactory.$inject = [\n    'settings',\n    'element',\n    'gameFactions',\n    'modelArea',\n    'modelAura',\n    'modelCharge',\n    'modelCounter',\n    'modelDamage',\n    'modelEffect',\n    'modelGeom',\n    'modelImage',\n    'modelIncorporeal',\n    'modelLeader',\n    'modelMelee',\n    'modelMove',\n    'modelPlace',\n    'modelRuler',\n    'modelUnit',\n    'modelWreck',\n  ];\n  function modelModelFactory(settingsModel,\n                             elementModel,\n                             gameFactionsModel,\n                             modelAreaModel,\n                             modelAuraModel,\n                             modelChargeModel,\n                             modelCounterModel,\n                             modelDamageModel,\n                             modelEffectModel,\n                             modelGeomModel,\n                             modelImageModel,\n                             modelIncorporealModel,\n                             modelLeaderModel,\n                             modelMeleeModel,\n                             modelMoveModel,\n                             modelPlaceModel,\n                             modelUnitModel,\n                             modelWreckModel,\n                             modelRulerModel) {\n    const EFFECTS = [\n      [ 'b' , '/data/icons/Blind.png'      ],\n      [ 'c' , '/data/icons/Corrosion.png'  ],\n      [ 'd' , '/data/icons/BoltBlue.png'   ],\n      [ 'f' , '/data/icons/Fire.png'       ],\n      [ 'e' , '/data/icons/BoltYellow.png' ],\n      [ 'k' , '/data/icons/KD.png'         ],\n      [ 't' , '/data/icons/Stationary.png' ],\n    ];\n    const DEFAULT_MOVES = {\n      Move: 10,\n      MoveSmall: 5,\n      Rotate: 15,\n      RotateSmall: 5,\n      Shift: 10,\n      ShiftSmall: 1,\n      RotateCharge: 10,\n      RotateChargeSmall: 2\n    };\n    const MOVES = R.clone(DEFAULT_MOVES);\n    settingsModel.register('Misc',\n                           'Model',\n                           DEFAULT_MOVES,\n                           (moves) => {\n                             R.extend(MOVES, moves);\n                           });\n\n    const base = elementModel('model', MOVES);\n    const modelModel = Object.create(base);\n    R.deepExtend(\n      modelModel, {\n        create: modelCreate,\n        state_checkers: [],\n        state_updaters: [],\n        checkState: modelCheckState,\n        descriptionFromInfo: modelDescriptionFromInfo,\n        user: modelUser,\n        userIs: modelUserIs,\n        modeFor: modelModeFor,\n        render: modelRender\n      },\n      modelAreaModel(modelModel),\n      modelAuraModel(modelModel),\n      modelChargeModel(MOVES, modelModel),\n      modelCounterModel(modelModel),\n      modelDamageModel(modelModel),\n      modelEffectModel(modelModel),\n      modelGeomModel(modelModel),\n      modelImageModel(modelModel),\n      modelIncorporealModel(modelModel),\n      modelLeaderModel(modelModel),\n      modelMeleeModel(modelModel),\n      modelMoveModel(MOVES, modelModel),\n      modelPlaceModel(MOVES, modelModel),\n      modelRulerModel(modelModel),\n      modelUnitModel(modelModel),\n      modelWreckModel(modelModel)\n    );\n\n    R.curryService(modelModel);\n    return modelModel;\n\n    function modelCreate(factions, temp) {\n      return R.thread(factions)(\n        gameFactionsModel.getModelInfo$(temp.info),\n        R.unless(\n          R.isNil,\n          (info) => {\n            const model = {\n              state: {\n                x: 0, y: 0, r: 0,\n                img: 0,\n                dsp: ['i'],\n                eff: [],\n                l: [],\n                c: 0, s: 0,\n                u: null,\n                aur: null,\n                are: null,\n                rml: null,\n                cml: null,\n                pml: [null,false],\n                cha: null,\n                pla: null,\n                dmg: initDamage(info.damage),\n                stamp: R.guid()\n              }\n            };\n            if(info.type === 'wardude' ||\n               info.type === 'beast' ||\n               info.type === 'jack') {\n              model.state.dsp = R.append('c', model.state.dsp);\n            }\n            if(info.immovable) {\n              model.state.lk = true;\n            }\n            model.state = R.deepExtend(model.state, temp);\n            return modelModel.checkState(factions, null, model);\n          }\n        )\n      );\n    }\n    function modelUser(model) {\n      return R.path(['state', 'user'], model);\n    }\n    function modelUserIs(user, model) {\n      return R.pathEq(['state', 'user'], user, model);\n    }\n    function modelCheckState(factions, target, model) {\n      return R.thread(factions)(\n        gameFactionsModel.getModelInfo$(model.state.info),\n        R.ifElse(\n          R.isNil,\n          () => R.prop('state', model),\n          (info) => {\n            const radius = info.base_radius;\n            return R.thread(model.state)(\n              R.assoc('x', Math.max(0+radius, Math.min(480-radius, model.state.x))),\n              R.assoc('y', Math.max(0+radius, Math.min(480-radius, model.state.y))),\n              (state) => R.reduce((state, checker) => {\n                return checker(info, target, state);\n              }, state, modelModel.state_checkers),\n              (state) => R.reduce(function(state, updater) {\n                return updater(state);\n              }, state, modelModel.state_updaters)\n            );\n          }\n        ),\n        (state) => R.assoc('state', state, model)\n      );\n    }\n    function modelModeFor(model) {\n      if(modelModel.isCharging(model)) {\n        return 'ModelCharge';\n      }\n      if(modelModel.isPlacing(model)) {\n        return 'ModelPlace';\n      }\n      return 'Model';\n    }\n    function modelDescriptionFromInfo(info, model) {\n      return R.thread(info)(\n        R.props(['unit_name', 'name']),\n        R.prepend(modelModel.user(model)),\n        R.reject(R.isNil),\n        R.join('/')\n      );\n    }\n    function initDamage(info) {\n      if(info.type === 'warrior') {\n        return { n: 0, t: 0 };\n      }\n      return R.thread(info)(\n        R.keys,\n        R.reject(R.equals('type')),\n        R.reject(R.equals('field')),\n        R.reject(R.equals('total')),\n        R.reject(R.equals('depth')),\n        R.reduce((mem, key) => {\n          return R.assoc(key, R.map(R.always(0), info[key]), mem);\n        }, {}),\n        R.assoc('f', 0),\n        R.assoc('t', 0)\n      );\n    }\n    function modelRender(is_flipped, factions, state) {\n      const info = R.thread(factions)(\n        gameFactionsModel.getModelInfo$(state.info),\n        R.defaultTo({ base_radius: 5.905 })\n      );\n      const is_wreck = modelModel.isWreckDisplayed({state});\n      const img = (is_wreck\n                   ? modelModel.getWreckImage(factions, {state})\n                   : modelModel.getImage(factions, {state}));\n      const cx = img.width / 2;\n      const cy = img.height / 2;\n      const radius = info.base_radius;\n      const dx = cx;\n      const dy = cy - info.base_radius;\n      const frx = cx - info.base_radius;\n      const flx = cx + info.base_radius;\n      const los = {\n        dy: cy - 700,\n        lx: cx - 700,\n        rx: cx + 700\n      };\n      const aura = {\n        show: modelModel.isAuraDisplayed({state}),\n        radius: radius * 1.2,\n        color: modelModel.auraDisplay({state})\n      };\n      const lock = {\n        show: modelModel.isLocked({state}),\n        x: cx + radius - 5,\n        y: cy - 5\n      };\n      const state_dmg = R.propOr({}, 'dmg', state);\n      const percent_damage = state_dmg.t / info.damage.total;\n      const damage_x = cx - radius + 2 * radius * percent_damage;\n      const dmg = {\n        show: !( info.damage.type === 'warrior' &&\n                 info.damage.n === 1),\n        lx: cx - radius,\n        ly: cy + radius + 2,\n        rx: cx + radius,\n        ry: cx + radius + 2,\n        x: damage_x\n      };\n      const percent_field = state_dmg.f / info.damage.field;\n      const field_x = cx - radius + 2 * radius * percent_field;\n      const field = {\n        show: R.exists(info.damage.field),\n        lx: dmg.lx,\n        ly: dmg.ly + 1,\n        rx: dmg.rx,\n        ry: dmg.ry + 1,\n        x: field_x\n      };\n      const label_options = {\n        flipped: is_flipped,\n        flip_center: { x: cx, y: cy },\n        text_center: { x: cx, y: cx + radius + 8 }\n      };\n      const label = base\n        .renderLabel(label_options, state);\n      const counter_options = {\n        rotate: state.r,\n        flipped: is_flipped,\n        flip_center: { x: cx, y: cy },\n        text_center: { x: cx, y: cy + 2 }\n      };\n      const counter = base\n              .renderText(counter_options, state.c);\n      counter.show = modelModel\n        .isCounterDisplayed('c', {state});\n      const souls_options = {\n        rotate: state.r,\n        flip_center: { x: cx, y: cy },\n        text_center: { x: cx + radius * 0.8 + 5,\n                       y: cy - radius - 5 }\n      };\n      const souls = base\n              .renderText(souls_options, state.s);\n      souls.show = modelModel\n        .isCounterDisplayed('s', {state});\n      souls.cx = souls.x - 10;\n      souls.cy = souls.y - 10;\n      const unit_options = {\n        rotate: state.r,\n        flip_center: { x: cx, y: cy },\n        text_center: { x: cx - radius * 0.7 - 5,\n                       y: cy - radius * 0.7 - 5 }\n      };\n      const unit = base\n              .renderText(unit_options, `U${modelModel.unit({state})}`);\n      unit.show = modelModel\n        .isUnitDisplayed({state});\n      unit.cx = unit.x - 10;\n      unit.cy = unit.y - 10;\n      const melee = {\n        melee: {\n          show: modelModel.isMeleeDisplayed('mm', {state}),\n          path: computeMeleePath(5, img, info)\n        },\n        reach: {\n          show: modelModel.isMeleeDisplayed('mr', {state}),\n          path: computeMeleePath(20, img, info)\n        },\n        strike: {\n          show: modelModel.isMeleeDisplayed('ms', {state}),\n          path: computeMeleePath(40, img, info)\n        }\n      };\n      const area = ( modelModel.isAreaDisplayed({state})\n                     ? modelModel.areaDisplay({state}) * 10 + radius\n                     : null\n                   );\n      const ctrl = ( modelModel.isCtrlAreaDisplayed(factions, {state})\n                     ? (info.focus || info.fury) * 20 + radius\n                     : null\n                   );\n      const effects = R.thread(EFFECTS)(\n        R.filter(([key]) => modelModel.isEffectDisplayed(key, {state})),\n        (actives) => {\n          const base_x = img.width / 2 - (R.length(actives) * 10 / 2);\n          const base_y = img.height / 2 + info.base_radius + 1;\n          return R.addIndex(R.reduce)((mem, [key, link], i) => {\n            return R.assoc(key, {\n              show: modelModel.isEffectDisplayed(key, {state}),\n              x: base_x + i * 10, y: base_y, link\n            }, mem);\n          }, {}, actives);\n        }\n      );\n      effects.l = {\n        show: modelModel.isLeaderDisplayed({state}),\n        link: '/data/icons/Leader.png',\n        x: cx - radius * 0.7 - 5,\n        y: cy - radius * 0.7 - 5\n      };\n      return {\n        stamp: state.stamp,\n        x: state.x, y: state.y,\n        transform: [ `translate(${state.x-cx},${state.y-cy})`,\n                     `rotate(${state.r},${cx},${cy})`\n                   ].join(' '),\n        cx, cy, radius, dx, dy, frx, flx, los,\n        width: img.width, height: img.height,\n        img: img.link,\n        base_color: info.base_color,\n        title: modelModel.descriptionFromInfo(info, {state}),\n        area, ctrl, aura, lock, dmg, field, label,\n        counter, souls, melee, effects, unit\n      };\n    }\n    function computeMeleePath(size, img, info) {\n      return [\n        `M${img.width/2-info.base_radius-size},${img.height/2}`,\n        `L${img.width/2+info.base_radius+size},${img.height/2}`,\n        `A${info.base_radius+size},${info.base_radius+size} 0 0,0`,\n        `${img.width/2-info.base_radius-size},${img.height/2}`,\n        `M${img.width/2},${img.height/2}`,\n        `L${img.width/2},${img.height/2-info.base_radius-size}`,\n      ].join(' ');\n    }\n  }\n})();\n"]}