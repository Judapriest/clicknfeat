{"version":3,"sources":["../../es6/controllers/loungeCtrl.js"],"names":[],"mappings":"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","file":"loungeCtrl.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.controllers')\n  .controller('loungeCtrl', [\n    '$scope',\n    'user',\n    'game',\n    'games',\n    'fileImport',\n    function($scope,\n             userService,\n             gameService,\n             gamesService,\n             fileImportService) {\n      console.log('init loungeCtrl');\n\n      gamesService.loadLocalGames()\n        .then(function(games) {\n          $scope.local_games = games;\n        });\n\n      $scope.local_games_selection = {};\n      function loadNewLocalGame(game) {\n        return R.pipeP(\n          gamesService.newLocalGame$(game),\n          function(games) {\n            $scope.local_games = games;\n            $scope.goToState('game', {\n              online: 'offline',\n              private: 'private',\n              id: R.length($scope.local_games)-1\n            });\n            $scope.$digest();\n          }\n        )($scope.local_games);\n      }\n      $scope.doCreateLocalGame = function() {\n        var game = gameService.create($scope.user.state);\n        return loadNewLocalGame(game);\n      };\n      $scope.doOpenLocalGameFile = function(files) {\n        return R.pipeP(\n          fileImportService.read$('json'),\n          loadNewLocalGame\n        )(files[0])\n          .catch(function() {\n            console.log('Failed to open local game file');\n          });\n      };\n      $scope.doLoadLocalGame = function() {\n        $scope.goToState('game', {\n          online: 'offline',\n          private: 'private',\n          id: $scope.local_games_selection.list[0]\n        });\n      };\n      $scope.doDeleteLocalGame = function() {\n        return R.pipeP(\n          gamesService.removeLocalGame$($scope.local_games_selection.list[0]),\n          function(games) {\n            $scope.local_games = games;\n            $scope.setLocalGamesSelection($scope.local_games_selection.list[0]);\n            $scope.$digest();\n          }\n        )($scope.local_games);\n      };\n\n      $scope.online_games_selection = {};\n      function loadNewOnlineGame(game) {\n        return R.pipeP(\n          gamesService.newOnlineGame,\n          function(game) {\n            $scope.goToState('game', {\n              online: 'online',\n              private: 'private',\n              id: game.private_stamp,\n            });\n          }\n        )(game);\n      }\n      $scope.doCreateOnlineGame = function() {\n        var game = gameService.create($scope.user.state);\n        return loadNewOnlineGame(game);\n      };\n      $scope.doOpenOnlineGameFile = function(files) {\n        return R.pipeP(\n          fileImportService.read$('json'),\n          loadNewOnlineGame\n        )(files[0])\n          .catch(function() {\n            console.log('Failed to open online game file');\n          });\n      };\n      $scope.doLoadOnlineGame = function() {\n        var game_index = $scope.online_games_selection.list[0];\n        var stamp = R.propOr('null', 'public_stamp', $scope.user.connection.games[game_index]);\n        $scope.goToState('game', {\n          online: 'online',\n          private: 'public',\n          id: stamp\n        });\n      };\n\n      $scope.doUserToggleOnline = function() {\n        return R.pipeP(\n          userService.toggleOnline,\n          $scope.setUser\n        )($scope.user);\n      };\n    }\n  ]);\n"]}