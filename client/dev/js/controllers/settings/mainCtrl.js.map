{"version":3,"sources":["../../../es6/controllers/settings/mainCtrl.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,sBAAsB,CAAC,CACnC,UAAU,CAAC,kBAAkB,EAAE,CAC9B,QAAQ,EACR,YAAY,EACZ,YAAY,EACZ,UAAS,MAAM,EACN,iBAAiB,EACjB,iBAAiB,EAAE;AAC1B,SAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;;AAErC,QAAM,CAAC,IAAI,GAAG;AACZ,QAAI,EAAE,0BAA0B;AAChC,OAAG,EAAE,IAAI;GACV,CAAC;AACF,WAAS,OAAO,GAAG;AACjB,qBAAiB,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;GAC5C;AACD,QAAM,CAAC,aAAa,GAAG,SAAS,aAAa,GAAG;AAC9C,WAAO,EAAE,CAAC;;AAEV,KAAC,CAAC,KAAK,CACL,YAAW;AACT,aAAO,iBAAiB,CACrB,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;KAC9C,EACD,UAAS,GAAG,EAAE;AACZ,YAAM,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;KACvB,CACF,EAAE,CAAC;GACL,CAAC;AACF,QAAM,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;AAChC,QAAM,CAAC,UAAU,CACd,IAAI,CAAC,YAAW;AACf,UAAM,CAAC,aAAa,EAAE,CAAC;GACxB,CAAC,CAAC;;AAEL,QAAM,CAAC,kBAAkB,GAAG,UAAS,KAAK,EAAE;AAC1C,WAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;;AAEvC,UAAM,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;AAC3B,KAAC,CAAC,IAAI,CACJ,YAAW;AACT,aAAO,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAC5C,KAAK,CAAC,UAAS,KAAK,EAAE;AACrB,cAAM,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC;OAC/B,CAAC,CAAC;KACN,EACD,UAAS,IAAI,EAAE;AACb,UAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,OAAO;;AAEzB,YAAM,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;AAC7B,YAAM,CAAC,aAAa,CAAC,GAAG,CAAE,iBAAiB,CAAE,CAAC;KAC/C,EACD,YAAW;AACT,YAAM,CAAC,OAAO,EAAE,CAAC;KAClB,CACF,EAAE,CAAC;GACL,CAAC;CACH,CACF,CAAC,CAAC","file":"mainCtrl.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.controllers')\n  .controller('settingsMainCtrl', [\n    '$scope',\n    'fileImport',\n    'fileExport',\n    function($scope,\n             fileImportService,\n             fileExportService) {\n      console.log('init settingsMainCtrl');\n      \n      $scope.save = {\n        name: 'clicknfeat_settings.json',\n        url: null,\n      };\n      function cleanup() {\n        fileExportService.cleanup($scope.save.url);\n      }\n      $scope.updateExports = function updateExports() {\n        cleanup();\n        \n        R.pipeP(\n          function() {\n            return fileExportService\n              .generate('json', $scope.settings.current);\n          },\n          function(url) {\n            $scope.save.url = url;\n          }\n        )();\n      };\n      $scope.$on('$destroy', cleanup);\n      $scope.data_ready\n        .then(function() {\n          $scope.updateExports();\n        });\n\n      $scope.doOpenSettingsFile = function(files) {\n        console.log('openSettingsFile', files);\n\n        $scope['open_result'] = '';\n        R.pipe(\n          function() {\n            return fileImportService.read('json', files[0])\n              .catch(function(error) {\n                $scope['open_result'] = error;\n              });\n          },\n          function(data) {\n            if(R.isNil(data)) return;\n            \n            $scope.doResetSettings(data);\n            $scope['open_result'] = [ 'Settings loaded' ];\n          },\n          function() {\n            $scope.$digest();\n          }\n        )();\n      };\n    }\n  ]);\n"]}