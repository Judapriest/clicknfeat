{"version":3,"sources":["../../es6/directives/gameCreateTemplate.js"],"names":[],"mappings":"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","file":"gameCreateTemplate.js","sourcesContent":["angular.module('clickApp.directives')\n  .directive('clickGameCreateTemplate', [\n    'gameMap',\n    function(gameMapService) {\n      var templates = {};\n      return {\n        restrict: 'A',\n        link: function(scope, parent) {\n          var map = document.getElementById('map');\n          var svgNS = map.namespaceURI;\n\n          templates['aoe'] = {\n            create: createAoE,\n            setPosition: setAoEPosition\n          };\n          templates['spray'] = {\n            create: createSpray,\n            setPosition: setSprayPosition\n          };\n          templates['wall'] = {\n            create: createWall,\n            setPosition: setWallPosition\n          };\n\n          console.log('clickCreateTemplate', scope.index);\n          let state = scope.state;\n          let template = R.nth(scope.index, state.create.template.templates);\n          let type = template.type;\n\n          let element = templates[type].create(document, svgNS, parent[0]);\n          let is_flipped = gameMapService.isFlipped(map);\n          templates[type].setPosition(state.create.template.base, is_flipped, template, element);\n\n          scope.onStateChangeEvent('Game.create.update', () => {\n            if(R.isNil(R.path(['create','template'], state))) return;\n\n            is_flipped = gameMapService.isFlipped(map);\n            templates[type].setPosition(state.create.template.base, is_flipped, template, element);\n          }, scope);\n        }\n      };\n      function createAoE(document, svgNS, parent) {\n        var aoe = document.createElementNS(svgNS, 'circle');\n        aoe.classList.add('create-template-aoe');\n        aoe.setAttribute('cx', '240');\n        aoe.setAttribute('cy', '240');\n        aoe.setAttribute('r', '15');\n        parent.appendChild(aoe);\n        return aoe;\n      }\n      function setAoEPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('cx', (base.x + coeff * template.x)+'');\n        element.setAttribute('cy', (base.y + coeff * template.y)+'');\n      }\n      function createSpray(document, svgNS, parent) {\n        var sp = document.createElementNS(svgNS, 'polygon');\n        sp.classList.add('create-template-spray');\n        sp.setAttribute('points', '8.75,0 5.125,-59 10,-60 14.875,-59 11.25,0');\n        sp.setAttribute('transform', 'translate(230,240)');\n        parent.appendChild(sp);\n        return sp;\n      }\n      function setSprayPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('transform', [\n          'translate(',\n          (base.x + coeff * template.x)-10,\n          ',',\n          (base.y + coeff * template.y),\n          ')',\n        ].join(''));\n      }\n      function createWall(document, svgNS, parent) {\n        var wall = document.createElementNS(svgNS, 'rect');\n        wall.classList.add('create-template-wall');\n        wall.setAttribute('x', '220');\n        wall.setAttribute('y', '236.25');\n        wall.setAttribute('width', '40');\n        wall.setAttribute('height', '7.5');\n        parent.appendChild(wall);\n        return wall;\n      }\n      function setWallPosition(base, is_flipped, template, element) {\n        var coeff = is_flipped ? -1 : 1;\n        element.setAttribute('x', ((base.x + coeff * template.x)-20)+'');\n        element.setAttribute('y', ((base.y + coeff * template.y)-3.75)+'');\n      }\n    }\n  ]);\n"]}