{"version":3,"sources":["../../es6/directives/mailNotification.js"],"names":[],"mappings":";;AAAA,OAAO,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAClC,SAAS,CAAC,2BAA2B,EAAE,CACtC,QAAQ,EACR,UAAS,aAAa,EAAE;AACtB,SAAO;AACL,YAAQ,EAAE,GAAG;AACb,YAAQ,EAAE,CACR,4CAA4C,EAC5C,UAAU,CACX,CAAC,IAAI,CAAC,EAAE,CAAC;AACV,QAAI,EAAE,cAAS,KAAK,EAAE,mBAAO,EAAa;AACxC,UAAI,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAC9C,WAAK,CAAC,UAAU,CAAC,IAAI,CAAC,YAAM;AAC1B,YAAI,KAAK,GAAG,aAAa,CAAC,SAAS,CAAC,MAAM,EAAE,UAAC,KAAK,EAAE,KAAK,EAAK;AAC5D,cAAI,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACxB,iBAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;AACvD,cAAG,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,OAAO;;AAE/C,eAAK,CAAC,WAAW,GAAG,CAAC,CAAC;AACtB,eAAK,CAAC,IAAI,EAAE,CAAC;SACd,EAAE,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAClC,aAAK,CAAC,GAAG,CAAC,UAAU,EAAE,YAAM;AAAE,eAAK,EAAE,CAAC;SAAE,CAAC,CAAC;OAC3C,CAAC,CAAC;KACJ;GACF,CAAC;CACH,CACF,CAAC,CACD,SAAS,CAAC,2BAA2B,EAAE,CACtC,YAAW;AACT,SAAO;AACL,YAAQ,EAAE,GAAG;AACb,YAAQ,EAAE,CACR,4CAA4C,EAC5C,UAAU,CACX,CAAC,IAAI,CAAC,EAAE,CAAC;AACV,QAAI,EAAE,cAAS,KAAK,EAAE,mBAAO,EAAa;AACxC,UAAI,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAC9C,WAAK,CAAC,WAAW,CAAC,MAAM,EAAE,UAAC,KAAK,EAAK;AACnC,YAAI,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAClC,eAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;AAChD,YAAG,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO;;AAE9C,aAAK,CAAC,WAAW,GAAG,CAAC,CAAC;AACtB,aAAK,CAAC,IAAI,EAAE,CAAC;OACd,EAAE,KAAK,CAAC,CAAC;KACX;GACF,CAAC;CACH,CACF,CAAC,CAAC","file":"mailNotification.js","sourcesContent":["angular.module('clickApp.directives')\n  .directive('clickUserMailNotification', [\n    'pubSub',\n    function(pubSubService) {\n      return {\n        restrict: 'E',\n        template: [\n          '<audio src=\"/data/sound/you_got_mail.wav\">',\n          '</audio>',\n        ].join(''),\n        link: function(scope, element/*, attrs*/) {\n          let audio = element[0].querySelector('audio');\n          scope.user_ready.then(() => {\n            let unsub = pubSubService.subscribe('chat', (event, chats) => {\n              let msg = R.last(chats);\n              console.log('userMailNotification', event, chats, msg);\n              if(msg.from === scope.user.state.stamp) return;\n              \n              audio.currentTime = 0;\n              audio.play();\n            }, scope.user.connection.channel);\n            scope.$on('$destroy', () => { unsub(); });\n          });\n        }\n      };\n    }\n  ])\n  .directive('clickGameMailNotification', [\n    function() {\n      return {\n        restrict: 'E',\n        template: [\n          '<audio src=\"/data/sound/you_got_mail.wav\">',\n          '</audio>',\n        ].join(''),\n        link: function(scope, element/*, attrs*/) {\n          let audio = element[0].querySelector('audio');\n          scope.onGameEvent('chat', (event) => {\n            let msg = R.last(scope.game.chat);\n            console.log('gameMailNotification', event, msg);\n            if(msg.from === scope.user.state.name) return;\n              \n            audio.currentTime = 0;\n            audio.play();\n          }, scope);\n        }\n      };\n    }\n  ]);\n"]}