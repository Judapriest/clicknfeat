{"version":3,"sources":["../../es6/directives/gameMap.js"],"names":[],"mappings":"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","file":"gameMap.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.directives')\n  .directive('clickGameMap', [\n    '$window',\n    'gameMap',\n    'terrain',\n    'defaultMode',\n    function($window,\n             gameMapService,\n             terrainService,\n             defaultModeService) {\n      function _eventModifiers(e) {\n        var modifiers = [];\n        \n        if (e.shiftKey) {\n          modifiers.push('shift');\n        }\n        \n        if (e.altKey) {\n          modifiers.push('alt');\n        }\n        \n        if (e.ctrlKey) {\n          modifiers.push('ctrl');\n        }\n        \n        if (e.metaKey) {\n          modifiers.push('meta');\n        }\n        \n        return modifiers.sort();\n      }\n      return {\n        restrict: 'A',\n        link: function(scope, element/*, attrs*/) {\n          var log = true ? R.bind(console.log, console) : function() {}; // eslint-disable-line\n\n          var viewport = document.querySelector('#viewport');\n          var map = element[0];\n\n          // function test() {\n          //   var map_rect = map.getBoundingClientRect();\n          //   if(map_rect.width > 0) {\n          //     console.error('map rect', map_rect.width);\n          //     return;\n          //   }\n          //   self.requestAnimationFrame(test);\n          // }\n          // test();\n          \n          var mouseEvents = (function() {\n            var drag = {\n              active: false,\n              start: null,\n              target: null,\n              now: null,\n            };\n            function mouseDownMap(event) {\n              log('mouseDownMap', event);\n              let inputs = [\n                ...document.querySelectorAll('input'),\n                ...document.querySelectorAll('select'),\n                ...document.querySelectorAll('textarea'),\n              ];\n              R.forEach((e) => { e.blur(); }, inputs);\n              event.preventDefault();\n              if(event.which !== 1) return;\n\n              map.addEventListener('mousemove', dragMap);\n              var start = gameMapService.eventToMapCoordinates(map, event);\n              gameMapService.findEventTarget(scope.game, event)\n                .then(function onFindEventTarget(target) {\n                  drag = {\n                    active: false,\n                    start: start,\n                    target: target,\n                    now: null,\n                  };\n                });\n            }\n            function dragMap(event) {\n              log('dragMap', event);\n              event.preventDefault();\n              if(event.which !== 1) return;\n\n              drag.now = gameMapService.eventToMapCoordinates(map, event);\n              if(!drag.active &&\n                 Math.abs(drag.now.x - drag.start.x) < defaultModeService.moves().DragEpsilon &&\n                 Math.abs(drag.now.y - drag.start.y) < defaultModeService.moves().DragEpsilon) {\n                return;\n              }\n              var emit = drag.active ? 'drag' : 'dragStart';\n              drag.active = true;\n\n              if('Terrain' === drag.target.type &&\n                 terrainService.isLocked(drag.target.target)) {\n                drag.target = { type: 'Map',\n                                target: null\n                              };\n              }\n              scope.$emit(emit+drag.target.type,\n                          { target: drag.target.target,\n                            start: drag.start,\n                            now: drag.now\n                          },\n                          event);\n            }\n            function mouseLeaveMap(event) {\n              log('mouseLeaveMap', event);\n              event.preventDefault();\n\n              map.removeEventListener('mousemove', dragMap);\n              if(drag.active) {\n                drag.active = false;\n                scope.$emit('dragEnd'+drag.target.type,\n                            { target: drag.target.target,\n                              start: drag.start,\n                              now: drag.now\n                            },\n                            event);\n              }\n            }\n            function clickMap(event) {\n              log('clickMap', event);\n              event.preventDefault();\n              if(event.which !== 1) return;\n\n              map.removeEventListener('mousemove', dragMap);\n\n              var now = gameMapService.eventToMapCoordinates(map, event);\n              if(drag.active) {\n                drag.active = false;\n                scope.$emit('dragEnd'+drag.target.type,\n                            { target: drag.target.target,\n                              start: drag.start,\n                              now: now\n                            },\n                            event);\n              }\n              else {\n                gameMapService.findEventTarget(scope.game, event)\n                  .then(function onFindEventTarget(target) {\n                    var event_name = R.pipe(\n                      R.append('click'+target.type),\n                      R.join('+')\n                    )(_eventModifiers(event));\n                    event['click#'] = {\n                      target: target.target,\n                      x: now.x,\n                      y: now.y\n                    };\n                    scope.gameEvent('closeSelectionDetail');\n                    scope.gameEvent('closeEditLabel');\n                    scope.gameEvent('closeEditDamage');\n                    Mousetrap.trigger(event_name,\n                                      undefined,\n                                      event);\n                  });\n              }\n            }\n            function rightClickMap(event) {\n              log('rightClickMap', event);\n              event.preventDefault();\n\n              var now = gameMapService.eventToMapCoordinates(map, event);\n              gameMapService.findEventTarget(scope.game, event)\n                .then(function onFindEventTarget(target) {\n                  var event_name = R.pipe(\n                    R.append('rightClick'+target.type),\n                    R.join('+')\n                  )(_eventModifiers(event));\n                  event['click#'] = {\n                    target: target.target,\n                    x: now.x,\n                    y: now.y\n                  };\n                  scope.gameEvent('closeSelectionDetail');\n                  scope.gameEvent('closeEditLabel');\n                  scope.gameEvent('closeEditDamage');\n                  Mousetrap.trigger(event_name,\n                                    undefined,\n                                    event);\n                });\n            }\n            function moveMap(event) {\n              log('moveMap', event);\n              event.preventDefault();\n\n              var now = gameMapService.eventToMapCoordinates(map, event);\n              scope.$emit('moveMap', now, event);\n            }\n            return {\n              down: mouseDownMap,\n              drag: dragMap,\n              leave: mouseLeaveMap,\n              click: clickMap,\n              rightClick: rightClickMap,\n              move: moveMap,\n            };\n          })();\n\n          var moveEvents = (function() {\n            var move_enabled = false;\n            function onEnableMove() {\n              if(move_enabled) return;\n              map.addEventListener('mousemove', mouseEvents.move);\n              move_enabled = true;\n            }\n            function onDisableMove() {\n              if(!move_enabled) return;\n              map.removeEventListener('mousemove', mouseEvents.move);\n              move_enabled = false;\n            }\n            return {\n              enable: onEnableMove,\n              disable: onDisableMove,\n            };\n          })();\n\n          var flipMap = (function() {\n            var deploiement_labels;\n            scope.ui_state.flip_map = false;\n            map.classList.remove('flipped');\n            return function flipMap() {\n              deploiement_labels = R.defaultTo(document.querySelector('#deploiement-labels'),\n                                               deploiement_labels);\n              scope.ui_state.flip_map = !map.classList.contains('flipped');\n              map.classList.toggle('flipped');\n              if(scope.ui_state.flip_map) {\n                deploiement_labels.setAttribute('transform','rotate(180,240,240)');\n              }\n              else {\n                deploiement_labels.setAttribute('transform','');\n              }\n              scope.gameEvent('mapFlipped');\n            };\n          })();\n\n          var zoomEvents = (function() {\n            function zoomReset() {\n              var rect = viewport.getBoundingClientRect();\n              var hw = Math.min(rect.width, rect.height);\n              setMapDimensions(hw-15);\n            }\n            function zoomIn() {\n              var vp = findViewportCenter();\n              var cx_cy = vp[0];\n              var vw_vh = vp[1];\n    \n              var rect = map.getBoundingClientRect();\n              var cx = (vw_vh[0] > rect.width) ? rect.width / 2 : cx_cy[0];\n              var cy = (vw_vh[1] > rect.height) ? rect.height / 2 : cx_cy[1];\n\n              setMapDimensions(rect.width*2);\n              setViewportCenter(cx*2, cy*2, vw_vh[0], vw_vh[1]);\n            }\n            function zoomOut() {\n              var vp = findViewportCenter();\n              var cx_cy = vp[0];\n              var vw_vh = vp[1];\n              var hw = Math.min(vw_vh[0], vw_vh[1]);\n            \n              var rect = map.getBoundingClientRect();\n\n              setMapDimensions(Math.max(hw-15, rect.width/2));\n              setViewportCenter(cx_cy[0]/2, cx_cy[1]/2, vw_vh[0], vw_vh[1]);\n            }\n            return {\n              in: zoomIn,\n              out: zoomOut,\n              reset: zoomReset,\n            };\n          })();\n\n          var scrollEvents = (function() {\n            var scroll_indent = 30;\n            function scrollLeft() {\n              var left = viewport.scrollLeft;\n              $window.requestAnimationFrame(function _scrollLeft() {\n                viewport.scrollLeft = left - scroll_indent;\n              });\n            }\n            function scrollRight() {\n              var left = viewport.scrollLeft;\n              $window.requestAnimationFrame(function _scrollRight() {\n                viewport.scrollLeft = left + scroll_indent;\n              });\n            }\n            function scrollUp() {\n              var top = viewport.scrollTop;\n              $window.requestAnimationFrame(function _scrollUp() {\n                viewport.scrollTop = top - scroll_indent;\n              });\n            }\n            function scrollDown() {\n              var top = viewport.scrollTop;\n              $window.requestAnimationFrame(function _scrollDown() {\n                viewport.scrollTop = top + scroll_indent;\n              });\n            }\n            return {\n              left: scrollLeft,\n              right: scrollRight,\n              up: scrollUp,\n              down: scrollDown,\n            };\n          })();\n\n          function setMapDimensions(dim) {\n            $window.requestAnimationFrame(function _setMapDimensions() {\n              map.style.width = dim+'px';\n              map.style.height = dim+'px';\n            });\n          }          \n\n          function findViewportCenter() {\n            var rect = viewport.getBoundingClientRect();\n            var vw = rect.width;\n            var vh = rect.height;\n\n            var cx = viewport.scrollLeft + vw/2;\n            var cy = viewport.scrollTop + vh/2;\n\n            return [[cx, cy], [vw, vh]];\n          }\n\n          function setViewportCenter(cx, cy, vw, vh) {\n            $window.requestAnimationFrame(function _setViewportCenter() {\n              viewport.scrollLeft = cx - vw/2;\n              viewport.scrollTop = cy - vh/2;\n            });\n          }\n\n          map.addEventListener('mouseup', mouseEvents.click);\n          map.addEventListener('mousedown', mouseEvents.down);\n          map.addEventListener('mouseleave', mouseEvents.leave);\n          map.addEventListener('dragstart', function dragStartDisable(event){\n            event.preventDefault();\n          });\n          map.addEventListener('contextmenu', mouseEvents.rightClick);\n          \n          scope.onGameEvent('flipMap', flipMap, scope);\n          scope.onGameEvent('enableMoveMap', moveEvents.enable, scope);\n          scope.onGameEvent('disableMoveMap', moveEvents.disable, scope);\n          scope.onGameEvent('viewZoomIn', zoomEvents.in, scope);\n          scope.onGameEvent('viewZoomOut', zoomEvents.out, scope);\n          scope.onGameEvent('viewZoomReset', zoomEvents.reset, scope);\n          scope.onGameEvent('viewScrollLeft', scrollEvents.left, scope);\n          scope.onGameEvent('viewScrollRight', scrollEvents.right, scope);\n          scope.onGameEvent('viewScrollUp', scrollEvents.up, scope);\n          scope.onGameEvent('viewScrollDown', scrollEvents.down, scope);\n\n          $window.requestAnimationFrame(function initMap() {\n            zoomEvents.reset();\n          });\n        }\n      };\n    }\n  ]);\n"]}