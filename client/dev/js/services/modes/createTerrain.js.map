{"version":3,"sources":["../../../es6/services/modes/createTerrain.js"],"names":[],"mappings":";;AAAA,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAChC,OAAO,CAAC,mBAAmB,EAAE,CAC5B,OAAO,EACP,UAAU,EACV,YAAY,EACZ,MAAM,EACN,SAAS,+BAA+B,CAAC,YAAY,EACZ,eAAe,EACf,iBAAiB,EAAE;AAC1D,MAAI,qBAAqB,GAAG,MAAM,CAAC,MAAM,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;AACrE,WAAS,gBAAgB,CAAC,KAAK,EAAE,KAAK,EAAE;AACtC,SAAK,CAAC,MAAM,GAAG,CAAC,CAAC,IAAI,CACnB,CAAC,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAC,MAAM,CAAC,CAAC,EAC9B,CAAC,CAAC,IAAI,CACJ,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC,EACrB,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC,CACtB,EACD,KAAK,CAAC,MAAM,CACb,CAAC;GACH;AACD,uBAAqB,CAAC,OAAO,GAAG,UAAC,KAAK,EAAE,KAAK,EAAK;AAChD,oBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;AAC/B,WAAO,KAAK,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;GAChD,CAAC;AACF,uBAAqB,CAAC,MAAM,GAAG,UAAC,KAAK,EAAE,KAAK,EAAK;AAC/C,QAAI,UAAU,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,UAAU,EAAC,UAAU,CAAC,EAAE,KAAK,CAAC,CAAC;AACxD,oBAAgB,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,CAAC;AACzC,WAAO,KAAK,CAAC,KAAK,CAAC,sBAAsB,EACtB,eAAe,EAAE,CAAE,KAAK,CAAC,MAAM,CAAC,OAAO,EAAE,UAAU,CAAE,CAAC,CAAC;GAC3E,CAAC;AACF,MAAI,8BAA8B,GAAG;AACnC,YAAQ,EAAE,UAAU;GACrB,CAAC;AACF,MAAI,sBAAsB,GAAG,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EACzC,8BAA8B,CAAC,CAAC;AACtE,MAAI,qBAAqB,GAAG,EAAE,CAAC;AAC/B,MAAI,kBAAkB,GAAG;AACvB,WAAO,EAAE,iBAAC,KAAK,EAAK;AAClB,WAAK,CAAC,WAAW,CAAC,4BAA4B,CAAC,CAAC;AAChD,WAAK,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC;KAC1C;AACD,WAAO,EAAE,iBAAC,KAAK,EAAK;AAClB,WAAK,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;AACtD,WAAK,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC;AAC1C,WAAK,CAAC,WAAW,CAAC,6BAA6B,CAAC,CAAC;KAClD;AACD,QAAI,EAAE,eAAe;AACrB,WAAO,EAAE,qBAAqB;AAC9B,WAAO,EAAE,qBAAqB;AAC9B,YAAQ,EAAE,sBAAsB;GACjC,CAAC;AACF,cAAY,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC;AAC9C,iBAAe,CAAC,QAAQ,CAAC,UAAU,EACV,kBAAkB,CAAC,IAAI,EACvB,8BAA8B,EAC9B,UAAC,EAAE,EAAK;AACN,KAAC,CAAC,MAAM,CAAC,kBAAkB,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;GAC3C,CAAC,CAAC;AAC5B,SAAO,kBAAkB,CAAC;CAC3B,CACF,CAAC,CAAC","file":"createTerrain.js","sourcesContent":["angular.module('clickApp.services')\n  .factory('createTerrainMode', [\n    'modes',\n    'settings',\n    'commonMode',\n    'game',\n    function createTerrainModeServiceFactory(modesService,\n                                             settingsService,\n                                             commonModeService) {\n      var createTerrain_actions = Object.create(commonModeService.actions);\n      function updateCreateBase(coord, state) {\n        state.create = R.over(\n          R.lensPath(['terrain','base']),\n          R.pipe(\n            R.assoc('x', coord.x),\n            R.assoc('y', coord.y)\n          ),\n          state.create\n        );\n      }\n      createTerrain_actions.moveMap = (state, coord) => {\n        updateCreateBase(coord, state);\n        return state.changeEvent('Game.create.update');\n      };\n      createTerrain_actions.create = (state, event) => {\n        let is_flipped = R.path(['ui_state','flip_map'], state);\n        updateCreateBase(event['click#'], state);\n        return state.event('Game.command.execute',\n                           'createTerrain', [ state.create.terrain, is_flipped ]);\n      };\n      var createTerrain_default_bindings = {\n        'create': 'clickMap'\n      };\n      var createTerrain_bindings = R.extend(Object.create(commonModeService.bindings),\n                                            createTerrain_default_bindings);\n      var createTerrain_buttons = [];\n      var createTerrain_mode = {\n        onEnter: (state) => {\n          state.changeEvent('Game.terrain.create.enable');\n          state.changeEvent('Game.moveMap.enable');\n        },\n        onLeave: (state) => {\n          state.create = R.assoc('terrain', null, state.create);\n          state.changeEvent('Game.moveMap.disable');\n          state.changeEvent('Game.terrain.create.disable');\n        },\n        name: 'CreateTerrain',\n        actions: createTerrain_actions,\n        buttons: createTerrain_buttons,\n        bindings: createTerrain_bindings\n      };\n      modesService.registerMode(createTerrain_mode);\n      settingsService.register('Bindings',\n                               createTerrain_mode.name,\n                               createTerrain_default_bindings,\n                               (bs) => {\n                                 R.extend(createTerrain_mode.bindings, bs);\n                               });\n      return createTerrain_mode;\n    }\n  ]);\n"]}