{"version":3,"sources":["../../../es6/services/command/rollDice.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAChC,OAAO,CAAC,iBAAiB,EAAE,CAC1B,UAAU,EACV,SAAS,6BAA6B,CAAC,eAAe,EAAE;AACtD,MAAI,sBAAsB,GAAG;AAC3B,WAAO,EAAE,SAAS,eAAe,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE;AAC7D,UAAI,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,YAAW;AAC7B,eAAO,CAAC,CAAC,WAAW,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;OAChC,EAAE,OAAO,CAAC,CAAC;AACZ,UAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;AACtC,UAAI,IAAI,GAAG;AACT,YAAI,EAAE,GAAG,GAAC,KAAK,GAAC,GAAG,GAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAC,OAAO,GAAC,KAAK;AACjD,SAAC,EAAE,KAAK;AACR,SAAC,EAAE,OAAO;AACV,SAAC,EAAE,KAAK;OACT,CAAC;AACF,UAAI,CAAC,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;AACtC,WAAK,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;AAClC,aAAO,IAAI,CAAC;KACb;AACD,UAAM,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC/C,UAAI,CAAC,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;AACtC,WAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;KAC7B;AACD,QAAI,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC7C,UAAI,CAAC,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;AAC/D,WAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;KAC7B;GACF,CAAC;AACF,iBAAe,CAAC,eAAe,CAAC,UAAU,EAAE,sBAAsB,CAAC,CAAC;AACpE,SAAO,sBAAsB,CAAC;CAC/B,CACF,CAAC,CAAC","file":"rollDice.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('rollDiceCommand', [\n    'commands',\n    function rollDiceCommandServiceFactory(commandsService) {\n      var rollDiceCommandService = {\n        execute: function rollDiceExecute(sides, nb_dice, scope, game) {\n          var dices = R.times(function() {\n            return R.randomRange(1, sides);\n          }, nb_dice);\n          var total = R.reduce(R.add, 0, dices);\n          var ctxt = {\n            desc: 'd'+sides+'['+dices.join(',')+'] =  '+total,\n            s: sides,\n            n: nb_dice,\n            d: dices,\n          };\n          game.dice = R.append(ctxt, game.dice);\n          scope.gameEvent('diceRoll', ctxt);\n          return ctxt;\n        },\n        replay: function rollDiceRedo(ctxt, scope, game) {\n          game.dice = R.append(ctxt, game.dice);\n          scope.gameEvent('diceRoll');\n        },\n        undo: function rollDiceUndo(ctxt, scope, game) {\n          game.dice = R.reject(R.propEq('stamp', ctxt.stamp), game.dice);\n          scope.gameEvent('diceRoll');\n        }\n      };\n      commandsService.registerCommand('rollDice', rollDiceCommandService);\n      return rollDiceCommandService;\n    }\n  ]);\n"]}