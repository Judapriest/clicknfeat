{"version":3,"sources":["../../../es6/services/command/rollDice.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAChC,OAAO,CAAC,iBAAiB,EAAE,CAC1B,UAAU,EACV,SAAS,6BAA6B,CAAC,eAAe,EAAE;AACtD,MAAI,sBAAsB,GAAG;AAC3B,WAAO,EAAE,SAAS,eAAe,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE;AAC7D,UAAI,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,YAAW;AAC7B,eAAO,CAAC,CAAC,WAAW,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;OAChC,EAAE,OAAO,CAAC,CAAC;AACZ,UAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,KAAK,CAAC,CACpC;AACD,UAAI,IAAI,GAAG;AACT,YAAI,QAAM,KAAK,SAAI,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,YAAO,KAAK,AAAE;AAChD,SAAC,EAAE,KAAK;AACR,SAAC,EAAE,OAAO;AACV,SAAC,EAAE,KAAK;OACT,CAAC;;AAEF,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KACrB;AACD,UAAM,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC/C,UAAI,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AACtC,UAAI,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;;AAEnD,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,IAAI,CAAC;KACb;AACD,QAAI,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC7C,UAAI,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AACtC,UAAI,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;;AAE5E,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,IAAI,CAAC;KACb;GACF,CAAC;AACF,iBAAe,CAAC,eAAe,CAAC,UAAU,EAAE,sBAAsB,CAAC,CAAC;AACpE,SAAO,sBAAsB,CAAC;CAC/B,CACF,CAAC,CAAC","file":"rollDice.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('rollDiceCommand', [\n    'commands',\n    function rollDiceCommandServiceFactory(commandsService) {\n      var rollDiceCommandService = {\n        execute: function rollDiceExecute(sides, nb_dice, state, game) {\n          var dices = R.times(function() {\n            return R.randomRange(1, sides);\n          }, nb_dice);\n          var total = R.reduce(R.add, 0, dices)\n          ;\n          var ctxt = {\n            desc: `d${sides}[${dices.join(',')}] = ${total}`,\n            s: sides,\n            n: nb_dice,\n            d: dices\n          };\n          \n          state.changeEvent('Game.dice.roll');\n          \n          return [ctxt, game];\n        },\n        replay: function rollDiceRedo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.append(ctxt, dice), game);\n\n          state.changeEvent('Game.dice.roll');\n          \n          return game;\n        },\n        undo: function rollDiceUndo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.reject(R.propEq('stamp', ctxt.stamp), dice), game);\n\n          state.changeEvent('Game.dice.roll');\n          \n          return game;\n        }\n      };\n      commandsService.registerCommand('rollDice', rollDiceCommandService);\n      return rollDiceCommandService;\n    }\n  ]);\n"]}