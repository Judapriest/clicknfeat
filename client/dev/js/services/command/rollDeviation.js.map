{"version":3,"sources":["../../../es6/services/command/rollDeviation.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAChC,OAAO,CAAC,sBAAsB,EAAE,CAC/B,UAAU,EACV,SAAS,kCAAkC,CAAC,eAAe,EAAE;AAC3D,MAAI,2BAA2B,GAAG;AAChC,WAAO,EAAE,SAAS,oBAAoB,CAAC,KAAK,EAAE,IAAI,EAAE;AAClD,UAAI,SAAS,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACpC,UAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;AAEnC,UAAI,IAAI,GAAG;AACT,YAAI,iCAA+B,SAAS,mBAAc,QAAQ,MAAG;AACrE,SAAC,EAAE,SAAS;AACZ,SAAC,EAAE,QAAQ;OACZ,CAAC;;AAEF,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KACrB;AACD,UAAM,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC/C,UAAI,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AACtC,UAAI,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;;AAEnD,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,IAAI,CAAC;KACb;AACD,QAAI,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE;AAC7C,UAAI,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AACtC,UAAI,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;;AAE5E,WAAK,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;;AAEpC,aAAO,IAAI,CAAC;KACb;GACF,CAAC;AACF,iBAAe,CAAC,eAAe,CAAC,eAAe,EAAE,2BAA2B,CAAC,CAAC;AAC9E,SAAO,2BAA2B,CAAC;CACpC,CACF,CAAC,CAAC","file":"rollDeviation.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('rollDeviationCommand', [\n    'commands',\n    function rollDeviationCommandServiceFactory(commandsService) {\n      var rollDeviationCommandService = {\n        execute: function rollDeviationExecute(state, game) {\n          var direction = R.randomRange(1, 6);\n          var distance = R.randomRange(1, 6);\n          \n          var ctxt = {\n            desc: `AoE deviation : direction ${direction}, distance ${distance}\"`,\n            r: direction,\n            d: distance\n          };\n\n          state.changeEvent('Game.dice.roll');\n\n          return [ctxt, game];\n        },\n        replay: function rollDiceRedo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.append(ctxt, dice), game);\n\n          state.changeEvent('Game.dice.roll');\n\n          return game;\n        },\n        undo: function rollDiceUndo(ctxt, state, game) {\n          let dice = R.propOr([], 'dice', game);\n          game = R.assoc('dice', R.reject(R.propEq('stamp', ctxt.stamp), dice), game);\n\n          state.changeEvent('Game.dice.roll');\n\n          return game;\n        }\n      };\n      commandsService.registerCommand('rollDeviation', rollDeviationCommandService);\n      return rollDeviationCommandService;\n    }\n  ]);\n"]}