{"version":3,"sources":["../../../es6/services/game/terrainSelection.js"],"names":[],"mappings":"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","file":"terrainSelection.js","sourcesContent":["angular.module('clickApp.services')\n  .factory('gameTerrainSelection', [\n    function gameTerrainSelectionServiceFactory() {\n      var gameTerrainSelectionService = {\n        create: function terrainSelectionCreate() {\n          return {\n            local: [],\n            remote: [],\n          };\n        },\n        'in': function terrainSelectionIn(where, stamp, selection) {\n          var stamps = R.prop(where, selection);\n          return R.find(R.equals(stamp), stamps);\n        },\n        get: function terrainSelectionGet(where, selection) {\n          return R.pipe(\n            R.defaultTo({}),\n            R.propOr([], where)\n          )(selection);\n        },\n        checkMode: function terrainSelectionCheckMode(scope, selection) {\n          return R.pipePromise(\n            gameTerrainSelectionService.get$('local'),\n            R.head,\n            (stamp) => {\n              if(R.isNil(stamp)) {\n                return self.Promise.reject('No terrain selection');\n              }\n\n              return scope.doSwitchToMode('Terrain');\n            }\n          )(selection);\n        },\n        set: function terrainSelectionSet(where, stamps, scope, selection) {\n          var previous = gameTerrainSelectionService.get(where, selection);\n          var ret = R.assoc(where, stamps, selection);\n\n          if('local' === where) {\n            scope.doSwitchToMode('Default');\n          }\n          \n          R.forEach(function(stamp) {\n            scope.gameEvent('changeTerrain-'+stamp);\n          }, stamps);\n          R.forEach(function(stamp) {\n            scope.gameEvent('changeTerrain-'+stamp);\n          }, previous);\n\n          return ret;\n        },\n        addTo: function terrainSelectionSet(where, stamps, scope, selection) {\n          var previous = gameTerrainSelectionService.get(where, selection);\n          var new_selection = R.uniq(R.concat(previous, stamps));\n          var ret = R.assoc(where, new_selection, selection);\n\n          if('local' === where) {\n            scope.doSwitchToMode('Default');\n          }\n          \n          R.forEach(function(stamp) {\n            scope.gameEvent('changeTerrain-'+stamp);\n          }, new_selection);\n\n          return ret;\n        },\n        removeFrom: function terrainSelectionRemoveFrom(where, stamps, scope, selection) {\n          var previous = R.prop(where, selection);\n          var new_selection = R.difference(previous, stamps);\n          var ret = R.assoc(where, new_selection, selection);\n          \n          if('local' === where) {\n            scope.doSwitchToMode('Default');\n          }\n\n          R.forEach(function(stamp) {\n            scope.gameEvent('changeTerrain-'+stamp);\n          }, R.uniq(R.concat(previous, stamps)));\n\n          return ret;\n        },\n        clear: function terrainSelectionClear(where, scope, selection) {\n          var previous = R.prop(where, selection);\n          return gameTerrainSelectionService\n            .removeFrom(where, previous, scope, selection);\n        },\n      };\n      R.curryService(gameTerrainSelectionService);\n      return gameTerrainSelectionService;\n    }\n  ]);\n"]}