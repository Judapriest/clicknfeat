{"version":3,"sources":["../../../es6/services/game/scenario.js"],"names":[],"mappings":"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","file":"scenario.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('gameScenario', [\n    'http',\n    'point',\n    function gameScenarioServiceFactory(httpService,\n                                        pointService) {\n      var gameScenarioService = {\n        init: function gameScenarioInit() {\n          return httpService.get('/data/scenarios.json')\n            .catch(function(reason) {\n              console.log('error getting scenarios.json', reason);\n              return [];\n            });\n        },\n        name: function gameScenarioName(scenario) {\n          return R.prop('name', scenario);\n        },\n        group: function gameScenarioGroup(group_name, groups) {\n          return R.find(R.compose(R.equals(group_name), R.head), groups);\n        },\n        forName: function gameScenarioForName(name, group) {\n          return R.find(R.propEq('name', name), group[1]);\n        },\n        groupForName: function gameScenarioGroupForName(name, groups) {\n          if(R.isNil(name)) return undefined;\n          return R.find(R.compose(R.find(R.propEq('name', name)), R.last), groups);\n        },\n        createObjectives: function gameScenarioCreateObjectives(scenario) {\n          return new self.Promise((resolve, reject) => {\n            let objectives = R.concat(\n              R.propOr([], 'objectives', scenario),\n              R.propOr([], 'flags', scenario)\n            );\n            if(R.isEmpty(objectives)) reject('No objectives');\n\n            let base = R.assoc('r', 0, R.head(objectives));\n            resolve({\n              base: R.pick(['x','y','r'], base),\n              models: R.map((objective) => {\n                return R.pipe(\n                  R.assoc('r', 0),\n                  R.assoc('info', R.concat(['scenario','models'], R.prop('info', objective))),\n                  pointService.differenceFrom$(base)\n                )(objective);\n              }, objectives)\n            });\n          });\n        },\n      };\n      return gameScenarioService;\n    }\n  ]);\n"]}