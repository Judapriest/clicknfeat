{"version":3,"sources":["../../../es6/services/game/terrainInfo.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAChC,OAAO,CAAC,iBAAiB,EAAE,CAC1B,MAAM,EACN,SAAS,6BAA6B,CAAC,WAAW,EAAE;AAClD,MAAI,sBAAsB,GAAG;AAC3B,QAAI,EAAE,SAAS,mBAAmB,GAAG;AACnC,aAAO,WAAW,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAC1C,KAAK,CAAC,UAAC,MAAM,EAAK;AACjB,eAAO,CAAC,KAAK,CAAC,6BAA6B,EAAE,MAAM,CAAC,CAAC;AACrD,eAAO,EAAE,CAAC;OACX,CAAC,CACD,IAAI,CAAC,cAAc,CAAC,CAAC;KACzB;AACD,WAAO,EAAE,SAAS,sBAAsB,CAAC,IAAI,EAAE,KAAK,EAAE;AACpD,aAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAK;AAC3C,YAAI,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AAC/B,YAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,mBAAiB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAa,CAAC,KAChE,OAAO,CAAC,IAAI,CAAC,CAAC;OACpB,CAAC,CAAC;KACJ;GACF,CAAC;AACF,WAAS,cAAc,CAAC,QAAQ,EAAE;AAChC,WAAO,CAAC,CAAC,IAAI,CACX,CAAC,CAAC,IAAI,EACN,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,EACpB,CAAC,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AACrB,SAAG,CAAC,GAAG,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;AACzC,aAAO,GAAG,CAAC;KACZ,EAAE,EAAE,CAAC,CACP,CAAC,QAAQ,CAAC,CAAC;GACb;AACD,WAAS,cAAc,CAAC,QAAQ,EAAE;AAChC,WAAO,CAAC,CAAC,IAAI,CACX,CAAC,CAAC,IAAI,EACN,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,EACpB,CAAC,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AACrB,SAAG,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;AACrC,aAAO,GAAG,CAAC;KACZ,EAAE,EAAE,CAAC,CACP,CAAC,QAAQ,CAAC,CAAC;GACb;AACD,WAAS,UAAU,CAAC,IAAI,EAAE;AACxB,WAAO,CAAC,CAAC,IAAI,CACX,CAAC,CAAC,IAAI,EACN,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,EACpB,CAAC,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AACrB,SAAG,CAAC,GAAG,CAAC,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACpC,aAAO,GAAG,CAAC;KACZ,EAAE,EAAE,CAAC,CACP,CAAC,IAAI,CAAC,CAAC;GACT;AACD,WAAS,aAAa,CAAC,OAAO,EAAE;AAC9B,WAAO,CAAC,CAAC,IAAI,CACX,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,EAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EACtD,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,EAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CACxD,CAAC,OAAO,CAAC,CAAC;GACZ;AACD,GAAC,CAAC,YAAY,CAAC,sBAAsB,CAAC,CAAC;AACvC,SAAO,sBAAsB,CAAC;CAC/B,CACF,CAAC,CAAC","file":"terrainInfo.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('gameTerrainInfo', [\n    'http',\n    function gameTerrainInfoServiceFactory(httpService) {\n      var gameTerrainInfoService = {\n        init: function gameTerrainInfoInit() {\n          return httpService.get('/data/terrains.json')\n            .catch((reason) => {\n              console.error('Error getting terrains.json', reason);\n              return [];\n            })\n            .then(updateTerrains);\n        },\n        getInfo: function gameTerrainInfoGetInfo(path, infos) {\n          return new self.Promise((resolve, reject) => {\n            var info = R.path(path, infos);\n            if(R.isNil(info)) reject(`Terrain info ${path.join('.')} not found`);\n            else resolve(info);\n          });\n        }\n      };\n      function updateTerrains(terrains) {\n        return R.pipe(\n          R.keys,\n          R.sortBy(R.identity),\n          R.reduce((mem, key) => {\n            mem[key] = updateAmbiance(terrains[key]);\n            return mem;\n          }, {})\n        )(terrains);\n      }\n      function updateAmbiance(ambiance) {\n        return R.pipe(\n          R.keys,\n          R.sortBy(R.identity),\n          R.reduce((mem, key) => {\n            mem[key] = updateType(ambiance[key]);\n            return mem;\n          }, {})\n        )(ambiance);\n      }\n      function updateType(type) {\n        return R.pipe(\n          R.keys,\n          R.sortBy(R.identity),\n          R.reduce((mem, key) => {\n            mem[key] = updateTerrain(type[key]);\n            return mem;\n          }, {})\n        )(type);\n      }\n      function updateTerrain(terrain) {\n        return R.pipe(\n          R.over(R.lensPath(['img','width']), R.divide(R.__, 3)),\n          R.over(R.lensPath(['img','height']), R.divide(R.__, 3))\n        )(terrain);\n      }\n      R.curryService(gameTerrainInfoService);\n      return gameTerrainInfoService;\n    }\n  ]);\n"]}