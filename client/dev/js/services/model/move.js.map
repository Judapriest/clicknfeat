{"version":3,"sources":["../../../es6/services/model/move.js"],"names":[],"mappings":"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","file":"move.js","sourcesContent":["'use strict';\n\nangular.module('clickApp.services')\n  .factory('modelMove', [\n    'settings',\n    'point',\n    function modelMoveServiceFactory(settingsService,\n                                     pointService) {\n      return function(MOVES, modelService) {\n        var modelMoveService = {\n          setPosition: function modelSetPosition(factions, target, pos, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n            \n            model = R.pipe(\n              R.assocPath(['state','x'], pos.x),\n              R.assocPath(['state','y'], pos.y)\n            )(model);\n            return modelService.checkState(factions, target, model);\n          },\n          setPosition_: function modelSetPosition(factions, target, pos, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n            \n            model.state = R.pipe(\n              R.assoc('x', pos.x),\n              R.assoc('y', pos.y)\n            )(model.state);\n            return R.pipePromise(\n              () => { return modelService.checkState(factions, target, model); },\n              (check) => {\n                model.state = check.state;\n                return model;\n              }\n            )();\n          },\n          shiftPosition: function modelSet(factions, target, shift, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            model = R.pipe(\n              R.over(R.lensPath(['state','x']), R.add(shift.x)),\n              R.over(R.lensPath(['state','y']), R.add(shift.y))\n            )(model);\n            return modelService.checkState(factions, target, model);\n          },\n          setOrientation: function modelSet(factions, orientation, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            model = R.assocPath(['state','r'], orientation, model);\n            return modelService.checkState(factions, null, model);\n          },\n          orientTo: function modelSet(factions, other, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            model = R.assocPath(['state','r'],\n                                pointService.directionTo(other.state, model.state),\n                                model);\n            return modelService.checkState(factions, null, model);\n          },\n          moveFront: function modelMoveFront(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'MoveSmall' : 'Move'];\n            model = R.over(R.lensProp('state'),\n                           pointService.moveFront$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          moveBack: function modelMoveBack(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'MoveSmall' : 'Move'];\n            model = R.over(R.lensProp('state'),\n                           pointService.moveBack$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          rotateLeft: function modelRotateLeft(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n            model = R.over(R.lensProp('state'),\n                           pointService.rotateLeft$(angle),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          rotateRight: function modelRotateRight(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n            model = R.over(R.lensProp('state'),\n                           pointService.rotateRight$(angle),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          shiftLeft: function modelShiftLeft(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n            model = R.over(R.lensProp('state'),\n                           pointService.shiftLeft$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          shiftRight: function modelShiftRight(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n            model = R.over(R.lensProp('state'),\n                           pointService.shiftRight$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          shiftUp: function modelShiftUp(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n            model = R.over(R.lensProp('state'),\n                           pointService.shiftUp$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          },\n          shiftDown: function modelShiftDown(factions, small, model) {\n            if(modelService.isLocked(model)) {\n              return self.Promise.reject('Model is locked');\n            }\n\n            var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n            model = R.over(R.lensProp('state'),\n                           pointService.shiftDown$(dist),\n                           model);\n            return modelService.checkState(factions, null, model);\n          }\n        };\n        return modelMoveService;\n      };\n    }\n  ]);\n"]}