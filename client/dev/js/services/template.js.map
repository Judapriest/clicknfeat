{"version":3,"sources":["../../es6/services/template.js"],"names":[],"mappings":"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","file":"template.js","sourcesContent":["angular.module('clickApp.services')\n  .factory('aoeTemplate', [\n    'template',\n    'model',\n    'point',\n    function aoeTemplateServiceFactory(templateService,\n                                       modelService,\n                                       pointService) {\n      var aoeTemplateService = Object.create(templateService);\n      aoeTemplateService.create = function aoeTemplateCreate(temp) {    \n        temp.state = R.assoc('s', 15, temp.state);\n        return temp;\n      };\n      aoeTemplateService.setSize = function aoeTemplateSetSize(size, temp) {\n        if(R.isNil(R.find(R.equals(size), [3,4,5]))) {\n          return self.Promise.reject('Invalid size for an AoE');\n        }\n        temp.state = R.assoc('s', size * 5, temp.state);\n        return null;\n      };\n      aoeTemplateService.size = function aoeTemplateSize(temp) {\n        return R.path(['state','s'], temp);\n      };\n      aoeTemplateService.deviate = function aoeTemplateDeviate(dir, len, temp) {\n        if(templateService.isLocked(temp)) {\n          return self.Promise.reject('Template is locked');\n        }\n        dir = temp.state.r + 60 * (dir-1);\n        var max_len = R.defaultTo(len, R.path(['state','m'], temp));\n        len = Math.min(len, max_len);\n        temp.state = pointService.translateInDirection(len * 10, dir,\n                                                       temp.state);\n        temp.state = R.assoc('r', dir, temp.state);\n        templateService.checkState(temp.state);\n        return null;\n      };\n      aoeTemplateService.maxDeviation = function aoeTemplateMaxDeviation(temp) {\n        return R.defaultTo(0, R.path(['state','m'], temp));\n      };\n      aoeTemplateService.setMaxDeviation = function aoeTemplateSetMaxDeviation(max, temp) {\n        temp.state = R.assoc('m', max, temp.state);\n        return null;\n      };\n      aoeTemplateService.setToRuler = function aoeTemplateSetToRuler(pos, temp) {\n        if(templateService.isLocked(temp)) {\n          return self.Promise.reject('Template is locked');\n        }\n        temp.state = R.pipe(\n          R.assoc('x', pos.x),\n          R.assoc('y', pos.y),\n          R.assoc('r', pos.r),\n          R.assoc('m', pos.m),\n          templateService.checkState\n        )(temp.state);\n        return null;\n      };\n      aoeTemplateService.setTarget = function aoeTemplateSetTarget(factions, origin, target, temp) {\n        return templateService.setPosition(target.state, temp);\n      };\n      templateService.registerTemplate('aoe', aoeTemplateService);\n      return aoeTemplateService;\n    }\n  ])\n  .factory('wallTemplate', [\n    'template',\n    self.wallTemplateServiceFactory = function wallTemplateServiceFactory(templateService) {\n      var wallTemplateService = Object.create(templateService);\n      wallTemplateService.create = function wallTemplateCreate(temp) {    \n        return temp;\n      };\n      templateService.registerTemplate('wall', wallTemplateService);\n      return wallTemplateService;\n    }\n  ])\n  .factory('sprayTemplate', [\n    'template',\n    'model',\n    'point',\n    self.sprayTemplateServiceFactory = function sprayTemplateServiceFactory(templateService,\n                                                                            modelService,\n                                                                            pointService) {\n      var sprayTemplateService = Object.create(templateService);\n      sprayTemplateService.create = function sprayTemplateCreate(temp) {    \n        temp.state = R.assoc('s', 6, temp.state);\n        return temp;\n      };\n      sprayTemplateService.setSize = function sprayTemplateSetSize(size, temp) {\n        if(R.isNil(R.find(R.equals(size), [6,8,10]))) {\n          return self.Promise.reject('Invalid size for a Spray');\n        }\n        temp.state = R.assoc('s', size, temp.state);\n        return null;\n      };\n      sprayTemplateService.size = function sprayTemplateSize(temp) {\n        return R.path(['state','s'], temp);\n      };\n      sprayTemplateService.origin = function sprayTemplateOrigin(temp) {\n        return R.path(['state','o'], temp);\n      };\n      sprayTemplateService.setOrigin = function sprayTemplateSetOrigin(factions, origin, temp) {\n        if(templateService.isLocked(temp)) {\n          return self.Promise.reject('Template is locked');\n        }\n        return R.pipeP(\n          modelService.baseEdgeInDirection$(factions, temp.state.r),\n          (position) => {\n            temp.state = R.assoc('o', origin.state.stamp, temp.state);\n\n            return templateService.setPosition(position, temp);\n          }\n        )(origin);\n      };\n      sprayTemplateService.setTarget = function sprayTemplateSetTarget(factions, origin, target, temp) {\n        if(templateService.isLocked(temp)) {\n          return self.Promise.reject('Template is locked');\n        }\n        var direction = pointService.directionTo(target.state, origin.state);\n        return R.pipeP(\n          modelService.baseEdgeInDirection$(factions, direction),\n          (position) => {\n            temp.state = R.assoc('r', direction, temp.state);\n            \n            return templateService.setPosition(position, temp);\n          }\n        )(origin);\n      };\n      var FORWARD_MOVES = [\n        'moveFront',\n        'moveBack',\n        'shiftLeft',\n        'shiftRight',\n        'shiftUp',\n        'shiftDown',\n        'setPosition',\n      ];\n      R.forEach(function(move) {\n        sprayTemplateService[move] = function sprayTemplateForwardMove(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          template.state = R.assoc('o', null, template.state);\n          templateService[move](small, template);\n          return null;\n        };\n      }, FORWARD_MOVES);\n      sprayTemplateService.rotateLeft = function sprayTemplateRotateLeft(factions, origin,\n                                                                         small, template) {\n        if(templateService.isLocked(template)) {\n          return self.Promise.reject('Template is locked');\n        }\n        if(R.isNil(origin)) return templateService.rotateLeft(small, template);\n        \n        var angle = templateService.moves()[small ? 'RotateSmall' : 'Rotate'];\n        template.state = pointService.rotateLeft(angle, template.state);\n        return R.pipeP(\n          modelService.baseEdgeInDirection$(factions, template.state.r),\n          (base_edge) => {\n            return templateService.setPosition(base_edge, template);\n          }\n        )(origin);\n      };\n      sprayTemplateService.rotateRight = function sprayTemplateRotateRight(factions, origin,\n                                                                           small, template) {\n        if(templateService.isLocked(template)) {\n          return self.Promise.reject('Template is locked');\n        }\n        if(R.isNil(origin)) return templateService.rotateRight(small, template);\n        \n        var angle = templateService.moves()[small ? 'RotateSmall' : 'Rotate'];\n        template.state = pointService.rotateRight(angle, template.state);\n        return R.pipeP(\n          modelService.baseEdgeInDirection$(factions, template.state.r),\n          (base_edge) => {\n            return templateService.setPosition(base_edge, template);\n          }\n        )(origin);\n      };\n      templateService.registerTemplate('spray', sprayTemplateService);\n      return sprayTemplateService;\n    }\n  ])\n  .factory('template', [\n    'settings',\n    'point',\n    self.templateServiceFactory = function templateServiceFactory(settingsService,\n                                                                  pointService) {\n      var TEMP_REGS = {};\n      var DEFAULT_MOVES = {\n        Move: 10,\n        MoveSmall: 1,\n        Rotate: 60,\n        RotateSmall: 6,\n        Shift: 10,\n        ShiftSmall: 1,\n      };\n      var MOVES = R.clone(DEFAULT_MOVES);\n      settingsService.register('Moves',\n                               'Template',\n                               DEFAULT_MOVES,\n                               function(moves) {\n                                 R.extend(MOVES, moves);\n                               });\n      var templateService = {\n        registerTemplate: function templateRegister(type, service) {\n          TEMP_REGS[type] = service;\n        },\n        moves: function templateMoves() {\n          return MOVES;\n        },\n        create: function templateCreate(temp) {\n          return R.pipePromise(\n            () => {\n              if(R.isNil(TEMP_REGS[temp.type])) {\n                console.log('Template: create unknown template type '+temp.type);\n                return self.Promise.reject('Create unknown template type '+temp.type);\n              }\n              return null;\n            },\n            () => {\n              var template = {\n                state: {\n                  type: temp.type,\n                  x: 0, y: 0, r: 0,\n                  l: [],\n                  stamp: R.guid()\n                }\n              };\n              return TEMP_REGS[temp.type].create(template);\n            },\n            (template) => {\n              template.state = R.deepExtend(template.state, temp);\n              return template;\n            }\n          )();\n        },\n        state: function templateState(template) {\n          return R.prop('state', template);\n        },\n        saveState: function templateSaveState(template) {\n          return R.clone(R.prop('state', template));\n        },\n        setState: function templateSetState(state, template) {\n          template.state = R.clone(state);\n        },\n        respondTo: function templateAnswerTo(method, template) {\n          return ( R.exists(TEMP_REGS[template.state.type]) &&\n                   R.exists(TEMP_REGS[template.state.type][method])\n                 );\n        },\n        call: function templateCall(method, ...args /*, template */) {\n          return new self.Promise(function(resolve, reject) {\n            var temp = R.last(args);\n            console.log('Template: call', temp, method, args);\n            if(!templateService.respondTo(method, temp)) {\n              console.log('Template: unknown call '+method+' on '+temp.state.type+' template');\n              reject('Unknown call '+method+' on '+temp.state.type+' template');\n              return;\n            }\n            resolve(TEMP_REGS[temp.state.type][method].apply(null, args));\n          });\n        },\n        checkState: function templateCheckState(state) {\n          state.x = Math.max(0, Math.min(480, state.x));\n          state.y = Math.max(0, Math.min(480, state.y));\n          return state;\n        },\n        isLocked: function templateIsLocked(template) {\n          return template.state.lk;\n        },\n        setLock: function templateIsLocked(lock, template) {\n          template.state.lk = lock;\n        },\n        setPosition: function templateSet(pos, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          template.state = R.pipe(\n            R.assoc('x', pos.x),\n            R.assoc('y', pos.y),\n            templateService.checkState\n          )(template.state);\n          return null;\n        },\n        moveFront: function templateMoveFront(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'MoveSmall' : 'Move'];\n          template.state = templateService\n            .checkState(pointService.moveFront(dist, template.state));\n          return null;\n        },\n        moveBack: function templateMoveBack(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'MoveSmall' : 'Move'];\n          template.state = templateService\n            .checkState(pointService.moveBack(dist, template.state));\n          return null;\n        },\n        rotateLeft: function templateRotateLeft(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n          template.state = templateService\n            .checkState(pointService.rotateLeft(angle, template.state));\n          return null;\n        },\n        rotateRight: function templateRotateRight(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var angle = MOVES[small ? 'RotateSmall' : 'Rotate'];\n          template.state = templateService\n            .checkState(pointService.rotateRight(angle, template.state));\n          return null;\n        },\n        shiftLeft: function templateShiftLeft(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n          template.state = templateService\n            .checkState(pointService.shiftLeft(dist, template.state));\n          return null;\n        },\n        shiftRight: function templateShiftRight(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n          template.state = templateService\n            .checkState(pointService.shiftRight(dist, template.state));\n          return null;\n        },\n        shiftUp: function templateShiftUp(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n          template.state = templateService\n            .checkState(pointService.shiftUp(dist, template.state));\n          return null;\n        },\n        shiftDown: function templateShiftDown(small, template) {\n          if(templateService.isLocked(template)) {\n            return self.Promise.reject('Template is locked');\n          }\n          var dist = MOVES[small ? 'ShiftSmall' : 'Shift'];\n          template.state = templateService\n            .checkState(pointService.shiftDown(dist, template.state));\n          return null;\n        },\n        eventName: function templateEventName(template) {\n          return R.path(['state','stamp'], template);\n        },\n        addLabel: function templateAddLabel(label, template) {\n          template.state.l = R.uniq(R.append(label, template.state.l));\n        },\n        removeLabel: function templateRemoveLabel(label, template) {\n          template.state.l = R.reject(R.equals(label), template.state.l);\n        },\n        fullLabel: function templateFullLabel(template) {\n          return template.state.l.join(' ');\n        },\n      };\n      R.curryService(templateService);\n      return templateService;\n    }\n  ])\n  .factory('allTemplates', [\n    'aoeTemplate',\n    'sprayTemplate',\n    'wallTemplate',\n    function() { return {}; }\n  ]);\n"]}